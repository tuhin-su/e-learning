(self.webpackChunktimt=self.webpackChunktimt||[]).push([[179],{421:(Yl,Ci,sr)=>{"use strict";function nt(n){return"function"==typeof n}function fu(n){const e=n(r=>{Error.call(r),r.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const Ql=fu(n=>function(e){n(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((r,o)=>`${o+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function Zl(n,t){if(n){const e=n.indexOf(t);0<=e&&n.splice(e,1)}}class de{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const i of e)i.remove(this);else e.remove(this);const{initialTeardown:r}=this;if(nt(r))try{r()}catch(i){t=i instanceof Ql?i.errors:[i]}const{_finalizers:o}=this;if(o){this._finalizers=null;for(const i of o)try{Jl(i)}catch(s){t=t??[],s instanceof Ql?t=[...t,...s.errors]:t.push(s)}}if(t)throw new Ql(t)}}add(t){var e;if(t&&t!==this)if(this.closed)Jl(t);else{if(t instanceof de){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(t)}}_hasParent(t){const{_parentage:e}=this;return e===t||Array.isArray(e)&&e.includes(t)}_addParent(t){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t}_removeParent(t){const{_parentage:e}=this;e===t?this._parentage=null:Array.isArray(e)&&Zl(e,t)}remove(t){const{_finalizers:e}=this;e&&Zl(e,t),t instanceof de&&t._removeParent(this)}}de.EMPTY=(()=>{const n=new de;return n.closed=!0,n})();const Lf=de.EMPTY;function Bf(n){return n instanceof de||n&&"closed"in n&&nt(n.remove)&&nt(n.add)&&nt(n.unsubscribe)}function Jl(n){nt(n)?n():n.unsubscribe()}const ys={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},W={setTimeout(n,t,...e){const{delegate:r}=W;return r?.setTimeout?r.setTimeout(n,t,...e):setTimeout(n,t,...e)},clearTimeout(n){const{delegate:t}=W;return(t?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Hm(n){W.setTimeout(()=>{const{onUnhandledError:t}=ys;if(!t)throw n;t(n)})}function va(){}const Vf=vo("C",void 0,void 0);function vo(n,t,e){return{kind:n,value:t,error:e}}let Wo=null;function hu(n){if(ys.useDeprecatedSynchronousErrorHandling){const t=!Wo;if(t&&(Wo={errorThrown:!1,error:null}),n(),t){const{errorThrown:e,error:r}=Wo;if(Wo=null,e)throw r}}else n()}class ws extends de{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,Bf(t)&&t.add(this)):this.destination=ya}static create(t,e,r){return new en(t,e,r)}next(t){this.isStopped?lt(function zn(n){return vo("N",n,void 0)}(t),this):this._next(t)}error(t){this.isStopped?lt(function ec(n){return vo("E",void 0,n)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?lt(Vf,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const tc=Function.prototype.bind;function Ei(n,t){return tc.call(n,t)}class nc{constructor(t){this.partialObserver=t}next(t){const{partialObserver:e}=this;if(e.next)try{e.next(t)}catch(r){zo(r)}}error(t){const{partialObserver:e}=this;if(e.error)try{e.error(t)}catch(r){zo(r)}else zo(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(e){zo(e)}}}class en extends ws{constructor(t,e,r){let o;if(super(),nt(t)||!t)o={next:t??void 0,error:e??void 0,complete:r??void 0};else{let i;this&&ys.useDeprecatedNextContext?(i=Object.create(t),i.unsubscribe=()=>this.unsubscribe(),o={next:t.next&&Ei(t.next,i),error:t.error&&Ei(t.error,i),complete:t.complete&&Ei(t.complete,i)}):o=t}this.destination=new nc(o)}}function zo(n){ys.useDeprecatedSynchronousErrorHandling?function Uf(n){ys.useDeprecatedSynchronousErrorHandling&&Wo&&(Wo.errorThrown=!0,Wo.error=n)}(n):Hm(n)}function lt(n,t){const{onStoppedNotification:e}=ys;e&&W.setTimeout(()=>e(n,t))}const ya={closed:!0,next:va,error:function ar(n){throw n},complete:va},rc="function"==typeof Symbol&&Symbol.observable||"@@observable";function $o(n){return n}function ic(n){return 0===n.length?$o:1===n.length?n[0]:function(e){return n.reduce((r,o)=>o(r),e)}}let Rt=(()=>{class n{constructor(e){e&&(this._subscribe=e)}lift(e){const r=new n;return r.source=this,r.operator=e,r}subscribe(e,r,o){const i=function bs(n){return n&&n instanceof ws||function Jr(n){return n&&nt(n.next)&&nt(n.error)&&nt(n.complete)}(n)&&Bf(n)}(e)?e:new en(e,r,o);return hu(()=>{const{operator:s,source:a}=this;i.add(s?s.call(i,a):a?this._subscribe(i):this._trySubscribe(i))}),i}_trySubscribe(e){try{return this._subscribe(e)}catch(r){e.error(r)}}forEach(e,r){return new(r=wa(r))((o,i)=>{const s=new en({next:a=>{try{e(a)}catch(u){i(u),s.unsubscribe()}},error:i,complete:o});this.subscribe(s)})}_subscribe(e){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(e)}[rc](){return this}pipe(...e){return ic(e)(this)}toPromise(e){return new(e=wa(e))((r,o)=>{let i;this.subscribe(s=>i=s,s=>o(s),()=>r(i))})}}return n.create=t=>new n(t),n})();function wa(n){var t;return null!==(t=n??ys.Promise)&&void 0!==t?t:Promise}const Di=fu(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let eo=(()=>{class n extends Rt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const r=new Si(this,this);return r.operator=e,r}_throwIfClosed(){if(this.closed)throw new Di}next(e){hu(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(e)}})}error(e){hu(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:r}=this;for(;r.length;)r.shift().error(e)}})}complete(){hu(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:r,isStopped:o,observers:i}=this;return r||o?Lf:(this.currentObservers=null,i.push(e),new de(()=>{this.currentObservers=null,Zl(i,e)}))}_checkFinalizedStatuses(e){const{hasError:r,thrownError:o,isStopped:i}=this;r?e.error(o):i&&e.complete()}asObservable(){const e=new Rt;return e.source=this,e}}return n.create=(t,e)=>new Si(t,e),n})();class Si extends eo{constructor(t,e){super(),this.destination=t,this.source=e}next(t){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===r||r.call(e,t)}error(t){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===r||r.call(e,t)}complete(){var t,e;null===(e=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===e||e.call(t)}_subscribe(t){var e,r;return null!==(r=null===(e=this.source)||void 0===e?void 0:e.subscribe(t))&&void 0!==r?r:Lf}}function _s(n){return nt(n?.lift)}function tn(n){return t=>{if(_s(t))return t.lift(function(e){try{return n(e,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Pt(n,t,e,r,o){return new sc(n,t,e,r,o)}class sc extends ws{constructor(t,e,r,o,i,s){super(t),this.onFinalize=i,this.shouldUnsubscribe=s,this._next=e?function(a){try{e(a)}catch(u){t.error(u)}}:super._next,this._error=o?function(a){try{o(a)}catch(u){t.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){t.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function Ge(n,t){return tn((e,r)=>{let o=0;e.subscribe(Pt(r,i=>{r.next(n.call(t,i,o++))}))})}function Vt(n){return this instanceof Vt?(this.v=n,this):new Vt(n)}function Wf(n,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,r=e.apply(n,t||[]),i=[];return o=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",function s(h){return function(p){return Promise.resolve(p).then(h,d)}}),o[Symbol.asyncIterator]=function(){return this},o;function a(h,p){r[h]&&(o[h]=function(m){return new Promise(function(v,y){i.push([h,m,v,y])>1||u(h,m)})},p&&(o[h]=p(o[h])))}function u(h,p){try{!function l(h){h.value instanceof Vt?Promise.resolve(h.value.v).then(c,d):f(i[0][2],h)}(r[h](p))}catch(m){f(i[0][3],m)}}function c(h){u("next",h)}function d(h){u("throw",h)}function f(h,p){h(p),i.shift(),i.length&&u(i[0][0],i[0][1])}}function cc(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,t=n[Symbol.asyncIterator];return t?t.call(n):(n=function Kt(n){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(i){e[i]=n[i]&&function(s){return new Promise(function(a,u){!function o(i,s,a,u){Promise.resolve(u).then(function(l){i({value:l,done:a})},s)}(a,u,(s=n[i](s)).done,s.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const pu=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Gf(n){return nt(n?.then)}function qf(n){return nt(n[rc])}function Go(n){return Symbol.asyncIterator&&nt(n?.[Symbol.asyncIterator])}function Kf(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Xf=function Zm(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function gu(n){return nt(n?.[Xf])}function Yf(n){return Wf(this,arguments,function*(){const e=n.getReader();try{for(;;){const{value:r,done:o}=yield Vt(e.read());if(o)return yield Vt(void 0);yield yield Vt(r)}}finally{e.releaseLock()}})}function Qf(n){return nt(n?.getReader)}function Fr(n){if(n instanceof Rt)return n;if(null!=n){if(qf(n))return function Jm(n){return new Rt(t=>{const e=n[rc]();if(nt(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(pu(n))return function ev(n){return new Rt(t=>{for(let e=0;e<n.length&&!t.closed;e++)t.next(n[e]);t.complete()})}(n);if(Gf(n))return function xt(n){return new Rt(t=>{n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,Hm)})}(n);if(Go(n))return Zf(n);if(gu(n))return function tv(n){return new Rt(t=>{for(const e of n)if(t.next(e),t.closed)return;t.complete()})}(n);if(Qf(n))return function nv(n){return Zf(Yf(n))}(n)}throw Kf(n)}function Zf(n){return new Rt(t=>{(function rv(n,t){var e,r,o,i;return function rt(n,t,e,r){return new(e||(e=Promise))(function(i,s){function a(c){try{l(r.next(c))}catch(d){s(d)}}function u(c){try{l(r.throw(c))}catch(d){s(d)}}function l(c){c.done?i(c.value):function o(i){return i instanceof e?i:new e(function(s){s(i)})}(c.value).then(a,u)}l((r=r.apply(n,t||[])).next())})}(this,void 0,void 0,function*(){try{for(e=cc(n);!(r=yield e.next()).done;)if(t.next(r.value),t.closed)return}catch(s){o={error:s}}finally{try{r&&!r.done&&(i=e.return)&&(yield i.call(e))}finally{if(o)throw o.error}}t.complete()})})(n,t).catch(e=>t.error(e))})}function wo(n,t,e,r=0,o=!1){const i=t.schedule(function(){e(),o?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(i),!o)return i}function nn(n,t,e=1/0){return nt(t)?nn((r,o)=>Ge((i,s)=>t(r,i,o,s))(Fr(n(r,o))),e):("number"==typeof t&&(e=t),tn((r,o)=>function ov(n,t,e,r,o,i,s,a){const u=[];let l=0,c=0,d=!1;const f=()=>{d&&!u.length&&!l&&t.complete()},h=m=>l<r?p(m):u.push(m),p=m=>{i&&t.next(m),l++;let v=!1;Fr(e(m,c++)).subscribe(Pt(t,y=>{o?.(y),i?h(y):t.next(y)},()=>{v=!0},void 0,()=>{if(v)try{for(l--;u.length&&l<r;){const y=u.shift();s?wo(t,s,()=>p(y)):p(y)}f()}catch(y){t.error(y)}}))};return n.subscribe(Pt(t,h,()=>{d=!0,f()})),()=>{a?.()}}(r,o,n,e)))}function ro(n=1/0){return nn($o,n)}const oo=new Rt(n=>n.complete());function hc(n){return n[n.length-1]}function Jf(n){return nt(hc(n))?n.pop():void 0}function Cs(n){return function iv(n){return n&&nt(n.schedule)}(hc(n))?n.pop():void 0}function eh(n,t=0){return tn((e,r)=>{e.subscribe(Pt(r,o=>wo(r,n,()=>r.next(o),t),()=>wo(r,n,()=>r.complete(),t),o=>wo(r,n,()=>r.error(o),t)))})}function th(n,t=0){return tn((e,r)=>{r.add(n.schedule(()=>e.subscribe(r),t))})}function oh(n,t){if(!n)throw new Error("Iterable cannot be null");return new Rt(e=>{wo(e,t,()=>{const r=n[Symbol.asyncIterator]();wo(e,t,()=>{r.next().then(o=>{o.done?e.complete():e.next(o.value)})},0,!0)})})}function Xt(n,t){return t?function cv(n,t){if(null!=n){if(qf(n))return function nh(n,t){return Fr(n).pipe(th(t),eh(t))}(n,t);if(pu(n))return function rh(n,t){return new Rt(e=>{let r=0;return t.schedule(function(){r===n.length?e.complete():(e.next(n[r++]),e.closed||this.schedule())})})}(n,t);if(Gf(n))return function av(n,t){return Fr(n).pipe(th(t),eh(t))}(n,t);if(Go(n))return oh(n,t);if(gu(n))return function uv(n,t){return new Rt(e=>{let r;return wo(e,t,()=>{r=n[Xf](),wo(e,t,()=>{let o,i;try{({value:o,done:i}=r.next())}catch(s){return void e.error(s)}i?e.complete():e.next(o)},0,!0)}),()=>nt(r?.return)&&r.return()})}(n,t);if(Qf(n))return function lv(n,t){return oh(Yf(n),t)}(n,t)}throw Kf(n)}(n,t):Fr(n)}function mu(n,t,...e){if(!0===t)return void n();if(!1===t)return;const r=new en({next:()=>{r.unsubscribe(),n()}});return t(...e).subscribe(r)}function vt(n){for(let t in n)if(n[t]===vt)return t;throw Error("Could not find renamed property on target object.")}function vu(n,t){for(const e in t)t.hasOwnProperty(e)&&!n.hasOwnProperty(e)&&(n[e]=t[e])}function yt(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(yt).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const t=n.toString();if(null==t)return""+t;const e=t.indexOf("\n");return-1===e?t:t.substring(0,e)}function pc(n,t){return null==n||""===n?null===t?"":t:null==t||""===t?n:n+" "+t}const Es=vt({__forward_ref__:vt});function wt(n){return n.__forward_ref__=wt,n.toString=function(){return yt(this())},n}function ke(n){return xa(n)?n():n}function xa(n){return"function"==typeof n&&n.hasOwnProperty(Es)&&n.__forward_ref__===wt}class Q extends Error{constructor(t,e){super(function yu(n,t){return`NG0${Math.abs(n)}${t?": "+t.trim():""}`}(t,e)),this.code=t}}function Pe(n){return"string"==typeof n?n:null==n?"":String(n)}function wu(n,t){throw new Q(-201,!1)}function lr(n,t){null==n&&function qe(n,t,e,r){throw new Error(`ASSERTION ERROR: ${n}`+(null==r?"":` [Expected=> ${e} ${r} ${t} <=Actual]`))}(t,n,null,"!=")}function fe(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function wn(n){return{providers:n.providers||[],imports:n.imports||[]}}function Ca(n){return ih(n,_u)||ih(n,ah)}function ih(n,t){return n.hasOwnProperty(t)?n[t]:null}function sh(n){return n&&(n.hasOwnProperty(gc)||n.hasOwnProperty(xv))?n[gc]:null}const _u=vt({\u0275prov:vt}),gc=vt({\u0275inj:vt}),ah=vt({ngInjectableDef:vt}),xv=vt({ngInjectorDef:vt});var Se=(()=>((Se=Se||{})[Se.Default=0]="Default",Se[Se.Host=1]="Host",Se[Se.Self=2]="Self",Se[Se.SkipSelf=4]="SkipSelf",Se[Se.Optional=8]="Optional",Se))();let mc;function cr(n){const t=mc;return mc=n,t}function uh(n,t,e){const r=Ca(n);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:e&Se.Optional?null:void 0!==t?t:void wu(yt(n))}function qo(n){return{toString:n}.toString()}var Cr=(()=>((Cr=Cr||{})[Cr.OnPush=0]="OnPush",Cr[Cr.Default=1]="Default",Cr))(),Er=(()=>{return(n=Er||(Er={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",Er;var n})();const bt=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),As={},ot=[],Ea=vt({\u0275cmp:vt}),Cu=vt({\u0275dir:vt}),Eu=vt({\u0275pipe:vt}),yc=vt({\u0275mod:vt}),io=vt({\u0275fac:vt}),Ts=vt({__NG_ELEMENT_ID__:vt});let dh=0;function bn(n){return qo(()=>{const e=!0===n.standalone,r={},o={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:r,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===Cr.OnPush,directiveDefs:null,pipeDefs:null,standalone:e,dependencies:e&&n.dependencies||null,getStandaloneInjector:null,selectors:n.selectors||ot,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||Er.Emulated,id:"c"+dh++,styles:n.styles||ot,_:null,setInput:null,schemas:n.schemas||null,tView:null},i=n.dependencies,s=n.features;return o.inputs=wc(n.inputs,r),o.outputs=wc(n.outputs),s&&s.forEach(a=>a(o)),o.directiveDefs=i?()=>("function"==typeof i?i():i).map(fh).filter(hh):null,o.pipeDefs=i?()=>("function"==typeof i?i():i).map(Pn).filter(hh):null,o})}function fh(n){return ht(n)||Fn(n)}function hh(n){return null!==n}function Tn(n){return qo(()=>({type:n.type,bootstrap:n.bootstrap||ot,declarations:n.declarations||ot,imports:n.imports||ot,exports:n.exports||ot,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function wc(n,t){if(null==n)return As;const e={};for(const r in n)if(n.hasOwnProperty(r)){let o=n[r],i=o;Array.isArray(o)&&(i=o[1],o=o[0]),e[o]=r,t&&(t[o]=i)}return e}const Ie=bn;function Gn(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function ht(n){return n[Ea]||null}function Fn(n){return n[Cu]||null}function Pn(n){return n[Eu]||null}function dr(n,t){const e=n[yc]||null;if(!e&&!0===t)throw new Error(`Type ${yt(n)} does not have '\u0275mod' property.`);return e}function qn(n){return Array.isArray(n)&&"object"==typeof n[1]}function Sr(n){return Array.isArray(n)&&!0===n[1]}function Ec(n){return 0!=(8&n.flags)}function Iu(n){return 2==(2&n.flags)}function Au(n){return 1==(1&n.flags)}function Pr(n){return null!==n.template}function Ev(n){return 0!=(256&n[2])}function Pi(n,t){return n.hasOwnProperty(io)?n[io]:null}class Mv{constructor(t,e,r){this.previousValue=t,this.currentValue=e,this.firstChange=r}isFirstChange(){return this.firstChange}}function Ir(){return vh}function vh(n){return n.type.prototype.ngOnChanges&&(n.setInput=g),Tu}function Tu(){const n=C(this),t=n?.current;if(t){const e=n.previous;if(e===As)n.previous=t;else for(let r in t)e[r]=t[r];n.current=null,this.ngOnChanges(t)}}function g(n,t,e,r){const o=C(n)||function T(n,t){return n[w]=t}(n,{previous:As,current:null}),i=o.current||(o.current={}),s=o.previous,a=this.declaredInputs[e],u=s[a];i[a]=new Mv(u&&u.currentValue,t,s===As),n[r]=t}Ir.ngInherit=!0;const w="__ngSimpleChanges__";function C(n){return n[w]||null}function ln(n){for(;Array.isArray(n);)n=n[0];return n}function yh(n,t){return ln(t[n])}function Or(n,t){return ln(t[n.index])}function kv(n,t){return n.data[t]}function Lr(n,t){const e=t[n];return qn(e)?e:e[0]}function wh(n){return 64==(64&n[2])}function Fs(n,t){return null==t?null:n[t]}function Ux(n){n[18]=0}function Rv(n,t){n[5]+=t;let e=n,r=n[3];for(;null!==r&&(1===t&&1===e[5]||-1===t&&0===e[5]);)r[5]+=t,e=r,r=r[3]}const Le={lFrame:Yx(null),bindingsEnabled:!0};function Hx(){return Le.bindingsEnabled}function ee(){return Le.lFrame.lView}function st(){return Le.lFrame.tView}function Kn(n){return Le.lFrame.contextLView=n,n[8]}function Xn(n){return Le.lFrame.contextLView=null,n}function _n(){let n=Wx();for(;null!==n&&64===n.type;)n=n.parent;return n}function Wx(){return Le.lFrame.currentTNode}function Xo(n,t){const e=Le.lFrame;e.currentTNode=n,e.isParent=t}function Nv(){return Le.lFrame.isParent}function pr(){const n=Le.lFrame;let t=n.bindingRootIndex;return-1===t&&(t=n.bindingRootIndex=n.tView.bindingStartIndex),t}function ku(){return Le.lFrame.bindingIndex++}function lO(n,t){const e=Le.lFrame;e.bindingIndex=e.bindingRootIndex=n,Pv(t)}function Pv(n){Le.lFrame.currentDirectiveIndex=n}function qx(){return Le.lFrame.currentQueryIndex}function Lv(n){Le.lFrame.currentQueryIndex=n}function dO(n){const t=n[1];return 2===t.type?t.declTNode:1===t.type?n[6]:null}function Kx(n,t,e){if(e&Se.SkipSelf){let o=t,i=n;for(;!(o=o.parent,null!==o||e&Se.Host||(o=dO(i),null===o||(i=i[15],10&o.type))););if(null===o)return!1;t=o,n=i}const r=Le.lFrame=Xx();return r.currentTNode=t,r.lView=n,!0}function Bv(n){const t=Xx(),e=n[1];Le.lFrame=t,t.currentTNode=e.firstChild,t.lView=n,t.tView=e,t.contextLView=n,t.bindingIndex=e.bindingStartIndex,t.inI18n=!1}function Xx(){const n=Le.lFrame,t=null===n?null:n.child;return null===t?Yx(n):t}function Yx(n){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=t),t}function Qx(){const n=Le.lFrame;return Le.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const Zx=Qx;function Vv(){const n=Qx();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function gr(){return Le.lFrame.selectedIndex}function Ps(n){Le.lFrame.selectedIndex=n}function jt(){const n=Le.lFrame;return kv(n.tView,n.selectedIndex)}function xo(){Le.lFrame.currentNamespace="svg"}function Co(){!function gO(){Le.lFrame.currentNamespace=null}()}function bh(n,t){for(let e=t.directiveStart,r=t.directiveEnd;e<r;e++){const i=n.data[e].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:u,ngAfterViewChecked:l,ngOnDestroy:c}=i;s&&(n.contentHooks||(n.contentHooks=[])).push(-e,s),a&&((n.contentHooks||(n.contentHooks=[])).push(e,a),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(e,a)),u&&(n.viewHooks||(n.viewHooks=[])).push(-e,u),l&&((n.viewHooks||(n.viewHooks=[])).push(e,l),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(e,l)),null!=c&&(n.destroyHooks||(n.destroyHooks=[])).push(e,c)}}function _h(n,t,e){Jx(n,t,3,e)}function xh(n,t,e,r){(3&n[2])===e&&Jx(n,t,e,r)}function Uv(n,t){let e=n[2];(3&e)===t&&(e&=2047,e+=1,n[2]=e)}function Jx(n,t,e,r){const i=r??-1,s=t.length-1;let a=0;for(let u=void 0!==r?65535&n[18]:0;u<s;u++)if("number"==typeof t[u+1]){if(a=t[u],null!=r&&a>=r)break}else t[u]<0&&(n[18]+=65536),(a<i||-1==i)&&(yO(n,e,t,u),n[18]=(4294901760&n[18])+u+2),u++}function yO(n,t,e,r){const o=e[r]<0,i=e[r+1],a=n[o?-e[r]:e[r]];if(o){if(n[2]>>11<n[18]>>16&&(3&n[2])===t){n[2]+=2048;try{i.call(a)}finally{}}}else try{i.call(a)}finally{}}class Tc{constructor(t,e,r){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=r}}function Ch(n,t,e){let r=0;for(;r<e.length;){const o=e[r];if("number"==typeof o){if(0!==o)break;r++;const i=e[r++],s=e[r++],a=e[r++];n.setAttribute(t,s,a,i)}else{const i=o,s=e[++r];tC(i)?n.setProperty(t,i,s):n.setAttribute(t,i,s),r++}}return r}function eC(n){return 3===n||4===n||6===n}function tC(n){return 64===n.charCodeAt(0)}function Eh(n,t){if(null!==t&&0!==t.length)if(null===n||0===n.length)n=t.slice();else{let e=-1;for(let r=0;r<t.length;r++){const o=t[r];"number"==typeof o?e=o:0===e||nC(n,e,o,null,-1===e||2===e?t[++r]:null)}}return n}function nC(n,t,e,r,o){let i=0,s=n.length;if(-1===t)s=-1;else for(;i<n.length;){const a=n[i++];if("number"==typeof a){if(a===t){s=-1;break}if(a>t){s=i-1;break}}}for(;i<n.length;){const a=n[i];if("number"==typeof a)break;if(a===e){if(null===r)return void(null!==o&&(n[i+1]=o));if(r===n[i+1])return void(n[i+2]=o)}i++,null!==r&&i++,null!==o&&i++}-1!==s&&(n.splice(s,0,t),i=s+1),n.splice(i++,0,e),null!==r&&n.splice(i++,0,r),null!==o&&n.splice(i++,0,o)}function rC(n){return-1!==n}function Ru(n){return 32767&n}function Nu(n,t){let e=function CO(n){return n>>16}(n),r=t;for(;e>0;)r=r[15],e--;return r}let Hv=!0;function Dh(n){const t=Hv;return Hv=n,t}let EO=0;const Yo={};function kc(n,t){const e=zv(n,t);if(-1!==e)return e;const r=t[1];r.firstCreatePass&&(n.injectorIndex=t.length,Wv(r.data,n),Wv(t,null),Wv(r.blueprint,null));const o=Sh(n,t),i=n.injectorIndex;if(rC(o)){const s=Ru(o),a=Nu(o,t),u=a[1].data;for(let l=0;l<8;l++)t[i+l]=a[s+l]|u[s+l]}return t[i+8]=o,i}function Wv(n,t){n.push(0,0,0,0,0,0,0,0,t)}function zv(n,t){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===t[n.injectorIndex+8]?-1:n.injectorIndex}function Sh(n,t){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let e=0,r=null,o=t;for(;null!==o;){if(r=fC(o),null===r)return-1;if(e++,o=o[15],-1!==r.injectorIndex)return r.injectorIndex|e<<16}return-1}function Ih(n,t,e){!function DO(n,t,e){let r;"string"==typeof e?r=e.charCodeAt(0)||0:e.hasOwnProperty(Ts)&&(r=e[Ts]),null==r&&(r=e[Ts]=EO++);const o=255&r;t.data[n+(o>>5)]|=1<<o}(n,t,e)}function sC(n,t,e){if(e&Se.Optional||void 0!==n)return n;wu()}function aC(n,t,e,r){if(e&Se.Optional&&void 0===r&&(r=null),0==(e&(Se.Self|Se.Host))){const o=n[9],i=cr(void 0);try{return o?o.get(t,r,e&Se.Optional):uh(t,r,e&Se.Optional)}finally{cr(i)}}return sC(r,0,e)}function uC(n,t,e,r=Se.Default,o){if(null!==n){if(1024&t[2]){const s=function MO(n,t,e,r,o){let i=n,s=t;for(;null!==i&&null!==s&&1024&s[2]&&!(256&s[2]);){const a=lC(i,s,e,r|Se.Self,Yo);if(a!==Yo)return a;let u=i.parent;if(!u){const l=s[21];if(l){const c=l.get(e,Yo,r);if(c!==Yo)return c}u=fC(s),s=s[15]}i=u}return o}(n,t,e,r,Yo);if(s!==Yo)return s}const i=lC(n,t,e,r,Yo);if(i!==Yo)return i}return aC(t,e,r,o)}function lC(n,t,e,r,o){const i=function AO(n){if("string"==typeof n)return n.charCodeAt(0)||0;const t=n.hasOwnProperty(Ts)?n[Ts]:void 0;return"number"==typeof t?t>=0?255&t:TO:t}(e);if("function"==typeof i){if(!Kx(t,n,r))return r&Se.Host?sC(o,0,r):aC(t,e,r,o);try{const s=i(r);if(null!=s||r&Se.Optional)return s;wu()}finally{Zx()}}else if("number"==typeof i){let s=null,a=zv(n,t),u=-1,l=r&Se.Host?t[16][6]:null;for((-1===a||r&Se.SkipSelf)&&(u=-1===a?Sh(n,t):t[a+8],-1!==u&&dC(r,!1)?(s=t[1],a=Ru(u),t=Nu(u,t)):a=-1);-1!==a;){const c=t[1];if(cC(i,a,c.data)){const d=IO(a,t,e,s,r,l);if(d!==Yo)return d}u=t[a+8],-1!==u&&dC(r,t[1].data[a+8]===l)&&cC(i,a,t)?(s=c,a=Ru(u),t=Nu(u,t)):a=-1}}return o}function IO(n,t,e,r,o,i){const s=t[1],a=s.data[n+8],c=Ah(a,s,e,null==r?Iu(a)&&Hv:r!=s&&0!=(3&a.type),o&Se.Host&&i===a);return null!==c?Rc(t,s,c,a):Yo}function Ah(n,t,e,r,o){const i=n.providerIndexes,s=t.data,a=1048575&i,u=n.directiveStart,c=i>>20,f=o?a+c:n.directiveEnd;for(let h=r?a:a+c;h<f;h++){const p=s[h];if(h<u&&e===p||h>=u&&p.type===e)return h}if(o){const h=s[u];if(h&&Pr(h)&&h.type===e)return u}return null}function Rc(n,t,e,r){let o=n[e];const i=t.data;if(function wO(n){return n instanceof Tc}(o)){const s=o;s.resolving&&function pv(n,t){const e=t?`. Dependency path: ${t.join(" > ")} > ${n}`:"";throw new Q(-200,`Circular dependency in DI detected for ${n}${e}`)}(function ct(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Pe(n)}(i[e]));const a=Dh(s.canSeeViewProviders);s.resolving=!0;const u=s.injectImpl?cr(s.injectImpl):null;Kx(n,r,Se.Default);try{o=n[e]=s.factory(void 0,i,n,r),t.firstCreatePass&&e>=r.directiveStart&&function vO(n,t,e){const{ngOnChanges:r,ngOnInit:o,ngDoCheck:i}=t.type.prototype;if(r){const s=vh(t);(e.preOrderHooks||(e.preOrderHooks=[])).push(n,s),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n,s)}o&&(e.preOrderHooks||(e.preOrderHooks=[])).push(0-n,o),i&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n,i),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n,i))}(e,i[e],t)}finally{null!==u&&cr(u),Dh(a),s.resolving=!1,Zx()}}return o}function cC(n,t,e){return!!(e[t+(n>>5)]&1<<n)}function dC(n,t){return!(n&Se.Self||n&Se.Host&&t)}class Fu{constructor(t,e){this._tNode=t,this._lView=e}get(t,e,r){return uC(this._tNode,this._lView,t,r,e)}}function TO(){return new Fu(_n(),ee())}function Yn(n){return qo(()=>{const t=n.prototype.constructor,e=t[io]||$v(t),r=Object.prototype;let o=Object.getPrototypeOf(n.prototype).constructor;for(;o&&o!==r;){const i=o[io]||$v(o);if(i&&i!==e)return i;o=Object.getPrototypeOf(o)}return i=>new i})}function $v(n){return xa(n)?()=>{const t=$v(ke(n));return t&&t()}:Pi(n)}function fC(n){const t=n[1],e=t.type;return 2===e?t.declTNode:1===e?n[6]:null}function Nc(n){return function SO(n,t){if("class"===t)return n.classes;if("style"===t)return n.styles;const e=n.attrs;if(e){const r=e.length;let o=0;for(;o<r;){const i=e[o];if(eC(i))break;if(0===i)o+=2;else if("number"==typeof i)for(o++;o<r&&"string"==typeof e[o];)o++;else{if(i===t)return e[o+1];o+=2}}}return null}(_n(),n)}const Ou="__parameters__";function Bu(n,t,e){return qo(()=>{const r=function Gv(n){return function(...e){if(n){const r=n(...e);for(const o in r)this[o]=r[o]}}}(t);function o(...i){if(this instanceof o)return r.apply(this,i),this;const s=new o(...i);return a.annotation=s,a;function a(u,l,c){const d=u.hasOwnProperty(Ou)?u[Ou]:Object.defineProperty(u,Ou,{value:[]})[Ou];for(;d.length<=c;)d.push(null);return(d[c]=d[c]||[]).push(s),u}}return e&&(o.prototype=Object.create(e.prototype)),o.prototype.ngMetadataName=n,o.annotationCls=o,o})}class _e{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=fe({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function Br(n,t){void 0===t&&(t=n);for(let e=0;e<n.length;e++){let r=n[e];Array.isArray(r)?(t===n&&(t=n.slice(0,e)),Br(r,t)):t!==n&&t.push(r)}return t}function Bi(n,t){n.forEach(e=>Array.isArray(e)?Bi(e,t):t(e))}function pC(n,t,e){t>=n.length?n.push(e):n.splice(t,0,e)}function Th(n,t){return t>=n.length-1?n.pop():n.splice(t,1)[0]}function Vr(n,t,e){let r=Vu(n,t);return r>=0?n[1|r]=e:(r=~r,function FO(n,t,e,r){let o=n.length;if(o==t)n.push(e,r);else if(1===o)n.push(r,n[0]),n[0]=e;else{for(o--,n.push(n[o-1],n[o]);o>t;)n[o]=n[o-2],o--;n[t]=e,n[t+1]=r}}(n,r,t,e)),r}function Kv(n,t){const e=Vu(n,t);if(e>=0)return n[1|e]}function Vu(n,t){return function vC(n,t,e){let r=0,o=n.length>>e;for(;o!==r;){const i=r+(o-r>>1),s=n[i<<e];if(t===s)return i<<e;s>t?o=i:r=i+1}return~(o<<e)}(n,t,1)}const Lc={},Yv="__NG_DI_FLAG__",kh="ngTempTokenPath",HO=/\n/gm,yC="__source";let Bc;function Uu(n){const t=Bc;return Bc=n,t}function zO(n,t=Se.Default){if(void 0===Bc)throw new Q(-203,!1);return null===Bc?uh(n,void 0,t):Bc.get(n,t&Se.Optional?null:void 0,t)}function re(n,t=Se.Default){return(function xu(){return mc}()||zO)(ke(n),t)}function rn(n,t=Se.Default){return"number"!=typeof t&&(t=0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)),re(n,t)}function Qv(n){const t=[];for(let e=0;e<n.length;e++){const r=ke(n[e]);if(Array.isArray(r)){if(0===r.length)throw new Q(900,!1);let o,i=Se.Default;for(let s=0;s<r.length;s++){const a=r[s],u=$O(a);"number"==typeof u?-1===u?o=a.token:i|=u:o=a}t.push(re(o,i))}else t.push(re(r))}return t}function Vc(n,t){return n[Yv]=t,n.prototype[Yv]=t,n}function $O(n){return n[Yv]}const Uc=Vc(Bu("Optional"),8),jc=Vc(Bu("SkipSelf"),4);var Ar=(()=>((Ar=Ar||{})[Ar.Important=1]="Important",Ar[Ar.DashCase=2]="DashCase",Ar))();const ny=new Map;let lL=0;const oy="__ngContext__";function Qn(n,t){qn(t)?(n[oy]=t[20],function dL(n){ny.set(n[20],n)}(t)):n[oy]=t}function sy(n,t){return undefined(n,t)}function $c(n){const t=n[3];return Sr(t)?t[3]:t}function ay(n){return VC(n[13])}function uy(n){return VC(n[4])}function VC(n){for(;null!==n&&!Sr(n);)n=n[4];return n}function Hu(n,t,e,r,o){if(null!=r){let i,s=!1;Sr(r)?i=r:qn(r)&&(s=!0,r=r[0]);const a=ln(r);0===n&&null!==e?null==o?$C(t,e,a):Ta(t,e,a,o||null,!0):1===n&&null!==e?Ta(t,e,a,o||null,!0):2===n?function gy(n,t,e){const r=Fh(n,t);r&&function NL(n,t,e,r){n.removeChild(t,e,r)}(n,r,t,e)}(t,a,s):3===n&&t.destroyNode(a),null!=i&&function OL(n,t,e,r,o){const i=e[7];i!==ln(e)&&Hu(t,n,r,i,o);for(let a=10;a<e.length;a++){const u=e[a];Gc(u[1],u,n,t,r,i)}}(t,n,i,e,o)}}function cy(n,t,e){return n.createElement(t,e)}function jC(n,t){const e=n[9],r=e.indexOf(t),o=t[3];512&t[2]&&(t[2]&=-513,Rv(o,-1)),e.splice(r,1)}function dy(n,t){if(n.length<=10)return;const e=10+t,r=n[e];if(r){const o=r[17];null!==o&&o!==n&&jC(o,r),t>0&&(n[e-1][4]=r[4]);const i=Th(n,10+t);!function DL(n,t){Gc(n,t,t[11],2,null,null),t[0]=null,t[6]=null}(r[1],r);const s=i[19];null!==s&&s.detachView(i[1]),r[3]=null,r[4]=null,r[2]&=-65}return r}function HC(n,t){if(!(128&t[2])){const e=t[11];e.destroyNode&&Gc(n,t,e,3,null,null),function AL(n){let t=n[13];if(!t)return fy(n[1],n);for(;t;){let e=null;if(qn(t))e=t[13];else{const r=t[10];r&&(e=r)}if(!e){for(;t&&!t[4]&&t!==n;)qn(t)&&fy(t[1],t),t=t[3];null===t&&(t=n),qn(t)&&fy(t[1],t),e=t&&t[4]}t=e}}(t)}}function fy(n,t){if(!(128&t[2])){t[2]&=-65,t[2]|=128,function RL(n,t){let e;if(null!=n&&null!=(e=n.destroyHooks))for(let r=0;r<e.length;r+=2){const o=t[e[r]];if(!(o instanceof Tc)){const i=e[r+1];if(Array.isArray(i))for(let s=0;s<i.length;s+=2){const a=o[i[s]],u=i[s+1];try{u.call(a)}finally{}}else try{i.call(o)}finally{}}}}(n,t),function kL(n,t){const e=n.cleanup,r=t[7];let o=-1;if(null!==e)for(let i=0;i<e.length-1;i+=2)if("string"==typeof e[i]){const s=e[i+1],a="function"==typeof s?s(t):ln(t[s]),u=r[o=e[i+2]],l=e[i+3];"boolean"==typeof l?a.removeEventListener(e[i],u,l):l>=0?r[o=l]():r[o=-l].unsubscribe(),i+=2}else{const s=r[o=e[i+1]];e[i].call(s)}if(null!==r){for(let i=o+1;i<r.length;i++)(0,r[i])();t[7]=null}}(n,t),1===t[1].type&&t[11].destroy();const e=t[17];if(null!==e&&Sr(t[3])){e!==t[3]&&jC(e,t);const r=t[19];null!==r&&r.detachView(n)}!function fL(n){ny.delete(n[20])}(t)}}function WC(n,t,e){return function zC(n,t,e){let r=t;for(;null!==r&&40&r.type;)r=(t=r).parent;if(null===r)return e[0];if(2&r.flags){const o=n.data[r.directiveStart].encapsulation;if(o===Er.None||o===Er.Emulated)return null}return Or(r,e)}(n,t.parent,e)}function Ta(n,t,e,r,o){n.insertBefore(t,e,r,o)}function $C(n,t,e){n.appendChild(t,e)}function GC(n,t,e,r,o){null!==r?Ta(n,t,e,r,o):$C(n,t,e)}function Fh(n,t){return n.parentNode(t)}let wy,XC=function KC(n,t,e){return 40&n.type?Or(n,e):null};function Ph(n,t,e,r){const o=WC(n,r,t),i=t[11],a=function qC(n,t,e){return XC(n,t,e)}(r.parent||t[6],r,t);if(null!=o)if(Array.isArray(e))for(let u=0;u<e.length;u++)GC(i,o,e[u],a,!1);else GC(i,o,e,a,!1)}function Oh(n,t){if(null!==t){const e=t.type;if(3&e)return Or(t,n);if(4&e)return py(-1,n[t.index]);if(8&e){const r=t.child;if(null!==r)return Oh(n,r);{const o=n[t.index];return Sr(o)?py(-1,o):ln(o)}}if(32&e)return sy(t,n)()||ln(n[t.index]);{const r=QC(n,t);return null!==r?Array.isArray(r)?r[0]:Oh($c(n[16]),r):Oh(n,t.next)}}return null}function QC(n,t){return null!==t?n[16][6].projection[t.projection]:null}function py(n,t){const e=10+n+1;if(e<t.length){const r=t[e],o=r[1].firstChild;if(null!==o)return Oh(r,o)}return t[7]}function my(n,t,e,r,o,i,s){for(;null!=e;){const a=r[e.index],u=e.type;if(s&&0===t&&(a&&Qn(ln(a),r),e.flags|=4),64!=(64&e.flags))if(8&u)my(n,t,e.child,r,o,i,!1),Hu(t,n,o,a,i);else if(32&u){const l=sy(e,r);let c;for(;c=l();)Hu(t,n,o,c,i);Hu(t,n,o,a,i)}else 16&u?ZC(n,t,r,e,o,i):Hu(t,n,o,a,i);e=s?e.projectionNext:e.next}}function Gc(n,t,e,r,o,i){my(e,r,n.firstChild,t,o,i,!1)}function ZC(n,t,e,r,o,i){const s=e[16],u=s[6].projection[r.projection];if(Array.isArray(u))for(let l=0;l<u.length;l++)Hu(t,n,o,u[l],i);else my(n,t,u,s[3],o,i,!0)}function JC(n,t,e){n.setAttribute(t,"style",e)}function vy(n,t,e){""===e?n.removeAttribute(t,"class"):n.setAttribute(t,"class",e)}class oE{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function Ls(n){return n instanceof oE?n.changingThisBreaksApplicationSecurity:n}const QL=/^(?:(?:https?|mailto|data|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi;var cn=(()=>((cn=cn||{})[cn.NONE=0]="NONE",cn[cn.HTML=1]="HTML",cn[cn.STYLE=2]="STYLE",cn[cn.SCRIPT=3]="SCRIPT",cn[cn.URL=4]="URL",cn[cn.RESOURCE_URL=5]="RESOURCE_URL",cn))();function Wu(n){const t=function Xc(){const n=ee();return n&&n[12]}();return t?t.sanitize(cn.URL,n)||"":function qc(n,t){const e=function qL(n){return n instanceof oE&&n.getTypeName()||null}(n);if(null!=e&&e!==t){if("ResourceURL"===e&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${e} (see https://g.co/ng/security#xss)`)}return e===t}(n,"URL")?Ls(n):function _y(n){return(n=String(n)).match(QL)?n:"unsafe:"+n}(Pe(n))}const Dy=new _e("ENVIRONMENT_INITIALIZER"),fE=new _e("INJECTOR",-1),hE=new _e("INJECTOR_DEF_TYPES");class pE{get(t,e=Lc){if(e===Lc){const r=new Error(`NullInjectorError: No provider for ${yt(t)}!`);throw r.name="NullInjectorError",r}return e}}function dB(...n){return{\u0275providers:gE(0,n)}}function gE(n,...t){const e=[],r=new Set;let o;return Bi(t,i=>{const s=i;Sy(s,e,[],r)&&(o||(o=[]),o.push(s))}),void 0!==o&&mE(o,e),e}function mE(n,t){for(let e=0;e<n.length;e++){const{providers:o}=n[e];Bi(o,i=>{t.push(i)})}}function Sy(n,t,e,r){if(!(n=ke(n)))return!1;let o=null,i=sh(n);const s=!i&&ht(n);if(i||s){if(s&&!s.standalone)return!1;o=n}else{const u=n.ngModule;if(i=sh(u),!i)return!1;o=u}const a=r.has(o);if(s){if(a)return!1;if(r.add(o),s.dependencies){const u="function"==typeof s.dependencies?s.dependencies():s.dependencies;for(const l of u)Sy(l,t,e,r)}}else{if(!i)return!1;{if(null!=i.imports&&!a){let l;r.add(o);try{Bi(i.imports,c=>{Sy(c,t,e,r)&&(l||(l=[]),l.push(c))})}finally{}void 0!==l&&mE(l,t)}if(!a){const l=Pi(o)||(()=>new o);t.push({provide:o,useFactory:l,deps:ot},{provide:hE,useValue:o,multi:!0},{provide:Dy,useValue:()=>re(o),multi:!0})}const u=i.providers;null==u||a||Bi(u,c=>{t.push(c)})}}return o!==n&&void 0!==n.providers}const fB=vt({provide:String,useValue:vt});function Iy(n){return null!==n&&"object"==typeof n&&fB in n}function ka(n){return"function"==typeof n}const Ay=new _e("Set Injector scope."),Uh={},pB={};let Ty;function jh(){return void 0===Ty&&(Ty=new pE),Ty}class Bs{}class wE extends Bs{constructor(t,e,r,o){super(),this.parent=e,this.source=r,this.scopes=o,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,ky(t,s=>this.processProvider(s)),this.records.set(fE,zu(void 0,this)),o.has("environment")&&this.records.set(Bs,zu(void 0,this));const i=this.records.get(Ay);null!=i&&"string"==typeof i.value&&this.scopes.add(i.value),this.injectorDefTypes=new Set(this.get(hE.multi,ot,Se.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();for(const t of this._onDestroyHooks)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(t){this._onDestroyHooks.push(t)}runInContext(t){this.assertNotDestroyed();const e=Uu(this),r=cr(void 0);try{return t()}finally{Uu(e),cr(r)}}get(t,e=Lc,r=Se.Default){this.assertNotDestroyed();const o=Uu(this),i=cr(void 0);try{if(!(r&Se.SkipSelf)){let a=this.records.get(t);if(void 0===a){const u=function wB(n){return"function"==typeof n||"object"==typeof n&&n instanceof _e}(t)&&Ca(t);a=u&&this.injectableDefInScope(u)?zu(My(t),Uh):null,this.records.set(t,a)}if(null!=a)return this.hydrate(t,a)}return(r&Se.Self?jh():this.parent).get(t,e=r&Se.Optional&&e===Lc?null:e)}catch(s){if("NullInjectorError"===s.name){if((s[kh]=s[kh]||[]).unshift(yt(t)),o)throw s;return function GO(n,t,e,r){const o=n[kh];throw t[yC]&&o.unshift(t[yC]),n.message=function qO(n,t,e,r=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let o=yt(t);if(Array.isArray(t))o=t.map(yt).join(" -> ");else if("object"==typeof t){let i=[];for(let s in t)if(t.hasOwnProperty(s)){let a=t[s];i.push(s+":"+("string"==typeof a?JSON.stringify(a):yt(a)))}o=`{${i.join(", ")}}`}return`${e}${r?"("+r+")":""}[${o}]: ${n.replace(HO,"\n  ")}`}("\n"+n.message,o,e,r),n.ngTokenPath=o,n[kh]=null,n}(s,t,"R3InjectorError",this.source)}throw s}finally{cr(i),Uu(o)}}resolveInjectorInitializers(){const t=Uu(this),e=cr(void 0);try{const r=this.get(Dy.multi,ot,Se.Self);for(const o of r)o()}finally{Uu(t),cr(e)}}toString(){const t=[],e=this.records;for(const r of e.keys())t.push(yt(r));return`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Q(205,!1)}processProvider(t){let e=ka(t=ke(t))?t:ke(t&&t.provide);const r=function mB(n){return Iy(n)?zu(void 0,n.useValue):zu(bE(n),Uh)}(t);if(ka(t)||!0!==t.multi)this.records.get(e);else{let o=this.records.get(e);o||(o=zu(void 0,Uh,!0),o.factory=()=>Qv(o.multi),this.records.set(e,o)),e=t,o.multi.push(t)}this.records.set(e,r)}hydrate(t,e){return e.value===Uh&&(e.value=pB,e.value=e.factory()),"object"==typeof e.value&&e.value&&function yB(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}injectableDefInScope(t){if(!t.providedIn)return!1;const e=ke(t.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}}function My(n){const t=Ca(n),e=null!==t?t.factory:Pi(n);if(null!==e)return e;if(n instanceof _e)throw new Q(204,!1);if(n instanceof Function)return function gB(n){const t=n.length;if(t>0)throw function Oc(n,t){const e=[];for(let r=0;r<n;r++)e.push(t);return e}(t,"?"),new Q(204,!1);const e=function bv(n){const t=n&&(n[_u]||n[ah]);if(t){const e=function _v(n){if(n.hasOwnProperty("name"))return n.name;const t=(""+n).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${e}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${e}" class.`),t}return null}(n);return null!==e?()=>e.factory(n):()=>new n}(n);throw new Q(204,!1)}function bE(n,t,e){let r;if(ka(n)){const o=ke(n);return Pi(o)||My(o)}if(Iy(n))r=()=>ke(n.useValue);else if(function yE(n){return!(!n||!n.useFactory)}(n))r=()=>n.useFactory(...Qv(n.deps||[]));else if(function vE(n){return!(!n||!n.useExisting)}(n))r=()=>re(ke(n.useExisting));else{const o=ke(n&&(n.useClass||n.provide));if(!function vB(n){return!!n.deps}(n))return Pi(o)||My(o);r=()=>new o(...Qv(n.deps))}return r}function zu(n,t,e=!1){return{factory:n,value:t,multi:e?[]:void 0}}function bB(n){return!!n.\u0275providers}function ky(n,t){for(const e of n)Array.isArray(e)?ky(e,t):bB(e)?ky(e.\u0275providers,t):t(e)}class _E{}class CB{resolveComponentFactory(t){throw function xB(n){const t=Error(`No component factory found for ${yt(n)}. Did you add it to @NgModule.entryComponents?`);return t.ngComponent=n,t}(t)}}let Yc=(()=>{class n{}return n.NULL=new CB,n})();function EB(){return $u(_n(),ee())}function $u(n,t){return new Ur(Or(n,t))}let Ur=(()=>{class n{constructor(e){this.nativeElement=e}}return n.__NG_ELEMENT_ID__=EB,n})();function DB(n){return n instanceof Ur?n.nativeElement:n}class Qc{}let Ui=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function SB(){const n=ee(),e=Lr(_n().index,n);return(qn(e)?e:n)[11]}(),n})(),IB=(()=>{class n{}return n.\u0275prov=fe({token:n,providedIn:"root",factory:()=>null}),n})();class Zc{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const AB=new Zc("14.3.0"),Ry={};function Fy(n){return n.ngOriginalError}class Gu{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t);this._console.error("ERROR",t),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(t){let e=t&&Fy(t);for(;e&&Fy(e);)e=Fy(e);return e||null}}function ji(n){return n instanceof Function?n():n}function EE(n,t,e){let r=n.length;for(;;){const o=n.indexOf(t,e);if(-1===o)return o;if(0===o||n.charCodeAt(o-1)<=32){const i=t.length;if(o+i===r||n.charCodeAt(o+i)<=32)return o}e=o+1}}const DE="ng-template";function VB(n,t,e){let r=0;for(;r<n.length;){let o=n[r++];if(e&&"class"===o){if(o=n[r],-1!==EE(o.toLowerCase(),t,0))return!0}else if(1===o){for(;r<n.length&&"string"==typeof(o=n[r++]);)if(o.toLowerCase()===t)return!0;return!1}}return!1}function SE(n){return 4===n.type&&n.value!==DE}function UB(n,t,e){return t===(4!==n.type||e?n.value:DE)}function jB(n,t,e){let r=4;const o=n.attrs||[],i=function zB(n){for(let t=0;t<n.length;t++)if(eC(n[t]))return t;return n.length}(o);let s=!1;for(let a=0;a<t.length;a++){const u=t[a];if("number"!=typeof u){if(!s)if(4&r){if(r=2|1&r,""!==u&&!UB(n,u,e)||""===u&&1===t.length){if(Eo(r))return!1;s=!0}}else{const l=8&r?u:t[++a];if(8&r&&null!==n.attrs){if(!VB(n.attrs,l,e)){if(Eo(r))return!1;s=!0}continue}const d=HB(8&r?"class":u,o,SE(n),e);if(-1===d){if(Eo(r))return!1;s=!0;continue}if(""!==l){let f;f=d>i?"":o[d+1].toLowerCase();const h=8&r?f:null;if(h&&-1!==EE(h,l,0)||2&r&&l!==f){if(Eo(r))return!1;s=!0}}}}else{if(!s&&!Eo(r)&&!Eo(u))return!1;if(s&&Eo(u))continue;s=!1,r=u|1&r}}return Eo(r)||s}function Eo(n){return 0==(1&n)}function HB(n,t,e,r){if(null===t)return-1;let o=0;if(r||!e){let i=!1;for(;o<t.length;){const s=t[o];if(s===n)return o;if(3===s||6===s)i=!0;else{if(1===s||2===s){let a=t[++o];for(;"string"==typeof a;)a=t[++o];continue}if(4===s)break;if(0===s){o+=4;continue}}o+=i?1:2}return-1}return function $B(n,t){let e=n.indexOf(4);if(e>-1)for(e++;e<n.length;){const r=n[e];if("number"==typeof r)return-1;if(r===t)return e;e++}return-1}(t,n)}function IE(n,t,e=!1){for(let r=0;r<t.length;r++)if(jB(n,t[r],e))return!0;return!1}function AE(n,t){return n?":not("+t.trim()+")":t}function qB(n){let t=n[0],e=1,r=2,o="",i=!1;for(;e<n.length;){let s=n[e];if("string"==typeof s)if(2&r){const a=n[++e];o+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else 8&r?o+="."+s:4&r&&(o+=" "+s);else""!==o&&!Eo(s)&&(t+=AE(i,o),o=""),r=s,i=i||!Eo(r);e++}return""!==o&&(t+=AE(i,o)),t}const Ve={};function xe(n){TE(st(),ee(),gr()+n,!1)}function TE(n,t,e,r){if(!r)if(3==(3&t[2])){const i=n.preOrderCheckHooks;null!==i&&_h(t,i,e)}else{const i=n.preOrderHooks;null!==i&&xh(t,i,0,e)}Ps(e)}function NE(n,t=null,e=null,r){const o=FE(n,t,e,r);return o.resolveInjectorInitializers(),o}function FE(n,t=null,e=null,r,o=new Set){const i=[e||ot,dB(n)];return r=r||("object"==typeof n?void 0:yt(n)),new wE(i,t||jh(),r||null,o)}let jr=(()=>{class n{static create(e,r){if(Array.isArray(e))return NE({name:""},r,e,"");{const o=e.name??"";return NE({name:o},e.parent,e.providers,o)}}}return n.THROW_IF_NOT_FOUND=Lc,n.NULL=new pE,n.\u0275prov=fe({token:n,providedIn:"any",factory:()=>re(fE)}),n.__NG_ELEMENT_ID__=-1,n})();function X(n,t=Se.Default){const e=ee();return null===e?re(n,t):uC(_n(),e,ke(n),t)}function Vy(){throw new Error("invalid")}function Wh(n,t){return n<<17|t<<2}function Do(n){return n>>17&32767}function Uy(n){return 2|n}function Hi(n){return(131068&n)>>2}function jy(n,t){return-131069&n|t<<2}function Hy(n){return 1|n}function QE(n,t){const e=n.contentQueries;if(null!==e)for(let r=0;r<e.length;r+=2){const o=e[r],i=e[r+1];if(-1!==i){const s=n.data[i];Lv(o),s.contentQueries(2,t[i],i)}}}function Gh(n,t,e,r,o,i,s,a,u,l,c){const d=t.blueprint.slice();return d[0]=o,d[2]=76|r,(null!==c||n&&1024&n[2])&&(d[2]|=1024),Ux(d),d[3]=d[15]=n,d[8]=e,d[10]=s||n&&n[10],d[11]=a||n&&n[11],d[12]=u||n&&n[12]||null,d[9]=l||n&&n[9]||null,d[6]=i,d[20]=function cL(){return lL++}(),d[21]=c,d[16]=2==t.type?n[16]:d,d}function Xu(n,t,e,r,o){let i=n.data[t];if(null===i)i=function Yy(n,t,e,r,o){const i=Wx(),s=Nv(),u=n.data[t]=function T3(n,t,e,r,o,i){return{type:e,index:r,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:o,attrs:i,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,s?i:i&&i.parent,e,t,r,o);return null===n.firstChild&&(n.firstChild=u),null!==i&&(s?null==i.child&&null!==u.parent&&(i.child=u):null===i.next&&(i.next=u)),u}(n,t,e,r,o),function uO(){return Le.lFrame.inI18n}()&&(i.flags|=64);else if(64&i.type){i.type=e,i.value=r,i.attrs=o;const s=function Ac(){const n=Le.lFrame,t=n.currentTNode;return n.isParent?t:t.parent}();i.injectorIndex=null===s?-1:s.injectorIndex}return Xo(i,!0),i}function Yu(n,t,e,r){if(0===e)return-1;const o=t.length;for(let i=0;i<e;i++)t.push(r),n.blueprint.push(r),n.data.push(null);return o}function Qy(n,t,e){Bv(t);try{const r=n.viewQuery;null!==r&&iw(1,r,e);const o=n.template;null!==o&&ZE(n,t,o,1,e),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&QE(n,t),n.staticViewQueries&&iw(2,n.viewQuery,e);const i=n.components;null!==i&&function S3(n,t){for(let e=0;e<t.length;e++)$3(n,t[e])}(t,i)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{t[2]&=-5,Vv()}}function qh(n,t,e,r){const o=t[2];if(128!=(128&o)){Bv(t);try{Ux(t),function $x(n){return Le.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==e&&ZE(n,t,e,2,r);const s=3==(3&o);if(s){const l=n.preOrderCheckHooks;null!==l&&_h(t,l,null)}else{const l=n.preOrderHooks;null!==l&&xh(t,l,0,null),Uv(t,0)}if(function W3(n){for(let t=ay(n);null!==t;t=uy(t)){if(!t[2])continue;const e=t[9];for(let r=0;r<e.length;r++){const o=e[r],i=o[3];0==(512&o[2])&&Rv(i,1),o[2]|=512}}}(t),function H3(n){for(let t=ay(n);null!==t;t=uy(t))for(let e=10;e<t.length;e++){const r=t[e],o=r[1];wh(r)&&qh(o,r,o.template,r[8])}}(t),null!==n.contentQueries&&QE(n,t),s){const l=n.contentCheckHooks;null!==l&&_h(t,l)}else{const l=n.contentHooks;null!==l&&xh(t,l,1),Uv(t,1)}!function E3(n,t){const e=n.hostBindingOpCodes;if(null!==e)try{for(let r=0;r<e.length;r++){const o=e[r];if(o<0)Ps(~o);else{const i=o,s=e[++r],a=e[++r];lO(s,i),a(2,t[i])}}}finally{Ps(-1)}}(n,t);const a=n.components;null!==a&&function D3(n,t){for(let e=0;e<t.length;e++)z3(n,t[e])}(t,a);const u=n.viewQuery;if(null!==u&&iw(2,u,r),s){const l=n.viewCheckHooks;null!==l&&_h(t,l)}else{const l=n.viewHooks;null!==l&&xh(t,l,2),Uv(t,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),t[2]&=-41,512&t[2]&&(t[2]&=-513,Rv(t[3],-1))}finally{Vv()}}}function ZE(n,t,e,r,o){const i=gr(),s=2&r;try{Ps(-1),s&&t.length>22&&TE(n,t,22,!1),e(r,o)}finally{Ps(i)}}function Zy(n,t,e){!Hx()||(function F3(n,t,e,r){const o=e.directiveStart,i=e.directiveEnd;n.firstCreatePass||kc(e,t),Qn(r,t);const s=e.initialInputs;for(let a=o;a<i;a++){const u=n.data[a],l=Pr(u);l&&V3(t,e,u);const c=Rc(t,n,a,e);Qn(c,t),null!==s&&U3(0,a-o,c,u,0,s),l&&(Lr(e.index,t)[8]=c)}}(n,t,e,Or(e,t)),128==(128&e.flags)&&function P3(n,t,e){const r=e.directiveStart,o=e.directiveEnd,i=e.index,s=function cO(){return Le.lFrame.currentDirectiveIndex}();try{Ps(i);for(let a=r;a<o;a++){const u=n.data[a],l=t[a];Pv(a),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&sD(u,l)}}finally{Ps(-1),Pv(s)}}(n,t,e))}function Jy(n,t,e=Or){const r=t.localNames;if(null!==r){let o=t.index+1;for(let i=0;i<r.length;i+=2){const s=r[i+1],a=-1===s?e(t,n):n[s];n[o++]=a}}}function eD(n){const t=n.tView;return null===t||t.incompleteFirstPass?n.tView=ew(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):t}function ew(n,t,e,r,o,i,s,a,u,l){const c=22+r,d=c+o,f=function I3(n,t){const e=[];for(let r=0;r<t;r++)e.push(r<n?null:Ve);return e}(c,d),h="function"==typeof l?l():l;return f[1]={type:n,blueprint:f,template:e,queries:null,viewQuery:a,declTNode:t,data:f.slice().fill(null,c),bindingStartIndex:c,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof i?i():i,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:u,consts:h,incompleteFirstPass:!1}}function tD(n,t,e,r){const o=dD(t);null===e?o.push(r):(o.push(e),n.firstCreatePass&&fD(n).push(r,o.length-1))}function nD(n,t,e){for(let r in n)if(n.hasOwnProperty(r)){const o=n[r];(e=null===e?{}:e).hasOwnProperty(r)?e[r].push(t,o):e[r]=[t,o]}return e}function rD(n,t){const r=t.directiveEnd,o=n.data,i=t.attrs,s=[];let a=null,u=null;for(let l=t.directiveStart;l<r;l++){const c=o[l],d=c.inputs,f=null===i||SE(t)?null:j3(d,i);s.push(f),a=nD(d,l,a),u=nD(c.outputs,l,u)}null!==a&&(a.hasOwnProperty("class")&&(t.flags|=16),a.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=s,t.inputs=a,t.outputs=u}function oD(n,t){const e=Lr(t,n);16&e[2]||(e[2]|=32)}function tw(n,t,e,r){let o=!1;if(Hx()){const i=function O3(n,t,e){const r=n.directiveRegistry;let o=null;if(r)for(let i=0;i<r.length;i++){const s=r[i];IE(e,s.selectors,!1)&&(o||(o=[]),Ih(kc(e,t),n,s.type),Pr(s)?(aD(n,e),o.unshift(s)):o.push(s))}return o}(n,t,e),s=null===r?null:{"":-1};if(null!==i){o=!0,uD(e,n.data.length,i.length);for(let c=0;c<i.length;c++){const d=i[c];d.providersResolver&&d.providersResolver(d)}let a=!1,u=!1,l=Yu(n,t,i.length,null);for(let c=0;c<i.length;c++){const d=i[c];e.mergedAttrs=Eh(e.mergedAttrs,d.hostAttrs),lD(n,e,t,l,d),B3(l,d,s),null!==d.contentQueries&&(e.flags|=8),(null!==d.hostBindings||null!==d.hostAttrs||0!==d.hostVars)&&(e.flags|=128);const f=d.type.prototype;!a&&(f.ngOnChanges||f.ngOnInit||f.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e.index),a=!0),!u&&(f.ngOnChanges||f.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e.index),u=!0),l++}rD(n,e)}s&&function L3(n,t,e){if(t){const r=n.localNames=[];for(let o=0;o<t.length;o+=2){const i=e[t[o+1]];if(null==i)throw new Q(-301,!1);r.push(t[o],i)}}}(e,r,s)}return e.mergedAttrs=Eh(e.mergedAttrs,e.attrs),o}function iD(n,t,e,r,o,i){const s=i.hostBindings;if(s){let a=n.hostBindingOpCodes;null===a&&(a=n.hostBindingOpCodes=[]);const u=~t.index;(function N3(n){let t=n.length;for(;t>0;){const e=n[--t];if("number"==typeof e&&e<0)return e}return 0})(a)!=u&&a.push(u),a.push(r,o,s)}}function sD(n,t){null!==n.hostBindings&&n.hostBindings(1,t)}function aD(n,t){t.flags|=2,(n.components||(n.components=[])).push(t.index)}function B3(n,t,e){if(e){if(t.exportAs)for(let r=0;r<t.exportAs.length;r++)e[t.exportAs[r]]=n;Pr(t)&&(e[""]=n)}}function uD(n,t,e){n.flags|=1,n.directiveStart=t,n.directiveEnd=t+e,n.providerIndexes=t}function lD(n,t,e,r,o){n.data[r]=o;const i=o.factory||(o.factory=Pi(o.type)),s=new Tc(i,Pr(o),X);n.blueprint[r]=s,e[r]=s,iD(n,t,0,r,Yu(n,e,o.hostVars,Ve),o)}function V3(n,t,e){const r=Or(t,n),o=eD(e),i=n[10],s=Kh(n,Gh(n,o,null,e.onPush?32:16,r,t,i,i.createRenderer(r,e),null,null,null));n[t.index]=s}function Qo(n,t,e,r,o,i){const s=Or(n,t);!function nw(n,t,e,r,o,i,s){if(null==i)n.removeAttribute(t,o,e);else{const a=null==s?Pe(i):s(i,r||"",o);n.setAttribute(t,o,a,e)}}(t[11],s,i,n.value,e,r,o)}function U3(n,t,e,r,o,i){const s=i[t];if(null!==s){const a=r.setInput;for(let u=0;u<s.length;){const l=s[u++],c=s[u++],d=s[u++];null!==a?r.setInput(e,d,l,c):e[c]=d}}}function j3(n,t){let e=null,r=0;for(;r<t.length;){const o=t[r];if(0!==o)if(5!==o){if("number"==typeof o)break;n.hasOwnProperty(o)&&(null===e&&(e=[]),e.push(o,n[o],t[r+1])),r+=2}else r+=2;else r+=4}return e}function cD(n,t,e,r){return new Array(n,!0,!1,t,null,0,r,e,null,null)}function z3(n,t){const e=Lr(t,n);if(wh(e)){const r=e[1];48&e[2]?qh(r,e,r.template,e[8]):e[5]>0&&rw(e)}}function rw(n){for(let r=ay(n);null!==r;r=uy(r))for(let o=10;o<r.length;o++){const i=r[o];if(wh(i))if(512&i[2]){const s=i[1];qh(s,i,s.template,i[8])}else i[5]>0&&rw(i)}const e=n[1].components;if(null!==e)for(let r=0;r<e.length;r++){const o=Lr(e[r],n);wh(o)&&o[5]>0&&rw(o)}}function $3(n,t){const e=Lr(t,n),r=e[1];(function G3(n,t){for(let e=t.length;e<n.blueprint.length;e++)t.push(n.blueprint[e])})(r,e),Qy(r,e,e[8])}function Kh(n,t){return n[13]?n[14][4]=t:n[13]=t,n[14]=t,t}function ow(n){for(;n;){n[2]|=32;const t=$c(n);if(Ev(n)&&!t)return n;n=t}return null}function Xh(n,t,e,r=!0){const o=t[10];o.begin&&o.begin();try{qh(n,t,n.template,e)}catch(s){throw r&&pD(t,s),s}finally{o.end&&o.end()}}function iw(n,t,e){Lv(0),t(n,e)}function dD(n){return n[7]||(n[7]=[])}function fD(n){return n.cleanup||(n.cleanup=[])}function pD(n,t){const e=n[9],r=e?e.get(Gu,null):null;r&&r.handleError(t)}function sw(n,t,e,r,o){for(let i=0;i<e.length;){const s=e[i++],a=e[i++],u=t[s],l=n.data[s];null!==l.setInput?l.setInput(u,o,r,a):u[a]=o}}function Yh(n,t,e){let r=e?n.styles:null,o=e?n.classes:null,i=0;if(null!==t)for(let s=0;s<t.length;s++){const a=t[s];"number"==typeof a?i=a:1==i?o=pc(o,a):2==i&&(r=pc(r,a+": "+t[++s]+";"))}e?n.styles=r:n.stylesWithoutHost=r,e?n.classes=o:n.classesWithoutHost=o}function Qh(n,t,e,r,o=!1){for(;null!==e;){const i=t[e.index];if(null!==i&&r.push(ln(i)),Sr(i))for(let a=10;a<i.length;a++){const u=i[a],l=u[1].firstChild;null!==l&&Qh(u[1],u,l,r)}const s=e.type;if(8&s)Qh(n,t,e.child,r);else if(32&s){const a=sy(e,t);let u;for(;u=a();)r.push(u)}else if(16&s){const a=QC(t,e);if(Array.isArray(a))r.push(...a);else{const u=$c(t[16]);Qh(u[1],u,a,r,!0)}}e=o?e.projectionNext:e.next}return r}class Jc{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,e=t[1];return Qh(e,t,e.firstChild,[])}get context(){return this._lView[8]}set context(t){this._lView[8]=t}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(Sr(t)){const e=t[8],r=e?e.indexOf(this):-1;r>-1&&(dy(t,r),Th(e,r))}this._attachedToViewContainer=!1}HC(this._lView[1],this._lView)}onDestroy(t){tD(this._lView[1],this._lView,null,t)}markForCheck(){ow(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){Xh(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Q(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function IL(n,t){Gc(n,t,t[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new Q(902,!1);this._appRef=t}}class q3 extends Jc{constructor(t){super(t),this._view=t}detectChanges(){const t=this._view;Xh(t[1],t,t[8],!1)}checkNoChanges(){}get context(){return null}}class aw extends Yc{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=ht(t);return new ed(e,this.ngModule)}}function gD(n){const t=[];for(let e in n)n.hasOwnProperty(e)&&t.push({propName:n[e],templateName:e});return t}class X3{constructor(t,e){this.injector=t,this.parentInjector=e}get(t,e,r){const o=this.injector.get(t,Ry,r);return o!==Ry||e===Ry?o:this.parentInjector.get(t,e,r)}}class ed extends _E{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=function KB(n){return n.map(qB).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return gD(this.componentDef.inputs)}get outputs(){return gD(this.componentDef.outputs)}create(t,e,r,o){let i=(o=o||this.ngModule)instanceof Bs?o:o?.injector;i&&null!==this.componentDef.getStandaloneInjector&&(i=this.componentDef.getStandaloneInjector(i)||i);const s=i?new X3(t,i):t,a=s.get(Qc,null);if(null===a)throw new Q(407,!1);const u=s.get(IB,null),l=a.createRenderer(null,this.componentDef),c=this.componentDef.selectors[0][0]||"div",d=r?function A3(n,t,e){return n.selectRootElement(t,e===Er.ShadowDom)}(l,r,this.componentDef.encapsulation):cy(l,c,function K3(n){const t=n.toLowerCase();return"svg"===t?"svg":"math"===t?"math":null}(c)),f=this.componentDef.onPush?288:272,h=ew(0,null,null,1,0,null,null,null,null,null),p=Gh(null,h,null,f,null,null,a,l,u,s,null);let m,v;Bv(p);try{const y=function Z3(n,t,e,r,o,i){const s=e[1];e[22]=n;const u=Xu(s,22,2,"#host",null),l=u.mergedAttrs=t.hostAttrs;null!==l&&(Yh(u,l,!0),null!==n&&(Ch(o,n,l),null!==u.classes&&vy(o,n,u.classes),null!==u.styles&&JC(o,n,u.styles)));const c=r.createRenderer(n,t),d=Gh(e,eD(t),null,t.onPush?32:16,e[22],u,r,c,i||null,null,null);return s.firstCreatePass&&(Ih(kc(u,e),s,t.type),aD(s,u),uD(u,e.length,1)),Kh(e,d),e[22]=d}(d,this.componentDef,p,a,l);if(d)if(r)Ch(l,d,["ng-version",AB.full]);else{const{attrs:_,classes:b}=function XB(n){const t=[],e=[];let r=1,o=2;for(;r<n.length;){let i=n[r];if("string"==typeof i)2===o?""!==i&&t.push(i,n[++r]):8===o&&e.push(i);else{if(!Eo(o))break;o=i}r++}return{attrs:t,classes:e}}(this.componentDef.selectors[0]);_&&Ch(l,d,_),b&&b.length>0&&vy(l,d,b.join(" "))}if(v=kv(h,22),void 0!==e){const _=v.projection=[];for(let b=0;b<this.ngContentSelectors.length;b++){const x=e[b];_.push(null!=x?Array.from(x):null)}}m=function J3(n,t,e,r){const o=e[1],i=function R3(n,t,e){const r=_n();n.firstCreatePass&&(e.providersResolver&&e.providersResolver(e),lD(n,r,t,Yu(n,t,1,null),e),rD(n,r));const o=Rc(t,n,r.directiveStart,r);Qn(o,t);const i=Or(r,t);return i&&Qn(i,t),o}(o,e,t);if(n[8]=e[8]=i,null!==r)for(const a of r)a(i,t);if(t.contentQueries){const a=_n();t.contentQueries(1,i,a.directiveStart)}const s=_n();return!o.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(Ps(s.index),iD(e[1],s,0,s.directiveStart,s.directiveEnd,t),sD(t,i)),i}(y,this.componentDef,p,[e4]),Qy(h,p,null)}finally{Vv()}return new Q3(this.componentType,m,$u(v,p),p,v)}}class Q3 extends class _B{}{constructor(t,e,r,o,i){super(),this.location=r,this._rootLView=o,this._tNode=i,this.instance=e,this.hostView=this.changeDetectorRef=new q3(o),this.componentType=t}setInput(t,e){const r=this._tNode.inputs;let o;if(null!==r&&(o=r[t])){const i=this._rootLView;sw(i[1],i,o,t,e),oD(i,this._tNode.index)}}get injector(){return new Fu(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}function e4(){const n=_n();bh(ee()[1],n)}function _t(n){let t=function mD(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),e=!0;const r=[n];for(;t;){let o;if(Pr(n))o=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Q(903,!1);o=t.\u0275dir}if(o){if(e){r.push(o);const s=n;s.inputs=uw(n.inputs),s.declaredInputs=uw(n.declaredInputs),s.outputs=uw(n.outputs);const a=o.hostBindings;a&&o4(n,a);const u=o.viewQuery,l=o.contentQueries;if(u&&n4(n,u),l&&r4(n,l),vu(n.inputs,o.inputs),vu(n.declaredInputs,o.declaredInputs),vu(n.outputs,o.outputs),Pr(o)&&o.data.animation){const c=n.data;c.animation=(c.animation||[]).concat(o.data.animation)}}const i=o.features;if(i)for(let s=0;s<i.length;s++){const a=i[s];a&&a.ngInherit&&a(n),a===_t&&(e=!1)}}t=Object.getPrototypeOf(t)}!function t4(n){let t=0,e=null;for(let r=n.length-1;r>=0;r--){const o=n[r];o.hostVars=t+=o.hostVars,o.hostAttrs=Eh(o.hostAttrs,e=Eh(e,o.hostAttrs))}}(r)}function uw(n){return n===As?{}:n===ot?[]:n}function n4(n,t){const e=n.viewQuery;n.viewQuery=e?(r,o)=>{t(r,o),e(r,o)}:t}function r4(n,t){const e=n.contentQueries;n.contentQueries=e?(r,o,i)=>{t(r,o,i),e(r,o,i)}:t}function o4(n,t){const e=n.hostBindings;n.hostBindings=e?(r,o)=>{t(r,o),e(r,o)}:t}let Zh=null;function Ra(){if(!Zh){const n=bt.Symbol;if(n&&n.iterator)Zh=n.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const r=t[e];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(Zh=r)}}}return Zh}function td(n){return!!lw(n)&&(Array.isArray(n)||!(n instanceof Map)&&Ra()in n)}function lw(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function Zn(n,t,e){return!Object.is(n[t],e)&&(n[t]=e,!0)}function Jo(n,t,e,r){const o=ee();return Zn(o,ku(),t)&&(st(),Qo(jt(),o,n,t,e,r)),Jo}function et(n,t,e,r,o,i,s,a){const u=ee(),l=st(),c=n+22,d=l.firstCreatePass?function f4(n,t,e,r,o,i,s,a,u){const l=t.consts,c=Xu(t,n,4,s||null,Fs(l,a));tw(t,e,c,Fs(l,u)),bh(t,c);const d=c.tViews=ew(2,c,r,o,i,t.directiveRegistry,t.pipeRegistry,null,t.schemas,l);return null!==t.queries&&(t.queries.template(t,c),d.queries=t.queries.embeddedTView(c)),c}(c,l,u,t,e,r,o,i,s):l.data[c];Xo(d,!1);const f=u[11].createComment("");Ph(l,u,f,d),Qn(f,u),Kh(u,u[c]=cD(f,u,f,d)),Au(d)&&Zy(l,u,d),null!=s&&Jy(u,d,a)}function Ce(n,t,e){const r=ee();return Zn(r,ku(),t)&&function Hr(n,t,e,r,o,i,s,a){const u=Or(t,e);let c,l=t.inputs;!a&&null!=l&&(c=l[r])?(sw(n,e,c,r,o),Iu(t)&&oD(e,t.index)):3&t.type&&(r=function M3(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(r),o=null!=s?s(o,t.value||"",r):o,i.setProperty(u,r,o))}(st(),jt(),r,n,t,r[11],e,!1),Ce}function cw(n,t,e,r,o){const s=o?"class":"style";sw(n,e,t.inputs[s],s,r)}function Z(n,t,e,r){const o=ee(),i=st(),s=22+n,a=o[11],u=o[s]=cy(a,t,function mO(){return Le.lFrame.currentNamespace}()),l=i.firstCreatePass?function g4(n,t,e,r,o,i,s){const a=t.consts,l=Xu(t,n,2,o,Fs(a,i));return tw(t,e,l,Fs(a,s)),null!==l.attrs&&Yh(l,l.attrs,!1),null!==l.mergedAttrs&&Yh(l,l.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,l),l}(s,i,o,0,t,e,r):i.data[s];Xo(l,!0);const c=l.mergedAttrs;null!==c&&Ch(a,u,c);const d=l.classes;null!==d&&vy(a,u,d);const f=l.styles;return null!==f&&JC(a,u,f),64!=(64&l.flags)&&Ph(i,o,u,l),0===function nO(){return Le.lFrame.elementDepthCount}()&&Qn(u,o),function rO(){Le.lFrame.elementDepthCount++}(),Au(l)&&(Zy(i,o,l),function JE(n,t,e){if(Ec(t)){const o=t.directiveEnd;for(let i=t.directiveStart;i<o;i++){const s=n.data[i];s.contentQueries&&s.contentQueries(1,e[i],i)}}}(i,l,o)),null!==r&&Jy(o,l),Z}function te(){let n=_n();Nv()?function Fv(){Le.lFrame.isParent=!1}():(n=n.parent,Xo(n,!1));const t=n;!function oO(){Le.lFrame.elementDepthCount--}();const e=st();return e.firstCreatePass&&(bh(e,n),Ec(n)&&e.queries.elementEnd(n)),null!=t.classesWithoutHost&&function _O(n){return 0!=(16&n.flags)}(t)&&cw(e,t,ee(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function xO(n){return 0!=(32&n.flags)}(t)&&cw(e,t,ee(),t.stylesWithoutHost,!1),te}function ye(n,t,e,r){return Z(n,t,e,r),te(),ye}function So(){return ee()}function rd(n){return!!n&&"function"==typeof n.then}function ID(n){return!!n&&"function"==typeof n.subscribe}const hw=ID;function pt(n,t,e,r){const o=ee(),i=st(),s=_n();return function TD(n,t,e,r,o,i,s,a){const u=Au(r),c=n.firstCreatePass&&fD(n),d=t[8],f=dD(t);let h=!0;if(3&r.type||a){const v=Or(r,t),y=a?a(v):v,_=f.length,b=a?E=>a(ln(E[r.index])):r.index;let x=null;if(!a&&u&&(x=function v4(n,t,e,r){const o=n.cleanup;if(null!=o)for(let i=0;i<o.length-1;i+=2){const s=o[i];if(s===e&&o[i+1]===r){const a=t[7],u=o[i+2];return a.length>u?a[u]:null}"string"==typeof s&&(i+=2)}return null}(n,t,o,r.index)),null!==x)(x.__ngLastListenerFn__||x).__ngNextListenerFn__=i,x.__ngLastListenerFn__=i,h=!1;else{i=kD(r,t,d,i,!1);const E=e.listen(y,o,i);f.push(i,E),c&&c.push(o,b,_,_+1)}}else i=kD(r,t,d,i,!1);const p=r.outputs;let m;if(h&&null!==p&&(m=p[o])){const v=m.length;if(v)for(let y=0;y<v;y+=2){const D=t[m[y]][m[y+1]].subscribe(i),k=f.length;f.push(i,D),c&&c.push(o,r.index,k,-(k+1))}}}(i,o,o[11],s,n,t,0,r),pt}function MD(n,t,e,r){try{return!1!==e(r)}catch(o){return pD(n,o),!1}}function kD(n,t,e,r,o){return function i(s){if(s===Function)return r;ow(2&n.flags?Lr(n.index,t):t);let u=MD(t,0,r,s),l=i.__ngNextListenerFn__;for(;l;)u=MD(t,0,l,s)&&u,l=l.__ngNextListenerFn__;return o&&!1===u&&(s.preventDefault(),s.returnValue=!1),u}}function dt(n=1){return function fO(n){return(Le.lFrame.contextLView=function hO(n,t){for(;n>0;)t=t[15],n--;return t}(n,Le.lFrame.contextLView))[8]}(n)}function jD(n,t,e,r,o){const i=n[e+1],s=null===t;let a=r?Do(i):Hi(i),u=!1;for(;0!==a&&(!1===u||s);){const c=n[a+1];C4(n[a],t)&&(u=!0,n[a+1]=r?Hy(c):Uy(c)),a=r?Do(c):Hi(c)}u&&(n[e+1]=r?Uy(i):Hy(i))}function C4(n,t){return null===n||null==t||(Array.isArray(n)?n[1]:n)===t||!(!Array.isArray(n)||"string"!=typeof t)&&Vu(n,t)>=0}function ep(n,t){return function Io(n,t,e,r){const o=ee(),i=st(),s=function Li(n){const t=Le.lFrame,e=t.bindingIndex;return t.bindingIndex=t.bindingIndex+n,e}(2);i.firstUpdatePass&&function YD(n,t,e,r){const o=n.data;if(null===o[e+1]){const i=o[gr()],s=function XD(n,t){return t>=n.expandoStartIndex}(n,e);(function eS(n,t){return 0!=(n.flags&(t?16:32))})(i,r)&&null===t&&!s&&(t=!1),t=function R4(n,t,e,r){const o=function Ov(n){const t=Le.lFrame.currentDirectiveIndex;return-1===t?null:n[t]}(n);let i=r?t.residualClasses:t.residualStyles;if(null===o)0===(r?t.classBindings:t.styleBindings)&&(e=od(e=gw(null,n,t,e,r),t.attrs,r),i=null);else{const s=t.directiveStylingLast;if(-1===s||n[s]!==o)if(e=gw(o,n,t,e,r),null===i){let u=function N4(n,t,e){const r=e?t.classBindings:t.styleBindings;if(0!==Hi(r))return n[Do(r)]}(n,t,r);void 0!==u&&Array.isArray(u)&&(u=gw(null,n,t,u[1],r),u=od(u,t.attrs,r),function F4(n,t,e,r){n[Do(e?t.classBindings:t.styleBindings)]=r}(n,t,r,u))}else i=function P4(n,t,e){let r;const o=t.directiveEnd;for(let i=1+t.directiveStylingLast;i<o;i++)r=od(r,n[i].hostAttrs,e);return od(r,t.attrs,e)}(n,t,r)}return void 0!==i&&(r?t.residualClasses=i:t.residualStyles=i),e}(o,i,t,r),function _4(n,t,e,r,o,i){let s=i?t.classBindings:t.styleBindings,a=Do(s),u=Hi(s);n[r]=e;let c,l=!1;if(Array.isArray(e)){const d=e;c=d[1],(null===c||Vu(d,c)>0)&&(l=!0)}else c=e;if(o)if(0!==u){const f=Do(n[a+1]);n[r+1]=Wh(f,a),0!==f&&(n[f+1]=jy(n[f+1],r)),n[a+1]=function p3(n,t){return 131071&n|t<<17}(n[a+1],r)}else n[r+1]=Wh(a,0),0!==a&&(n[a+1]=jy(n[a+1],r)),a=r;else n[r+1]=Wh(u,0),0===a?a=r:n[u+1]=jy(n[u+1],r),u=r;l&&(n[r+1]=Uy(n[r+1])),jD(n,c,r,!0),jD(n,c,r,!1),function x4(n,t,e,r,o){const i=o?n.residualClasses:n.residualStyles;null!=i&&"string"==typeof t&&Vu(i,t)>=0&&(e[r+1]=Hy(e[r+1]))}(t,c,n,r,i),s=Wh(a,u),i?t.classBindings=s:t.styleBindings=s}(o,i,t,e,s,r)}}(i,n,s,r),t!==Ve&&Zn(o,s,t)&&function ZD(n,t,e,r,o,i,s,a){if(!(3&t.type))return;const u=n.data,l=u[a+1];tp(function WE(n){return 1==(1&n)}(l)?JD(u,t,e,o,Hi(l),s):void 0)||(tp(i)||function HE(n){return 2==(2&n)}(l)&&(i=JD(u,null,e,o,a,s)),function LL(n,t,e,r,o){if(t)o?n.addClass(e,r):n.removeClass(e,r);else{let i=-1===r.indexOf("-")?void 0:Ar.DashCase;null==o?n.removeStyle(e,r,i):("string"==typeof o&&o.endsWith("!important")&&(o=o.slice(0,-10),i|=Ar.Important),n.setStyle(e,r,o,i))}}(r,s,yh(gr(),e),o,i))}(i,i.data[gr()],o,o[11],n,o[s+1]=function B4(n,t){return null==n||("string"==typeof t?n+=t:"object"==typeof n&&(n=yt(Ls(n)))),n}(t,e),r,s)}(n,t,null,!0),ep}function gw(n,t,e,r,o){let i=null;const s=e.directiveEnd;let a=e.directiveStylingLast;for(-1===a?a=e.directiveStart:a++;a<s&&(i=t[a],r=od(r,i.hostAttrs,o),i!==n);)a++;return null!==n&&(e.directiveStylingLast=a),r}function od(n,t,e){const r=e?1:2;let o=-1;if(null!==t)for(let i=0;i<t.length;i++){const s=t[i];"number"==typeof s?o=s:o===r&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Vr(n,s,!!e||t[++i]))}return void 0===n?null:n}function JD(n,t,e,r,o,i){const s=null===t;let a;for(;o>0;){const u=n[o],l=Array.isArray(u),c=l?u[1]:u,d=null===c;let f=e[o+1];f===Ve&&(f=d?ot:void 0);let h=d?Kv(f,r):c===r?f:void 0;if(l&&!tp(h)&&(h=Kv(u,r)),tp(h)&&(a=h,s))return a;const p=n[o+1];o=s?Do(p):Hi(p)}if(null!==t){let u=i?t.residualClasses:t.residualStyles;null!=u&&(a=Kv(u,r))}return a}function tp(n){return void 0!==n}function Ee(n,t=""){const e=ee(),r=st(),o=n+22,i=r.firstCreatePass?Xu(r,o,1,t,null):r.data[o],s=e[o]=function ly(n,t){return n.createText(t)}(e[11],t);Ph(r,e,s,i),Xo(i,!1)}function Wr(n){return np("",n,""),Wr}function np(n,t,e){const r=ee(),o=function Zu(n,t,e,r){return Zn(n,ku(),e)?t+Pe(e)+r:Ve}(r,n,t,e);return o!==Ve&&function Wi(n,t,e){const r=yh(t,n);!function UC(n,t,e){n.setValue(t,e)}(n[11],r,e)}(r,gr(),o),np}const ul="en-US";let xS=ul;function yw(n,t,e,r,o){if(n=ke(n),Array.isArray(n))for(let i=0;i<n.length;i++)yw(n[i],t,e,r,o);else{const i=st(),s=ee();let a=ka(n)?n:ke(n.provide),u=bE(n);const l=_n(),c=1048575&l.providerIndexes,d=l.directiveStart,f=l.providerIndexes>>20;if(ka(n)||!n.multi){const h=new Tc(u,o,X),p=bw(a,t,o?c:c+f,d);-1===p?(Ih(kc(l,s),i,a),ww(i,n,t.length),t.push(a),l.directiveStart++,l.directiveEnd++,o&&(l.providerIndexes+=1048576),e.push(h),s.push(h)):(e[p]=h,s[p]=h)}else{const h=bw(a,t,c+f,d),p=bw(a,t,c,c+f),m=h>=0&&e[h],v=p>=0&&e[p];if(o&&!v||!o&&!m){Ih(kc(l,s),i,a);const y=function nU(n,t,e,r,o){const i=new Tc(n,e,X);return i.multi=[],i.index=t,i.componentProviders=0,qS(i,o,r&&!e),i}(o?tU:eU,e.length,o,r,u);!o&&v&&(e[p].providerFactory=y),ww(i,n,t.length,0),t.push(a),l.directiveStart++,l.directiveEnd++,o&&(l.providerIndexes+=1048576),e.push(y),s.push(y)}else ww(i,n,h>-1?h:p,qS(e[o?p:h],u,!o&&r));!o&&r&&v&&e[p].componentProviders++}}}function ww(n,t,e,r){const o=ka(t),i=function hB(n){return!!n.useClass}(t);if(o||i){const u=(i?ke(t.useClass):t).prototype.ngOnDestroy;if(u){const l=n.destroyHooks||(n.destroyHooks=[]);if(!o&&t.multi){const c=l.indexOf(e);-1===c?l.push(e,[r,u]):l[c+1].push(r,u)}else l.push(e,u)}}}function qS(n,t,e){return e&&n.componentProviders++,n.multi.push(t)-1}function bw(n,t,e,r){for(let o=e;o<r;o++)if(t[o]===n)return o;return-1}function eU(n,t,e,r){return _w(this.multi,[])}function tU(n,t,e,r){const o=this.multi;let i;if(this.providerFactory){const s=this.providerFactory.componentProviders,a=Rc(e,e[1],this.providerFactory.index,r);i=a.slice(0,s),_w(o,i);for(let u=s;u<a.length;u++)i.push(a[u])}else i=[],_w(o,i);return i}function _w(n,t){for(let e=0;e<n.length;e++)t.push((0,n[e])());return t}function Lt(n,t=[]){return e=>{e.providersResolver=(r,o)=>function JV(n,t,e){const r=st();if(r.firstCreatePass){const o=Pr(n);yw(e,r.data,r.blueprint,o,!0),yw(t,r.data,r.blueprint,o,!1)}}(r,o?o(n):n,t)}}class Pa{}class KS{}class XS extends Pa{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new aw(this);const r=dr(t);this._bootstrapComponents=ji(r.bootstrap),this._r3Injector=FE(t,e,[{provide:Pa,useValue:this},{provide:Yc,useValue:this.componentFactoryResolver}],yt(t),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(t)}get injector(){return this._r3Injector}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class xw extends KS{constructor(t){super(),this.moduleType=t}create(t){return new XS(this.moduleType,t)}}class oU extends Pa{constructor(t,e,r){super(),this.componentFactoryResolver=new aw(this),this.instance=null;const o=new wE([...t,{provide:Pa,useValue:this},{provide:Yc,useValue:this.componentFactoryResolver}],e||jh(),r,new Set(["environment"]));this.injector=o,o.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}}function ap(n,t,e=null){return new oU(n,t,e).injector}let iU=(()=>{class n{constructor(e){this._injector=e,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e.id)){const r=gE(0,e.type),o=r.length>0?ap([r],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e.id,o)}return this.cachedInjectors.get(e.id)}ngOnDestroy(){try{for(const e of this.cachedInjectors.values())null!==e&&e.destroy()}finally{this.cachedInjectors.clear()}}}return n.\u0275prov=fe({token:n,providedIn:"environment",factory:()=>new n(re(Bs))}),n})();function YS(n){n.getStandaloneInjector=t=>t.get(iU).getOrCreateStandaloneInjector(n)}function o2(n,t,e,r,o,i){const s=t+e;return Zn(n,s,o)?function Zo(n,t,e){return n[t]=e}(n,s+1,i?r.call(i,o):r(o)):function cd(n,t){const e=n[t];return e===Ve?void 0:e}(n,s+1)}function Ew(n){return t=>{setTimeout(n,void 0,t)}}const Qt=class AU extends eo{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,r){let o=t,i=e||(()=>null),s=r;if(t&&"object"==typeof t){const u=t;o=u.next?.bind(u),i=u.error?.bind(u),s=u.complete?.bind(u)}this.__isAsync&&(i=Ew(i),o&&(o=Ew(o)),s&&(s=Ew(s)));const a=super.subscribe({next:o,error:i,complete:s});return t instanceof de&&t.add(a),a}};function TU(){return this._results[Ra()]()}class Dw{constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=Ra(),r=Dw.prototype;r[e]||(r[e]=TU)}get changes(){return this._changes||(this._changes=new Qt)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){const r=this;r.dirty=!1;const o=Br(t);(this._changesDetected=!function RO(n,t,e){if(n.length!==t.length)return!1;for(let r=0;r<n.length;r++){let o=n[r],i=t[r];if(e&&(o=e(o),i=e(i)),i!==o)return!1}return!0}(r._results,o,e))&&(r._results=o,r.length=o.length,r.last=o[this.length-1],r.first=o[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let zi=(()=>{class n{}return n.__NG_ELEMENT_ID__=RU,n})();const MU=zi,kU=class extends MU{constructor(t,e,r){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=r}createEmbeddedView(t,e){const r=this._declarationTContainer.tViews,o=Gh(this._declarationLView,r,t,16,null,r.declTNode,null,null,null,null,e||null);o[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(o[19]=s.createEmbeddedView(r)),Qy(r,o,t),new Jc(o)}};function RU(){return up(_n(),ee())}function up(n,t){return 4&n.type?new kU(t,n,$u(n,t)):null}let To=(()=>{class n{}return n.__NG_ELEMENT_ID__=NU,n})();function NU(){return h2(_n(),ee())}const FU=To,d2=class extends FU{constructor(t,e,r){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=r}get element(){return $u(this._hostTNode,this._hostLView)}get injector(){return new Fu(this._hostTNode,this._hostLView)}get parentInjector(){const t=Sh(this._hostTNode,this._hostLView);if(rC(t)){const e=Nu(t,this._hostLView),r=Ru(t);return new Fu(e[1].data[r+8],e)}return new Fu(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=f2(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,e,r){let o,i;"number"==typeof r?o=r:null!=r&&(o=r.index,i=r.injector);const s=t.createEmbeddedView(e||{},i);return this.insert(s,o),s}createComponent(t,e,r,o,i){const s=t&&!function Pc(n){return"function"==typeof n}(t);let a;if(s)a=e;else{const d=e||{};a=d.index,r=d.injector,o=d.projectableNodes,i=d.environmentInjector||d.ngModuleRef}const u=s?t:new ed(ht(t)),l=r||this.parentInjector;if(!i&&null==u.ngModule){const f=(s?l:this.parentInjector).get(Bs,null);f&&(i=f)}const c=u.create(l,o,void 0,i);return this.insert(c.hostView,a),c}insert(t,e){const r=t._lView,o=r[1];if(function tO(n){return Sr(n[3])}(r)){const c=this.indexOf(t);if(-1!==c)this.detach(c);else{const d=r[3],f=new d2(d,d[6],d[3]);f.detach(f.indexOf(t))}}const i=this._adjustIndex(e),s=this._lContainer;!function TL(n,t,e,r){const o=10+r,i=e.length;r>0&&(e[o-1][4]=t),r<i-10?(t[4]=e[o],pC(e,10+r,t)):(e.push(t),t[4]=null),t[3]=e;const s=t[17];null!==s&&e!==s&&function ML(n,t){const e=n[9];t[16]!==t[3][3][16]&&(n[2]=!0),null===e?n[9]=[t]:e.push(t)}(s,t);const a=t[19];null!==a&&a.insertView(n),t[2]|=64}(o,r,s,i);const a=py(i,s),u=r[11],l=Fh(u,s[7]);return null!==l&&function SL(n,t,e,r,o,i){r[0]=o,r[6]=t,Gc(n,r,e,1,o,i)}(o,s[6],u,r,l,a),t.attachToViewContainerRef(),pC(Sw(s),i,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=f2(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),r=dy(this._lContainer,e);r&&(Th(Sw(this._lContainer),e),HC(r[1],r))}detach(t){const e=this._adjustIndex(t,-1),r=dy(this._lContainer,e);return r&&null!=Th(Sw(this._lContainer),e)?new Jc(r):null}_adjustIndex(t,e=0){return t??this.length+e}};function f2(n){return n[8]}function Sw(n){return n[8]||(n[8]=[])}function h2(n,t){let e;const r=t[n.index];if(Sr(r))e=r;else{let o;if(8&n.type)o=ln(r);else{const i=t[11];o=i.createComment("");const s=Or(n,t);Ta(i,Fh(i,s),o,function FL(n,t){return n.nextSibling(t)}(i,s),!1)}t[n.index]=e=cD(r,t,o,n),Kh(t,e)}return new d2(e,n,t)}class Iw{constructor(t){this.queryList=t,this.matches=null}clone(){return new Iw(this.queryList)}setDirty(){this.queryList.setDirty()}}class Aw{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const r=null!==t.contentQueries?t.contentQueries[0]:e.length,o=[];for(let i=0;i<r;i++){const s=e.getByIndex(i);o.push(this.queries[s.indexInDeclarationView].clone())}return new Aw(o)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==y2(t,e).matches&&this.queries[e].setDirty()}}class p2{constructor(t,e,r=null){this.predicate=t,this.flags=e,this.read=r}}class Tw{constructor(t=[]){this.queries=t}elementStart(t,e){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let r=0;r<this.length;r++){const o=null!==e?e.length:0,i=this.getByIndex(r).embeddedTView(t,o);i&&(i.indexInDeclarationView=r,null!==e?e.push(i):e=[i])}return null!==e?new Tw(e):null}template(t,e){for(let r=0;r<this.queries.length;r++)this.queries[r].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class Mw{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new Mw(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let r=t.parent;for(;null!==r&&8&r.type&&r.index!==e;)r=r.parent;return e===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const r=this.metadata.predicate;if(Array.isArray(r))for(let o=0;o<r.length;o++){const i=r[o];this.matchTNodeWithReadOption(t,e,LU(e,i)),this.matchTNodeWithReadOption(t,e,Ah(e,t,i,!1,!1))}else r===zi?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,Ah(e,t,r,!1,!1))}matchTNodeWithReadOption(t,e,r){if(null!==r){const o=this.metadata.read;if(null!==o)if(o===Ur||o===To||o===zi&&4&e.type)this.addMatch(e.index,-2);else{const i=Ah(e,t,o,!1,!1);null!==i&&this.addMatch(e.index,i)}else this.addMatch(e.index,r)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function LU(n,t){const e=n.localNames;if(null!==e)for(let r=0;r<e.length;r+=2)if(e[r]===t)return e[r+1];return null}function VU(n,t,e,r){return-1===e?function BU(n,t){return 11&n.type?$u(n,t):4&n.type?up(n,t):null}(t,n):-2===e?function UU(n,t,e){return e===Ur?$u(t,n):e===zi?up(t,n):e===To?h2(t,n):void 0}(n,t,r):Rc(n,n[1],e,t)}function g2(n,t,e,r){const o=t[19].queries[r];if(null===o.matches){const i=n.data,s=e.matches,a=[];for(let u=0;u<s.length;u+=2){const l=s[u];a.push(l<0?null:VU(t,i[l],s[u+1],e.metadata.read))}o.matches=a}return o.matches}function kw(n,t,e,r){const o=n.queries.getByIndex(e),i=o.matches;if(null!==i){const s=g2(n,t,o,e);for(let a=0;a<i.length;a+=2){const u=i[a];if(u>0)r.push(s[a/2]);else{const l=i[a+1],c=t[-u];for(let d=10;d<c.length;d++){const f=c[d];f[17]===f[3]&&kw(f[1],f,l,r)}if(null!==c[9]){const d=c[9];for(let f=0;f<d.length;f++){const h=d[f];kw(h[1],h,l,r)}}}}}return r}function ll(n){const t=ee(),e=st(),r=qx();Lv(r+1);const o=y2(e,r);if(n.dirty&&function eO(n){return 4==(4&n[2])}(t)===(2==(2&o.metadata.flags))){if(null===o.matches)n.reset([]);else{const i=o.crossesNgTemplate?kw(e,t,r,[]):g2(e,t,o,r);n.reset(i,DB),n.notifyOnChanges()}return!0}return!1}function lp(n,t,e){const r=st();r.firstCreatePass&&(function v2(n,t,e){null===n.queries&&(n.queries=new Tw),n.queries.track(new Mw(t,e))}(r,new p2(n,t,e),-1),2==(2&t)&&(r.staticViewQueries=!0)),function m2(n,t,e){const r=new Dw(4==(4&e));tD(n,t,r,r.destroy),null===t[19]&&(t[19]=new Aw),t[19].queries.push(new Iw(r))}(r,ee(),t)}function cl(){return function jU(n,t){return n[19].queries[t].queryList}(ee(),qx())}function y2(n,t){return n.queries.getByIndex(t)}function dp(...n){}const fp=new _e("Application Initializer");let hp=(()=>{class n{constructor(e){this.appInits=e,this.resolve=dp,this.reject=dp,this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,o)=>{this.resolve=r,this.reject=o})}runInitializers(){if(this.initialized)return;const e=[],r=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let o=0;o<this.appInits.length;o++){const i=this.appInits[o]();if(rd(i))e.push(i);else if(hw(i)){const s=new Promise((a,u)=>{i.subscribe({complete:a,error:u})});e.push(s)}}Promise.all(e).then(()=>{r()}).catch(o=>{this.reject(o)}),0===e.length&&r(),this.initialized=!0}}return n.\u0275fac=function(e){return new(e||n)(re(fp,8))},n.\u0275prov=fe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const hd=new _e("AppId",{providedIn:"root",factory:function L2(){return`${Lw()}${Lw()}${Lw()}`}});function Lw(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const B2=new _e("Platform Initializer"),Bw=new _e("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),V2=new _e("appBootstrapListener"),U2=new _e("AnimationModuleType");let lj=(()=>{class n{log(e){console.log(e)}warn(e){console.warn(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=fe({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const $i=new _e("LocaleId",{providedIn:"root",factory:()=>rn($i,Se.Optional|Se.SkipSelf)||function cj(){return typeof $localize<"u"&&$localize.locale||ul}()});class fj{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}let Vw=(()=>{class n{compileModuleSync(e){return new xw(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){const r=this.compileModuleSync(e),i=ji(dr(e).declarations).reduce((s,a)=>{const u=ht(a);return u&&s.push(new ed(u)),s},[]);return new fj(r,i)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=fe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const gj=(()=>Promise.resolve(0))();function Uw(n){typeof Zone>"u"?gj.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class on{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Qt(!1),this.onMicrotaskEmpty=new Qt(!1),this.onStable=new Qt(!1),this.onError=new Qt(!1),typeof Zone>"u")throw new Q(908,!1);Zone.assertZonePatched();const o=this;if(o._nesting=0,o._outer=o._inner=Zone.current,Zone.AsyncStackTaggingZoneSpec){const i=Zone.AsyncStackTaggingZoneSpec;o._inner=o._inner.fork(new i("Angular"))}Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!r&&e,o.shouldCoalesceRunChangeDetection=r,o.lastRequestAnimationFrameId=-1,o.nativeRequestAnimationFrame=function mj(){let n=bt.requestAnimationFrame,t=bt.cancelAnimationFrame;if(typeof Zone<"u"&&n&&t){const e=n[Zone.__symbol__("OriginalDelegate")];e&&(n=e);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function wj(n){const t=()=>{!function yj(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(bt,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,Hw(n),n.isCheckStableRunning=!0,jw(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),Hw(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,r,o,i,s,a)=>{try{return W2(n),e.invokeTask(o,i,s,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===i.type||n.shouldCoalesceRunChangeDetection)&&t(),z2(n)}},onInvoke:(e,r,o,i,s,a,u)=>{try{return W2(n),e.invoke(o,i,s,a,u)}finally{n.shouldCoalesceRunChangeDetection&&t(),z2(n)}},onHasTask:(e,r,o,i)=>{e.hasTask(o,i),r===o&&("microTask"==i.change?(n._hasPendingMicrotasks=i.microTask,Hw(n),jw(n)):"macroTask"==i.change&&(n.hasPendingMacrotasks=i.macroTask))},onHandleError:(e,r,o,i)=>(e.handleError(o,i),n.runOutsideAngular(()=>n.onError.emit(i)),!1)})}(o)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!on.isInAngularZone())throw new Q(909,!1)}static assertNotInAngularZone(){if(on.isInAngularZone())throw new Q(909,!1)}run(t,e,r){return this._inner.run(t,e,r)}runTask(t,e,r,o){const i=this._inner,s=i.scheduleEventTask("NgZoneEvent: "+o,t,vj,dp,dp);try{return i.runTask(s,e,r)}finally{i.cancelTask(s)}}runGuarded(t,e,r){return this._inner.runGuarded(t,e,r)}runOutsideAngular(t){return this._outer.run(t)}}const vj={};function jw(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function Hw(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function W2(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function z2(n){n._nesting--,jw(n)}class bj{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Qt,this.onMicrotaskEmpty=new Qt,this.onStable=new Qt,this.onError=new Qt}run(t,e,r){return t.apply(e,r)}runGuarded(t,e,r){return t.apply(e,r)}runOutsideAngular(t){return t()}runTask(t,e,r,o){return t.apply(e,r)}}const $2=new _e(""),pp=new _e("");let $w,Ww=(()=>{class n{constructor(e,r,o){this._ngZone=e,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,$w||(function _j(n){$w=n}(o),o.addToWindow(r)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{on.assertNotInAngularZone(),Uw(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Uw(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(e)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,r,o){let i=-1;r&&r>0&&(i=setTimeout(()=>{this._callbacks=this._callbacks.filter(s=>s.timeoutId!==i),e(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:e,timeoutId:i,updateCb:o})}whenStable(e,r,o){if(o&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,r,o),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,r,o){return[]}}return n.\u0275fac=function(e){return new(e||n)(re(on),re(zw),re(pp))},n.\u0275prov=fe({token:n,factory:n.\u0275fac}),n})(),zw=(()=>{class n{constructor(){this._applications=new Map}registerApplication(e,r){this._applications.set(e,r)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,r=!0){return $w?.findTestabilityInTree(this,e,r)??null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=fe({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})(),js=null;const G2=new _e("AllowMultipleToken"),Gw=new _e("PlatformDestroyListeners");class q2{constructor(t,e){this.name=t,this.token=e}}function X2(n,t,e=[]){const r=`Platform: ${t}`,o=new _e(r);return(i=[])=>{let s=qw();if(!s||s.injector.get(G2,!1)){const a=[...e,...i,{provide:o,useValue:!0}];n?n(a):function Ej(n){if(js&&!js.get(G2,!1))throw new Q(400,!1);js=n;const t=n.get(Q2);(function K2(n){const t=n.get(B2,null);t&&t.forEach(e=>e())})(n)}(function Y2(n=[],t){return jr.create({name:t,providers:[{provide:Ay,useValue:"platform"},{provide:Gw,useValue:new Set([()=>js=null])},...n]})}(a,r))}return function Sj(n){const t=qw();if(!t)throw new Q(401,!1);return t}()}}function qw(){return js?.get(Q2)??null}let Q2=(()=>{class n{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,r){const o=function J2(n,t){let e;return e="noop"===n?new bj:("zone.js"===n?void 0:n)||new on(t),e}(r?.ngZone,function Z2(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!n||!n.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!n||!n.ngZoneRunCoalescing)||!1}}(r)),i=[{provide:on,useValue:o}];return o.run(()=>{const s=jr.create({providers:i,parent:this.injector,name:e.moduleType.name}),a=e.create(s),u=a.injector.get(Gu,null);if(!u)throw new Q(402,!1);return o.runOutsideAngular(()=>{const l=o.onError.subscribe({next:c=>{u.handleError(c)}});a.onDestroy(()=>{gp(this._modules,a),l.unsubscribe()})}),function eI(n,t,e){try{const r=e();return rd(r)?r.catch(o=>{throw t.runOutsideAngular(()=>n.handleError(o)),o}):r}catch(r){throw t.runOutsideAngular(()=>n.handleError(r)),r}}(u,o,()=>{const l=a.injector.get(hp);return l.runInitializers(),l.donePromise.then(()=>(function CS(n){lr(n,"Expected localeId to be defined"),"string"==typeof n&&(xS=n.toLowerCase().replace(/_/g,"-"))}(a.injector.get($i,ul)||ul),this._moduleDoBootstrap(a),a))})})}bootstrapModule(e,r=[]){const o=tI({},r);return function xj(n,t,e){const r=new xw(e);return Promise.resolve(r)}(0,0,e).then(i=>this.bootstrapModuleFactory(i,o))}_moduleDoBootstrap(e){const r=e.injector.get(pd);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(o=>r.bootstrap(o));else{if(!e.instance.ngDoBootstrap)throw new Q(403,!1);e.instance.ngDoBootstrap(r)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Q(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const e=this._injector.get(Gw,null);e&&(e.forEach(r=>r()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(e){return new(e||n)(re(jr))},n.\u0275prov=fe({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function tI(n,t){return Array.isArray(t)?t.reduce(tI,n):{...n,...t}}let pd=(()=>{class n{constructor(e,r,o){this._zone=e,this._injector=r,this._exceptionHandler=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const i=new Rt(a=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{a.next(this._stable),a.complete()})}),s=new Rt(a=>{let u;this._zone.runOutsideAngular(()=>{u=this._zone.onStable.subscribe(()=>{on.assertNotInAngularZone(),Uw(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,a.next(!0))})})});const l=this._zone.onUnstable.subscribe(()=>{on.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{a.next(!1)}))});return()=>{u.unsubscribe(),l.unsubscribe()}});this.isStable=function dv(...n){const t=Cs(n),e=function sv(n,t){return"number"==typeof hc(n)?n.pop():t}(n,1/0),r=n;return r.length?1===r.length?Fr(r[0]):ro(e)(Xt(r,t)):oo}(i,s.pipe(function fv(n={}){const{connector:t=(()=>new eo),resetOnError:e=!0,resetOnComplete:r=!0,resetOnRefCountZero:o=!0}=n;return i=>{let s,a,u,l=0,c=!1,d=!1;const f=()=>{a?.unsubscribe(),a=void 0},h=()=>{f(),s=u=void 0,c=d=!1},p=()=>{const m=s;h(),m?.unsubscribe()};return tn((m,v)=>{l++,!d&&!c&&f();const y=u=u??t();v.add(()=>{l--,0===l&&!d&&!c&&(a=mu(p,o))}),y.subscribe(v),!s&&l>0&&(s=new en({next:_=>y.next(_),error:_=>{d=!0,f(),a=mu(h,e,_),y.error(_)},complete:()=>{c=!0,f(),a=mu(h,r),y.complete()}}),Fr(m).subscribe(s))})(i)}}()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(e,r){const o=e instanceof _E;if(!this._injector.get(hp).done)throw!o&&function Ti(n){const t=ht(n)||Fn(n)||Pn(n);return null!==t&&t.standalone}(e),new Q(405,false);let s;s=o?e:this._injector.get(Yc).resolveComponentFactory(e),this.componentTypes.push(s.componentType);const a=function Cj(n){return n.isBoundToModule}(s)?void 0:this._injector.get(Pa),l=s.create(jr.NULL,[],r||s.selector,a),c=l.location.nativeElement,d=l.injector.get($2,null);return d?.registerApplication(c),l.onDestroy(()=>{this.detachView(l.hostView),gp(this.components,l),d?.unregisterApplication(c)}),this._loadComponent(l),l}tick(){if(this._runningTick)throw new Q(101,!1);try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const r=e;this._views.push(r),r.attachToAppRef(this)}detachView(e){const r=e;gp(this._views,r),r.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(V2,[]).concat(this._bootstrapListeners).forEach(o=>o(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>gp(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new Q(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(e){return new(e||n)(re(on),re(Bs),re(Gu))},n.\u0275prov=fe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function gp(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}let rI=!0,mp=(()=>{class n{}return n.__NG_ELEMENT_ID__=Tj,n})();function Tj(n){return function Mj(n,t,e){if(Iu(n)&&!e){const r=Lr(n.index,t);return new Jc(r,r)}return 47&n.type?new Jc(t[16],t):null}(_n(),ee(),16==(16&n))}class uI{constructor(){}supports(t){return td(t)}create(t){return new Oj(t)}}const Pj=(n,t)=>t;class Oj{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||Pj}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,r=this._removalsHead,o=0,i=null;for(;e||r;){const s=!r||e&&e.currentIndex<cI(r,o,i)?e:r,a=cI(s,o,i),u=s.currentIndex;if(s===r)o--,r=r._nextRemoved;else if(e=e._next,null==s.previousIndex)o++;else{i||(i=[]);const l=a-o,c=u-o;if(l!=c){for(let f=0;f<l;f++){const h=f<i.length?i[f]:i[f]=0,p=h+f;c<=p&&p<l&&(i[f]=h+1)}i[s.previousIndex]=c-l}}a!==u&&t(s,a,u)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!td(t))throw new Q(900,!1);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let o,i,s,e=this._itHead,r=!1;if(Array.isArray(t)){this.length=t.length;for(let a=0;a<this.length;a++)i=t[a],s=this._trackByFn(a,i),null!==e&&Object.is(e.trackById,s)?(r&&(e=this._verifyReinsertion(e,i,s,a)),Object.is(e.item,i)||this._addIdentityChange(e,i)):(e=this._mismatch(e,i,s,a),r=!0),e=e._next}else o=0,function l4(n,t){if(Array.isArray(n))for(let e=0;e<n.length;e++)t(n[e]);else{const e=n[Ra()]();let r;for(;!(r=e.next()).done;)t(r.value)}}(t,a=>{s=this._trackByFn(o,a),null!==e&&Object.is(e.trackById,s)?(r&&(e=this._verifyReinsertion(e,a,s,o)),Object.is(e.item,a)||this._addIdentityChange(e,a)):(e=this._mismatch(e,a,s,o),r=!0),e=e._next,o++}),this.length=o;return this._truncate(e),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,r,o){let i;return null===t?i=this._itTail:(i=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,i,o)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(r,o))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,i,o)):t=this._addAfter(new Lj(e,r),i,o),t}_verifyReinsertion(t,e,r,o){let i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==i?t=this._reinsertAfter(i,t._prev,o):t.currentIndex!=o&&(t.currentIndex=o,this._addToMoves(t,o)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const o=t._prevRemoved,i=t._nextRemoved;return null===o?this._removalsHead=i:o._nextRemoved=i,null===i?this._removalsTail=o:i._prevRemoved=o,this._insertAfter(t,e,r),this._addToMoves(t,r),t}_moveAfter(t,e,r){return this._unlink(t),this._insertAfter(t,e,r),this._addToMoves(t,r),t}_addAfter(t,e,r){return this._insertAfter(t,e,r),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,r){const o=null===e?this._itHead:e._next;return t._next=o,t._prev=e,null===o?this._itTail=t:o._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new lI),this._linkedRecords.put(t),t.currentIndex=r,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,r=t._next;return null===e?this._itHead=r:e._next=r,null===r?this._itTail=e:r._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new lI),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class Lj{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Bj{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===e||e<=r.currentIndex)&&Object.is(r.trackById,t))return r;return null}remove(t){const e=t._prevDup,r=t._nextDup;return null===e?this._head=r:e._nextDup=r,null===r?this._tail=e:r._prevDup=e,null===this._head}}class lI{constructor(){this.map=new Map}put(t){const e=t.trackById;let r=this.map.get(e);r||(r=new Bj,this.map.set(e,r)),r.add(t)}get(t,e){const o=this.map.get(t);return o?o.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function cI(n,t,e){const r=n.previousIndex;if(null===r)return r;let o=0;return e&&r<e.length&&(o=e[r]),r+t+o}class dI{constructor(){}supports(t){return t instanceof Map||lw(t)}create(){return new Vj}}class Vj{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||lw(t)))throw new Q(900,!1)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(r,o)=>{if(e&&e.key===o)this._maybeAddToChanges(e,r),this._appendAfter=e,e=e._next;else{const i=this._getOrCreateRecordForKey(o,r);e=this._insertBeforeOrAppend(e,i)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let r=e;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const r=t._prev;return e._next=t,e._prev=r,t._prev=e,r&&(r._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const o=this._records.get(t);this._maybeAddToChanges(o,e);const i=o._prev,s=o._next;return i&&(i._next=s),s&&(s._prev=i),o._next=null,o._prev=null,o}const r=new Uj(t);return this._records.set(t,r),r.currentValue=e,this._addToAdditions(r),r}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(r=>e(t[r],r))}}class Uj{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function fI(){return new wp([new uI])}let wp=(()=>{class n{constructor(e){this.factories=e}static create(e,r){if(null!=r){const o=r.factories.slice();e=e.concat(o)}return new n(e)}static extend(e){return{provide:n,useFactory:r=>n.create(e,r||fI()),deps:[[n,new jc,new Uc]]}}find(e){const r=this.factories.find(o=>o.supports(e));if(null!=r)return r;throw new Q(901,!1)}}return n.\u0275prov=fe({token:n,providedIn:"root",factory:fI}),n})();function hI(){return new gd([new dI])}let gd=(()=>{class n{constructor(e){this.factories=e}static create(e,r){if(r){const o=r.factories.slice();e=e.concat(o)}return new n(e)}static extend(e){return{provide:n,useFactory:r=>n.create(e,r||hI()),deps:[[n,new jc,new Uc]]}}find(e){const r=this.factories.find(o=>o.supports(e));if(r)return r;throw new Q(901,!1)}}return n.\u0275prov=fe({token:n,providedIn:"root",factory:hI}),n})();const Wj=X2(null,"core",[]);let zj=(()=>{class n{constructor(e){}}return n.\u0275fac=function(e){return new(e||n)(re(pd))},n.\u0275mod=Tn({type:n}),n.\u0275inj=wn({}),n})();function qi(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}let bp=null;function ni(){return bp}const Ln=new _e("DocumentToken");let Zw=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=fe({token:n,factory:function(){return function Kj(){return re(pI)}()},providedIn:"platform"}),n})();const Xj=new _e("Location Initialized");let pI=(()=>{class n extends Zw{constructor(e){super(),this._doc=e,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return ni().getBaseHref(this._doc)}onPopState(e){const r=ni().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",e,!1),()=>r.removeEventListener("popstate",e)}onHashChange(e){const r=ni().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",e,!1),()=>r.removeEventListener("hashchange",e)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(e){this.location.pathname=e}pushState(e,r,o){gI()?this._history.pushState(e,r,o):this.location.hash=o}replaceState(e,r,o){gI()?this._history.replaceState(e,r,o):this.location.hash=o}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return n.\u0275fac=function(e){return new(e||n)(re(Ln))},n.\u0275prov=fe({token:n,factory:function(){return function Yj(){return new pI(re(Ln))}()},providedIn:"platform"}),n})();function gI(){return!!window.history.pushState}function Jw(n,t){if(0==n.length)return t;if(0==t.length)return n;let e=0;return n.endsWith("/")&&e++,t.startsWith("/")&&e++,2==e?n+t.substring(1):1==e?n+t:n+"/"+t}function mI(n){const t=n.match(/#|\?|$/),e=t&&t.index||n.length;return n.slice(0,e-("/"===n[e-1]?1:0))+n.slice(e)}function Ki(n){return n&&"?"!==n[0]?"?"+n:n}let La=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=fe({token:n,factory:function(){return rn(yI)},providedIn:"root"}),n})();const vI=new _e("appBaseHref");let yI=(()=>{class n extends La{constructor(e,r){super(),this._platformLocation=e,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??rn(Ln).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return Jw(this._baseHref,e)}path(e=!1){const r=this._platformLocation.pathname+Ki(this._platformLocation.search),o=this._platformLocation.hash;return o&&e?`${r}${o}`:r}pushState(e,r,o,i){const s=this.prepareExternalUrl(o+Ki(i));this._platformLocation.pushState(e,r,s)}replaceState(e,r,o,i){const s=this.prepareExternalUrl(o+Ki(i));this._platformLocation.replaceState(e,r,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return n.\u0275fac=function(e){return new(e||n)(re(Zw),re(vI,8))},n.\u0275prov=fe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Qj=(()=>{class n extends La{constructor(e,r){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(e){const r=Jw(this._baseHref,e);return r.length>0?"#"+r:r}pushState(e,r,o,i){let s=this.prepareExternalUrl(o+Ki(i));0==s.length&&(s=this._platformLocation.pathname),this._platformLocation.pushState(e,r,s)}replaceState(e,r,o,i){let s=this.prepareExternalUrl(o+Ki(i));0==s.length&&(s=this._platformLocation.pathname),this._platformLocation.replaceState(e,r,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return n.\u0275fac=function(e){return new(e||n)(re(Zw),re(vI,8))},n.\u0275prov=fe({token:n,factory:n.\u0275fac}),n})(),md=(()=>{class n{constructor(e){this._subject=new Qt,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=e;const r=this._locationStrategy.getBaseHref();this._baseHref=mI(wI(r)),this._locationStrategy.onPopState(o=>{this._subject.emit({url:this.path(!0),pop:!0,state:o.state,type:o.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,r=""){return this.path()==this.normalize(e+Ki(r))}normalize(e){return n.stripTrailingSlash(function Jj(n,t){return n&&t.startsWith(n)?t.substring(n.length):t}(this._baseHref,wI(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,r="",o=null){this._locationStrategy.pushState(o,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Ki(r)),o)}replaceState(e,r="",o=null){this._locationStrategy.replaceState(o,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Ki(r)),o)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",r){this._urlChangeListeners.forEach(o=>o(e,r))}subscribe(e,r,o){return this._subject.subscribe({next:e,error:r,complete:o})}}return n.normalizeQueryParams=Ki,n.joinWithSlash=Jw,n.stripTrailingSlash=mI,n.\u0275fac=function(e){return new(e||n)(re(La))},n.\u0275prov=fe({token:n,factory:function(){return function Zj(){return new md(re(La))}()},providedIn:"root"}),n})();function wI(n){return n.replace(/\/index.html$/,"")}function AI(n,t){t=encodeURIComponent(t);for(const e of n.split(";")){const r=e.indexOf("="),[o,i]=-1==r?[e,""]:[e.slice(0,r),e.slice(r+1)];if(o.trim()===t)return decodeURIComponent(i)}return null}class BH{constructor(t,e,r,o){this.$implicit=t,this.ngForOf=e,this.index=r,this.count=o}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let kI=(()=>{class n{constructor(e,r,o){this._viewContainer=e,this._template=r,this._differs=o,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const r=this._viewContainer;e.forEachOperation((o,i,s)=>{if(null==o.previousIndex)r.createEmbeddedView(this._template,new BH(o.item,this._ngForOf,-1,-1),null===s?void 0:s);else if(null==s)r.remove(null===i?void 0:i);else if(null!==i){const a=r.get(i);r.move(a,s),RI(a,o)}});for(let o=0,i=r.length;o<i;o++){const a=r.get(o).context;a.index=o,a.count=i,a.ngForOf=this._ngForOf}e.forEachIdentityChange(o=>{RI(r.get(o.currentIndex),o)})}static ngTemplateContextGuard(e,r){return!0}}return n.\u0275fac=function(e){return new(e||n)(X(To),X(zi),X(wp))},n.\u0275dir=Ie({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),n})();function RI(n,t){n.context.$implicit=t.item}let Hs=(()=>{class n{constructor(e,r){this._viewContainer=e,this._context=new UH,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){NI("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){NI("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,r){return!0}}return n.\u0275fac=function(e){return new(e||n)(X(To),X(zi))},n.\u0275dir=Ie({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class UH{constructor(){this.$implicit=null,this.ngIf=null}}function NI(n,t){if(t&&!t.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${yt(t)}'.`)}let PI=(()=>{class n{constructor(e,r,o){this._ngEl=e,this._differs=r,this._renderer=o,this._ngStyle=null,this._differ=null}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){const e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,r){const[o,i]=e.split("."),s=-1===o.indexOf("-")?void 0:Ar.DashCase;null!=r?this._renderer.setStyle(this._ngEl.nativeElement,o,i?`${r}${i}`:r,s):this._renderer.removeStyle(this._ngEl.nativeElement,o,s)}_applyChanges(e){e.forEachRemovedItem(r=>this._setStyle(r.key,null)),e.forEachAddedItem(r=>this._setStyle(r.key,r.currentValue)),e.forEachChangedItem(r=>this._setStyle(r.key,r.currentValue))}}return n.\u0275fac=function(e){return new(e||n)(X(Ur),X(gd),X(Ui))},n.\u0275dir=Ie({type:n,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0}),n})();class $H{createSubscription(t,e){return t.subscribe({next:e,error:r=>{throw r}})}dispose(t){t.unsubscribe()}}class GH{createSubscription(t,e){return t.then(e,r=>{throw r})}dispose(t){}}const qH=new GH,KH=new $H;let OI=(()=>{class n{constructor(e){this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null,this._ref=e}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(e){return this._obj?e!==this._obj?(this._dispose(),this.transform(e)):this._latestValue:(e&&this._subscribe(e),this._latestValue)}_subscribe(e){this._obj=e,this._strategy=this._selectStrategy(e),this._subscription=this._strategy.createSubscription(e,r=>this._updateLatestValue(e,r))}_selectStrategy(e){if(rd(e))return qH;if(ID(e))return KH;throw function Ro(n,t){return new Q(2100,!1)}()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(e,r){e===this._obj&&(this._latestValue=r,this._ref.markForCheck())}}return n.\u0275fac=function(e){return new(e||n)(X(mp,16))},n.\u0275pipe=Gn({name:"async",type:n,pure:!1,standalone:!0}),n})(),d5=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Tn({type:n}),n.\u0275inj=wn({}),n})();let g5=(()=>{class n{}return n.\u0275prov=fe({token:n,providedIn:"root",factory:()=>new m5(re(Ln),window)}),n})();class m5{constructor(t,e){this.document=t,this.window=e,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const e=function v5(n,t){const e=n.getElementById(t)||n.getElementsByName(t)[0];if(e)return e;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let o=r.currentNode;for(;o;){const i=o.shadowRoot;if(i){const s=i.getElementById(t)||i.querySelector(`[name="${t}"]`);if(s)return s}o=r.nextNode()}}return null}(this.document,t);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),r=e.left+this.window.pageXOffset,o=e.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(r-i[0],o-i[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=VI(this.window.history)||VI(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function VI(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class UI{}class gb extends class z5 extends class qj{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function Gj(n){bp||(bp=n)}(new gb)}onAndCancel(t,e,r){return t.addEventListener(e,r,!1),()=>{t.removeEventListener(e,r,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=function $5(){return bd=bd||document.querySelector("base"),bd?bd.getAttribute("href"):null}();return null==e?null:function G5(n){Rp=Rp||document.createElement("a"),Rp.setAttribute("href",n);const t=Rp.pathname;return"/"===t.charAt(0)?t:`/${t}`}(e)}resetBaseElement(){bd=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return AI(document.cookie,t)}}let Rp,bd=null;const $I=new _e("TRANSITION_ID"),K5=[{provide:fp,useFactory:function q5(n,t,e){return()=>{e.get(hp).donePromise.then(()=>{const r=ni(),o=t.querySelectorAll(`style[ng-transition="${n}"]`);for(let i=0;i<o.length;i++)r.remove(o[i])})}},deps:[$I,Ln,jr],multi:!0}];let Y5=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=fe({token:n,factory:n.\u0275fac}),n})();const Np=new _e("EventManagerPlugins");let Fp=(()=>{class n{constructor(e,r){this._zone=r,this._eventNameToPlugin=new Map,e.forEach(o=>o.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,r,o){return this._findPluginFor(r).addEventListener(e,r,o)}addGlobalEventListener(e,r,o){return this._findPluginFor(r).addGlobalEventListener(e,r,o)}getZone(){return this._zone}_findPluginFor(e){const r=this._eventNameToPlugin.get(e);if(r)return r;const o=this._plugins;for(let i=0;i<o.length;i++){const s=o[i];if(s.supports(e))return this._eventNameToPlugin.set(e,s),s}throw new Error(`No event manager plugin found for event ${e}`)}}return n.\u0275fac=function(e){return new(e||n)(re(Np),re(on))},n.\u0275prov=fe({token:n,factory:n.\u0275fac}),n})();class GI{constructor(t){this._doc=t}addGlobalEventListener(t,e,r){const o=ni().getGlobalEventTarget(this._doc,t);if(!o)throw new Error(`Unsupported event target ${o} for event ${e}`);return this.addEventListener(o,e,r)}}let qI=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(e){const r=new Set;e.forEach(o=>{this._stylesSet.has(o)||(this._stylesSet.add(o),r.add(o))}),this.onStylesAdded(r)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=fe({token:n,factory:n.\u0275fac}),n})(),_d=(()=>{class n extends qI{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,r,o){e.forEach(i=>{const s=this._doc.createElement("style");s.textContent=i,o.push(r.appendChild(s))})}addHost(e){const r=[];this._addStylesToHost(this._stylesSet,e,r),this._hostNodes.set(e,r)}removeHost(e){const r=this._hostNodes.get(e);r&&r.forEach(KI),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((r,o)=>{this._addStylesToHost(e,o,r)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(KI))}}return n.\u0275fac=function(e){return new(e||n)(re(Ln))},n.\u0275prov=fe({token:n,factory:n.\u0275fac}),n})();function KI(n){ni().remove(n)}const mb={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},vb=/%COMP%/g;function Pp(n,t,e){for(let r=0;r<t.length;r++){let o=t[r];Array.isArray(o)?Pp(n,o,e):(o=o.replace(vb,n),e.push(o))}return e}function QI(n){return t=>{if("__ngUnwrap__"===t)return n;!1===n(t)&&(t.preventDefault(),t.returnValue=!1)}}let Op=(()=>{class n{constructor(e,r,o){this.eventManager=e,this.sharedStylesHost=r,this.appId=o,this.rendererByCompId=new Map,this.defaultRenderer=new yb(e)}createRenderer(e,r){if(!e||!r)return this.defaultRenderer;switch(r.encapsulation){case Er.Emulated:{let o=this.rendererByCompId.get(r.id);return o||(o=new nW(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,o)),o.applyToHost(e),o}case 1:case Er.ShadowDom:return new rW(this.eventManager,this.sharedStylesHost,e,r);default:if(!this.rendererByCompId.has(r.id)){const o=Pp(r.id,r.styles,[]);this.sharedStylesHost.addStyles(o),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(e){return new(e||n)(re(Fp),re(_d),re(hd))},n.\u0275prov=fe({token:n,factory:n.\u0275fac}),n})();class yb{constructor(t){this.eventManager=t,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,e){return e?document.createElementNS(mb[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){(JI(t)?t.content:t).appendChild(e)}insertBefore(t,e,r){t&&(JI(t)?t.content:t).insertBefore(e,r)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let r="string"==typeof t?document.querySelector(t):t;if(!r)throw new Error(`The selector "${t}" did not match any elements`);return e||(r.textContent=""),r}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,r,o){if(o){e=o+":"+e;const i=mb[o];i?t.setAttributeNS(i,e,r):t.setAttribute(e,r)}else t.setAttribute(e,r)}removeAttribute(t,e,r){if(r){const o=mb[r];o?t.removeAttributeNS(o,e):t.removeAttribute(`${r}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,r,o){o&(Ar.DashCase|Ar.Important)?t.style.setProperty(e,r,o&Ar.Important?"important":""):t.style[e]=r}removeStyle(t,e,r){r&Ar.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,r){t[e]=r}setValue(t,e){t.nodeValue=e}listen(t,e,r){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,QI(r)):this.eventManager.addEventListener(t,e,QI(r))}}function JI(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class nW extends yb{constructor(t,e,r,o){super(t),this.component=r;const i=Pp(o+"-"+r.id,r.styles,[]);e.addStyles(i),this.contentAttr=function J5(n){return"_ngcontent-%COMP%".replace(vb,n)}(o+"-"+r.id),this.hostAttr=function eW(n){return"_nghost-%COMP%".replace(vb,n)}(o+"-"+r.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const r=super.createElement(t,e);return super.setAttribute(r,this.contentAttr,""),r}}class rW extends yb{constructor(t,e,r,o){super(t),this.sharedStylesHost=e,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const i=Pp(o.id,o.styles,[]);for(let s=0;s<i.length;s++){const a=document.createElement("style");a.textContent=i[s],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,r){return super.insertBefore(this.nodeOrShadowRoot(t),e,r)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let oW=(()=>{class n extends GI{constructor(e){super(e)}supports(e){return!0}addEventListener(e,r,o){return e.addEventListener(r,o,!1),()=>this.removeEventListener(e,r,o)}removeEventListener(e,r,o){return e.removeEventListener(r,o)}}return n.\u0275fac=function(e){return new(e||n)(re(Ln))},n.\u0275prov=fe({token:n,factory:n.\u0275fac}),n})();const eA=["alt","control","meta","shift"],iW={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},sW={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let aW=(()=>{class n extends GI{constructor(e){super(e)}supports(e){return null!=n.parseEventName(e)}addEventListener(e,r,o){const i=n.parseEventName(r),s=n.eventCallback(i.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ni().onAndCancel(e,i.domEventName,s))}static parseEventName(e){const r=e.toLowerCase().split("."),o=r.shift();if(0===r.length||"keydown"!==o&&"keyup"!==o)return null;const i=n._normalizeKey(r.pop());let s="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),s="code."),eA.forEach(l=>{const c=r.indexOf(l);c>-1&&(r.splice(c,1),s+=l+".")}),s+=i,0!=r.length||0===i.length)return null;const u={};return u.domEventName=o,u.fullKey=s,u}static matchEventFullKeyCode(e,r){let o=iW[e.key]||e.key,i="";return r.indexOf("code.")>-1&&(o=e.code,i="code."),!(null==o||!o)&&(o=o.toLowerCase()," "===o?o="space":"."===o&&(o="dot"),eA.forEach(s=>{s!==o&&(0,sW[s])(e)&&(i+=s+".")}),i+=o,i===r)}static eventCallback(e,r,o){return i=>{n.matchEventFullKeyCode(i,e)&&o.runGuarded(()=>r(i))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return n.\u0275fac=function(e){return new(e||n)(re(Ln))},n.\u0275prov=fe({token:n,factory:n.\u0275fac}),n})();const nA=[{provide:Bw,useValue:"browser"},{provide:B2,useValue:function uW(){gb.makeCurrent()},multi:!0},{provide:Ln,useFactory:function cW(){return function jL(n){wy=n}(document),document},deps:[]}],dW=X2(Wj,"browser",nA),rA=new _e(""),oA=[{provide:pp,useClass:class X5{addToWindow(t){bt.getAngularTestability=(r,o=!0)=>{const i=t.findTestabilityInTree(r,o);if(null==i)throw new Error("Could not find testability for element.");return i},bt.getAllAngularTestabilities=()=>t.getAllTestabilities(),bt.getAllAngularRootElements=()=>t.getAllRootElements(),bt.frameworkStabilizers||(bt.frameworkStabilizers=[]),bt.frameworkStabilizers.push(r=>{const o=bt.getAllAngularTestabilities();let i=o.length,s=!1;const a=function(u){s=s||u,i--,0==i&&r(s)};o.forEach(function(u){u.whenStable(a)})})}findTestabilityInTree(t,e,r){return null==e?null:t.getTestability(e)??(r?ni().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null)}},deps:[]},{provide:$2,useClass:Ww,deps:[on,zw,pp]},{provide:Ww,useClass:Ww,deps:[on,zw,pp]}],iA=[{provide:Ay,useValue:"root"},{provide:Gu,useFactory:function lW(){return new Gu},deps:[]},{provide:Np,useClass:oW,multi:!0,deps:[Ln,on,Bw]},{provide:Np,useClass:aW,multi:!0,deps:[Ln]},{provide:Op,useClass:Op,deps:[Fp,_d,hd]},{provide:Qc,useExisting:Op},{provide:qI,useExisting:_d},{provide:_d,useClass:_d,deps:[Ln]},{provide:Fp,useClass:Fp,deps:[Np,on]},{provide:UI,useClass:Y5,deps:[]},[]];let Lp=(()=>{class n{constructor(e){}static withServerTransition(e){return{ngModule:n,providers:[{provide:hd,useValue:e.appId},{provide:$I,useExisting:hd},K5]}}}return n.\u0275fac=function(e){return new(e||n)(re(rA,12))},n.\u0275mod=Tn({type:n}),n.\u0275inj=wn({providers:[...iA,...oA],imports:[d5,zj]}),n})(),sA=(()=>{class n{constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}}return n.\u0275fac=function(e){return new(e||n)(re(Ln))},n.\u0275prov=fe({token:n,factory:function(e){let r=null;return r=e?new e:function hW(){return new sA(re(Ln))}(),r},providedIn:"root"}),n})();function De(...n){return Xt(n,Cs(n))}typeof window<"u"&&window;class lo extends eo{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){const{hasError:t,thrownError:e,_value:r}=this;if(t)throw e;return this._throwIfClosed(),r}next(t){super.next(this._value=t)}}const xd=fu(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"}),{isArray:_W}=Array,{getPrototypeOf:xW,prototype:CW,keys:EW}=Object;function lA(n){if(1===n.length){const t=n[0];if(_W(t))return{args:t,keys:null};if(function DW(n){return n&&"object"==typeof n&&xW(n)===CW}(t)){const e=EW(t);return{args:e.map(r=>t[r]),keys:e}}}return{args:n,keys:null}}const{isArray:SW}=Array;function cA(n){return Ge(t=>function IW(n,t){return SW(t)?n(...t):n(t)}(n,t))}function dA(n,t){return n.reduce((e,r,o)=>(e[r]=t[o],e),{})}function fA(...n){const t=Cs(n),e=Jf(n),{args:r,keys:o}=lA(n);if(0===r.length)return Xt([],t);const i=new Rt(function AW(n,t,e=$o){return r=>{hA(t,()=>{const{length:o}=n,i=new Array(o);let s=o,a=o;for(let u=0;u<o;u++)hA(t,()=>{const l=Xt(n[u],t);let c=!1;l.subscribe(Pt(r,d=>{i[u]=d,c||(c=!0,a--),a||r.next(e(i.slice()))},()=>{--s||r.complete()}))},r)},r)}}(r,t,o?s=>dA(o,s):$o));return e?i.pipe(cA(e)):i}function hA(n,t,e){n?wo(e,n,t):t()}function _b(...n){return function TW(){return ro(1)}()(Xt(n,Cs(n)))}function pA(n){return new Rt(t=>{Fr(n()).subscribe(t)})}function Cd(n,t){const e=nt(n)?n:()=>n,r=o=>o.error(e());return new Rt(t?o=>t.schedule(r,0,o):r)}function xb(){return tn((n,t)=>{let e=null;n._refCount++;const r=Pt(t,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(e=null);const o=n._connection,i=e;e=null,o&&(!i||o===i)&&o.unsubscribe(),t.unsubscribe()});n.subscribe(r),r.closed||(e=n.connect())})}class gA extends Rt{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,_s(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,t?.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new de;const e=this.getSubject();t.add(this.source.subscribe(Pt(e,void 0,()=>{this._teardown(),e.complete()},r=>{this._teardown(),e.error(r)},()=>this._teardown()))),t.closed&&(this._connection=null,t=de.EMPTY)}return t}refCount(){return xb()(this)}}function ri(n,t){return tn((e,r)=>{let o=null,i=0,s=!1;const a=()=>s&&!o&&r.complete();e.subscribe(Pt(r,u=>{o?.unsubscribe();let l=0;const c=i++;Fr(n(u,c)).subscribe(o=Pt(r,d=>r.next(t?t(u,d,c,l++):d),()=>{o=null,a()}))},()=>{s=!0,a()}))})}function Ed(n){return n<=0?()=>oo:tn((t,e)=>{let r=0;t.subscribe(Pt(e,o=>{++r<=n&&(e.next(o),n<=r&&e.complete())}))})}function Yi(n,t){return tn((e,r)=>{let o=0;e.subscribe(Pt(r,i=>n.call(t,i,o++)&&r.next(i)))})}function Bp(n){return tn((t,e)=>{let r=!1;t.subscribe(Pt(e,o=>{r=!0,e.next(o)},()=>{r||e.next(n),e.complete()}))})}function mA(n=kW){return tn((t,e)=>{let r=!1;t.subscribe(Pt(e,o=>{r=!0,e.next(o)},()=>r?e.complete():e.error(n())))})}function kW(){return new xd}function zs(n,t){const e=arguments.length>=2;return r=>r.pipe(n?Yi((o,i)=>n(o,i,r)):$o,Ed(1),e?Bp(t):mA(()=>new xd))}function $s(n,t){return nt(t)?nn(n,t,1):nn(n,1)}function Tt(n,t,e){const r=nt(n)||t||e?{next:n,error:t,complete:e}:n;return r?tn((o,i)=>{var s;null===(s=r.subscribe)||void 0===s||s.call(r);let a=!0;o.subscribe(Pt(i,u=>{var l;null===(l=r.next)||void 0===l||l.call(r,u),i.next(u)},()=>{var u;a=!1,null===(u=r.complete)||void 0===u||u.call(r),i.complete()},u=>{var l;a=!1,null===(l=r.error)||void 0===l||l.call(r,u),i.error(u)},()=>{var u,l;a&&(null===(u=r.unsubscribe)||void 0===u||u.call(r)),null===(l=r.finalize)||void 0===l||l.call(r)}))}):$o}function Gs(n){return tn((t,e)=>{let i,r=null,o=!1;r=t.subscribe(Pt(e,void 0,void 0,s=>{i=Fr(n(s,Gs(n)(t))),r?(r.unsubscribe(),r=null,i.subscribe(e)):o=!0})),o&&(r.unsubscribe(),r=null,i.subscribe(e))})}function RW(n,t,e,r,o){return(i,s)=>{let a=e,u=t,l=0;i.subscribe(Pt(s,c=>{const d=l++;u=a?n(u,c,d):(a=!0,c),r&&s.next(u)},o&&(()=>{a&&s.next(u),s.complete()})))}}function vA(n,t){return tn(RW(n,t,arguments.length>=2,!0))}function Cb(n){return n<=0?()=>oo:tn((t,e)=>{let r=[];t.subscribe(Pt(e,o=>{r.push(o),n<r.length&&r.shift()},()=>{for(const o of r)e.next(o);e.complete()},void 0,()=>{r=null}))})}function yA(n,t){const e=arguments.length>=2;return r=>r.pipe(n?Yi((o,i)=>n(o,i,r)):$o,Cb(1),e?Bp(t):mA(()=>new xd))}function Vp(n){return tn((t,e)=>{try{t.subscribe(e)}finally{e.add(n)}})}const Ke="primary",Dd=Symbol("RouteTitle");class PW{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function hl(n){return new PW(n)}function OW(n,t,e){const r=e.path.split("/");if(r.length>n.length||"full"===e.pathMatch&&(t.hasChildren()||r.length<n.length))return null;const o={};for(let i=0;i<r.length;i++){const s=r[i],a=n[i];if(s.startsWith(":"))o[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:o}}function oi(n,t){const e=n?Object.keys(n):void 0,r=t?Object.keys(t):void 0;if(!e||!r||e.length!=r.length)return!1;let o;for(let i=0;i<e.length;i++)if(o=e[i],!wA(n[o],t[o]))return!1;return!0}function wA(n,t){if(Array.isArray(n)&&Array.isArray(t)){if(n.length!==t.length)return!1;const e=[...n].sort(),r=[...t].sort();return e.every((o,i)=>r[i]===o)}return n===t}function bA(n){return Array.prototype.concat.apply([],n)}function _A(n){return n.length>0?n[n.length-1]:null}function Bn(n,t){for(const e in n)n.hasOwnProperty(e)&&t(n[e],e)}function qs(n){return hw(n)?n:rd(n)?Xt(Promise.resolve(n)):De(n)}const VW={exact:function EA(n,t,e){if(!Va(n.segments,t.segments)||!Up(n.segments,t.segments,e)||n.numberOfChildren!==t.numberOfChildren)return!1;for(const r in t.children)if(!n.children[r]||!EA(n.children[r],t.children[r],e))return!1;return!0},subset:DA},xA={exact:function UW(n,t){return oi(n,t)},subset:function jW(n,t){return Object.keys(t).length<=Object.keys(n).length&&Object.keys(t).every(e=>wA(n[e],t[e]))},ignored:()=>!0};function CA(n,t,e){return VW[e.paths](n.root,t.root,e.matrixParams)&&xA[e.queryParams](n.queryParams,t.queryParams)&&!("exact"===e.fragment&&n.fragment!==t.fragment)}function DA(n,t,e){return SA(n,t,t.segments,e)}function SA(n,t,e,r){if(n.segments.length>e.length){const o=n.segments.slice(0,e.length);return!(!Va(o,e)||t.hasChildren()||!Up(o,e,r))}if(n.segments.length===e.length){if(!Va(n.segments,e)||!Up(n.segments,e,r))return!1;for(const o in t.children)if(!n.children[o]||!DA(n.children[o],t.children[o],r))return!1;return!0}{const o=e.slice(0,n.segments.length),i=e.slice(n.segments.length);return!!(Va(n.segments,o)&&Up(n.segments,o,r)&&n.children[Ke])&&SA(n.children[Ke],t,i,r)}}function Up(n,t,e){return t.every((r,o)=>xA[e](n[o].parameters,r.parameters))}class Ba{constructor(t,e,r){this.root=t,this.queryParams=e,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=hl(this.queryParams)),this._queryParamMap}toString(){return zW.serialize(this)}}class Qe{constructor(t,e){this.segments=t,this.children=e,this.parent=null,Bn(e,(r,o)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return jp(this)}}class Sd{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=hl(this.parameters)),this._parameterMap}toString(){return MA(this)}}function Va(n,t){return n.length===t.length&&n.every((e,r)=>e.path===t[r].path)}let IA=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=fe({token:n,factory:function(){return new Db},providedIn:"root"}),n})();class Db{parse(t){const e=new JW(t);return new Ba(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){const e=`/${Id(t.root,!0)}`,r=function qW(n){const t=Object.keys(n).map(e=>{const r=n[e];return Array.isArray(r)?r.map(o=>`${Hp(e)}=${Hp(o)}`).join("&"):`${Hp(e)}=${Hp(r)}`}).filter(e=>!!e);return t.length?`?${t.join("&")}`:""}(t.queryParams);return`${e}${r}${"string"==typeof t.fragment?`#${function $W(n){return encodeURI(n)}(t.fragment)}`:""}`}}const zW=new Db;function jp(n){return n.segments.map(t=>MA(t)).join("/")}function Id(n,t){if(!n.hasChildren())return jp(n);if(t){const e=n.children[Ke]?Id(n.children[Ke],!1):"",r=[];return Bn(n.children,(o,i)=>{i!==Ke&&r.push(`${i}:${Id(o,!1)}`)}),r.length>0?`${e}(${r.join("//")})`:e}{const e=function WW(n,t){let e=[];return Bn(n.children,(r,o)=>{o===Ke&&(e=e.concat(t(r,o)))}),Bn(n.children,(r,o)=>{o!==Ke&&(e=e.concat(t(r,o)))}),e}(n,(r,o)=>o===Ke?[Id(n.children[Ke],!1)]:[`${o}:${Id(r,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[Ke]?`${jp(n)}/${e[0]}`:`${jp(n)}/(${e.join("//")})`}}function AA(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Hp(n){return AA(n).replace(/%3B/gi,";")}function Sb(n){return AA(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Wp(n){return decodeURIComponent(n)}function TA(n){return Wp(n.replace(/\+/g,"%20"))}function MA(n){return`${Sb(n.path)}${function GW(n){return Object.keys(n).map(t=>`;${Sb(t)}=${Sb(n[t])}`).join("")}(n.parameters)}`}const KW=/^[^\/()?;=#]+/;function zp(n){const t=n.match(KW);return t?t[0]:""}const XW=/^[^=?&#]+/,QW=/^[^&#]+/;class JW{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Qe([],{}):new Qe([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(r[Ke]=new Qe(t,e)),r}parseSegment(){const t=zp(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Q(4009,!1);return this.capture(t),new Sd(Wp(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=zp(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){const o=zp(this.remaining);o&&(r=o,this.capture(r))}t[Wp(e)]=Wp(r)}parseQueryParam(t){const e=function YW(n){const t=n.match(XW);return t?t[0]:""}(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){const s=function ZW(n){const t=n.match(QW);return t?t[0]:""}(this.remaining);s&&(r=s,this.capture(r))}const o=TA(e),i=TA(r);if(t.hasOwnProperty(o)){let s=t[o];Array.isArray(s)||(s=[s],t[o]=s),s.push(i)}else t[o]=i}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=zp(this.remaining),o=this.remaining[r.length];if("/"!==o&&")"!==o&&";"!==o)throw new Q(4010,!1);let i;r.indexOf(":")>-1?(i=r.slice(0,r.indexOf(":")),this.capture(i),this.capture(":")):t&&(i=Ke);const s=this.parseChildren();e[i]=1===Object.keys(s).length?s[Ke]:new Qe([],s),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Q(4011,!1)}}function Ib(n){return n.segments.length>0?new Qe([],{[Ke]:n}):n}function $p(n){const t={};for(const r of Object.keys(n.children)){const i=$p(n.children[r]);(i.segments.length>0||i.hasChildren())&&(t[r]=i)}return function ez(n){if(1===n.numberOfChildren&&n.children[Ke]){const t=n.children[Ke];return new Qe(n.segments.concat(t.segments),t.children)}return n}(new Qe(n.segments,t))}function Ua(n){return n instanceof Ba}function rz(n,t,e,r,o){if(0===e.length)return pl(t.root,t.root,t.root,r,o);const i=function NA(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new RA(!0,0,n);let t=0,e=!1;const r=n.reduce((o,i,s)=>{if("object"==typeof i&&null!=i){if(i.outlets){const a={};return Bn(i.outlets,(u,l)=>{a[l]="string"==typeof u?u.split("/"):u}),[...o,{outlets:a}]}if(i.segmentPath)return[...o,i.segmentPath]}return"string"!=typeof i?[...o,i]:0===s?(i.split("/").forEach((a,u)=>{0==u&&"."===a||(0==u&&""===a?e=!0:".."===a?t++:""!=a&&o.push(a))}),o):[...o,i]},[]);return new RA(e,t,r)}(e);return i.toRoot()?pl(t.root,t.root,new Qe([],{}),r,o):function s(u){const l=function iz(n,t,e,r){if(n.isAbsolute)return new gl(t.root,!0,0);if(-1===r)return new gl(e,e===t.root,0);return function FA(n,t,e){let r=n,o=t,i=e;for(;i>o;){if(i-=o,r=r.parent,!r)throw new Q(4005,!1);o=r.segments.length}return new gl(r,!1,o-i)}(e,r+(Ad(n.commands[0])?0:1),n.numberOfDoubleDots)}(i,t,n.snapshot?._urlSegment,u),c=l.processChildren?Md(l.segmentGroup,l.index,i.commands):Tb(l.segmentGroup,l.index,i.commands);return pl(t.root,l.segmentGroup,c,r,o)}(n.snapshot?._lastPathIndex)}function Ad(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function Td(n){return"object"==typeof n&&null!=n&&n.outlets}function pl(n,t,e,r,o){let s,i={};r&&Bn(r,(u,l)=>{i[l]=Array.isArray(u)?u.map(c=>`${c}`):`${u}`}),s=n===t?e:kA(n,t,e);const a=Ib($p(s));return new Ba(a,i,o)}function kA(n,t,e){const r={};return Bn(n.children,(o,i)=>{r[i]=o===t?e:kA(o,t,e)}),new Qe(n.segments,r)}class RA{constructor(t,e,r){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=r,t&&r.length>0&&Ad(r[0]))throw new Q(4003,!1);const o=r.find(Td);if(o&&o!==_A(r))throw new Q(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class gl{constructor(t,e,r){this.segmentGroup=t,this.processChildren=e,this.index=r}}function Tb(n,t,e){if(n||(n=new Qe([],{})),0===n.segments.length&&n.hasChildren())return Md(n,t,e);const r=function az(n,t,e){let r=0,o=t;const i={match:!1,pathIndex:0,commandIndex:0};for(;o<n.segments.length;){if(r>=e.length)return i;const s=n.segments[o],a=e[r];if(Td(a))break;const u=`${a}`,l=r<e.length-1?e[r+1]:null;if(o>0&&void 0===u)break;if(u&&l&&"object"==typeof l&&void 0===l.outlets){if(!OA(u,l,s))return i;r+=2}else{if(!OA(u,{},s))return i;r++}o++}return{match:!0,pathIndex:o,commandIndex:r}}(n,t,e),o=e.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){const i=new Qe(n.segments.slice(0,r.pathIndex),{});return i.children[Ke]=new Qe(n.segments.slice(r.pathIndex),n.children),Md(i,0,o)}return r.match&&0===o.length?new Qe(n.segments,{}):r.match&&!n.hasChildren()?Mb(n,t,e):r.match?Md(n,0,o):Mb(n,t,e)}function Md(n,t,e){if(0===e.length)return new Qe(n.segments,{});{const r=function sz(n){return Td(n[0])?n[0].outlets:{[Ke]:n}}(e),o={};return Bn(r,(i,s)=>{"string"==typeof i&&(i=[i]),null!==i&&(o[s]=Tb(n.children[s],t,i))}),Bn(n.children,(i,s)=>{void 0===r[s]&&(o[s]=i)}),new Qe(n.segments,o)}}function Mb(n,t,e){const r=n.segments.slice(0,t);let o=0;for(;o<e.length;){const i=e[o];if(Td(i)){const u=uz(i.outlets);return new Qe(r,u)}if(0===o&&Ad(e[0])){r.push(new Sd(n.segments[t].path,PA(e[0]))),o++;continue}const s=Td(i)?i.outlets[Ke]:`${i}`,a=o<e.length-1?e[o+1]:null;s&&a&&Ad(a)?(r.push(new Sd(s,PA(a))),o+=2):(r.push(new Sd(s,{})),o++)}return new Qe(r,{})}function uz(n){const t={};return Bn(n,(e,r)=>{"string"==typeof e&&(e=[e]),null!==e&&(t[r]=Mb(new Qe([],{}),0,e))}),t}function PA(n){const t={};return Bn(n,(e,r)=>t[r]=`${e}`),t}function OA(n,t,e){return n==e.path&&oi(t,e.parameters)}class Qi{constructor(t,e){this.id=t,this.url=e}}class kb extends Qi{constructor(t,e,r="imperative",o=null){super(t,e),this.type=0,this.navigationTrigger=r,this.restoredState=o}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class ja extends Qi{constructor(t,e,r){super(t,e),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Gp extends Qi{constructor(t,e,r,o){super(t,e),this.reason=r,this.code=o,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class LA extends Qi{constructor(t,e,r,o){super(t,e),this.error=r,this.target=o,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class lz extends Qi{constructor(t,e,r,o){super(t,e),this.urlAfterRedirects=r,this.state=o,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class cz extends Qi{constructor(t,e,r,o){super(t,e),this.urlAfterRedirects=r,this.state=o,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class dz extends Qi{constructor(t,e,r,o,i){super(t,e),this.urlAfterRedirects=r,this.state=o,this.shouldActivate=i,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class fz extends Qi{constructor(t,e,r,o){super(t,e),this.urlAfterRedirects=r,this.state=o,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class hz extends Qi{constructor(t,e,r,o){super(t,e),this.urlAfterRedirects=r,this.state=o,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class pz{constructor(t){this.route=t,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class gz{constructor(t){this.route=t,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class mz{constructor(t){this.snapshot=t,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class vz{constructor(t){this.snapshot=t,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class yz{constructor(t){this.snapshot=t,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class wz{constructor(t){this.snapshot=t,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class BA{constructor(t,e,r){this.routerEvent=t,this.position=e,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class VA{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=Rb(t,this._root);return e?e.children.map(r=>r.value):[]}firstChild(t){const e=Rb(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=Nb(t,this._root);return e.length<2?[]:e[e.length-2].children.map(o=>o.value).filter(o=>o!==t)}pathFromRoot(t){return Nb(t,this._root).map(e=>e.value)}}function Rb(n,t){if(n===t.value)return t;for(const e of t.children){const r=Rb(n,e);if(r)return r}return null}function Nb(n,t){if(n===t.value)return[t];for(const e of t.children){const r=Nb(n,e);if(r.length)return r.unshift(t),r}return[]}class Zi{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function ml(n){const t={};return n&&n.children.forEach(e=>t[e.value.outlet]=e),t}class UA extends VA{constructor(t,e){super(t),this.snapshot=e,Fb(this,t)}toString(){return this.snapshot.toString()}}function jA(n,t){const e=function _z(n,t){const s=new qp([],{},{},"",{},Ke,t,null,n.root,-1,{});return new WA("",new Zi(s,[]))}(n,t),r=new lo([new Sd("",{})]),o=new lo({}),i=new lo({}),s=new lo({}),a=new lo(""),u=new Ha(r,o,s,a,i,Ke,t,e.root);return u.snapshot=e.root,new UA(new Zi(u,[]),e)}class Ha{constructor(t,e,r,o,i,s,a,u){this.url=t,this.params=e,this.queryParams=r,this.fragment=o,this.data=i,this.outlet=s,this.component=a,this.title=this.data?.pipe(Ge(l=>l[Dd]))??De(void 0),this._futureSnapshot=u}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Ge(t=>hl(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Ge(t=>hl(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function HA(n,t="emptyOnly"){const e=n.pathFromRoot;let r=0;if("always"!==t)for(r=e.length-1;r>=1;){const o=e[r],i=e[r-1];if(o.routeConfig&&""===o.routeConfig.path)r--;else{if(i.component)break;r--}}return function xz(n){return n.reduce((t,e)=>({params:{...t.params,...e.params},data:{...t.data,...e.data},resolve:{...e.data,...t.resolve,...e.routeConfig?.data,...e._resolvedData}}),{params:{},data:{},resolve:{}})}(e.slice(r))}class qp{constructor(t,e,r,o,i,s,a,u,l,c,d,f){this.url=t,this.params=e,this.queryParams=r,this.fragment=o,this.data=i,this.outlet=s,this.component=a,this.title=this.data?.[Dd],this.routeConfig=u,this._urlSegment=l,this._lastPathIndex=c,this._correctedLastPathIndex=f??c,this._resolve=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=hl(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=hl(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class WA extends VA{constructor(t,e){super(e),this.url=t,Fb(this,e)}toString(){return zA(this._root)}}function Fb(n,t){t.value._routerState=n,t.children.forEach(e=>Fb(n,e))}function zA(n){const t=n.children.length>0?` { ${n.children.map(zA).join(", ")} } `:"";return`${n.value}${t}`}function Pb(n){if(n.snapshot){const t=n.snapshot,e=n._futureSnapshot;n.snapshot=e,oi(t.queryParams,e.queryParams)||n.queryParams.next(e.queryParams),t.fragment!==e.fragment&&n.fragment.next(e.fragment),oi(t.params,e.params)||n.params.next(e.params),function LW(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;++e)if(!oi(n[e],t[e]))return!1;return!0}(t.url,e.url)||n.url.next(e.url),oi(t.data,e.data)||n.data.next(e.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function Ob(n,t){const e=oi(n.params,t.params)&&function HW(n,t){return Va(n,t)&&n.every((e,r)=>oi(e.parameters,t[r].parameters))}(n.url,t.url);return e&&!(!n.parent!=!t.parent)&&(!n.parent||Ob(n.parent,t.parent))}function kd(n,t,e){if(e&&n.shouldReuseRoute(t.value,e.value.snapshot)){const r=e.value;r._futureSnapshot=t.value;const o=function Ez(n,t,e){return t.children.map(r=>{for(const o of e.children)if(n.shouldReuseRoute(r.value,o.value.snapshot))return kd(n,r,o);return kd(n,r)})}(n,t,e);return new Zi(r,o)}{if(n.shouldAttach(t.value)){const i=n.retrieve(t.value);if(null!==i){const s=i.route;return s.value._futureSnapshot=t.value,s.children=t.children.map(a=>kd(n,a)),s}}const r=function Dz(n){return new Ha(new lo(n.url),new lo(n.params),new lo(n.queryParams),new lo(n.fragment),new lo(n.data),n.outlet,n.component,n)}(t.value),o=t.children.map(i=>kd(n,i));return new Zi(r,o)}}const Lb="ngNavigationCancelingError";function $A(n,t){const{redirectTo:e,navigationBehaviorOptions:r}=Ua(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,o=GA(!1,0,t);return o.url=e,o.navigationBehaviorOptions=r,o}function GA(n,t,e){const r=new Error("NavigationCancelingError: "+(n||""));return r[Lb]=!0,r.cancellationCode=t,e&&(r.url=e),r}function qA(n){return KA(n)&&Ua(n.url)}function KA(n){return n&&n[Lb]}class Sz{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new Rd,this.attachRef=null}}let Rd=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(e,r){const o=this.getOrCreateContext(e);o.outlet=r,this.contexts.set(e,o)}onChildOutletDestroyed(e){const r=this.getContext(e);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let r=this.getContext(e);return r||(r=new Sz,this.contexts.set(e,r)),r}getContext(e){return this.contexts.get(e)||null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=fe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Kp=!1;let Bb=(()=>{class n{constructor(e,r,o,i,s){this.parentContexts=e,this.location=r,this.changeDetector=i,this.environmentInjector=s,this.activated=null,this._activatedRoute=null,this.activateEvents=new Qt,this.deactivateEvents=new Qt,this.attachEvents=new Qt,this.detachEvents=new Qt,this.name=o||Ke,e.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.getContext(this.name)?.outlet===this&&this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Q(4012,Kp);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Q(4012,Kp);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Q(4012,Kp);this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,r){this.activated=e,this._activatedRoute=r,this.location.insert(e.hostView),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,r){if(this.isActivated)throw new Q(4013,Kp);this._activatedRoute=e;const o=this.location,s=e._futureSnapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,u=new Iz(e,a,o.injector);if(r&&function Az(n){return!!n.resolveComponentFactory}(r)){const l=r.resolveComponentFactory(s);this.activated=o.createComponent(l,o.length,u)}else this.activated=o.createComponent(s,{index:o.length,injector:u,environmentInjector:r??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(e){return new(e||n)(X(Rd),X(To),Nc("name"),X(mp),X(Bs))},n.\u0275dir=Ie({type:n,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0}),n})();class Iz{constructor(t,e,r){this.route=t,this.childContexts=e,this.parent=r}get(t,e){return t===Ha?this.route:t===Rd?this.childContexts:this.parent.get(t,e)}}let Vb=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=bn({type:n,selectors:[["ng-component"]],standalone:!0,features:[YS],decls:1,vars:0,template:function(e,r){1&e&&ye(0,"router-outlet")},dependencies:[Bb],encapsulation:2}),n})();function XA(n,t){return n.providers&&!n._injector&&(n._injector=ap(n.providers,t,`Route: ${n.path}`)),n._injector??t}function jb(n){const t=n.children&&n.children.map(jb),e=t?{...n,children:t}:{...n};return!e.component&&!e.loadComponent&&(t||e.loadChildren)&&e.outlet&&e.outlet!==Ke&&(e.component=Vb),e}function co(n){return n.outlet||Ke}function YA(n,t){const e=n.filter(r=>co(r)===t);return e.push(...n.filter(r=>co(r)!==t)),e}function Nd(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let t=n.parent;t;t=t.parent){const e=t.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}class Nz{constructor(t,e,r,o){this.routeReuseStrategy=t,this.futureState=e,this.currState=r,this.forwardEvent=o}activate(t){const e=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,r,t),Pb(this.futureState.root),this.activateChildRoutes(e,r,t)}deactivateChildRoutes(t,e,r){const o=ml(e);t.children.forEach(i=>{const s=i.value.outlet;this.deactivateRoutes(i,o[s],r),delete o[s]}),Bn(o,(i,s)=>{this.deactivateRouteAndItsChildren(i,r)})}deactivateRoutes(t,e,r){const o=t.value,i=e?e.value:null;if(o===i)if(o.component){const s=r.getContext(o.outlet);s&&this.deactivateChildRoutes(t,e,s.children)}else this.deactivateChildRoutes(t,e,r);else i&&this.deactivateRouteAndItsChildren(e,r)}deactivateRouteAndItsChildren(t,e){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const r=e.getContext(t.value.outlet),o=r&&t.value.component?r.children:e,i=ml(t);for(const s of Object.keys(i))this.deactivateRouteAndItsChildren(i[s],o);if(r&&r.outlet){const s=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:s,route:t,contexts:a})}}deactivateRouteAndOutlet(t,e){const r=e.getContext(t.value.outlet),o=r&&t.value.component?r.children:e,i=ml(t);for(const s of Object.keys(i))this.deactivateRouteAndItsChildren(i[s],o);r&&r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated(),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(t,e,r){const o=ml(e);t.children.forEach(i=>{this.activateRoutes(i,o[i.value.outlet],r),this.forwardEvent(new wz(i.value.snapshot))}),t.children.length&&this.forwardEvent(new vz(t.value.snapshot))}activateRoutes(t,e,r){const o=t.value,i=e?e.value:null;if(Pb(o),o===i)if(o.component){const s=r.getOrCreateContext(o.outlet);this.activateChildRoutes(t,e,s.children)}else this.activateChildRoutes(t,e,r);else if(o.component){const s=r.getOrCreateContext(o.outlet);if(this.routeReuseStrategy.shouldAttach(o.snapshot)){const a=this.routeReuseStrategy.retrieve(o.snapshot);this.routeReuseStrategy.store(o.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),Pb(a.route.value),this.activateChildRoutes(t,null,s.children)}else{const a=Nd(o.snapshot),u=a?.get(Yc)??null;s.attachRef=null,s.route=o,s.resolver=u,s.injector=a,s.outlet&&s.outlet.activateWith(o,s.injector),this.activateChildRoutes(t,null,s.children)}}else this.activateChildRoutes(t,null,r)}}class QA{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class Xp{constructor(t,e){this.component=t,this.route=e}}function Fz(n,t,e){const r=n._root;return Fd(r,t?t._root:null,e,[r.value])}function vl(n,t){const e=Symbol(),r=t.get(n,e);return r===e?"function"!=typeof n||function Is(n){return null!==Ca(n)}(n)?t.get(n):n:r}function Fd(n,t,e,r,o={canDeactivateChecks:[],canActivateChecks:[]}){const i=ml(t);return n.children.forEach(s=>{(function Oz(n,t,e,r,o={canDeactivateChecks:[],canActivateChecks:[]}){const i=n.value,s=t?t.value:null,a=e?e.getContext(n.value.outlet):null;if(s&&i.routeConfig===s.routeConfig){const u=function Lz(n,t,e){if("function"==typeof e)return e(n,t);switch(e){case"pathParamsChange":return!Va(n.url,t.url);case"pathParamsOrQueryParamsChange":return!Va(n.url,t.url)||!oi(n.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Ob(n,t)||!oi(n.queryParams,t.queryParams);default:return!Ob(n,t)}}(s,i,i.routeConfig.runGuardsAndResolvers);u?o.canActivateChecks.push(new QA(r)):(i.data=s.data,i._resolvedData=s._resolvedData),Fd(n,t,i.component?a?a.children:null:e,r,o),u&&a&&a.outlet&&a.outlet.isActivated&&o.canDeactivateChecks.push(new Xp(a.outlet.component,s))}else s&&Pd(t,a,o),o.canActivateChecks.push(new QA(r)),Fd(n,null,i.component?a?a.children:null:e,r,o)})(s,i[s.value.outlet],e,r.concat([s.value]),o),delete i[s.value.outlet]}),Bn(i,(s,a)=>Pd(s,e.getContext(a),o)),o}function Pd(n,t,e){const r=ml(n),o=n.value;Bn(r,(i,s)=>{Pd(i,o.component?t?t.children.getContext(s):null:t,e)}),e.canDeactivateChecks.push(new Xp(o.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,o))}function Od(n){return"function"==typeof n}function Hb(n){return n instanceof xd||"EmptyError"===n?.name}const Yp=Symbol("INITIAL_VALUE");function yl(){return ri(n=>fA(n.map(t=>t.pipe(Ed(1),function MW(...n){const t=Cs(n);return tn((e,r)=>{(t?_b(n,e,t):_b(n,e)).subscribe(r)})}(Yp)))).pipe(Ge(t=>{for(const e of t)if(!0!==e){if(e===Yp)return Yp;if(!1===e||e instanceof Ba)return e}return!0}),Yi(t=>t!==Yp),Ed(1)))}function ZA(n){return function oc(...n){return ic(n)}(Tt(t=>{if(Ua(t))throw $A(0,t)}),Ge(t=>!0===t))}const Wb={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function JA(n,t,e,r,o){const i=zb(n,t,e);return i.matched?function e$(n,t,e,r){const o=t.canMatch;return o&&0!==o.length?De(o.map(s=>{const a=vl(s,n);return qs(function Wz(n){return n&&Od(n.canMatch)}(a)?a.canMatch(t,e):n.runInContext(()=>a(t,e)))})).pipe(yl(),ZA()):De(!0)}(r=XA(t,r),t,e).pipe(Ge(s=>!0===s?i:{...Wb})):De(i)}function zb(n,t,e){if(""===t.path)return"full"===t.pathMatch&&(n.hasChildren()||e.length>0)?{...Wb}:{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};const o=(t.matcher||OW)(e,n,t);if(!o)return{...Wb};const i={};Bn(o.posParams,(a,u)=>{i[u]=a.path});const s=o.consumed.length>0?{...i,...o.consumed[o.consumed.length-1].parameters}:i;return{matched:!0,consumedSegments:o.consumed,remainingSegments:e.slice(o.consumed.length),parameters:s,positionalParamSegments:o.posParams??{}}}function Qp(n,t,e,r,o="corrected"){if(e.length>0&&function r$(n,t,e){return e.some(r=>Zp(n,t,r)&&co(r)!==Ke)}(n,e,r)){const s=new Qe(t,function n$(n,t,e,r){const o={};o[Ke]=r,r._sourceSegment=n,r._segmentIndexShift=t.length;for(const i of e)if(""===i.path&&co(i)!==Ke){const s=new Qe([],{});s._sourceSegment=n,s._segmentIndexShift=t.length,o[co(i)]=s}return o}(n,t,r,new Qe(e,n.children)));return s._sourceSegment=n,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:[]}}if(0===e.length&&function o$(n,t,e){return e.some(r=>Zp(n,t,r))}(n,e,r)){const s=new Qe(n.segments,function t$(n,t,e,r,o,i){const s={};for(const a of r)if(Zp(n,e,a)&&!o[co(a)]){const u=new Qe([],{});u._sourceSegment=n,u._segmentIndexShift="legacy"===i?n.segments.length:t.length,s[co(a)]=u}return{...o,...s}}(n,t,e,r,n.children,o));return s._sourceSegment=n,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:e}}const i=new Qe(n.segments,n.children);return i._sourceSegment=n,i._segmentIndexShift=t.length,{segmentGroup:i,slicedSegments:e}}function Zp(n,t,e){return(!(n.hasChildren()||t.length>0)||"full"!==e.pathMatch)&&""===e.path}function eT(n,t,e,r){return!!(co(n)===r||r!==Ke&&Zp(t,e,n))&&("**"===n.path||zb(t,n,e).matched)}function tT(n,t,e){return 0===t.length&&!n.children[e]}const Jp=!1;class eg{constructor(t){this.segmentGroup=t||null}}class nT{constructor(t){this.urlTree=t}}function Ld(n){return Cd(new eg(n))}function rT(n){return Cd(new nT(n))}class u${constructor(t,e,r,o,i){this.injector=t,this.configLoader=e,this.urlSerializer=r,this.urlTree=o,this.config=i,this.allowRedirects=!0}apply(){const t=Qp(this.urlTree.root,[],[],this.config).segmentGroup,e=new Qe(t.segments,t.children);return this.expandSegmentGroup(this.injector,this.config,e,Ke).pipe(Ge(i=>this.createUrlTree($p(i),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Gs(i=>{if(i instanceof nT)return this.allowRedirects=!1,this.match(i.urlTree);throw i instanceof eg?this.noMatchError(i):i}))}match(t){return this.expandSegmentGroup(this.injector,this.config,t.root,Ke).pipe(Ge(o=>this.createUrlTree($p(o),t.queryParams,t.fragment))).pipe(Gs(o=>{throw o instanceof eg?this.noMatchError(o):o}))}noMatchError(t){return new Q(4002,Jp)}createUrlTree(t,e,r){const o=Ib(t);return new Ba(o,e,r)}expandSegmentGroup(t,e,r,o){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(t,e,r).pipe(Ge(i=>new Qe([],i))):this.expandSegment(t,r,e,r.segments,o,!0)}expandChildren(t,e,r){const o=[];for(const i of Object.keys(r.children))"primary"===i?o.unshift(i):o.push(i);return Xt(o).pipe($s(i=>{const s=r.children[i],a=YA(e,i);return this.expandSegmentGroup(t,a,s,i).pipe(Ge(u=>({segment:u,outlet:i})))}),vA((i,s)=>(i[s.outlet]=s.segment,i),{}),yA())}expandSegment(t,e,r,o,i,s){return Xt(r).pipe($s(a=>this.expandSegmentAgainstRoute(t,e,r,a,o,i,s).pipe(Gs(l=>{if(l instanceof eg)return De(null);throw l}))),zs(a=>!!a),Gs((a,u)=>{if(Hb(a))return tT(e,o,i)?De(new Qe([],{})):Ld(e);throw a}))}expandSegmentAgainstRoute(t,e,r,o,i,s,a){return eT(o,e,i,s)?void 0===o.redirectTo?this.matchSegmentAgainstRoute(t,e,o,i,s):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,r,o,i,s):Ld(e):Ld(e)}expandSegmentAgainstRouteUsingRedirect(t,e,r,o,i,s){return"**"===o.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,r,o,s):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,r,o,i,s)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,r,o){const i=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?rT(i):this.lineralizeSegments(r,i).pipe(nn(s=>{const a=new Qe(s,{});return this.expandSegment(t,a,e,s,o,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,r,o,i,s){const{matched:a,consumedSegments:u,remainingSegments:l,positionalParamSegments:c}=zb(e,o,i);if(!a)return Ld(e);const d=this.applyRedirectCommands(u,o.redirectTo,c);return o.redirectTo.startsWith("/")?rT(d):this.lineralizeSegments(o,d).pipe(nn(f=>this.expandSegment(t,e,r,f.concat(l),s,!1)))}matchSegmentAgainstRoute(t,e,r,o,i){return"**"===r.path?(t=XA(r,t),r.loadChildren?(r._loadedRoutes?De({routes:r._loadedRoutes,injector:r._loadedInjector}):this.configLoader.loadChildren(t,r)).pipe(Ge(a=>(r._loadedRoutes=a.routes,r._loadedInjector=a.injector,new Qe(o,{})))):De(new Qe(o,{}))):JA(e,r,o,t).pipe(ri(({matched:s,consumedSegments:a,remainingSegments:u})=>s?this.getChildConfig(t=r._injector??t,r,o).pipe(nn(c=>{const d=c.injector??t,f=c.routes,{segmentGroup:h,slicedSegments:p}=Qp(e,a,u,f),m=new Qe(h.segments,h.children);if(0===p.length&&m.hasChildren())return this.expandChildren(d,f,m).pipe(Ge(b=>new Qe(a,b)));if(0===f.length&&0===p.length)return De(new Qe(a,{}));const v=co(r)===i;return this.expandSegment(d,m,f,p,v?Ke:i,!0).pipe(Ge(_=>new Qe(a.concat(_.segments),_.children)))})):Ld(e)))}getChildConfig(t,e,r){return e.children?De({routes:e.children,injector:t}):e.loadChildren?void 0!==e._loadedRoutes?De({routes:e._loadedRoutes,injector:e._loadedInjector}):function Jz(n,t,e,r){const o=t.canLoad;return void 0===o||0===o.length?De(!0):De(o.map(s=>{const a=vl(s,n);return qs(function Vz(n){return n&&Od(n.canLoad)}(a)?a.canLoad(t,e):n.runInContext(()=>a(t,e)))})).pipe(yl(),ZA())}(t,e,r).pipe(nn(o=>o?this.configLoader.loadChildren(t,e).pipe(Tt(i=>{e._loadedRoutes=i.routes,e._loadedInjector=i.injector})):function s$(n){return Cd(GA(Jp,3))}())):De({routes:[],injector:t})}lineralizeSegments(t,e){let r=[],o=e.root;for(;;){if(r=r.concat(o.segments),0===o.numberOfChildren)return De(r);if(o.numberOfChildren>1||!o.children[Ke])return Cd(new Q(4e3,Jp));o=o.children[Ke]}}applyRedirectCommands(t,e,r){return this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),t,r)}applyRedirectCreateUrlTree(t,e,r,o){const i=this.createSegmentGroup(t,e.root,r,o);return new Ba(i,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const r={};return Bn(t,(o,i)=>{if("string"==typeof o&&o.startsWith(":")){const a=o.substring(1);r[i]=e[a]}else r[i]=o}),r}createSegmentGroup(t,e,r,o){const i=this.createSegments(t,e.segments,r,o);let s={};return Bn(e.children,(a,u)=>{s[u]=this.createSegmentGroup(t,a,r,o)}),new Qe(i,s)}createSegments(t,e,r,o){return e.map(i=>i.path.startsWith(":")?this.findPosParam(t,i,o):this.findOrReturn(i,r))}findPosParam(t,e,r){const o=r[e.path.substring(1)];if(!o)throw new Q(4001,Jp);return o}findOrReturn(t,e){let r=0;for(const o of e){if(o.path===t.path)return e.splice(r),o;r++}return t}}class c${}class h${constructor(t,e,r,o,i,s,a,u){this.injector=t,this.rootComponentType=e,this.config=r,this.urlTree=o,this.url=i,this.paramsInheritanceStrategy=s,this.relativeLinkResolution=a,this.urlSerializer=u}recognize(){const t=Qp(this.urlTree.root,[],[],this.config.filter(e=>void 0===e.redirectTo),this.relativeLinkResolution).segmentGroup;return this.processSegmentGroup(this.injector,this.config,t,Ke).pipe(Ge(e=>{if(null===e)return null;const r=new qp([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Ke,this.rootComponentType,null,this.urlTree.root,-1,{}),o=new Zi(r,e),i=new WA(this.url,o);return this.inheritParamsAndData(i._root),i}))}inheritParamsAndData(t){const e=t.value,r=HA(e,this.paramsInheritanceStrategy);e.params=Object.freeze(r.params),e.data=Object.freeze(r.data),t.children.forEach(o=>this.inheritParamsAndData(o))}processSegmentGroup(t,e,r,o){return 0===r.segments.length&&r.hasChildren()?this.processChildren(t,e,r):this.processSegment(t,e,r,r.segments,o)}processChildren(t,e,r){return Xt(Object.keys(r.children)).pipe($s(o=>{const i=r.children[o],s=YA(e,o);return this.processSegmentGroup(t,s,i,o)}),vA((o,i)=>o&&i?(o.push(...i),o):null),function NW(n,t=!1){return tn((e,r)=>{let o=0;e.subscribe(Pt(r,i=>{const s=n(i,o++);(s||t)&&r.next(i),!s&&r.complete()}))})}(o=>null!==o),Bp(null),yA(),Ge(o=>{if(null===o)return null;const i=oT(o);return function p$(n){n.sort((t,e)=>t.value.outlet===Ke?-1:e.value.outlet===Ke?1:t.value.outlet.localeCompare(e.value.outlet))}(i),i}))}processSegment(t,e,r,o,i){return Xt(e).pipe($s(s=>this.processSegmentAgainstRoute(s._injector??t,s,r,o,i)),zs(s=>!!s),Gs(s=>{if(Hb(s))return tT(r,o,i)?De([]):De(null);throw s}))}processSegmentAgainstRoute(t,e,r,o,i){if(e.redirectTo||!eT(e,r,o,i))return De(null);let s;if("**"===e.path){const a=o.length>0?_A(o).parameters:{},u=sT(r)+o.length;s=De({snapshot:new qp(o,a,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,uT(e),co(e),e.component??e._loadedComponent??null,e,iT(r),u,lT(e),u),consumedSegments:[],remainingSegments:[]})}else s=JA(r,e,o,t).pipe(Ge(({matched:a,consumedSegments:u,remainingSegments:l,parameters:c})=>{if(!a)return null;const d=sT(r)+u.length;return{snapshot:new qp(u,c,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,uT(e),co(e),e.component??e._loadedComponent??null,e,iT(r),d,lT(e),d),consumedSegments:u,remainingSegments:l}}));return s.pipe(ri(a=>{if(null===a)return De(null);const{snapshot:u,consumedSegments:l,remainingSegments:c}=a;t=e._injector??t;const d=e._loadedInjector??t,f=function g$(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(e),{segmentGroup:h,slicedSegments:p}=Qp(r,l,c,f.filter(v=>void 0===v.redirectTo),this.relativeLinkResolution);if(0===p.length&&h.hasChildren())return this.processChildren(d,f,h).pipe(Ge(v=>null===v?null:[new Zi(u,v)]));if(0===f.length&&0===p.length)return De([new Zi(u,[])]);const m=co(e)===i;return this.processSegment(d,f,h,p,m?Ke:i).pipe(Ge(v=>null===v?null:[new Zi(u,v)]))}))}}function m$(n){const t=n.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}function oT(n){const t=[],e=new Set;for(const r of n){if(!m$(r)){t.push(r);continue}const o=t.find(i=>r.value.routeConfig===i.value.routeConfig);void 0!==o?(o.children.push(...r.children),e.add(o)):t.push(r)}for(const r of e){const o=oT(r.children);t.push(new Zi(r.value,o))}return t.filter(r=>!e.has(r))}function iT(n){let t=n;for(;t._sourceSegment;)t=t._sourceSegment;return t}function sT(n){let t=n,e=t._segmentIndexShift??0;for(;t._sourceSegment;)t=t._sourceSegment,e+=t._segmentIndexShift??0;return e-1}function uT(n){return n.data||{}}function lT(n){return n.resolve||{}}function cT(n){return"string"==typeof n.title||null===n.title}function $b(n){return ri(t=>{const e=n(t);return e?Xt(e).pipe(Ge(()=>t)):De(t)})}let dT=(()=>{class n{buildTitle(e){let r,o=e.root;for(;void 0!==o;)r=this.getResolvedTitleForRoute(o)??r,o=o.children.find(i=>i.outlet===Ke);return r}getResolvedTitleForRoute(e){return e.data[Dd]}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=fe({token:n,factory:function(){return rn(fT)},providedIn:"root"}),n})(),fT=(()=>{class n extends dT{constructor(e){super(),this.title=e}updateTitle(e){const r=this.buildTitle(e);void 0!==r&&this.title.setTitle(r)}}return n.\u0275fac=function(e){return new(e||n)(re(sA))},n.\u0275prov=fe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class E${}class S$ extends class D${shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}{}const ng=new _e("",{providedIn:"root",factory:()=>({})}),Gb=new _e("ROUTES");let qb=(()=>{class n{constructor(e,r){this.injector=e,this.compiler=r,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return De(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);const r=qs(e.loadComponent()).pipe(Tt(i=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=i}),Vp(()=>{this.componentLoaders.delete(e)})),o=new gA(r,()=>new eo).pipe(xb());return this.componentLoaders.set(e,o),o}loadChildren(e,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return De({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const i=this.loadModuleFactoryOrRoutes(r.loadChildren).pipe(Ge(a=>{this.onLoadEndListener&&this.onLoadEndListener(r);let u,l,c=!1;Array.isArray(a)?l=a:(u=a.create(e).injector,l=bA(u.get(Gb,[],Se.Self|Se.Optional)));return{routes:l.map(jb),injector:u}}),Vp(()=>{this.childrenLoaders.delete(r)})),s=new gA(i,()=>new eo).pipe(xb());return this.childrenLoaders.set(r,s),s}loadModuleFactoryOrRoutes(e){return qs(e()).pipe(nn(r=>r instanceof KS||Array.isArray(r)?De(r):Xt(this.compiler.compileModuleAsync(r))))}}return n.\u0275fac=function(e){return new(e||n)(re(jr),re(Vw))},n.\u0275prov=fe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class A${}class T${shouldProcessUrl(t){return!0}extract(t){return t}merge(t,e){return t}}function M$(n){throw n}function k$(n,t,e){return t.parse("/")}const R$={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},N$={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};function pT(){const n=rn(IA),t=rn(Rd),e=rn(md),r=rn(jr),o=rn(Vw),i=rn(Gb,{optional:!0})??[],s=rn(ng,{optional:!0})??{},a=rn(fT),u=rn(dT,{optional:!0}),l=rn(A$,{optional:!0}),c=rn(E$,{optional:!0}),d=new Wt(null,n,t,e,r,o,bA(i));return l&&(d.urlHandlingStrategy=l),c&&(d.routeReuseStrategy=c),d.titleStrategy=u??a,function F$(n,t){n.errorHandler&&(t.errorHandler=n.errorHandler),n.malformedUriErrorHandler&&(t.malformedUriErrorHandler=n.malformedUriErrorHandler),n.onSameUrlNavigation&&(t.onSameUrlNavigation=n.onSameUrlNavigation),n.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=n.paramsInheritanceStrategy),n.relativeLinkResolution&&(t.relativeLinkResolution=n.relativeLinkResolution),n.urlUpdateStrategy&&(t.urlUpdateStrategy=n.urlUpdateStrategy),n.canceledNavigationResolution&&(t.canceledNavigationResolution=n.canceledNavigationResolution)}(s,d),d}let Wt=(()=>{class n{constructor(e,r,o,i,s,a,u){this.rootComponentType=e,this.urlSerializer=r,this.rootContexts=o,this.location=i,this.config=u,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new eo,this.errorHandler=M$,this.malformedUriErrorHandler=k$,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>De(void 0),this.urlHandlingStrategy=new T$,this.routeReuseStrategy=new S$,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.configLoader=s.get(qb),this.configLoader.onLoadEndListener=f=>this.triggerEvent(new gz(f)),this.configLoader.onLoadStartListener=f=>this.triggerEvent(new pz(f)),this.ngModule=s.get(Pa),this.console=s.get(lj);const d=s.get(on);this.isNgZoneEnabled=d instanceof on&&on.isInAngularZone(),this.resetConfig(u),this.currentUrlTree=function BW(){return new Ba(new Qe([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=jA(this.currentUrlTree,this.rootComponentType),this.transitions=new lo({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){return this.location.getState()?.\u0275routerPageId}setupNavigations(e){const r=this.events;return e.pipe(Yi(o=>0!==o.id),Ge(o=>({...o,extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),ri(o=>{let i=!1,s=!1;return De(o).pipe(Tt(a=>{this.currentNavigation={id:a.id,initialUrl:a.rawUrl,extractedUrl:a.extractedUrl,trigger:a.source,extras:a.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),ri(a=>{const u=this.browserUrlTree.toString(),l=!this.navigated||a.extractedUrl.toString()!==u||u!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||l)&&this.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return gT(a.source)&&(this.browserUrlTree=a.extractedUrl),De(a).pipe(ri(d=>{const f=this.transitions.getValue();return r.next(new kb(d.id,this.serializeUrl(d.extractedUrl),d.source,d.restoredState)),f!==this.transitions.getValue()?oo:Promise.resolve(d)}),function l$(n,t,e,r){return ri(o=>function a$(n,t,e,r,o){return new u$(n,t,e,r,o).apply()}(n,t,e,o.extractedUrl,r).pipe(Ge(i=>({...o,urlAfterRedirects:i}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),Tt(d=>{this.currentNavigation={...this.currentNavigation,finalUrl:d.urlAfterRedirects},o.urlAfterRedirects=d.urlAfterRedirects}),function y$(n,t,e,r,o,i){return nn(s=>function f$(n,t,e,r,o,i,s="emptyOnly",a="legacy"){return new h$(n,t,e,r,o,s,a,i).recognize().pipe(ri(u=>null===u?function d$(n){return new Rt(t=>t.error(n))}(new c$):De(u)))}(n,t,e,s.urlAfterRedirects,r.serialize(s.urlAfterRedirects),r,o,i).pipe(Ge(a=>({...s,targetSnapshot:a}))))}(this.ngModule.injector,this.rootComponentType,this.config,this.urlSerializer,this.paramsInheritanceStrategy,this.relativeLinkResolution),Tt(d=>{if(o.targetSnapshot=d.targetSnapshot,"eager"===this.urlUpdateStrategy){if(!d.extras.skipLocationChange){const h=this.urlHandlingStrategy.merge(d.urlAfterRedirects,d.rawUrl);this.setBrowserUrl(h,d)}this.browserUrlTree=d.urlAfterRedirects}const f=new lz(d.id,this.serializeUrl(d.extractedUrl),this.serializeUrl(d.urlAfterRedirects),d.targetSnapshot);r.next(f)}));if(l&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:f,extractedUrl:h,source:p,restoredState:m,extras:v}=a,y=new kb(f,this.serializeUrl(h),p,m);r.next(y);const _=jA(h,this.rootComponentType).snapshot;return De(o={...a,targetSnapshot:_,urlAfterRedirects:h,extras:{...v,skipLocationChange:!1,replaceUrl:!1}})}return this.rawUrlTree=a.rawUrl,a.resolve(null),oo}),Tt(a=>{const u=new cz(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot);this.triggerEvent(u)}),Ge(a=>o={...a,guards:Fz(a.targetSnapshot,a.currentSnapshot,this.rootContexts)}),function $z(n,t){return nn(e=>{const{targetSnapshot:r,currentSnapshot:o,guards:{canActivateChecks:i,canDeactivateChecks:s}}=e;return 0===s.length&&0===i.length?De({...e,guardsResult:!0}):function Gz(n,t,e,r){return Xt(n).pipe(nn(o=>function Zz(n,t,e,r,o){const i=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return i&&0!==i.length?De(i.map(a=>{const u=Nd(t)??o,l=vl(a,u);return qs(function Hz(n){return n&&Od(n.canDeactivate)}(l)?l.canDeactivate(n,t,e,r):u.runInContext(()=>l(n,t,e,r))).pipe(zs())})).pipe(yl()):De(!0)}(o.component,o.route,e,t,r)),zs(o=>!0!==o,!0))}(s,r,o,n).pipe(nn(a=>a&&function Bz(n){return"boolean"==typeof n}(a)?function qz(n,t,e,r){return Xt(t).pipe($s(o=>_b(function Xz(n,t){return null!==n&&t&&t(new mz(n)),De(!0)}(o.route.parent,r),function Kz(n,t){return null!==n&&t&&t(new yz(n)),De(!0)}(o.route,r),function Qz(n,t,e){const r=t[t.length-1],i=t.slice(0,t.length-1).reverse().map(s=>function Pz(n){const t=n.routeConfig?n.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:n,guards:t}:null}(s)).filter(s=>null!==s).map(s=>pA(()=>De(s.guards.map(u=>{const l=Nd(s.node)??e,c=vl(u,l);return qs(function jz(n){return n&&Od(n.canActivateChild)}(c)?c.canActivateChild(r,n):l.runInContext(()=>c(r,n))).pipe(zs())})).pipe(yl())));return De(i).pipe(yl())}(n,o.path,e),function Yz(n,t,e){const r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||0===r.length)return De(!0);const o=r.map(i=>pA(()=>{const s=Nd(t)??e,a=vl(i,s);return qs(function Uz(n){return n&&Od(n.canActivate)}(a)?a.canActivate(t,n):s.runInContext(()=>a(t,n))).pipe(zs())}));return De(o).pipe(yl())}(n,o.route,e))),zs(o=>!0!==o,!0))}(r,i,n,t):De(a)),Ge(a=>({...e,guardsResult:a})))})}(this.ngModule.injector,a=>this.triggerEvent(a)),Tt(a=>{if(o.guardsResult=a.guardsResult,Ua(a.guardsResult))throw $A(0,a.guardsResult);const u=new dz(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);this.triggerEvent(u)}),Yi(a=>!!a.guardsResult||(this.restoreHistory(a),this.cancelNavigationTransition(a,"",3),!1)),$b(a=>{if(a.guards.canActivateChecks.length)return De(a).pipe(Tt(u=>{const l=new fz(u.id,this.serializeUrl(u.extractedUrl),this.serializeUrl(u.urlAfterRedirects),u.targetSnapshot);this.triggerEvent(l)}),ri(u=>{let l=!1;return De(u).pipe(function w$(n,t){return nn(e=>{const{targetSnapshot:r,guards:{canActivateChecks:o}}=e;if(!o.length)return De(e);let i=0;return Xt(o).pipe($s(s=>function b$(n,t,e,r){const o=n.routeConfig,i=n._resolve;return void 0!==o?.title&&!cT(o)&&(i[Dd]=o.title),function _$(n,t,e,r){const o=function x$(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===o.length)return De({});const i={};return Xt(o).pipe(nn(s=>function C$(n,t,e,r){const o=Nd(t)??r,i=vl(n,o);return qs(i.resolve?i.resolve(t,e):o.runInContext(()=>i(t,e)))}(n[s],t,e,r).pipe(zs(),Tt(a=>{i[s]=a}))),Cb(1),function FW(n){return Ge(()=>n)}(i),Gs(s=>Hb(s)?oo:Cd(s)))}(i,n,t,r).pipe(Ge(s=>(n._resolvedData=s,n.data=HA(n,e).resolve,o&&cT(o)&&(n.data[Dd]=o.title),null)))}(s.route,r,n,t)),Tt(()=>i++),Cb(1),nn(s=>i===o.length?De(e):oo))})}(this.paramsInheritanceStrategy,this.ngModule.injector),Tt({next:()=>l=!0,complete:()=>{l||(this.restoreHistory(u),this.cancelNavigationTransition(u,"",2))}}))}),Tt(u=>{const l=new hz(u.id,this.serializeUrl(u.extractedUrl),this.serializeUrl(u.urlAfterRedirects),u.targetSnapshot);this.triggerEvent(l)}))}),$b(a=>{const u=l=>{const c=[];l.routeConfig?.loadComponent&&!l.routeConfig._loadedComponent&&c.push(this.configLoader.loadComponent(l.routeConfig).pipe(Tt(d=>{l.component=d}),Ge(()=>{})));for(const d of l.children)c.push(...u(d));return c};return fA(u(a.targetSnapshot.root)).pipe(Bp(),Ed(1))}),$b(()=>this.afterPreactivation()),Ge(a=>{const u=function Cz(n,t,e){const r=kd(n,t._root,e?e._root:void 0);return new UA(r,t)}(this.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);return o={...a,targetRouterState:u}}),Tt(a=>{this.currentUrlTree=a.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(a.urlAfterRedirects,a.rawUrl),this.routerState=a.targetRouterState,"deferred"===this.urlUpdateStrategy&&(a.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,a),this.browserUrlTree=a.urlAfterRedirects)}),((n,t,e)=>Ge(r=>(new Nz(t,r.targetRouterState,r.currentRouterState,e).activate(n),r)))(this.rootContexts,this.routeReuseStrategy,a=>this.triggerEvent(a)),Tt({next(){i=!0},complete(){i=!0}}),Vp(()=>{i||s||this.cancelNavigationTransition(o,"",1),this.currentNavigation?.id===o.id&&(this.currentNavigation=null)}),Gs(a=>{if(s=!0,KA(a)){qA(a)||(this.navigated=!0,this.restoreHistory(o,!0));const u=new Gp(o.id,this.serializeUrl(o.extractedUrl),a.message,a.cancellationCode);if(r.next(u),qA(a)){const l=this.urlHandlingStrategy.merge(a.url,this.rawUrlTree),c={skipLocationChange:o.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||gT(o.source)};this.scheduleNavigation(l,"imperative",null,c,{resolve:o.resolve,reject:o.reject,promise:o.promise})}else o.resolve(!1)}else{this.restoreHistory(o,!0);const u=new LA(o.id,this.serializeUrl(o.extractedUrl),a,o.targetSnapshot??void 0);r.next(u);try{o.resolve(this.errorHandler(a))}catch(l){o.reject(l)}}return oo}))}))}resetRootComponentType(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}setTransition(e){this.transitions.next({...this.transitions.value,...e})}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const r="popstate"===e.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{const o={replaceUrl:!0},i=e.state?.navigationId?e.state:null;if(i){const a={...i};delete a.navigationId,delete a.\u0275routerPageId,0!==Object.keys(a).length&&(o.state=a)}const s=this.parseUrl(e.url);this.scheduleNavigation(s,r,i,o)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(e){this.events.next(e)}resetConfig(e){this.config=e.map(jb),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(e,r={}){const{relativeTo:o,queryParams:i,fragment:s,queryParamsHandling:a,preserveFragment:u}=r,l=o||this.routerState.root,c=u?this.currentUrlTree.fragment:s;let d=null;switch(a){case"merge":d={...this.currentUrlTree.queryParams,...i};break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=i||null}return null!==d&&(d=this.removeEmptyProps(d)),rz(l,this.currentUrlTree,e,d,c??null)}navigateByUrl(e,r={skipLocationChange:!1}){const o=Ua(e)?e:this.parseUrl(e),i=this.urlHandlingStrategy.merge(o,this.rawUrlTree);return this.scheduleNavigation(i,"imperative",null,r)}navigate(e,r={skipLocationChange:!1}){return function P$(n){for(let t=0;t<n.length;t++){if(null==n[t])throw new Q(4008,false)}}(e),this.navigateByUrl(this.createUrlTree(e,r),r)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let r;try{r=this.urlSerializer.parse(e)}catch(o){r=this.malformedUriErrorHandler(o,this.urlSerializer,e)}return r}isActive(e,r){let o;if(o=!0===r?{...R$}:!1===r?{...N$}:r,Ua(e))return CA(this.currentUrlTree,e,o);const i=this.parseUrl(e);return CA(this.currentUrlTree,i,o)}removeEmptyProps(e){return Object.keys(e).reduce((r,o)=>{const i=e[o];return null!=i&&(r[o]=i),r},{})}processNavigations(){this.navigations.subscribe(e=>{this.navigated=!0,this.lastSuccessfulId=e.id,this.currentPageId=e.targetPageId,this.events.next(new ja(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.titleStrategy?.updateTitle(this.routerState.snapshot),e.resolve(!0)},e=>{this.console.warn(`Unhandled Navigation Error: ${e}`)})}scheduleNavigation(e,r,o,i,s){if(this.disposed)return Promise.resolve(!1);let a,u,l;s?(a=s.resolve,u=s.reject,l=s.promise):l=new Promise((f,h)=>{a=f,u=h});const c=++this.navigationId;let d;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(o=this.location.getState()),d=o&&o.\u0275routerPageId?o.\u0275routerPageId:i.replaceUrl||i.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):d=0,this.setTransition({id:c,targetPageId:d,source:r,restoredState:o,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:i,resolve:a,reject:u,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(f=>Promise.reject(f))}setBrowserUrl(e,r){const o=this.urlSerializer.serialize(e),i={...r.extras.state,...this.generateNgRouterState(r.id,r.targetPageId)};this.location.isCurrentPathEqualTo(o)||r.extras.replaceUrl?this.location.replaceState(o,"",i):this.location.go(o,"",i)}restoreHistory(e,r=!1){if("computed"===this.canceledNavigationResolution){const o=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.currentNavigation?.finalUrl||0===o?this.currentUrlTree===this.currentNavigation?.finalUrl&&0===o&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(o)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(e,r,o){const i=new Gp(e.id,this.serializeUrl(e.extractedUrl),r,o);this.triggerEvent(i),e.resolve(!1)}generateNgRouterState(e,r){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:r}:{navigationId:e}}}return n.\u0275fac=function(e){Vy()},n.\u0275prov=fe({token:n,factory:function(){return pT()},providedIn:"root"}),n})();function gT(n){return"imperative"!==n}let Bd=(()=>{class n{constructor(e,r,o,i,s){this.router=e,this.route=r,this.tabIndexAttribute=o,this.renderer=i,this.el=s,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.commands=null,this.onChanges=new eo,this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(e){this._preserveFragment=qi(e)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(e){this._skipLocationChange=qi(e)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(e){this._replaceUrl=qi(e)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(e){if(null!=this.tabIndexAttribute)return;const r=this.renderer,o=this.el.nativeElement;null!==e?r.setAttribute(o,"tabindex",e):r.removeAttribute(o,"tabindex")}ngOnChanges(e){this.onChanges.next(this)}set routerLink(e){null!=e?(this.commands=Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(){return null===this.urlTree||this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!0}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(e){return new(e||n)(X(Wt),X(Ha),Nc("tabindex"),X(Ui),X(Ur))},n.\u0275dir=Ie({type:n,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(e,r){1&e&&pt("click",function(){return r.onClick()})},inputs:{queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[Ir]}),n})(),og=(()=>{class n{constructor(e,r,o){this.router=e,this.route=r,this.locationStrategy=o,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.commands=null,this.href=null,this.onChanges=new eo,this.subscription=e.events.subscribe(i=>{i instanceof ja&&this.updateTargetUrlAndHref()})}set preserveFragment(e){this._preserveFragment=qi(e)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(e){this._skipLocationChange=qi(e)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(e){this._replaceUrl=qi(e)}get replaceUrl(){return this._replaceUrl}set routerLink(e){this.commands=null!=e?Array.isArray(e)?e:[e]:null}ngOnChanges(e){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(e,r,o,i,s){return!!(0!==e||r||o||i||s||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!1)}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(e){return new(e||n)(X(Wt),X(Ha),X(La))},n.\u0275dir=Ie({type:n,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,r){1&e&&pt("click",function(i){return r.onClick(i.button,i.ctrlKey,i.shiftKey,i.altKey,i.metaKey)}),2&e&&Jo("target",r.target)("href",r.href,Wu)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[Ir]}),n})();class mT{}let B$=(()=>{class n{constructor(e,r,o,i,s){this.router=e,this.injector=o,this.preloadingStrategy=i,this.loader=s}setUpPreloading(){this.subscription=this.router.events.pipe(Yi(e=>e instanceof ja),$s(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,r){const o=[];for(const i of r){i.providers&&!i._injector&&(i._injector=ap(i.providers,e,`Route: ${i.path}`));const s=i._injector??e,a=i._loadedInjector??s;i.loadChildren&&!i._loadedRoutes&&void 0===i.canLoad||i.loadComponent&&!i._loadedComponent?o.push(this.preloadConfig(s,i)):(i.children||i._loadedRoutes)&&o.push(this.processRoutes(a,i.children??i._loadedRoutes))}return Xt(o).pipe(ro())}preloadConfig(e,r){return this.preloadingStrategy.preload(r,()=>{let o;o=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(e,r):De(null);const i=o.pipe(nn(s=>null===s?De(void 0):(r._loadedRoutes=s.routes,r._loadedInjector=s.injector,this.processRoutes(s.injector??e,s.routes))));return r.loadComponent&&!r._loadedComponent?Xt([i,this.loader.loadComponent(r)]).pipe(ro()):i})}}return n.\u0275fac=function(e){return new(e||n)(re(Wt),re(Vw),re(Bs),re(mT),re(qb))},n.\u0275prov=fe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Kb=new _e("");let vT=(()=>{class n{constructor(e,r,o={}){this.router=e,this.viewportScroller=r,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration=o.scrollPositionRestoration||"disabled",o.anchorScrolling=o.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(e=>{e instanceof kb?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof ja&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.router.parseUrl(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(e=>{e instanceof BA&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,r){this.router.triggerEvent(new BA(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return n.\u0275fac=function(e){Vy()},n.\u0275prov=fe({token:n,factory:n.\u0275fac}),n})();function wl(n,t){return{\u0275kind:n,\u0275providers:t}}function Xb(n){return[{provide:Gb,multi:!0,useValue:n}]}function wT(){const n=rn(jr);return t=>{const e=n.get(pd);if(t!==e.components[0])return;const r=n.get(Wt),o=n.get(bT);1===n.get(Yb)&&r.initialNavigation(),n.get(_T,null,Se.Optional)?.setUpPreloading(),n.get(Kb,null,Se.Optional)?.init(),r.resetRootComponentType(e.componentTypes[0]),o.closed||(o.next(),o.unsubscribe())}}const bT=new _e("",{factory:()=>new eo}),Yb=new _e("",{providedIn:"root",factory:()=>1});const _T=new _e("");function H$(n){return wl(0,[{provide:_T,useExisting:B$},{provide:mT,useExisting:n}])}const xT=new _e("ROUTER_FORROOT_GUARD"),W$=[md,{provide:IA,useClass:Db},{provide:Wt,useFactory:pT},Rd,{provide:Ha,useFactory:function yT(n){return n.routerState.root},deps:[Wt]},qb];function z$(){return new q2("Router",Wt)}let ag=(()=>{class n{constructor(e){}static forRoot(e,r){return{ngModule:n,providers:[W$,[],Xb(e),{provide:xT,useFactory:K$,deps:[[Wt,new Uc,new jc]]},{provide:ng,useValue:r||{}},r?.useHash?{provide:La,useClass:Qj}:{provide:La,useClass:yI},{provide:Kb,useFactory:()=>{const n=rn(Wt),t=rn(g5),e=rn(ng);return e.scrollOffset&&t.setOffset(e.scrollOffset),new vT(n,t,e)}},r?.preloadingStrategy?H$(r.preloadingStrategy).\u0275providers:[],{provide:q2,multi:!0,useFactory:z$},r?.initialNavigation?X$(r):[],[{provide:CT,useFactory:wT},{provide:V2,multi:!0,useExisting:CT}]]}}static forChild(e){return{ngModule:n,providers:[Xb(e)]}}}return n.\u0275fac=function(e){return new(e||n)(re(xT,8))},n.\u0275mod=Tn({type:n}),n.\u0275inj=wn({imports:[Vb]}),n})();function K$(n){return"guarded"}function X$(n){return["disabled"===n.initialNavigation?wl(3,[{provide:fp,multi:!0,useFactory:()=>{const t=rn(Wt);return()=>{t.setUpLocationChangeListener()}}},{provide:Yb,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?wl(2,[{provide:Yb,useValue:0},{provide:fp,multi:!0,deps:[jr],useFactory:t=>{const e=t.get(Xj,Promise.resolve());let r=!1;return()=>e.then(()=>new Promise(i=>{const s=t.get(Wt),a=t.get(bT);(function o(i){t.get(Wt).events.pipe(Yi(a=>a instanceof ja||a instanceof Gp||a instanceof LA),Ge(a=>a instanceof ja||a instanceof Gp&&(0===a.code||1===a.code)&&null),Yi(a=>null!==a),Ed(1)).subscribe(()=>{i()})})(()=>{i(!0),r=!0}),s.afterPreactivation=()=>(i(!0),r||a.closed?De(void 0):a),s.initialNavigation()}))}}]).\u0275providers:[]]}const CT=new _e("");let Ji=(()=>{class n{constructor(e){this.router=e}canActivate(){const e=localStorage.getItem("token");return!(!e||!this.isValidToken(e))||(this.router.navigate(["/login"]),!1)}isValidToken(e){try{return 1e3*JSON.parse(atob(e.split(".")[1])).exp>Date.now()}catch{return!1}}}return n.\u0275fac=function(e){return new(e||n)(re(Wt))},n.\u0275prov=fe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),ET=(()=>{class n{constructor(e,r){this._renderer=e,this._elementRef=r,this.onChange=o=>{},this.onTouched=()=>{}}setProperty(e,r){this._renderer.setProperty(this._elementRef.nativeElement,e,r)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return n.\u0275fac=function(e){return new(e||n)(X(Ui),X(Ur))},n.\u0275dir=Ie({type:n}),n})(),Wa=(()=>{class n extends ET{}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Yn(n)))(r||n)}}(),n.\u0275dir=Ie({type:n,features:[_t]}),n})();const ii=new _e("NgValueAccessor"),J$={provide:ii,useExisting:wt(()=>bl),multi:!0},t6=new _e("CompositionEventMode");let bl=(()=>{class n extends ET{constructor(e,r,o){super(e,r),this._compositionMode=o,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function e6(){const n=ni()?ni().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return n.\u0275fac=function(e){return new(e||n)(X(Ui),X(Ur),X(t6,8))},n.\u0275dir=Ie({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,r){1&e&&pt("input",function(i){return r._handleInput(i.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(i){return r._compositionEnd(i.target.value)})},features:[Lt([J$]),_t]}),n})();function Ks(n){return null==n||("string"==typeof n||Array.isArray(n))&&0===n.length}function ST(n){return null!=n&&"number"==typeof n.length}const Jn=new _e("NgValidators"),Xs=new _e("NgAsyncValidators"),r6=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class si{static min(t){return function IT(n){return t=>{if(Ks(t.value)||Ks(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e<n?{min:{min:n,actual:t.value}}:null}}(t)}static max(t){return function AT(n){return t=>{if(Ks(t.value)||Ks(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e>n?{max:{max:n,actual:t.value}}:null}}(t)}static required(t){return function TT(n){return Ks(n.value)?{required:!0}:null}(t)}static requiredTrue(t){return function MT(n){return!0===n.value?null:{required:!0}}(t)}static email(t){return function kT(n){return Ks(n.value)||r6.test(n.value)?null:{email:!0}}(t)}static minLength(t){return function RT(n){return t=>Ks(t.value)||!ST(t.value)?null:t.value.length<n?{minlength:{requiredLength:n,actualLength:t.value.length}}:null}(t)}static maxLength(t){return function NT(n){return t=>ST(t.value)&&t.value.length>n?{maxlength:{requiredLength:n,actualLength:t.value.length}}:null}(t)}static pattern(t){return function FT(n){if(!n)return ug;let t,e;return"string"==typeof n?(e="","^"!==n.charAt(0)&&(e+="^"),e+=n,"$"!==n.charAt(n.length-1)&&(e+="$"),t=new RegExp(e)):(e=n.toString(),t=n),r=>{if(Ks(r.value))return null;const o=r.value;return t.test(o)?null:{pattern:{requiredPattern:e,actualValue:o}}}}(t)}static nullValidator(t){return null}static compose(t){return UT(t)}static composeAsync(t){return jT(t)}}function ug(n){return null}function PT(n){return null!=n}function OT(n){return rd(n)?Xt(n):n}function LT(n){let t={};return n.forEach(e=>{t=null!=e?{...t,...e}:t}),0===Object.keys(t).length?null:t}function BT(n,t){return t.map(e=>e(n))}function VT(n){return n.map(t=>function o6(n){return!n.validate}(t)?t:e=>t.validate(e))}function UT(n){if(!n)return null;const t=n.filter(PT);return 0==t.length?null:function(e){return LT(BT(e,t))}}function Qb(n){return null!=n?UT(VT(n)):null}function jT(n){if(!n)return null;const t=n.filter(PT);return 0==t.length?null:function(e){return function Q$(...n){const t=Jf(n),{args:e,keys:r}=lA(n),o=new Rt(i=>{const{length:s}=e;if(!s)return void i.complete();const a=new Array(s);let u=s,l=s;for(let c=0;c<s;c++){let d=!1;Fr(e[c]).subscribe(Pt(i,f=>{d||(d=!0,l--),a[c]=f},()=>u--,void 0,()=>{(!u||!d)&&(l||i.next(r?dA(r,a):a),i.complete())}))}});return t?o.pipe(cA(t)):o}(BT(e,t).map(OT)).pipe(Ge(LT))}}function Zb(n){return null!=n?jT(VT(n)):null}function HT(n,t){return null===n?[t]:Array.isArray(n)?[...n,t]:[n,t]}function WT(n){return n._rawValidators}function zT(n){return n._rawAsyncValidators}function Jb(n){return n?Array.isArray(n)?n:[n]:[]}function lg(n,t){return Array.isArray(n)?n.includes(t):n===t}function $T(n,t){const e=Jb(t);return Jb(n).forEach(o=>{lg(e,o)||e.push(o)}),e}function GT(n,t){return Jb(t).filter(e=>!lg(n,e))}class qT{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=Qb(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=Zb(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}class wr extends qT{get formDirective(){return null}get path(){return null}}class Ys extends qT{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class KT{constructor(t){this._cd=t}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let Vd=(()=>{class n extends KT{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(X(Ys,2))},n.\u0275dir=Ie({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,r){2&e&&ep("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[_t]}),n})(),cg=(()=>{class n extends KT{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(X(wr,10))},n.\u0275dir=Ie({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,r){2&e&&ep("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},features:[_t]}),n})();const Ud="VALID",fg="INVALID",_l="PENDING",jd="DISABLED";function r0(n){return(hg(n)?n.validators:n)||null}function YT(n){return Array.isArray(n)?Qb(n):n||null}function o0(n,t){return(hg(t)?t.asyncValidators:n)||null}function QT(n){return Array.isArray(n)?Zb(n):n||null}function hg(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}function ZT(n,t,e){const r=n.controls;if(!(t?Object.keys(r):r).length)throw new Q(1e3,"");if(!r[e])throw new Q(1001,"")}function JT(n,t,e){n._forEachChild((r,o)=>{if(void 0===e[o])throw new Q(1002,"")})}class pg{constructor(t,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=e,this._composedValidatorFn=YT(this._rawValidators),this._composedAsyncValidatorFn=QT(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===Ud}get invalid(){return this.status===fg}get pending(){return this.status==_l}get disabled(){return this.status===jd}get enabled(){return this.status!==jd}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._rawValidators=t,this._composedValidatorFn=YT(t)}setAsyncValidators(t){this._rawAsyncValidators=t,this._composedAsyncValidatorFn=QT(t)}addValidators(t){this.setValidators($T(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators($T(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(GT(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(GT(t,this._rawAsyncValidators))}hasValidator(t){return lg(this._rawValidators,t)}hasAsyncValidator(t){return lg(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=_l,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=jd,this.errors=null,this._forEachChild(r=>{r.disable({...t,onlySelf:!0})}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(r=>r(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=Ud,this._forEachChild(r=>{r.enable({...t,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Ud||this.status===_l)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?jd:Ud}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=_l,this._hasOwnPendingAsyncValidator=!0;const e=OT(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){let e=t;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((r,o)=>r&&r._find(o),this)}getError(t,e){const r=e?this.get(e):this;return r&&r.errors?r.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new Qt,this.statusChanges=new Qt}_calculateStatus(){return this._allControlsDisabled()?jd:this.errors?fg:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(_l)?_l:this._anyControlsHaveStatus(fg)?fg:Ud}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){hg(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(t){return null}}class Hd extends pg{constructor(t,e,r){super(r0(e),o0(r,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,r={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,r={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){JT(this,0,t),Object.keys(t).forEach(r=>{ZT(this,!0,r),this.controls[r].setValue(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(Object.keys(t).forEach(r=>{const o=this.controls[r];o&&o.patchValue(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((r,o)=>{r.reset(t[o],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,r)=>(t[r]=e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,r)=>!!r._syncPendingControls()||e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{const r=this.controls[e];r&&t(r,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const[e,r]of Object.entries(this.controls))if(this.contains(e)&&t(r))return!0;return!1}_reduceValue(){return this._reduceChildren({},(e,r,o)=>((r.enabled||this.disabled)&&(e[o]=r.value),e))}_reduceChildren(t,e){let r=t;return this._forEachChild((o,i)=>{r=e(r,o,i)}),r}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}}class eM extends Hd{}function gg(n,t){return[...t.path,n]}function Wd(n,t){s0(n,t),t.valueAccessor.writeValue(n.value),n.disabled&&t.valueAccessor.setDisabledState?.(!0),function f6(n,t){t.valueAccessor.registerOnChange(e=>{n._pendingValue=e,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&tM(n,t)})}(n,t),function p6(n,t){const e=(r,o)=>{t.valueAccessor.writeValue(r),o&&t.viewToModelUpdate(r)};n.registerOnChange(e),t._registerOnDestroy(()=>{n._unregisterOnChange(e)})}(n,t),function h6(n,t){t.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&tM(n,t),"submit"!==n.updateOn&&n.markAsTouched()})}(n,t),function d6(n,t){if(t.valueAccessor.setDisabledState){const e=r=>{t.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(e),t._registerOnDestroy(()=>{n._unregisterOnDisabledChange(e)})}}(n,t)}function mg(n,t,e=!0){const r=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(r),t.valueAccessor.registerOnTouched(r)),yg(n,t),n&&(t._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function vg(n,t){n.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function s0(n,t){const e=WT(n);null!==t.validator?n.setValidators(HT(e,t.validator)):"function"==typeof e&&n.setValidators([e]);const r=zT(n);null!==t.asyncValidator?n.setAsyncValidators(HT(r,t.asyncValidator)):"function"==typeof r&&n.setAsyncValidators([r]);const o=()=>n.updateValueAndValidity();vg(t._rawValidators,o),vg(t._rawAsyncValidators,o)}function yg(n,t){let e=!1;if(null!==n){if(null!==t.validator){const o=WT(n);if(Array.isArray(o)&&o.length>0){const i=o.filter(s=>s!==t.validator);i.length!==o.length&&(e=!0,n.setValidators(i))}}if(null!==t.asyncValidator){const o=zT(n);if(Array.isArray(o)&&o.length>0){const i=o.filter(s=>s!==t.asyncValidator);i.length!==o.length&&(e=!0,n.setAsyncValidators(i))}}}const r=()=>{};return vg(t._rawValidators,r),vg(t._rawAsyncValidators,r),e}function tM(n,t){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function a0(n,t){if(!n.hasOwnProperty("model"))return!1;const e=n.model;return!!e.isFirstChange()||!Object.is(t,e.currentValue)}function u0(n,t){if(!t)return null;let e,r,o;return Array.isArray(t),t.forEach(i=>{i.constructor===bl?e=i:function v6(n){return Object.getPrototypeOf(n.constructor)===Wa}(i)?r=i:o=i}),o||r||e||null}function iM(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}function sM(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const $d=class extends pg{constructor(t=null,e,r){super(r0(e),o0(r,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),hg(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=sM(t)?t.value:t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){iM(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){iM(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){sM(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}},x6={provide:Ys,useExisting:wt(()=>c0)},lM=(()=>Promise.resolve())();let c0=(()=>{class n extends Ys{constructor(e,r,o,i,s){super(),this._changeDetectorRef=s,this.control=new $d,this._registered=!1,this.update=new Qt,this._parent=e,this._setValidators(r),this._setAsyncValidators(o),this.valueAccessor=u0(0,i)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const r=e.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),a0(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Wd(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){lM.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){const r=e.isDisabled.currentValue,o=0!==r&&qi(r);lM.then(()=>{o&&!this.control.disabled?this.control.disable():!o&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?gg(e,this._parent):[e]}}return n.\u0275fac=function(e){return new(e||n)(X(wr,9),X(Jn,10),X(Xs,10),X(ii,10),X(mp,8))},n.\u0275dir=Ie({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Lt([x6]),_t,Ir]}),n})(),wg=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Ie({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),n})();const C6={provide:ii,useExisting:wt(()=>d0),multi:!0};let d0=(()=>{class n extends Wa{writeValue(e){this.setProperty("value",e??"")}registerOnChange(e){this.onChange=r=>{e(""==r?null:parseFloat(r))}}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Yn(n)))(r||n)}}(),n.\u0275dir=Ie({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(e,r){1&e&&pt("input",function(i){return r.onChange(i.target.value)})("blur",function(){return r.onTouched()})},features:[Lt([C6]),_t]}),n})();const E6={provide:ii,useExisting:wt(()=>f0),multi:!0};let cM=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Tn({type:n}),n.\u0275inj=wn({}),n})(),D6=(()=>{class n{constructor(){this._accessors=[]}add(e,r){this._accessors.push([e,r])}remove(e){for(let r=this._accessors.length-1;r>=0;--r)if(this._accessors[r][1]===e)return void this._accessors.splice(r,1)}select(e){this._accessors.forEach(r=>{this._isSameGroup(r,e)&&r[1]!==e&&r[1].fireUncheck(e.value)})}_isSameGroup(e,r){return!!e[0].control&&e[0]._parent===r._control._parent&&e[1].name===r.name}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=fe({token:n,factory:n.\u0275fac,providedIn:cM}),n})(),f0=(()=>{class n extends Wa{constructor(e,r,o,i){super(e,r),this._registry=o,this._injector=i,this.onChange=()=>{}}ngOnInit(){this._control=this._injector.get(Ys),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(e){this._state=e===this.value,this.setProperty("checked",this._state)}registerOnChange(e){this._fn=e,this.onChange=()=>{e(this.value),this._registry.select(this)}}fireUncheck(e){this.writeValue(e)}_checkName(){!this.name&&this.formControlName&&(this.name=this.formControlName)}}return n.\u0275fac=function(e){return new(e||n)(X(Ui),X(Ur),X(D6),X(jr))},n.\u0275dir=Ie({type:n,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(e,r){1&e&&pt("change",function(){return r.onChange()})("blur",function(){return r.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[Lt([E6]),_t]}),n})();const h0=new _e("NgModelWithFormControlWarning"),A6={provide:wr,useExisting:wt(()=>xl)};let xl=(()=>{class n extends wr{constructor(e,r){super(),this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Qt,this._setValidators(e),this._setAsyncValidators(r)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(yg(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){const r=this.form.get(e.path);return Wd(r,e),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),r}getControl(e){return this.form.get(e.path)}removeControl(e){mg(e.control||null,e,!1),function y6(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,r){this.form.get(e.path).setValue(r)}onSubmit(e){return this.submitted=!0,function oM(n,t){n._syncPendingControls(),t.forEach(e=>{const r=e.control;"submit"===r.updateOn&&r._pendingChange&&(e.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}(this.form,this.directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_updateDomValue(){this.directives.forEach(e=>{const r=e.control,o=this.form.get(e.path);r!==o&&(mg(r||null,e),(n=>n instanceof $d)(o)&&(Wd(o,e),e.control=o))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){const r=this.form.get(e.path);(function nM(n,t){s0(n,t)})(r,e),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){const r=this.form.get(e.path);r&&function g6(n,t){return yg(n,t)}(r,e)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){s0(this.form,this),this._oldForm&&yg(this._oldForm,this)}_checkFormPresent(){}}return n.\u0275fac=function(e){return new(e||n)(X(Jn,10),X(Xs,10))},n.\u0275dir=Ie({type:n,selectors:[["","formGroup",""]],hostBindings:function(e,r){1&e&&pt("submit",function(i){return r.onSubmit(i)})("reset",function(){return r.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Lt([A6]),_t,Ir]}),n})();const k6={provide:Ys,useExisting:wt(()=>Gd)};let Gd=(()=>{class n extends Ys{constructor(e,r,o,i,s){super(),this._ngModelWarningConfig=s,this._added=!1,this.update=new Qt,this._ngModelWarningSent=!1,this._parent=e,this._setValidators(r),this._setAsyncValidators(o),this.valueAccessor=u0(0,i)}set isDisabled(e){}ngOnChanges(e){this._added||this._setUpControl(),a0(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return gg(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}}return n._ngModelWarningSentOnce=!1,n.\u0275fac=function(e){return new(e||n)(X(wr,13),X(Jn,10),X(Xs,10),X(ii,10),X(h0,8))},n.\u0275dir=Ie({type:n,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[Lt([k6]),_t,Ir]}),n})();const R6={provide:ii,useExisting:wt(()=>bg),multi:!0};function pM(n,t){return null==n?`${t}`:(t&&"object"==typeof t&&(t="Object"),`${n}: ${t}`.slice(0,50))}let bg=(()=>{class n extends Wa{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const o=pM(this._getOptionId(e),e);this.setProperty("value",o)}registerOnChange(e){this.onChange=r=>{this.value=this._getOptionValue(r),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const r of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(r),e))return r;return null}_getOptionValue(e){const r=function N6(n){return n.split(":")[0]}(e);return this._optionMap.has(r)?this._optionMap.get(r):e}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Yn(n)))(r||n)}}(),n.\u0275dir=Ie({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,r){1&e&&pt("change",function(i){return r.onChange(i.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[Lt([R6]),_t]}),n})(),gM=(()=>{class n{constructor(e,r,o){this._element=e,this._renderer=r,this._select=o,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(pM(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(e){return new(e||n)(X(Ur),X(Ui),X(bg,9))},n.\u0275dir=Ie({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})();const F6={provide:ii,useExisting:wt(()=>m0),multi:!0};function mM(n,t){return null==n?`${t}`:("string"==typeof t&&(t=`'${t}'`),t&&"object"==typeof t&&(t="Object"),`${n}: ${t}`.slice(0,50))}let m0=(()=>{class n extends Wa{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let r;if(this.value=e,Array.isArray(e)){const o=e.map(i=>this._getOptionId(i));r=(i,s)=>{i._setSelected(o.indexOf(s.toString())>-1)}}else r=(o,i)=>{o._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(e){this.onChange=r=>{const o=[],i=r.selectedOptions;if(void 0!==i){const s=i;for(let a=0;a<s.length;a++){const l=this._getOptionValue(s[a].value);o.push(l)}}else{const s=r.options;for(let a=0;a<s.length;a++){const u=s[a];if(u.selected){const l=this._getOptionValue(u.value);o.push(l)}}}this.value=o,e(o)}}_registerOption(e){const r=(this._idCounter++).toString();return this._optionMap.set(r,e),r}_getOptionId(e){for(const r of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(r)._value,e))return r;return null}_getOptionValue(e){const r=function P6(n){return n.split(":")[0]}(e);return this._optionMap.has(r)?this._optionMap.get(r)._value:e}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Yn(n)))(r||n)}}(),n.\u0275dir=Ie({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,r){1&e&&pt("change",function(i){return r.onChange(i.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[Lt([F6]),_t]}),n})(),vM=(()=>{class n{constructor(e,r,o){this._element=e,this._renderer=r,this._select=o,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(mM(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(mM(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(e){return new(e||n)(X(Ur),X(Ui),X(m0,9))},n.\u0275dir=Ie({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})(),IM=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Tn({type:n}),n.\u0275inj=wn({imports:[cM]}),n})(),y0=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Tn({type:n}),n.\u0275inj=wn({imports:[IM]}),n})(),_g=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:h0,useValue:e.warnOnNgModelWithFormControl}]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Tn({type:n}),n.\u0275inj=wn({imports:[IM]}),n})();class AM extends pg{constructor(t,e,r){super(r0(e),o0(r,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(t){return this.controls[this._adjustIndex(t)]}push(t,e={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(t,e,r={}){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(t,e={}){let r=this._adjustIndex(t);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(t,e,r={}){let o=this._adjustIndex(t);o<0&&(o=0),this.controls[o]&&this.controls[o]._registerOnCollectionChange(()=>{}),this.controls.splice(o,1),e&&(this.controls.splice(o,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){JT(this,0,t),t.forEach((r,o)=>{ZT(this,!1,o),this.at(o).setValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(t.forEach((r,o)=>{this.at(o)&&this.at(o).patchValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t=[],e={}){this._forEachChild((r,o)=>{r.reset(t[o],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t.getRawValue())}clear(t={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_adjustIndex(t){return t<0?t+this.length:t}_syncPendingControls(){let t=this.controls.reduce((e,r)=>!!r._syncPendingControls()||e,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((e,r)=>{t(e,r)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}_find(t){return this.at(t)??null}}function TM(n){return!!n&&(void 0!==n.asyncValidators||void 0!==n.validators||void 0!==n.updateOn)}let w0=(()=>{class n{constructor(){this.useNonNullable=!1}get nonNullable(){const e=new n;return e.useNonNullable=!0,e}group(e,r=null){const o=this._reduceControls(e);let i={};return TM(r)?i=r:null!==r&&(i.validators=r.validator,i.asyncValidators=r.asyncValidator),new Hd(o,i)}record(e,r=null){const o=this._reduceControls(e);return new eM(o,r)}control(e,r,o){let i={};return this.useNonNullable?(TM(r)?i=r:(i.validators=r,i.asyncValidators=o),new $d(e,{...i,nonNullable:!0})):new $d(e,r,o)}array(e,r,o){const i=e.map(s=>this._createControl(s));return new AM(i,r,o)}_reduceControls(e){const r={};return Object.keys(e).forEach(o=>{r[o]=this._createControl(e[o])}),r}_createControl(e){return e instanceof $d||e instanceof pg?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=fe({token:n,factory:n.\u0275fac,providedIn:_g}),n})();class MM{}const es="*";function kM(n,t){return{type:7,name:n,definitions:t,options:{}}}function RM(n,t=null){return{type:4,styles:t,timings:n}}function NM(n,t=null){return{type:2,steps:n,options:t}}function Cl(n){return{type:6,styles:n,offset:null}}function FM(n,t,e=null){return{type:1,expr:n,animation:t,options:e}}function PM(n){Promise.resolve().then(n)}class qd{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){PM(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}class OM{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,r=0,o=0;const i=this.players.length;0==i?PM(()=>this._onFinish()):this.players.forEach(s=>{s.onDone(()=>{++e==i&&this._onFinish()}),s.onDestroy(()=>{++r==i&&this._onDestroy()}),s.onStart(()=>{++o==i&&this._onStart()})}),this.totalTime=this.players.reduce((s,a)=>Math.max(s,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(r=>{const o=r.totalTime?Math.min(1,e/r.totalTime):1;r.setPosition(o)})}getPosition(){const t=this.players.reduce((e,r)=>null===e||r.totalTime>e.totalTime?r:e,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}var $6=sr(226),_0=sr.n($6);function xg(n,t=!1){_0().fire({title:"TIMT SAY",text:n,icon:"success",showCancelButton:t,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"OK"})}function Qs(n,t=!1){_0().fire({title:"TIMT SAY",text:n,icon:"error",showCancelButton:t,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"OK"})}function Zs(n,t=!1){_0().fire({title:"TIMT SAY",text:n,icon:"warning",showCancelButton:t,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"OK"})}function ai(){return localStorage.getItem("token")?localStorage.getItem("token"):null}const El_apiUrl="https://api.timt.in";class LM{}class BM{}class Vn{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(e=>{const r=e.indexOf(":");if(r>0){const o=e.slice(0,r),i=o.toLowerCase(),s=e.slice(r+1).trim();this.maybeSetNormalizedName(o,i),this.headers.has(i)?this.headers.get(i).push(s):this.headers.set(i,[s])}})}:()=>{this.headers=new Map,Object.keys(t).forEach(e=>{let r=t[e];const o=e.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(this.headers.set(o,r),this.maybeSetNormalizedName(e,o))})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof Vn?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new Vn;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof Vn?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let r=t.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(t.name,e);const o=("a"===t.op?this.headers.get(e):void 0)||[];o.push(...r),this.headers.set(e,o);break;case"d":const i=t.value;if(i){let s=this.headers.get(e);if(!s)return;s=s.filter(a=>-1===i.indexOf(a)),0===s.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,s)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class q6{encodeKey(t){return VM(t)}encodeValue(t){return VM(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const X6=/%(\d[a-f0-9])/gi,Y6={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function VM(n){return encodeURIComponent(n).replace(X6,(t,e)=>Y6[e]??t)}function Cg(n){return`${n}`}class Js{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new q6,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function K6(n,t){const e=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(o=>{const i=o.indexOf("="),[s,a]=-1==i?[t.decodeKey(o),""]:[t.decodeKey(o.slice(0,i)),t.decodeValue(o.slice(i+1))],u=e.get(s)||[];u.push(a),e.set(s,u)}),e}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const r=t.fromObject[e],o=Array.isArray(r)?r.map(Cg):[Cg(r)];this.map.set(e,o)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){const e=[];return Object.keys(t).forEach(r=>{const o=t[r];Array.isArray(o)?o.forEach(i=>{e.push({param:r,value:i,op:"a"})}):e.push({param:r,value:o,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(r=>e+"="+this.encoder.encodeValue(r)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new Js({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(Cg(t.value)),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let r=this.map.get(t.param)||[];const o=r.indexOf(Cg(t.value));-1!==o&&r.splice(o,1),r.length>0?this.map.set(t.param,r):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class Q6{constructor(){this.map=new Map}set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}}function UM(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function jM(n){return typeof Blob<"u"&&n instanceof Blob}function HM(n){return typeof FormData<"u"&&n instanceof FormData}class Kd{constructor(t,e,r,o){let i;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function Z6(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||o?(this.body=void 0!==r?r:null,i=o):i=r,i&&(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.context&&(this.context=i.context),i.params&&(this.params=i.params)),this.headers||(this.headers=new Vn),this.context||(this.context=new Q6),this.params){const s=this.params.toString();if(0===s.length)this.urlWithParams=e;else{const a=e.indexOf("?");this.urlWithParams=e+(-1===a?"?":a<e.length-1?"&":"")+s}}else this.params=new Js,this.urlWithParams=e}serializeBody(){return null===this.body?null:UM(this.body)||jM(this.body)||HM(this.body)||function J6(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Js?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||HM(this.body)?null:jM(this.body)?this.body.type||null:UM(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Js?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(t={}){const e=t.method||this.method,r=t.url||this.url,o=t.responseType||this.responseType,i=void 0!==t.body?t.body:this.body,s=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,a=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let u=t.headers||this.headers,l=t.params||this.params;const c=t.context??this.context;return void 0!==t.setHeaders&&(u=Object.keys(t.setHeaders).reduce((d,f)=>d.set(f,t.setHeaders[f]),u)),t.setParams&&(l=Object.keys(t.setParams).reduce((d,f)=>d.set(f,t.setParams[f]),l)),new Kd(e,r,i,{params:l,headers:u,context:c,reportProgress:a,responseType:o,withCredentials:s})}}var hn=(()=>((hn=hn||{})[hn.Sent=0]="Sent",hn[hn.UploadProgress=1]="UploadProgress",hn[hn.ResponseHeader=2]="ResponseHeader",hn[hn.DownloadProgress=3]="DownloadProgress",hn[hn.Response=4]="Response",hn[hn.User=5]="User",hn))();class x0{constructor(t,e=200,r="OK"){this.headers=t.headers||new Vn,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class C0 extends x0{constructor(t={}){super(t),this.type=hn.ResponseHeader}clone(t={}){return new C0({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class Eg extends x0{constructor(t={}){super(t),this.type=hn.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new Eg({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class WM extends x0{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function E0(n,t){return{body:t,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let $a=(()=>{class n{constructor(e){this.handler=e}request(e,r,o={}){let i;if(e instanceof Kd)i=e;else{let u,l;u=o.headers instanceof Vn?o.headers:new Vn(o.headers),o.params&&(l=o.params instanceof Js?o.params:new Js({fromObject:o.params})),i=new Kd(e,r,void 0!==o.body?o.body:null,{headers:u,context:o.context,params:l,reportProgress:o.reportProgress,responseType:o.responseType||"json",withCredentials:o.withCredentials})}const s=De(i).pipe($s(u=>this.handler.handle(u)));if(e instanceof Kd||"events"===o.observe)return s;const a=s.pipe(Yi(u=>u instanceof Eg));switch(o.observe||"body"){case"body":switch(i.responseType){case"arraybuffer":return a.pipe(Ge(u=>{if(null!==u.body&&!(u.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return u.body}));case"blob":return a.pipe(Ge(u=>{if(null!==u.body&&!(u.body instanceof Blob))throw new Error("Response is not a Blob.");return u.body}));case"text":return a.pipe(Ge(u=>{if(null!==u.body&&"string"!=typeof u.body)throw new Error("Response is not a string.");return u.body}));default:return a.pipe(Ge(u=>u.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${o.observe}}`)}}delete(e,r={}){return this.request("DELETE",e,r)}get(e,r={}){return this.request("GET",e,r)}head(e,r={}){return this.request("HEAD",e,r)}jsonp(e,r){return this.request("JSONP",e,{params:(new Js).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,r={}){return this.request("OPTIONS",e,r)}patch(e,r,o={}){return this.request("PATCH",e,E0(o,r))}post(e,r,o={}){return this.request("POST",e,E0(o,r))}put(e,r,o={}){return this.request("PUT",e,E0(o,r))}}return n.\u0275fac=function(e){return new(e||n)(re(LM))},n.\u0275prov=fe({token:n,factory:n.\u0275fac}),n})();class zM{constructor(t,e){this.next=t,this.interceptor=e}handle(t){return this.interceptor.intercept(t,this.next)}}const D0=new _e("HTTP_INTERCEPTORS");let eG=(()=>{class n{intercept(e,r){return r.handle(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=fe({token:n,factory:n.\u0275fac}),n})();const tG=/^\)\]\}',?\n/;let $M=(()=>{class n{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new Rt(r=>{const o=this.xhrFactory.build();if(o.open(e.method,e.urlWithParams),e.withCredentials&&(o.withCredentials=!0),e.headers.forEach((h,p)=>o.setRequestHeader(h,p.join(","))),e.headers.has("Accept")||o.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const h=e.detectContentTypeHeader();null!==h&&o.setRequestHeader("Content-Type",h)}if(e.responseType){const h=e.responseType.toLowerCase();o.responseType="json"!==h?h:"text"}const i=e.serializeBody();let s=null;const a=()=>{if(null!==s)return s;const h=o.statusText||"OK",p=new Vn(o.getAllResponseHeaders()),m=function nG(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(o)||e.url;return s=new C0({headers:p,status:o.status,statusText:h,url:m}),s},u=()=>{let{headers:h,status:p,statusText:m,url:v}=a(),y=null;204!==p&&(y=typeof o.response>"u"?o.responseText:o.response),0===p&&(p=y?200:0);let _=p>=200&&p<300;if("json"===e.responseType&&"string"==typeof y){const b=y;y=y.replace(tG,"");try{y=""!==y?JSON.parse(y):null}catch(x){y=b,_&&(_=!1,y={error:x,text:y})}}_?(r.next(new Eg({body:y,headers:h,status:p,statusText:m,url:v||void 0})),r.complete()):r.error(new WM({error:y,headers:h,status:p,statusText:m,url:v||void 0}))},l=h=>{const{url:p}=a(),m=new WM({error:h,status:o.status||0,statusText:o.statusText||"Unknown Error",url:p||void 0});r.error(m)};let c=!1;const d=h=>{c||(r.next(a()),c=!0);let p={type:hn.DownloadProgress,loaded:h.loaded};h.lengthComputable&&(p.total=h.total),"text"===e.responseType&&!!o.responseText&&(p.partialText=o.responseText),r.next(p)},f=h=>{let p={type:hn.UploadProgress,loaded:h.loaded};h.lengthComputable&&(p.total=h.total),r.next(p)};return o.addEventListener("load",u),o.addEventListener("error",l),o.addEventListener("timeout",l),o.addEventListener("abort",l),e.reportProgress&&(o.addEventListener("progress",d),null!==i&&o.upload&&o.upload.addEventListener("progress",f)),o.send(i),r.next({type:hn.Sent}),()=>{o.removeEventListener("error",l),o.removeEventListener("abort",l),o.removeEventListener("load",u),o.removeEventListener("timeout",l),e.reportProgress&&(o.removeEventListener("progress",d),null!==i&&o.upload&&o.upload.removeEventListener("progress",f)),o.readyState!==o.DONE&&o.abort()}})}}return n.\u0275fac=function(e){return new(e||n)(re(UI))},n.\u0275prov=fe({token:n,factory:n.\u0275fac}),n})();const S0=new _e("XSRF_COOKIE_NAME"),I0=new _e("XSRF_HEADER_NAME");class GM{}let rG=(()=>{class n{constructor(e,r,o){this.doc=e,this.platform=r,this.cookieName=o,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=AI(e,this.cookieName),this.lastCookieString=e),this.lastToken}}return n.\u0275fac=function(e){return new(e||n)(re(Ln),re(Bw),re(S0))},n.\u0275prov=fe({token:n,factory:n.\u0275fac}),n})(),A0=(()=>{class n{constructor(e,r){this.tokenService=e,this.headerName=r}intercept(e,r){const o=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||o.startsWith("http://")||o.startsWith("https://"))return r.handle(e);const i=this.tokenService.getToken();return null!==i&&!e.headers.has(this.headerName)&&(e=e.clone({headers:e.headers.set(this.headerName,i)})),r.handle(e)}}return n.\u0275fac=function(e){return new(e||n)(re(GM),re(I0))},n.\u0275prov=fe({token:n,factory:n.\u0275fac}),n})(),oG=(()=>{class n{constructor(e,r){this.backend=e,this.injector=r,this.chain=null}handle(e){if(null===this.chain){const r=this.injector.get(D0,[]);this.chain=r.reduceRight((o,i)=>new zM(o,i),this.backend)}return this.chain.handle(e)}}return n.\u0275fac=function(e){return new(e||n)(re(BM),re(jr))},n.\u0275prov=fe({token:n,factory:n.\u0275fac}),n})(),iG=(()=>{class n{static disable(){return{ngModule:n,providers:[{provide:A0,useClass:eG}]}}static withOptions(e={}){return{ngModule:n,providers:[e.cookieName?{provide:S0,useValue:e.cookieName}:[],e.headerName?{provide:I0,useValue:e.headerName}:[]]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Tn({type:n}),n.\u0275inj=wn({providers:[A0,{provide:D0,useExisting:A0,multi:!0},{provide:GM,useClass:rG},{provide:S0,useValue:"XSRF-TOKEN"},{provide:I0,useValue:"X-XSRF-TOKEN"}]}),n})(),sG=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Tn({type:n}),n.\u0275inj=wn({providers:[$a,{provide:LM,useClass:oG},$M,{provide:BM,useExisting:$M}],imports:[iG.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]}),n})(),aG=(()=>{class n{constructor(e){this.http=e,this.apiUrl=El_apiUrl}login(e,r){return this.http.post(`${this.apiUrl}/login`,{username:e,password:r},{headers:{"Content-Type":"application/json"}})}}return n.\u0275fac=function(e){return new(e||n)(re($a))},n.\u0275prov=fe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function uG(n,t){if(1&n){const e=So();Z(0,"form",4),pt("ngSubmit",function(){return Kn(e),Xn(dt().onSubmit())}),Z(1,"div",5)(2,"label",6),xo(),Z(3,"svg",7),ye(4,"path",8)(5,"path",9),te(),Co(),ye(6,"input",10),te()(),Z(7,"div",5)(8,"label",6),xo(),Z(9,"svg",7),ye(10,"path",11),te(),Co(),ye(11,"input",12),te()(),Z(12,"div",13)(13,"button",14),Ee(14," Login "),te()()()}2&n&&Ce("formGroup",dt().loginForm)}let lG=(()=>{class n{constructor(e,r,o){this.fb=e,this.loginService=r,this.router=o}ngOnInit(){this.loginForm=this.fb.group({username:["",si.required],password:["",si.required]})}ngOnDestroy(){this.loginServiceHolder&&this.loginServiceHolder.unsubscribe()}onSubmit(){if(this.loginForm&&this.loginForm.valid){const{username:e,password:r}=this.loginForm.value;this.loginServiceHolder=this.loginService.login(e,r).subscribe(o=>{console.log(o),o.token&&o.lable&&(localStorage.setItem("token",o.token),localStorage.setItem("lable",o.lable),o.info?(localStorage.setItem("info",JSON.stringify(o.info)),this.router.navigate(["/"]),xg("Login successful")):this.router.navigate(["/me_data"]))},o=>{Qs(o.error.message),this.errorMessage="Login failed"})}else Zs("Please fill all the fields"),this.errorMessage="Form is invalid"}}return n.\u0275fac=function(e){return new(e||n)(X(w0),X(aG),X(Wt))},n.\u0275cmp=bn({type:n,selectors:[["app-login"]],decls:4,vars:2,consts:[[1,"h-full","w-full","login-container","bg-[#00000070]",2,"display","flex","justify-content","center","align-items","center","flex-direction","column"],[1,"w-72","m-1"],["src","assets/imgs/user-286-512.png",1,"w-full"],[3,"formGroup","ngSubmit",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"w-72","m-3"],[1,"input","input-bordered","flex","items-center","gap-2"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 16 16","fill","currentColor",1,"h-4","w-4","opacity-70"],["d","M2.5 3A1.5 1.5 0 0 0 1 4.5v.793c.026.009.051.02.076.032L7.674 8.51c.206.1.446.1.652 0l6.598-3.185A.755.755 0 0 1 15 5.293V4.5A1.5 1.5 0 0 0 13.5 3h-11Z"],["d","M15 6.954 8.978 9.86a2.25 2.25 0 0 1-1.956 0L1 6.954V11.5A1.5 1.5 0 0 0 2.5 13h11a1.5 1.5 0 0 0 1.5-1.5V6.954Z"],["type","text","formControlName","username","placeholder","Email",1,"grow"],["fill-rule","evenodd","d","M14 6a4 4 0 0 1-4.899 3.899l-1.955 1.955a.5.5 0 0 1-.353.146H5v1.5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5v-2.293a.5.5 0 0 1 .146-.353l3.955-3.955A4 4 0 1 1 14 6Zm-4-2a.75.75 0 0 0 0 1.5.5.5 0 0 1 .5.5.75.75 0 0 0 1.5 0 2 2 0 0 0-2-2Z","clip-rule","evenodd"],["type","password","formControlName","password","value","password","placeholder","Password ddmmyyyy",1,"grow"],[1,"w-72","m-1","text-center"],["type","submit",1,"w-50","select-none","rounded-lg","bg-blue-500","py-3","px-6","text-center","align-middle","font-sans","text-xs","font-bold","uppercase","text-white","shadow-md","shadow-blue-500/20","transition-all","hover:shadow-lg","hover:shadow-blue-500/40","focus:opacity-[0.85]","focus:shadow-none","active:opacity-[0.85]","active:shadow-none","disabled:pointer-events-none","disabled:opacity-50","disabled:shadow-none"]],template:function(e,r){1&e&&(Z(0,"div",0)(1,"div",1),ye(2,"img",2),te(),et(3,uG,15,1,"form",3),te()),2&e&&(Ce("@bounceUp",void 0),xe(3),Ce("ngIf",r.loginForm))},dependencies:[Hs,wg,bl,Vd,cg,xl,Gd],data:{animation:[kM("bounceUp",[FM(":enter",[Cl({transform:"translateY(100%)",opacity:0}),RM("0.6s ease-out",Cl({transform:"translateY(0)",opacity:1}))])])]}}),n})(),cG=(()=>{class n{constructor(e){this.router=e}ngOnInit(){localStorage.getItem("token")&&localStorage.removeItem("token"),localStorage.getItem("PInfo")&&localStorage.removeItem("PInfo")}logout(){localStorage.clear(),this.router.navigate(["/login"])}}return n.\u0275fac=function(e){return new(e||n)(X(Wt))},n.\u0275cmp=bn({type:n,selectors:[["app-logout"]],decls:8,vars:1,consts:[[1,"w-full","h-full",2,"display","flex","justify-content","center","align-items","center","flex-direction","column"],[1,"w-72","h-72"],["src","assets/imgs/verified_7641727.png",1,"w-full"],[1,"text-center"],["type","button",1,"w-50","mt-3","select-none","rounded-lg","bg-blue-500","py-3","px-6","text-center","align-middle","font-sans","text-xs","font-bold","uppercase","text-white","shadow-md","shadow-blue-500/20","transition-all","hover:shadow-lg","hover:shadow-blue-500/40","focus:opacity-[0.85]","focus:shadow-none","active:opacity-[0.85]","active:shadow-none","disabled:pointer-events-none","disabled:opacity-50","disabled:shadow-none",3,"click"]],template:function(e,r){1&e&&(Z(0,"div",0)(1,"div",1),ye(2,"img",2),te(),Z(3,"div",3)(4,"h1"),Ee(5,"Successfully Logout!"),te(),Z(6,"button",4),pt("click",function(){return r.logout()}),Ee(7," Login Again "),te()()()),2&e&&(xe(1),Ce("@bounceUp",void 0))},data:{animation:[kM("bounceUp",[FM(":enter",[Cl({transform:"translateY(100%)",opacity:0}),RM("0.6s ease-out",Cl({transform:"translateY(0)",opacity:1}))])])]}}),n})();function dG(n,t){if(1&n&&(Z(0,"h5",5),Ee(1),te()),2&n){const e=dt();xe(1),Wr(e.title)}}const fG=function(n){return{"background-image":n}};let hG=(()=>{class n{constructor(e){this.router=e}ngOnInit(){}clickBtn(){this.link?.startsWith("https://")&&(window.location.href=this.link),this.link&&this.router.navigate([this.link])}}return n.\u0275fac=function(e){return new(e||n)(X(Wt))},n.\u0275cmp=bn({type:n,selectors:[["app-card"]],inputs:{img:"img",title:"title",link:"link"},decls:5,vars:4,consts:[[1,"w-[100px]","h-[100px]","m-2",3,"click"],[1,"w-full","h-[75%]"],[1,"h-full","w-full",2,"background-repeat","no-repeat","background-position","center","background-size","40px 40px",3,"ngStyle"],[1,"w-full","h-[25%]","text-wrap","text-center"],["class","mb-2  decoration-auto tracking-tight text-gray-900 dark:text-white",4,"ngIf"],[1,"mb-2","decoration-auto","tracking-tight","text-gray-900","dark:text-white"]],template:function(e,r){1&e&&(Z(0,"div",0),pt("click",function(){return r.clickBtn()}),Z(1,"div",1),ye(2,"div",2),te(),Z(3,"div",3),et(4,dG,2,1,"h5",4),te()()),2&e&&(xe(2),Ce("ngStyle",function r2(n,t,e,r){return o2(ee(),pr(),n,t,e,r)}(2,fG,"url("+r.img+")")),xe(2),Ce("ngIf",r.title))},dependencies:[Hs,PI],styles:[".conent-img[_ngcontent-%COMP%]{background:center center no-repeat;background-size:contain}"]}),n})();const pG=["navImg"];function gG(n,t){1&n&&ye(0,"app-card",19)}function mG(n,t){1&n&&ye(0,"app-card",19)}function vG(n,t){1&n&&ye(0,"app-card",19)}function yG(n,t){1&n&&ye(0,"app-card",19)}function wG(n,t){1&n&&ye(0,"app-card",19)}function bG(n,t){1&n&&ye(0,"app-card",19)}let qM=(()=>{class n{constructor(e){this.router=e,this.user=localStorage.getItem("info"),this.lable=localStorage.getItem("lable"),this.storedLocation={lat:0,lng:0}}ngOnInit(){this.user&&(this.user=JSON.parse(this.user),this.user.name=function G6(n){return n.split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}(this.user.name)),setTimeout(()=>{this.user?.img&&this.navImg&&(this.navImg.nativeElement.src=this.user.img)},0)}setting(){this.router.navigate(["setting"])}notify(){this.router.navigate(["notify"])}}return n.\u0275fac=function(e){return new(e||n)(X(Wt))},n.\u0275cmp=bn({type:n,selectors:[["app-dashbord"]],viewQuery:function(e,r){if(1&e&&lp(pG,5),2&e){let o;ll(o=cl())&&(r.navImg=o.first)}},decls:49,vars:7,consts:[[1,"w-full","h-full"],[1,"navbar","bg-base-100","fixed","z-50",2,"border-bottom","1px solid gray"],[1,"flex-1"],[1,"btn","btn-ghost","text-xl"],[1,"flex-none","gap-2"],[1,"dropdown","dropdown-end"],["tabindex","0","role","button",1,"btn","btn-ghost","btn-circle","avatar"],[1,"w-10","rounded-full"],["alt","user","src","assets/imgs/user-286-64.png"],["navImg",""],["tabindex","0",1,"menu","menu-sm","dropdown-content","bg-base-100","rounded-box","z-[1]","mt-3","w-52","p-2","shadow"],["routerLink","/me_data"],["routerLink","/logout"],[1,"flex","flex-wrap","h-auto","w-full","pb-12","absolute","top-14","p-1",2,"justify-content","space-around"],["img","assets/imgs/icon/school/college.png","title","Attendance","link","attendance"],["img","assets/imgs/icon/school/presentation.png","title","Classes","link","classes"],["img","assets/imgs/icon/school/certificate.png","title","NoticBord","link","notic_bord"],["img","assets/imgs/icon/school/university.png","title","Payment","link",""],["img","assets/imgs/icon/school/university.png","title","Token","link","token",4,"ngIf"],["img","assets/imgs/icon/school/university.png","title","Token","link","token"]],template:function(e,r){1&e&&(Z(0,"div",0)(1,"div",1)(2,"div",2)(3,"a",3),Ee(4),te()(),Z(5,"div",4)(6,"div",5)(7,"div",6)(8,"div",7),ye(9,"img",8,9),te()(),Z(11,"ul",10)(12,"li")(13,"a",11),Ee(14,"Settings"),te()(),Z(15,"li")(16,"a",12),Ee(17,"Logout"),te()()()()()(),Z(18,"div",13),ye(19,"app-card",14)(20,"app-card",15)(21,"app-card",16)(22,"app-card",17),et(23,gG,1,0,"app-card",18),ye(24,"app-card",14)(25,"app-card",15)(26,"app-card",16)(27,"app-card",17),et(28,mG,1,0,"app-card",18),ye(29,"app-card",14)(30,"app-card",15)(31,"app-card",16)(32,"app-card",17),et(33,vG,1,0,"app-card",18),ye(34,"app-card",14)(35,"app-card",15)(36,"app-card",16)(37,"app-card",17),et(38,yG,1,0,"app-card",18),ye(39,"app-card",14)(40,"app-card",15)(41,"app-card",16)(42,"app-card",17),et(43,wG,1,0,"app-card",18),ye(44,"app-card",14)(45,"app-card",15)(46,"app-card",16)(47,"app-card",17),et(48,bG,1,0,"app-card",18),te()()),2&e&&(xe(4),Wr(null==r.user?null:r.user.name),xe(19),Ce("ngIf","1"==r.lable||"2"==r.lable),xe(5),Ce("ngIf","1"==r.lable||"2"==r.lable),xe(5),Ce("ngIf","1"==r.lable||"2"==r.lable),xe(5),Ce("ngIf","1"==r.lable||"2"==r.lable),xe(5),Ce("ngIf","1"==r.lable||"2"==r.lable),xe(5),Ce("ngIf","1"==r.lable||"2"==r.lable))},dependencies:[Hs,hG,og]}),n})();function ui(n,t){const e="object"==typeof t;return new Promise((r,o)=>{const i=new en({next:s=>{r(s),i.unsubscribe()},error:o,complete:()=>{e?r(t.defaultValue):o(new xd)}});n.subscribe(i)})}let _G=(()=>{class n{constructor(e){this.http=e,this.apiUrl=El_apiUrl}postInfo(e){const r=`${this.apiUrl}/user_info`,o=ai(),i=new Vn({"Content-Type":"application/json",Authorization:o?`Bearer ${o}`:""});return this.http.post(r,e,{headers:i})}}return n.\u0275fac=function(e){return new(e||n)(re($a))},n.\u0275prov=fe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),xG=(()=>{class n{constructor(e,r,o){this.fb=e,this.router=r,this.userInfoService=o,this.profileForm=null,this.imageSrc=null,this.userInfo=localStorage.getItem("info")?JSON.parse(localStorage.getItem("info")):null}ngOnInit(){this.init()}init(){this.profileForm=this.fb.group({name:["",si.required],phone:["",si.required],address:["",si.required],gender:["",si.required],dob:["",si.required],img:[""]}),this.userInfo&&(this.profileForm.patchValue(this.userInfo),this.imageSrc=this.userInfo.img)}onFileChange(e){const r=e.target;if(r.files&&r.files[0]){const o=r.files[0],i=new FileReader;i.onload=s=>{this.imageSrc=s.target.result,this.profileForm.patchValue({img:s.target.result})},i.onerror=s=>{console.error("FileReader error:",s)},i.readAsDataURL(o)}}onSubmit(){if(console.log(this.profileForm.valid),null!=this.profileForm){if(!this.profileForm.valid)return void console.log("From are invalid");ui(this.userInfoService.postInfo(this.profileForm.value).pipe(Tt(e=>{e&&(localStorage.setItem("info",JSON.stringify(this.profileForm.value)),this.router.navigate(["/"]))},e=>{console.log(e),this.router.navigate(["/"])})))}}logout(){this.router.navigate(["/logout"])}}return n.\u0275fac=function(e){return new(e||n)(X(w0),X(Wt),X(_G))},n.\u0275cmp=bn({type:n,selectors:[["app-me-data"]],decls:56,vars:2,consts:[[1,"w-full","h-full","p-4","flex","justify-center","flex-col"],[3,"formGroup","submit"],[1,"grid","min-h-[140px]","w-full","place-items-center","overflow-x-scroll","rounded-lg","p-6","lg:overflow-visible","relative"],["id","imagePreview","alt","Profile Image",1,"circular-image","object-cover","object-center","w-96","h-96",3,"src"],[1,"block"],["type","file","id","fileInput","formControlName","img",1,"absolute","inset-0","opacity-0","cursor-pointer","file-input","w-full","max-w-xs",3,"change"],[1,"block","w-full","py-2","px-4","rounded-lg","border-0","text-sm","font-semibold","bg-blue-600","text-white","hover:bg-blue-700","disabled:opacity-50","disabled:pointer-events-none","dark:text-neutral-500","dark:bg-blue-500","dark:hover:bg-blue-400"],[1,"relative","w-full","min-w-[200px]","h-10","mb-4"],[1,"input","input-bordered","flex","items-center","gap-2"],["type","text","placeholder","John Doe","formControlName","name",1,"grow"],["type","number","placeholder","9067340000","formControlName","phone",1,"grow"],["type","text","placeholder","John Doe, 456 Elm Street, Suite 3, Los Angeles, CA 90001, USA","formControlName","address",1,"grow"],[1,"flex","gap-10"],[1,"inline-flex","items-center"],["for","male",1,"relative","flex","items-center","p-3","rounded-full","cursor-pointer"],["id","male","type","radio","value","M","formControlName","gender",1,"before:content['']","peer","relative","h-5","w-5","cursor-pointer","appearance-none","rounded-full","border","border-blue-gray-200","text-blue-600","transition-all","before:absolute","before:top-2/4","before:left-2/4","before:block","before:h-12","before:w-12","before:-translate-y-2/4","before:-translate-x-2/4","before:rounded-full","before:bg-blue-gray-500","before:opacity-0","before:transition-opacity","checked:border-gray-900","checked:before:bg-gray-900","hover:before:opacity-10"],[1,"absolute","text-blue-600","transition-opacity","opacity-0","pointer-events-none","top-2/4","left-2/4","-translate-y-2/4","-translate-x-2/4","peer-checked:opacity-100"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 16 16","fill","currentColor",1,"h-3.5","w-3.5"],["data-name","ellipse","cx","8","cy","8","r","8"],["for","male",1,"mt-px","font-light","text-gray-700","cursor-pointer","select-none"],["for","female",1,"relative","flex","items-center","p-3","rounded-full","cursor-pointer"],["id","female","type","radio","value","F","formControlName","gender",1,"before:content['']","peer","relative","h-5","w-5","cursor-pointer","appearance-none","rounded-full","border","border-blue-gray-200","text-blue-600","transition-all","before:absolute","before:top-2/4","before:left-2/4","before:block","before:h-12","before:w-12","before:-translate-y-2/4","before:-translate-x-2/4","before:rounded-full","before:bg-blue-gray-500","before:opacity-0","before:transition-opacity","checked:border-blue-900","checked:before:bg-blue-900","hover:before:opacity-10"],["for","female",1,"mt-px","font-light","text-gray-700","cursor-pointer","select-none"],["for","other",1,"relative","flex","items-center","p-3","rounded-full","cursor-pointer"],["id","other","type","radio","value","O","formControlName","gender",1,"before:content['']","peer","relative","h-5","w-5","cursor-pointer","appearance-none","rounded-full","border","border-blue-gray-200","text-blue-600","transition-all","before:absolute","before:top-2/4","before:left-2/4","before:block","before:h-12","before:w-12","before:-translate-y-2/4","before:-translate-x-2/4","before:rounded-full","before:bg-blue-gray-500","before:opacity-0","before:transition-opacity","checked:border-gray-900","checked:before:bg-gray-900","hover:before:opacity-10"],["for","other",1,"mt-px","font-light","text-gray-700","cursor-pointer","select-none"],["type","date","formControlName","dob",1,"grow"],[1,"w-full","text-center"],["type","submit",1,"rounded-md","bg-blue-800","py-2","px-4","border","border-transparent","text-center","text-sm","text-white","transition-all","shadow-md","hover:shadow-lg","focus:bg-blue-700","focus:shadow-none","active:bg-blue-700","hover:bg-blue-700","active:shadow-none","disabled:pointer-events-none","disabled:opacity-50","disabled:shadow-none","ml-2"],[1,"w-full","text-center","p-5"],[1,"text-gray-800",3,"click"]],template:function(e,r){1&e&&(Z(0,"div",0)(1,"form",1),pt("submit",function(){return r.onSubmit()}),Z(2,"div")(3,"div",2),ye(4,"img",3),Z(5,"label",4)(6,"input",5),pt("change",function(i){return r.onFileChange(i)}),te(),Z(7,"span",6),Ee(8,"Choose"),te()()()(),Z(9,"div",7)(10,"label",8),Ee(11," Name "),ye(12,"input",9),te()(),Z(13,"div",7)(14,"label",8),Ee(15," Mobile No "),ye(16,"input",10),te()(),Z(17,"div",7)(18,"label",8),Ee(19," Address "),ye(20,"input",11),te()(),Z(21,"div",12)(22,"div",13)(23,"label",14),ye(24,"input",15),Z(25,"span",16),xo(),Z(26,"svg",17),ye(27,"circle",18),te()()(),Co(),Z(28,"label",19),Ee(29," Male "),te()(),Z(30,"div",13)(31,"label",20),ye(32,"input",21),Z(33,"span",16),xo(),Z(34,"svg",17),ye(35,"circle",18),te()()(),Co(),Z(36,"label",22),Ee(37," Female "),te()(),Z(38,"div",13)(39,"label",23),ye(40,"input",24),Z(41,"span",16),xo(),Z(42,"svg",17),ye(43,"circle",18),te()()(),Co(),Z(44,"label",25),Ee(45," Other "),te()()(),Z(46,"div",7)(47,"label",8),Ee(48," BOD "),ye(49,"input",26),te()(),Z(50,"div",27)(51,"button",28),Ee(52," Save "),te()(),Z(53,"div",29)(54,"h1",30),pt("click",function(){return r.logout()}),Ee(55,"It not my account?"),te()()()()),2&e&&(xe(1),Ce("formGroup",r.profileForm),xe(3),Ce("src",r.imageSrc||"assets/imgs/user-286-512.png",Wu))},dependencies:[wg,bl,d0,f0,Vd,cg,xl,Gd],styles:[".circular-image[_ngcontent-%COMP%]{border-radius:50%;object-fit:cover}"]}),n})(),CG=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=bn({type:n,selectors:[["app-setting"]],decls:9,vars:0,consts:[[1,"h-full","w-full","flex","justify-center","align-center"],[1,"bg-gray-100","flex","items-center","justify-center","h-screen"],[1,"text-center","p-6","bg-white","shadow-md","rounded-lg"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"mx-auto","mb-4","w-24","h-24","text-yellow-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v6m-3-3h6M12 3v3m0 0a9 9 0 100 18 9 9 0 000-18zM12 3a9 9 0 100 18 9 9 0 000-18z"],[1,"text-2xl","font-bold","text-gray-800","mb-2"],[1,"text-gray-600"]],template:function(e,r){1&e&&(Z(0,"div",0)(1,"div",1)(2,"div",2),xo(),Z(3,"svg",3),ye(4,"path",4),te(),Co(),Z(5,"h1",5),Ee(6,"Under Construction"),te(),Z(7,"p",6),Ee(8,"We are working hard to get things up and running. Check back soon!"),te()()()())}}),n})(),EG=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=bn({type:n,selectors:[["app-notify"]],decls:9,vars:0,consts:[[1,"h-full","w-full","flex","justify-center","align-center"],[1,"bg-gray-100","flex","items-center","justify-center","h-screen"],[1,"text-center","p-6","bg-white","shadow-md","rounded-lg"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"mx-auto","mb-4","w-24","h-24","text-yellow-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v6m-3-3h6M12 3v3m0 0a9 9 0 100 18 9 9 0 000-18zM12 3a9 9 0 100 18 9 9 0 000-18z"],[1,"text-2xl","font-bold","text-gray-800","mb-2"],[1,"text-gray-600"]],template:function(e,r){1&e&&(Z(0,"div",0)(1,"div",1)(2,"div",2),xo(),Z(3,"svg",3),ye(4,"path",4),te(),Co(),Z(5,"h1",5),Ee(6,"Under Construction"),te(),Z(7,"p",6),Ee(8,"We are working hard to get things up and running. Check back soon!"),te()()()())}}),n})(),KM=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Tn({type:n}),n.\u0275inj=wn({imports:[Lp,y0,_g]}),n})();function XM(n,t,e,r,o,i,s){try{var a=n[i](s),u=a.value}catch(l){return void e(l)}a.done?t(u):Promise.resolve(u).then(r,o)}function er(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var i=n.apply(t,e);function s(u){XM(i,r,o,s,a,"next",u)}function a(u){XM(i,r,o,s,a,"throw",u)}s(void 0)})}}var YM=function(n,t){return(YM=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o])})(n,t)};function No(n,t){function e(){this.constructor=n}YM(n,t),n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}function he(n,t,e,r){return new(e||(e=Promise))(function(o,i){function s(l){try{u(r.next(l))}catch(c){i(c)}}function a(l){try{u(r.throw(l))}catch(c){i(c)}}function u(l){l.done?o(l.value):new e(function(c){c(l.value)}).then(s,a)}u((r=r.apply(n,t||[])).next())})}function pe(n,t){var e,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(u){return function(l){return function(c){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return s.label++,{value:c[1],done:!1};case 5:s.label++,r=c[1],c=[0];continue;case 7:c=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){s=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){s.label=c[1];break}if(6===c[0]&&s.label<o[1]){s.label=o[1],o=c;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(c);break}o[2]&&s.ops.pop(),s.trys.pop();continue}c=t.call(n,s)}catch(d){c=[6,d],r=0}finally{e=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}var DG=function(){function n(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return n.prototype.setPlatform=function(t,e){null!=this.platform&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+e+"."),this.platformName=t,this.platform=e},n.prototype.registerFlag=function(t,e,r){if(this.flagRegistry[t]={evaluationFn:e,setHook:r},null!=this.urlFlags[t]){var o=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+o+"."),this.set(t,o)}},n.prototype.get=function(t){return t in this.flags||(this.flags[t]=this.evaluateFlag(t)),this.flags[t]},n.prototype.getNumber=function(t){return this.get(t)},n.prototype.getBool=function(t){return this.get(t)},n.prototype.getFlags=function(){return this.flags},Object.defineProperty(n.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),n.prototype.set=function(t,e){if(null==this.flagRegistry[t])throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)},n.prototype.evaluateFlag=function(t){if(null==this.flagRegistry[t])throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},n.prototype.setFlags=function(t){this.flags=Object.assign({},t)},n.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},n.prototype.populateURLFlags=function(){var t=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var r,o=(r={},this.global.location.search.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(i){for(var s=[],a=1;a<arguments.length;a++)s[a-1]=arguments[a];return SG(r,s[0],s[1]),s.join("=")}),r);"tfjsflags"in o&&o.tfjsflags.split(",").forEach(function(i){var s=i.split(":"),a=s[0];t.urlFlags[a]=function(l,c){if("true"===(c=c.toLowerCase())||"false"===c)return"true"===c;if(""+ +c===c)return+c;throw new Error("Could not parse value flag value "+c+" for flag "+l+".")}(a,s[1])})}},n}();function SG(n,t,e){n[decodeURIComponent(t)]=decodeURIComponent(e||"")}function $(){return QM}var QM=null,Dl=new Map,Xd=new Map;function ZM(n,t){var e=T0(n,t);return Dl.get(e)}function JM(n){for(var t=Dl.entries(),e=[];;){var r=t.next(),i=r.value;if(r.done)break;var a=i[1];i[0].split("_")[0]===n&&e.push(a)}return e}function ek(n){var t=n.kernelName,e=n.backendName,r=T0(t,e);if(Dl.has(r))throw new Error("The kernel '"+t+"' for backend '"+e+"' is already registered");Dl.set(r,n)}function AG(n){var t=n.kernelName;Xd.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),Xd.set(t,n)}function T0(n,t){return t+"_"+n}function tk(n){for(var t=n.length,e=0,r=0;t>0;)r=Math.random()*t|0,e=n[--t],n[t]=n[r],n[r]=e}function Dg(n,t,e){return Math.max(n,Math.min(t,e))}function M0(n){return n%2==0?n:n+1}function nk(n){for(var t=0,e=0;e<n.length;e++)t+=n[e];return t}function I(n,t){if(!n)throw new Error("string"==typeof t?t:t())}function at(n,t,e){void 0===e&&(e=""),I(pn(n,t),function(){return e+" Shapes "+n+" and "+t+" must match"})}function Ga(n){I(null!=n,function(){return"The input to the tensor constructor must be a non-null value."})}function ts(n,t,e){if(void 0===t&&(t=[]),void 0===e&&(e=!1),null==t&&(t=[]),Array.isArray(n)||Un(n)&&!e)for(var r=0;r<n.length;++r)ts(n[r],t,e);else t.push(n);return t}function me(n){if(0===n.length)return 1;for(var t=n[0],e=1;e<n.length;e++)t*=n[e];return t}function pn(n,t){if(n===t)return!0;if(null==n||null==t||n.length!==t.length)return!1;for(var e=0;e<n.length;e++)if(n[e]!==t[e])return!1;return!0}function zt(n){return n%1==0}function rk(n){if(null!=Math.tanh)return Math.tanh(n);if(n===1/0)return 1;if(n===-1/0)return-1;var t=Math.exp(2*n);return(t-1)/(t+1)}function Sg(n){var t=Math.ceil(Math.sqrt(n));return[t,Math.ceil(n/t)]}function qa(n,t){return t<=n.length?n:n+" ".repeat(t-n.length)}function k0(n,t,e){return void 0===t&&(t=function(r){return 0}),new Promise(function(r,o){var i=0,s=function(){if(n())r();else{i++;var a=t(i);null!=e&&i>=e?o():setTimeout(s,a)}};s()})}function ok(n,t){for(var e=1,r=-1,o=0;o<n.length;++o)if(n[o]>=0)e*=n[o];else if(-1===n[o]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+o);r=o}else if(n[o]<0)throw Error("Shapes can not be < 0. Found "+n[o]+" at dim "+o);if(-1===r){if(t>0&&t!==e)throw Error("Size("+t+") must match the product of shape "+n);return n}if(0===e)throw Error("Cannot infer the missing size in ["+n+"] when there are 0 elements");if(t%e!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+e);var i=n.slice();return i[r]=t/e,i}function gn(n,t){var e=t.length;return I((n=null==n?t.map(function(r,o){return o}):[].concat(n)).every(function(r){return r>=-e&&r<e}),function(){return"All values in axis param must be in range [-"+e+", "+e+") but got axis "+n}),I(n.every(function(r){return zt(r)}),function(){return"All values in axis param must be integers but got axis "+n}),n.map(function(r){return r<0?e+r:r})}function ea(n,t){for(var e=[],r=[],o=null!=t&&Array.isArray(t)&&0===t.length,i=null==t||o?null:gn(t,n).sort(),s=0,a=0;a<n.length;++a){if(null!=i){if(i[s]===a&&1!==n[a])throw new Error("Can't squeeze axis "+a+" since its dim '"+n[a]+"' is not 1");(null==i[s]||i[s]>a)&&1===n[a]&&(e.push(n[a]),r.push(a)),i[s]<=a&&s++}1!==n[a]&&(e.push(n[a]),r.push(a))}return{newShape:e,keptDims:r}}function Sl(n,t){var e=null;if(null==n||"float32"===n)e=new Float32Array(t);else if("int32"===n)e=new Int32Array(t);else{if("bool"!==n)throw new Error("Unknown data type "+n);e=new Uint8Array(t)}return e}function Yd(n,t){var e=null;if(null==n||"float32"===n)e=new Float32Array(t);else if("int32"===n)e=new Int32Array(t);else if("bool"===n)e=new Uint8Array(t);else{if("string"!==n)throw new Error("Unknown data type "+n);e=new Array(t)}return e}function ik(n,t){for(var e=0;e<n.length;e++){var r=n[e];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}function sk(n){return"bool"===n||"complex64"===n||"float32"===n||"int32"===n||"string"===n}function ak(n,t){return!("complex64"===t||"float32"===t&&"complex64"!==n||"int32"===t&&"float32"!==n&&"complex64"!==n||"bool"===t&&"bool"===n)}function Un(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array}function R0(n){if("float32"===n||"int32"===n)return 4;if("complex64"===n)return 8;if("bool"===n)return 1;throw new Error("Unknown dtype "+n)}function uk(n){if(null==n)return 0;var t=0;return n.forEach(function(e){return t+=e.length}),t}function ta(n){return"string"==typeof n||n instanceof String}function lk(n){return"boolean"==typeof n}function ck(n){return"number"==typeof n}function Il(n){return Array.isArray(n)?Il(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array?"int32":ck(n)?"float32":ta(n)?"string":lk(n)?"bool":"float32"}function na(n){return!!(n&&n.constructor&&n.call&&n.apply)}function Ig(n,t){for(var e=t;e<n;++e)if(n%e==0)return e;return n}function Fo(n){var t=n.length;if(t<2)return[];var e=new Array(t-1);e[t-2]=n[t-1];for(var r=t-3;r>=0;--r)e[r]=e[r+1]*n[r+1];return e}function N0(n,t,e){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=ts(n)),e&&ik(n,t),s=t,(i=n)instanceof Float32Array&&"float32"===s||i instanceof Int32Array&&"int32"===s||i instanceof Uint8Array&&"bool"===s)return n;var i,s;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(n);if("int32"===t)return new Int32Array(n);if("bool"===t){for(var r=new Uint8Array(n.length),o=0;o<r.length;++o)0!==Math.round(n[o])&&(r[o]=1);return r}throw new Error("Unknown data type "+t)}function F0(n,t){if(0===n.length)return t[0];var e=n.reduce(function(r,o){return r*o});if(0===e)return[];if(e!==t.length)throw new Error("["+n+"] does not match the input size.");return function r(o,i,s){var a=new Array;if(1===i.length)for(var u=i[0],l=0;l<u;l++)a[l]=s[o+l];else{u=i[0];var c=i.slice(1),d=c.reduce(function(f,h){return f*h});for(l=0;l<u;l++)a[l]=r(o+l*d,c,s)}return a}(0,n,t)}function P0(n,t){for(var e=Al(n,t),r=0;r<e.length;r++)e[r]=1;return e}function Al(n,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(n);if("int32"===t)return new Int32Array(n);if("bool"===t)return new Uint8Array(n);throw new Error("Unknown data type "+t)}function Po(){return $().platform.now()}function O0(n){n.forEach(function(t){I(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+n+"]."})})}function dk(n,t){return void 0===t&&(t="utf-8"),t=t||"utf-8",$().platform.encode(n,t)}function Qd(n,t){return void 0===t&&(t="utf-8"),t=t||"utf-8",$().platform.decode(n,t)}function L0(n,t,e){if(0===t)return 0;if(1===t)return n[0];for(var r=n[n.length-1],o=0;o<n.length-1;++o)r+=e[o]*n[o];return r}function fk(n,t,e){if(0===t)return[];if(1===t)return[n];for(var r=new Array(t),o=0;o<r.length-1;++o)r[o]=Math.floor(n/e[o]),n-=r[o]*e[o];return r[r.length-1]=n,r}Object.freeze({shuffle:tk,clamp:Dg,nearestLargerEven:M0,sum:nk,randUniform:function(n,t){var e=Math.random();return t*e+(1-e)*n},distSquared:function(n,t){for(var e=0,r=0;r<n.length;r++){var o=Number(n[r])-Number(t[r]);e+=o*o}return e},assert:I,assertShapesMatch:at,assertNonNull:Ga,flatten:ts,sizeFromShape:me,isScalarShape:function(n){return 0===n.length},arraysEqual:pn,isInt:zt,tanh:rk,sizeToSquarishShape:Sg,createShuffledIndices:function(n){for(var t=new Uint32Array(n),e=0;e<n;++e)t[e]=e;return tk(t),t},rightPad:qa,repeatedTry:k0,inferFromImplicitShape:ok,parseAxisParam:gn,squeezeShape:ea,getTypedArrayFromDType:Sl,getArrayFromDType:Yd,checkConversionForErrors:ik,isValidDtype:sk,hasEncodingLoss:ak,isTypedArray:Un,bytesPerElement:R0,bytesFromStringArray:uk,isString:ta,isBoolean:lk,isNumber:ck,inferDtype:Il,isFunction:na,nearestDivisor:Ig,computeStrides:Fo,toTypedArray:N0,toNestedArray:F0,makeOnesTypedArray:P0,makeZerosTypedArray:Al,now:Po,assertNonNegativeIntegerDimensions:O0,fetch:function(n,t){return $().platform.fetch(n,t)},encodeString:dk,decodeString:Qd,locToIndex:L0,indexToLoc:fk});var TG=function(){function n(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new MG)}return n.prototype.profileKernel=function(t,e,r){var o,i=this,s=this.backendTimer.time(function(){o=r()});return o.forEach(function(a){a.data().then(function(u){(function(l,c,d){if("float32"!==c)return!1;for(var f=0;f<l.length;f++){var h=l[f];if(isNaN(h)||!isFinite(h))return console.warn("Found "+h+" in the result of '"+d+"'"),!0}})(u,a.dtype,t),s.then(function(l){var c="";null!=l.getExtraProfileInfo&&(c=l.getExtraProfileInfo()),i.logger.logKernelProfile(t,a,u,l.kernelMs,e,c)})})}),o},n}(),MG=function(){function n(){}return n.prototype.logKernelProfile=function(t,e,r,o,i,s){var a="number"==typeof o?qa(o+"ms",9):o.error,u=qa(t,25),l=e.rank,c=e.size,d=qa(e.shape.toString(),14),f="";for(var h in i){var p=i[h].shape||e.shape,m=p.length;f+=h+": "+m+"D "+(m>0?p:"")+" "}console.log("%c"+u+"\t%c"+a+"\t%c"+l+"D "+d+"\t%c"+c+"\t%c"+f+"\t%c"+s,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},n}();function Jd(n,t,e){return qa(Array.isArray(n)?parseFloat(n[0].toFixed(7))+" + "+parseFloat(n[1].toFixed(7))+"j":ta(n)?"'"+n+"'":"bool"===e?pk(n):parseFloat(n.toFixed(7)).toString(),t)}function pk(n){return 0===n?"false":"true"}function ef(n){for(var t=[],e=0;e<n.length;e+=2)t.push([n[e],n[e+1]]);return t}var tf=function(){function n(t,e,r){var o=this;if(this.dtype=e,this.shape=t.slice(),this.size=me(t),null!=r){var i=r.length;I(i===this.size,function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+o.size+"'."})}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Yd(e,this.size),this.strides=Fo(t)}return n.prototype.set=function(t){for(var e=this,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];0===r.length&&(r=[0]),I(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+e.rank+")"});var i=this.locToIndex(r);this.values[i]=t},n.prototype.get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];0===t.length&&(t=[0]);for(var r=0,o=0,i=t;o<i.length;o++){var s=i[o];if(s<0||s>=this.shape[r]){var a="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(a)}r++}for(var u=t[t.length-1],l=0;l<t.length-1;++l)u+=this.strides[l]*t[l];return this.values[u]},n.prototype.locToIndex=function(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];for(var e=t[t.length-1],r=0;r<t.length-1;++r)e+=this.strides[r]*t[r];return e},n.prototype.indexToLoc=function(t){if(0===this.rank)return[];if(1===this.rank)return[t];for(var e=new Array(this.shape.length),r=0;r<e.length-1;++r)e[r]=Math.floor(t/this.strides[r]),t-=e[r]*this.strides[r];return e[e.length-1]=t,e},Object.defineProperty(n.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),n.prototype.toTensor=function(){return li().makeTensor(this.values,this.shape,this.dtype)},n}(),li=null,H=null,gk=null,It=function(){function n(t,e,r,o){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=me(t),this.strides=Fo(t),this.dataId=r,this.id=o,this.rankType=this.rank<5?this.rank.toString():"higher"}return n.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},n.prototype.asScalar=function(){return this.throwIfDisposed(),I(1===this.size,function(){return"The array must have only 1 element."}),this.reshape([])},n.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},n.prototype.as2D=function(t,e){return this.throwIfDisposed(),this.reshape([t,e])},n.prototype.as3D=function(t,e,r){return this.throwIfDisposed(),this.reshape([t,e,r])},n.prototype.as4D=function(t,e,r,o){return this.throwIfDisposed(),this.reshape([t,e,r,o])},n.prototype.as5D=function(t,e,r,o,i){return this.throwIfDisposed(),this.reshape([t,e,r,o,i])},n.prototype.asType=function(t){return this.throwIfDisposed(),H.cast(this,t)},Object.defineProperty(n.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),n.prototype.buffer=function(){return he(this,void 0,void 0,function(){var t;return pe(this,function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,H.buffer(this.shape,this.dtype,t)]}})})},n.prototype.bufferSync=function(){return H.buffer(this.shape,this.dtype,this.dataSync())},n.prototype.array=function(){return he(this,void 0,void 0,function(){var t;return pe(this,function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,F0(this.shape,t)]}})})},n.prototype.arraySync=function(){return F0(this.shape,this.dataSync())},n.prototype.data=function(){return he(this,void 0,void 0,function(){var t,e;return pe(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),t=li().read(this.dataId),"string"!==this.dtype?[3,2]:[4,t];case 1:e=r.sent();try{return[2,e.map(function(o){return Qd(o)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,t]}})})},n.prototype.dataSync=function(){this.throwIfDisposed();var t=li().readSync(this.dataId);if("string"===this.dtype)try{return t.map(function(e){return Qd(e)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},n.prototype.bytes=function(){return he(this,void 0,void 0,function(){var t;return pe(this,function(e){switch(e.label){case 0:return this.throwIfDisposed(),[4,li().read(this.dataId)];case 1:return t=e.sent(),"string"===this.dtype?[2,t]:[2,new Uint8Array(t.buffer)]}})})},n.prototype.dispose=function(){this.isDisposed||(li().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(n.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),n.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},n.prototype.toFloat=function(){return this.asType("float32")},n.prototype.toInt=function(){return this.asType("int32")},n.prototype.toBool=function(){return this.asType("bool")},n.prototype.print=function(t){return void 0===t&&(t=!1),H.print(this,t)},n.prototype.reshape=function(t){return this.throwIfDisposed(),H.reshape(this,t)},n.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},n.prototype.expandDims=function(t){return void 0===t&&(t=0),H.expandDims(this,t)},n.prototype.cumsum=function(t,e,r){return void 0===t&&(t=0),void 0===e&&(e=!1),void 0===r&&(r=!1),H.cumsum(this,t,e,r)},n.prototype.squeeze=function(t){return this.throwIfDisposed(),H.squeeze(this,t)},n.prototype.clone=function(){return this.throwIfDisposed(),H.clone(this)},n.prototype.oneHot=function(t,e,r){return this.throwIfDisposed(),H.oneHot(this,t,e,r)},n.prototype.toString=function(t){return void 0===t&&(t=!1),function kG(n,t,e,r){var o=Fo(t),i=function(l,c,d,f){var h=me(c),p=f[f.length-1],m=new Array(p).fill(0),v=c.length,y="complex64"===d?ef(l):l;if(v>1)for(var _=0;_<h/p;_++)for(var b=_*p,x=0;x<p;x++)m[x]=Math.max(m[x],Jd(y[b+x],0,d).length);return m}(n,t,e,o),s=t.length,a=function l(c,d,f,h,p,m){void 0===m&&(m=!0);var v="complex64"===f?2:1,y=d[0],_=d.length;if(0===_)return"complex64"===f?[Jd(ef(c)[0],0,f)]:"bool"===f?[pk(c[0])]:[c[0].toString()];if(1===_){if(y>20){var x=Array.from(c.slice(0,3*v)),E=Array.from(c.slice((y-3)*v,y*v));return"complex64"===f&&(x=ef(x),E=ef(E)),["["+x.map(function(K,L){return Jd(K,p[L],f)}).join(", ")+", ..., "+E.map(function(K,L){return Jd(K,p[y-3+L],f)}).join(", ")+"]"]}return["["+("complex64"===f?ef(c):Array.from(c)).map(function(K,L){return Jd(K,p[L],f)}).join(", ")+"]"]}var D=d.slice(1),k=h.slice(1),R=h[0]*v,A=[];if(y>20){for(var M=0;M<3;M++){var O=(P=M*R)+R;A.push.apply(A,l(c.slice(P,O),D,f,k,p,!1))}for(A.push("..."),M=y-3;M<y;M++)O=(P=M*R)+R,A.push.apply(A,l(c.slice(P,O),D,f,k,p,M===y-1))}else for(M=0;M<y;M++){var P;O=(P=M*R)+R,A.push.apply(A,l(c.slice(P,O),D,f,k,p,M===y-1))}var G=2===_?",":"";for(A[0]="["+A[0]+G,M=1;M<A.length-1;M++)A[M]=" "+A[M]+G;var q=",\n";for(M=2;M<_;M++)q+="\n";return A[A.length-1]=" "+A[A.length-1]+"]"+(m?"":q),A}(n,t,e,o,i),u=["Tensor"];return r&&(u.push("  dtype: "+e),u.push("  rank: "+s),u.push("  shape: ["+t+"]"),u.push("  values:")),u.push(a.map(function(l){return"    "+l}).join("\n")),u.join("\n")}(this.dataSync(),this.shape,this.dtype,t)},n.prototype.tile=function(t){return this.throwIfDisposed(),H.tile(this,t)},n.prototype.gather=function(t,e){return void 0===e&&(e=0),this.throwIfDisposed(),H.gather(this,t,e)},n.prototype.matMul=function(t,e,r){return void 0===e&&(e=!1),void 0===r&&(r=!1),this.throwIfDisposed(),H.matMul(this,t,e,r)},n.prototype.dot=function(t){return this.throwIfDisposed(),H.dot(this,t)},n.prototype.norm=function(t,e,r){return void 0===t&&(t="euclidean"),void 0===e&&(e=null),void 0===r&&(r=!1),this.throwIfDisposed(),H.norm(this,t,e,r)},n.prototype.slice=function(t,e){return this.throwIfDisposed(),H.slice(this,t,e)},n.prototype.reverse=function(t){return this.throwIfDisposed(),H.reverse(this,t)},n.prototype.concat=function(t,e){return void 0===e&&(e=0),this.throwIfDisposed(),t instanceof n&&(t=[t]),H.concat([this].concat(t),e)},n.prototype.split=function(t,e){return void 0===e&&(e=0),this.throwIfDisposed(),H.split(this,t,e)},n.prototype.stack=function(t,e){return void 0===e&&(e=0),H.stack([this,t],e)},n.prototype.unstack=function(t){return void 0===t&&(t=0),H.unstack(this,t)},n.prototype.pad=function(t,e){return void 0===e&&(e=0),H.pad(this,t,e)},n.prototype.batchNormalization=function(t,e,r,o,i){return void 0===r&&(r=.001),gk("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,e,i,o,r)},n.prototype.batchNorm=function(t,e,r,o,i){return void 0===i&&(i=.001),this.throwIfDisposed(),H.batchNorm(this,t,e,r,o,i)},n.prototype.all=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),H.all(this,t,e)},n.prototype.any=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),H.any(this,t,e)},n.prototype.logSumExp=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),H.logSumExp(this,t,e)},n.prototype.sum=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),H.sum(this,t,e)},n.prototype.prod=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),H.prod(this,t,e)},n.prototype.mean=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),H.mean(this,t,e)},n.prototype.min=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),H.min(this,t,e)},n.prototype.max=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),H.max(this,t,e)},n.prototype.argMin=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),H.argMin(this,t)},n.prototype.argMax=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),H.argMax(this,t)},n.prototype.cast=function(t){return this.throwIfDisposed(),H.cast(this,t)},n.prototype.add=function(t){return this.throwIfDisposed(),H.add(this,t)},n.prototype.addStrict=function(t){return this.throwIfDisposed(),H.addStrict(this,t)},n.prototype.atan2=function(t){return this.throwIfDisposed(),H.atan2(this,t)},n.prototype.sub=function(t){return this.throwIfDisposed(),H.sub(this,t)},n.prototype.subStrict=function(t){return this.throwIfDisposed(),H.subStrict(this,t)},n.prototype.pow=function(t){return this.throwIfDisposed(),H.pow(this,t)},n.prototype.powStrict=function(t){return this.throwIfDisposed(),H.powStrict(this,t)},n.prototype.mul=function(t){return this.throwIfDisposed(),H.mul(this,t)},n.prototype.mulStrict=function(t){return this.throwIfDisposed(),H.mulStrict(this,t)},n.prototype.div=function(t){return this.throwIfDisposed(),H.div(this,t)},n.prototype.divNoNan=function(t){return this.throwIfDisposed(),H.divNoNan(this,t)},n.prototype.floorDiv=function(t){return this.throwIfDisposed(),H.floorDiv(this,t)},n.prototype.divStrict=function(t){return this.throwIfDisposed(),H.divStrict(this,t)},n.prototype.minimum=function(t){return this.throwIfDisposed(),H.minimum(this,t)},n.prototype.minimumStrict=function(t){return this.throwIfDisposed(),H.minimumStrict(this,t)},n.prototype.maximum=function(t){return this.throwIfDisposed(),H.maximum(this,t)},n.prototype.maximumStrict=function(t){return this.throwIfDisposed(),H.maximumStrict(this,t)},n.prototype.mod=function(t){return this.throwIfDisposed(),H.mod(this,t)},n.prototype.modStrict=function(t){return this.throwIfDisposed(),H.modStrict(this,t)},n.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),H.squaredDifferenceStrict(this,t)},n.prototype.transpose=function(t){return this.throwIfDisposed(),H.transpose(this,t)},n.prototype.notEqual=function(t){return this.throwIfDisposed(),H.notEqual(this,t)},n.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),H.notEqualStrict(this,t)},n.prototype.less=function(t){return this.throwIfDisposed(),H.less(this,t)},n.prototype.lessStrict=function(t){return this.throwIfDisposed(),H.lessStrict(this,t)},n.prototype.equal=function(t){return this.throwIfDisposed(),H.equal(this,t)},n.prototype.equalStrict=function(t){return this.throwIfDisposed(),H.equalStrict(this,t)},n.prototype.lessEqual=function(t){return this.throwIfDisposed(),H.lessEqual(this,t)},n.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),H.lessEqualStrict(this,t)},n.prototype.greater=function(t){return this.throwIfDisposed(),H.greater(this,t)},n.prototype.greaterStrict=function(t){return this.throwIfDisposed(),H.greaterStrict(this,t)},n.prototype.greaterEqual=function(t){return this.throwIfDisposed(),H.greaterEqual(this,t)},n.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),H.greaterEqualStrict(this,t)},n.prototype.logicalAnd=function(t){return this.throwIfDisposed(),H.logicalAnd(this,t)},n.prototype.logicalOr=function(t){return this.throwIfDisposed(),H.logicalOr(this,t)},n.prototype.logicalNot=function(){return this.throwIfDisposed(),H.logicalNot(this)},n.prototype.logicalXor=function(t){return this.throwIfDisposed(),H.logicalXor(this,t)},n.prototype.where=function(t,e){return this.throwIfDisposed(),H.where(t,this,e)},n.prototype.neg=function(){return this.throwIfDisposed(),H.neg(this)},n.prototype.ceil=function(){return this.throwIfDisposed(),H.ceil(this)},n.prototype.floor=function(){return this.throwIfDisposed(),H.floor(this)},n.prototype.sign=function(){return this.throwIfDisposed(),H.sign(this)},n.prototype.isNaN=function(){return this.throwIfDisposed(),H.isNaN(this)},n.prototype.isInf=function(){return this.throwIfDisposed(),H.isInf(this)},n.prototype.isFinite=function(){return this.throwIfDisposed(),H.isFinite(this)},n.prototype.exp=function(){return this.throwIfDisposed(),H.exp(this)},n.prototype.expm1=function(){return this.throwIfDisposed(),H.expm1(this)},n.prototype.log=function(){return this.throwIfDisposed(),H.log(this)},n.prototype.log1p=function(){return this.throwIfDisposed(),H.log1p(this)},n.prototype.sqrt=function(){return this.throwIfDisposed(),H.sqrt(this)},n.prototype.rsqrt=function(){return this.throwIfDisposed(),H.rsqrt(this)},n.prototype.square=function(){return this.throwIfDisposed(),H.square(this)},n.prototype.reciprocal=function(){return this.throwIfDisposed(),H.reciprocal(this)},n.prototype.abs=function(){return this.throwIfDisposed(),H.abs(this)},n.prototype.clipByValue=function(t,e){return this.throwIfDisposed(),H.clipByValue(this,t,e)},n.prototype.relu=function(){return this.throwIfDisposed(),H.relu(this)},n.prototype.relu6=function(){return this.throwIfDisposed(),H.relu6(this)},n.prototype.elu=function(){return this.throwIfDisposed(),H.elu(this)},n.prototype.selu=function(){return this.throwIfDisposed(),H.selu(this)},n.prototype.leakyRelu=function(t){return void 0===t&&(t=.2),this.throwIfDisposed(),H.leakyRelu(this,t)},n.prototype.prelu=function(t){return this.throwIfDisposed(),H.prelu(this,t)},n.prototype.sigmoid=function(){return this.throwIfDisposed(),H.sigmoid(this)},n.prototype.logSigmoid=function(){return this.throwIfDisposed(),H.logSigmoid(this)},n.prototype.softplus=function(){return this.throwIfDisposed(),H.softplus(this)},n.prototype.zerosLike=function(){return this.throwIfDisposed(),H.zerosLike(this)},n.prototype.onesLike=function(){return this.throwIfDisposed(),H.onesLike(this)},n.prototype.sin=function(){return this.throwIfDisposed(),H.sin(this)},n.prototype.cos=function(){return this.throwIfDisposed(),H.cos(this)},n.prototype.tan=function(){return this.throwIfDisposed(),H.tan(this)},n.prototype.asin=function(){return this.throwIfDisposed(),H.asin(this)},n.prototype.acos=function(){return this.throwIfDisposed(),H.acos(this)},n.prototype.atan=function(){return this.throwIfDisposed(),H.atan(this)},n.prototype.sinh=function(){return this.throwIfDisposed(),H.sinh(this)},n.prototype.cosh=function(){return this.throwIfDisposed(),H.cosh(this)},n.prototype.tanh=function(){return this.throwIfDisposed(),H.tanh(this)},n.prototype.asinh=function(){return this.throwIfDisposed(),H.asinh(this)},n.prototype.acosh=function(){return this.throwIfDisposed(),H.acosh(this)},n.prototype.atanh=function(){return this.throwIfDisposed(),H.atanh(this)},n.prototype.erf=function(){return this.throwIfDisposed(),H.erf(this)},n.prototype.round=function(){return this.throwIfDisposed(),H.round(this)},n.prototype.step=function(t){return void 0===t&&(t=0),this.throwIfDisposed(),H.step(this,t)},n.prototype.softmax=function(t){return void 0===t&&(t=-1),this.throwIfDisposed(),H.softmax(this,t)},n.prototype.logSoftmax=function(t){return void 0===t&&(t=-1),this.throwIfDisposed(),H.logSoftmax(this,t)},n.prototype.resizeBilinear=function(t,e){return void 0===e&&(e=!1),this.throwIfDisposed(),H.image.resizeBilinear(this,t,e)},n.prototype.resizeNearestNeighbor=function(t,e){return void 0===e&&(e=!1),this.throwIfDisposed(),H.image.resizeNearestNeighbor(this,t,e)},n.prototype.conv1d=function(t,e,r,o,i,s){return void 0===o&&(o="NWC"),void 0===i&&(i=1),this.throwIfDisposed(),H.conv1d(this,t,e,r,o,i,s)},n.prototype.conv2d=function(t,e,r,o,i,s){return void 0===o&&(o="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),H.conv2d(this,t,e,r,o,i,s)},n.prototype.conv2dTranspose=function(t,e,r,o,i){return this.throwIfDisposed(),H.conv2dTranspose(this,t,e,r,o,i)},n.prototype.depthwiseConv2D=function(t,e,r,o,i,s){return void 0===o&&(o="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),H.depthwiseConv2d(this,t,e,r,o,i,s)},n.prototype.separableConv2d=function(t,e,r,o,i,s){return void 0===i&&(i=[1,1]),void 0===s&&(s="NHWC"),this.throwIfDisposed(),H.separableConv2d(this,t,e,r,o,i,s)},n.prototype.avgPool=function(t,e,r,o){return this.throwIfDisposed(),H.avgPool(this,t,e,r,o)},n.prototype.maxPool=function(t,e,r,o){return this.throwIfDisposed(),H.maxPool(this,t,e,r,o)},n.prototype.localResponseNormalization=function(t,e,r,o){return void 0===t&&(t=5),void 0===e&&(e=1),void 0===r&&(r=1),void 0===o&&(o=.5),H.localResponseNormalization(this,t,e,r,o)},n.prototype.pool=function(t,e,r,o,i){return this.throwIfDisposed(),H.pool(this,t,e,r,o,i)},n.prototype.variable=function(t,e,r){return void 0===t&&(t=!0),this.throwIfDisposed(),li().makeVariable(this,t,e,r)},n.prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),H.unsortedSegmentSum(this,t,e)},n.prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),H.batchToSpaceND(this,t,e)},n.prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),H.spaceToBatchND(this,t,e)},n.prototype.topk=function(t,e){return void 0===t&&(t=1),void 0===e&&(e=!0),this.throwIfDisposed(),H.topk(this,t,e)},n.prototype.stridedSlice=function(t,e,r,o,i,s,a,u){return void 0===o&&(o=0),void 0===i&&(i=0),void 0===s&&(s=0),void 0===a&&(a=0),void 0===u&&(u=0),this.throwIfDisposed(),H.stridedSlice(this,t,e,r,o,i,s,a,u)},n.prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),H.depthToSpace(this,t,e)},n.prototype.fft=function(){return this.throwIfDisposed(),H.spectral.fft(this)},n.prototype.ifft=function(){return this.throwIfDisposed(),H.spectral.ifft(this)},n.prototype.rfft=function(){return this.throwIfDisposed(),H.spectral.rfft(this)},n.prototype.irfft=function(){return this.throwIfDisposed(),H.spectral.irfft(this)},n}();Object.defineProperty(It,Symbol.hasInstance,{value:function(n){return!!n&&null!=n.dataId&&null!=n.shape&&null!=n.dtype}});var mk,V0,U0,j0,H0,n,Tl=function(n){function t(e,r,o,i){var s=n.call(this,e.shape,e.dtype,e.dataId,i)||this;return s.trainable=r,s.name=o,s}return No(t,n),t.prototype.assign=function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value ("+e.dtype+") and previous value ("+this.dtype+") must match");if(!pn(e.shape,this.shape))throw new Error("shape of the new value ("+e.shape+") and previous value ("+this.shape+") must match");li().disposeTensor(this),this.dataId=e.dataId,li().incRef(this,null)},t.prototype.dispose=function(){li().disposeVariable(this),this.isDisposedInternal=!0},t}(It);Object.defineProperty(Tl,Symbol.hasInstance,{value:function(n){return n instanceof It&&null!=n.assign&&n.assign instanceof Function}}),(n=mk||(mk={})).R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6",function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"}(V0||(V0={})),function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"}(U0||(U0={})),function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"}(j0||(j0={})),function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"}(H0||(H0={}));var RG={float32:j0,int32:V0,bool:U0,complex64:H0};function kn(n,t){if("string"===n||"string"===t){if("string"===n&&"string"===t)return"string";throw new Error("Can not upcast "+n+" with "+t)}return RG[n][t]}function W0(n){return kn(n,"int32")}function Bt(n,t){if(n.dtype===t.dtype)return[n,t];var e=kn(n.dtype,t.dtype);return[n.cast(e),t.cast(e)]}function vk(n,t){I(n.dtype===t.dtype,function(){return"The dtypes of the first("+n.dtype+") and second("+t.dtype+") input must match"})}function z0(n){var t=[];return function e(r,o,i){if(null!=r){if(r instanceof It)return void o.push(r);if(s=r,Array.isArray(s)||"object"==typeof s){var s,a=r;for(var u in a){var l=a[u];i.has(l)||(i.add(l),e(l,o,i))}}}}(n,t,new Set),t}Object.freeze({makeTypesMatch:Bt,assertTypesMatch:vk,isTensorInList:function(n,t){return t.some(function(e){return e.id===n.id})},getTensorsInContainer:z0});var $0,yk=function(){function n(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return n.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},n}(),NG=function(){function n(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new yk}return n.prototype.ready=function(){return he(this,void 0,void 0,function(){var t,e,r;return pe(this,function(o){switch(o.label){case 0:if(null!=this.pendingBackendInit)return[2,this.pendingBackendInit.then(function(){})];if(null!=this.backendInstance)return[2];t=this.getSortedBackends(),e=0,o.label=1;case 1:return e<t.length?[4,this.initializeBackend(r=t[e]).success]:[3,5];case 2:return o.sent()?[4,this.setBackend(r)]:[3,4];case 3:return o.sent(),[2];case 4:return e++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(n.prototype,"backend",{get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var t=this.initializeBackendsAndReturnBest(),e=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+e+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(e)}return this.backendInstance},enumerable:!0,configurable:!0}),n.prototype.backendNames=function(){return Object.keys(this.registryFactory)},n.prototype.findBackend=function(t){return t in this.registry||t in this.registryFactory&&!this.initializeBackend(t).asyncInit?this.registry[t]:null},n.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},n.prototype.registerBackend=function(t,e,r){return void 0===r&&(r=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:r},!0)},n.prototype.setBackend=function(t){return he(this,void 0,void 0,function(){var e,r,o;return pe(this,function(i){switch(i.label){case 0:if(null==this.registryFactory[t])throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,null!=this.registry[t]?[3,4]:(this.backendInstance=null,e=this.initializeBackend(t),r=e.success,e.asyncInit?[4,r]:[3,2]);case 1:return o=i.sent(),[3,3];case 2:o=r,i.label=3;case 3:if(!o)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new TG(this.backendInstance),[2,!0]}})})},n.prototype.setupRegisteredKernels=function(){var t=this;JM(this.backendName).forEach(function(e){null!=e.setupFunc&&e.setupFunc(t.backendInstance)})},n.prototype.disposeRegisteredKernels=function(t){var e=this;JM(t).forEach(function(r){null!=r.disposeFunc&&r.disposeFunc(e.registry[t])})},n.prototype.initializeBackend=function(t){var e=this,r=this.registryFactory[t];if(null==r)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var o=r.factory();if(Promise.resolve(o)===o){var i=++this.pendingBackendInitId,s=o.then(function(a){return!(i<e.pendingBackendInitId||(e.registry[t]=a,e.pendingBackendInit=null,0))}).catch(function(a){return!(i<e.pendingBackendInitId||(e.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(a.stack||a.message),1))});return this.pendingBackendInit=s,{success:s,asyncInit:!0}}return this.registry[t]=o,{success:!0,asyncInit:!1}}catch(a){return console.warn("Initialization of backend "+t+" failed"),console.warn(a.stack||a.message),{success:!1,asyncInit:!1}}},n.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},n.prototype.getSortedBackends=function(){var t=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(e,r){return t.registryFactory[r].priority-t.registryFactory[e].priority})},n.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),e=0;e<t.length;e++){var r=t[e],o=this.initializeBackend(r),s=o.asyncInit;if(s||o.success)return{name:r,asyncInit:s}}throw new Error("Could not initialize any backends, all backend initializations failed.")},n.prototype.moveData=function(t,e){var r=this.state.tensorInfo.get(e),o=r.backend,i=this.readSync(e);o.disposeData(e),r.backend=t,t.move(e,i,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},n.prototype.tidy=function(t,e){var r,o=this,i=null;if(null==e){if("function"!=typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!=typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun(function(){return o.startScope(i)},function(){return o.endScope(r)},function(){return(r=e())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r})},n.prototype.scopedRun=function(t,e,r){t();try{var o=r();return e(),o}catch(i){throw e(),i}},n.prototype.nextTensorId=function(){return n.nextTensorId++},n.prototype.nextVariableId=function(){return n.nextVariableId++},n.prototype.clone=function(t){var e=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype);return this.addTapeNode(this.state.activeScope.name,{x:t},[e],function(o){return{x:function(){return o.toFloat()}}},[]),e},n.prototype.runKernel=function(t,e,r,o,i){return this.runKernelFunc(null,e,null,t,r,o,i)},n.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},n.prototype.checkKernelForMemLeak=function(t,e,r){var o=this.backend.numDataIds(),i=0;r.forEach(function(u){i+="complex64"===u.dtype?3:1});var a=o-e-i-this.state.numDataMovesStack[this.state.numDataMovesStack.length-1];if(a>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+a+" data ids) after running '"+t+"'")},n.prototype.runKernelFunc=function(t,e,r,o,i,s,a){var u,l=this;void 0===s&&(s=[]),void 0===a&&(a=[]);var c=[],d=this.isTapeOn();null==o&&(o=null!=this.state.activeScope?this.state.activeScope.name:"");var f,h=function(_){d&&(c=_.map(function(b){return l.keep(l.clone(b))}))},p=this.state.numBytes,m=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var v,y=ZM(o,this.backendName);return f=null!=y?function(){var _=l.backend.numDataIds();v=y.kernelFunc({inputs:e,attrs:i,backend:l.backend});var b=Array.isArray(v)?v:[v];l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(o,_,b);var x=b.map(function(D){return l.makeTensorFromDataId(D.dataId,D.shape,D.dtype)}),E=x.filter(function(D,k){return a[k]});return h((s||[]).slice().concat(E)),x}:function(){var _=l.backend.numDataIds();v=l.tidy(function(){return t(l.backend,h)});var b=Array.isArray(v)?v:[v];return l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(o,_,b),b},this.scopedRun(function(){return l.state.kernelDepth++},function(){return l.state.kernelDepth--},function(){u=l.ENV.getBool("DEBUG")?l.profiler.profileKernel(o,e,function(){return f()}):f()}),d&&this.addTapeNode(o,e,u,r,c),this.state.profiling&&this.state.activeProfile.kernels.push({name:o,bytesAdded:this.state.numBytes-p,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-m,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(e).map(function(_){return e[_].shape}),outputShapes:u.map(function(_){return _.shape})}),Array.isArray(v)?u:u[0]},n.prototype.makeTensor=function(t,e,r,o){if(null==t)throw new Error("Values passed to engine.makeTensor() are null");o=o||this.backend;var i=t;"string"===(r=r||"float32")&&ta(t[0])&&(i=t.map(function(c){return dk(c)}));var s=o.write(i,e,r),a=new It(e,r,s,this.nextTensorId());if(this.incRef(a,o),"string"===r){var u=this.state.tensorInfo.get(s),l=uk(i);this.state.numBytes+=l-u.bytes,u.bytes=l}return a},n.prototype.makeTensorFromDataId=function(t,e,r,o){var i=new It(e,r=r||"float32",t,this.nextTensorId());return this.incRef(i,o),i},n.prototype.makeVariable=function(t,e,r,o){void 0===e&&(e=!0),r=r||this.nextVariableId().toString(),null!=o&&o!==t.dtype&&(t=t.asType(o));var i=new Tl(t,e,r,this.nextTensorId());if(null!=this.state.registeredVariables[i.name])throw new Error("Variable with name "+i.name+" was already registered");return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},n.prototype.incRef=function(t,e){var r=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++,0===r){this.state.numDataBuffers++;var o=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(o=t.size*R0(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:o,refCount:0}),this.state.numBytes+=o}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof Tl||this.track(t)},n.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,"string"===t.dtype&&this.state.numStringTensors--;var e=this.state.tensorInfo.get(t.dataId);e.refCount<=1?("complex64"!==t.dtype&&(this.state.numBytes-=e.bytes),this.state.numDataBuffers--,e.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},n.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables)this.disposeVariable(this.state.registeredVariables[t])},n.prototype.disposeVariable=function(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]},n.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},n.prototype.profile=function(t){return he(this,void 0,void 0,function(){var e,r;return pe(this,function(o){return this.state.profiling=!0,e=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(i){return i.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-r,[2,this.state.activeProfile]})})},n.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth},n.prototype.addTapeNode=function(t,e,r,o,i){var s=this,a={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:r,saved:i},u=function IG(n){return Xd.get(n)}(t);null!=u&&(o=u.gradFunc),null!=o&&(a.gradient=function(l){return l=l.map(function(c,d){if(null==c){var f=r[d],h=Al(f.size,f.dtype);return s.makeTensor(h,f.shape,f.dtype)}return c}),o(l.length>1?l:l[0],i)}),this.state.activeTape.push(a)},n.prototype.keep=function(t){return t.kept=!0,t},n.prototype.startTape=function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++},n.prototype.endTape=function(){this.state.gradientDepth--},n.prototype.startScope=function(t){var e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e},n.prototype.endScope=function(t){for(var e=this,r=z0(t),o=new Set(r.map(function(u){return u.id})),i=0;i<this.state.activeScope.track.length;i++){var s=this.state.activeScope.track[i];s.kept||o.has(s.id)||s.dispose()}var a=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(function(u){u.kept||u.scopeId!==a.id||e.track(u)})},n.prototype.gradients=function(t,e,r,o){var i=this;if(void 0===o&&(o=!1),I(e.length>0,function(){return"gradients() received an empty list of xs."}),null!=r&&"float32"!==r.dtype)throw new Error("dy must have 'float32' dtype, but has '"+r.dtype+"'");var s=this.scopedRun(function(){return i.startTape()},function(){return i.endTape()},function(){return i.tidy("forward",t)});I(s instanceof It,function(){return"The result y returned by f() must be a tensor."});var a=function(u,l,c){for(var d={},f={},h=0;h<l.length;h++)d[l[h].id]=!0;for(h=0;h<u.length;h++){var p=(D=u[h]).inputs;for(var m in p){for(var v=p[m],y=!1,_=0;_<l.length;_++)if(d[v.id]){D.outputs.forEach(function(M){return d[M.id]=!0}),y=!0,f[D.id]=!0;break}if(y)break}}var b={};b[c.id]=!0;var x={};for(h=u.length-1;h>=0;h--)for(p=(D=u[h]).inputs,_=0;_<D.outputs.length;_++)if(b[D.outputs[_].id]){for(var m in p)b[p[m].id]=!0,x[D.id]=!0;break}var E=[];for(h=0;h<u.length;h++){var D;if(f[(D=u[h]).id]&&x[D.id]){var k={};for(var m in D.inputs){var R=D.inputs[m];d[R.id]&&(k[m]=R)}var A=Object.assign({},D);A.inputs=k,A.outputs=D.outputs,E.push(A)}}return E}(this.state.activeTape,e,s);if(!o&&0===a.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var u,l,c={};c[s.id]=r??(l=P0(me(u=s.shape),"float32"),N.makeTensor(l,u,"float32")),function(f,h,p){for(var m=function(y){var _=h[y],b=[];if(_.outputs.forEach(function(k){var R=f[k.id];b.push(null!=R?R:null)}),null==_.gradient)throw new Error("Cannot compute gradient: gradient function not found for "+_.kernelName+".");var x=_.gradient(b),E=function(k){if(!(k in x))throw new Error("Cannot backprop through input "+k+". Available gradients found: "+Object.keys(x)+".");var R=i.tidy(function(){return x[k]()});if("float32"!==R.dtype)throw new Error("Error in gradient for op "+_.kernelName+". The gradient of input "+k+" must have 'float32' dtype, but has '"+R.dtype+"'");var A=_.inputs[k];if(!pn(R.shape,A.shape))throw new Error("Error in gradient for op "+_.kernelName+". The gradient of input '"+k+"' has shape '"+R.shape+"', which does not match the shape of the input '"+A.shape+"'");if(null==f[A.id])f[A.id]=R;else{var M=f[A.id];f[A.id]=M.add(R),M.dispose()}};for(var D in _.inputs)E(D)},v=h.length-1;v>=0;v--)m(v)}(c,a);var d=e.map(function(f){return c[f.id]});return 0===i.state.gradientDepth&&(i.state.activeTape.forEach(function(f){for(var h=0,p=f.saved;h<p.length;h++)p[h].dispose()}),i.state.activeTape=null),{value:s,grads:d}})},n.prototype.customGrad=function(t){var e=this;return I(na(t),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var r,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];I(o.every(function(a){return a instanceof It}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var s={};return o.forEach(function(a,u){s[u]=a}),e.runKernelFunc(function(a,u){return I((r=t.apply(void 0,o.concat([u]))).value instanceof It,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),I(na(r.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),r.value},s,function(a,u){var l=r.gradFunc(a,u),c=Array.isArray(l)?l:[l];I(c.length===o.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),I(c.every(function(f){return f instanceof It}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var d={};return c.forEach(function(f,h){d[h]=function(){return f}}),d})}},n.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},n.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},n.prototype.time=function(t){return he(this,void 0,void 0,function(){var e,r;return pe(this,function(o){switch(o.label){case 0:return e=Po(),[4,this.backend.time(t)];case 1:return(r=o.sent()).wallMs=Po()-e,[2,r]}})})},n.prototype.track=function(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(n.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),n.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new yk,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},n.nextTensorId=0,n.nextVariableId=0,n}(),N=function(){var n=function(){if(null==$0){var e=void 0;if(typeof window<"u")e=window;else if(typeof global<"u")e=global;else if(typeof process<"u")e=process;else{if(typeof self>"u")throw new Error("Could not find a global object");e=self}$0=e}return $0}();if(null==n._tfengine){var t=new DG(n);n._tfengine=new NG(t)}return QM=n._tfengine.ENV,li=function(){return n._tfengine},n._tfengine}();function wk(){return typeof window<"u"&&null!=window.document||typeof WorkerGlobalScope<"u"}var ns=$();ns.registerFlag("DEBUG",function(){return!1},function(n){n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),ns.registerFlag("IS_BROWSER",function(){return wk()}),ns.registerFlag("IS_NODE",function(){return typeof process<"u"&&void 0!==process.versions&&void 0!==process.versions.node}),ns.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),ns.registerFlag("PROD",function(){return!1}),ns.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return ns.getBool("DEBUG")}),ns.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),ns.registerFlag("IS_TEST",function(){return!1});var nf,zr,$r,Ka={},G0={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function bk(n,t){Ka[n]=t}function ci(n){n in Ka||(Ka[n]=function(e){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var r=function(o){if(typeof OffscreenCanvas<"u"&&2===o)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e);return r.addEventListener("webglcontextlost",function(o){o.preventDefault(),delete Ka[e]},!1),1===e?r.getContext("webgl",G0)||r.getContext("experimental-webgl",G0):r.getContext("webgl2",G0)}(n));var t=Ka[n];return t.isContextLost()?(delete Ka[n],ci(n)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Ka[n])}function Ag(n,t){return[t,n]}function rf(n){var t=me(n);return Sg(Math.ceil(t/4))}function sf(n,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(n/2))]}function q0(n,t){var e,r,o,i,s,a,u,l,c,d=n;return 2===$().getNumber("WEBGL_VERSION")?(e=d.R32F,r=d.R16F,o=d.RGBA16F,i=d.RGBA32F,s=d.RED,a=4,u=1,l=d.HALF_FLOAT,c=d.FLOAT):(e=n.RGBA,r=n.RGBA,o=n.RGBA,i=d.RGBA,s=n.RGBA,a=4,u=4,l=null!=t?t.HALF_FLOAT_OES:null,c=n.FLOAT),{internalFormatFloat:e,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:s,downloadTextureFormat:n.RGBA,downloadUnpackNumChannels:a,defaultNumChannels:u,textureTypeHalfFloat:l,textureTypeFloat:c}}function ce(n,t,e){var r=e();return t&&function(o){var i=o.getError();if(i!==o.NO_ERROR)throw new Error("WebGL Error: "+xk(o,i))}(n),r}function _k(n){return!!($().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===n||5.96e-8<Math.abs(n)&&Math.abs(n)<65504)}function xk(n,t){switch(t){case n.NO_ERROR:return"NO_ERROR";case n.INVALID_ENUM:return"INVALID_ENUM";case n.INVALID_VALUE:return"INVALID_VALUE";case n.INVALID_OPERATION:return"INVALID_OPERATION";case n.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case n.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case n.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function af(n,t,e){return rs(n,t,function(){return n.getExtension(e)},'Extension "'+e+'" not supported on this browser.')}function Ck(n,t,e){var r=rs(n,t,function(){return n.createShader(n.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(ce(n,t,function(){return n.shaderSource(r,e)}),ce(n,t,function(){return n.compileShader(r)}),!1===n.getShaderParameter(r,n.COMPILE_STATUS))throw console.log(n.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function Ek(n,t,e){var r=rs(n,t,function(){return n.createShader(n.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(ce(n,t,function(){return n.shaderSource(r,e)}),ce(n,t,function(){return n.compileShader(r)}),!1===n.getShaderParameter(r,n.COMPILE_STATUS))throw function(o,i){var s=OG.exec(i);if(null==s)return console.log("Couldn't parse line number in error: "+i),void console.log(o);for(var a=+s[1],u=o.split("\n"),l=u.length.toString().length+2,c=u.map(function(v,y){return qa((y+1).toString(),l)+v}),d=0,f=0;f<c.length;f++)d=Math.max(c[f].length,d);var h=c.slice(0,a-1),p=c.slice(a-1,a),m=c.slice(a);console.log(h.join("\n")),console.log(i.split("\n")[0]),console.log("%c "+qa(p[0],d),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(m.join("\n"))}(e,n.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}(function(n){n[n.DENSE=0]="DENSE",n[n.SHARED_BATCH=1]="SHARED_BATCH"})(nf||(nf={})),function(n){n[n.RENDER=0]="RENDER",n[n.UPLOAD=1]="UPLOAD",n[n.PIXELS=2]="PIXELS",n[n.DOWNLOAD=3]="DOWNLOAD"}(zr||(zr={})),function(n){n[n.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",n[n.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",n[n.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",n[n.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",n[n.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}($r||($r={}));var Tg,Mg,OG=/ERROR: [0-9]+:([0-9]+):/g;function Dk(n,t){return rs(n,t,function(){return n.createProgram()},"Unable to create WebGLProgram.")}function Sk(n,t,e){if(ce(n,t,function(){return n.linkProgram(e)}),!1===n.getProgramParameter(e,n.LINK_STATUS))throw console.log(n.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function kg(n,t,e){if(ce(n,t,function(){return n.validateProgram(e)}),!1===n.getProgramParameter(e,n.VALIDATE_STATUS))throw console.log(n.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function Ik(n,t,e){var r=rs(n,t,function(){return n.createBuffer()},"Unable to create WebGLBuffer");return ce(n,t,function(){return n.bindBuffer(n.ARRAY_BUFFER,r)}),ce(n,t,function(){return n.bufferData(n.ARRAY_BUFFER,e,n.STATIC_DRAW)}),r}function Ak(n,t,e){var r=rs(n,t,function(){return n.createBuffer()},"Unable to create WebGLBuffer");return ce(n,t,function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,r)}),ce(n,t,function(){return n.bufferData(n.ELEMENT_ARRAY_BUFFER,e,n.STATIC_DRAW)}),r}function Tk(n,t){return rs(n,t,function(){return n.createTexture()},"Unable to create WebGLTexture.")}function Mk(n,t){var e=$().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n<=0||t<=0){var r="["+n+"x"+t+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(n>e||t>e)throw r="["+n+"x"+t+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU ["+e+"x"+e+"].")}function kk(n,t){return rs(n,t,function(){return n.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function K0(n,t,e,r,o,i,s,a){var u=n.getAttribLocation(e,r);return-1!==u&&(ce(n,t,function(){return n.bindBuffer(n.ARRAY_BUFFER,o)}),ce(n,t,function(){return n.vertexAttribPointer(u,i,n.FLOAT,!1,s,a)}),ce(n,t,function(){return n.enableVertexAttribArray(u)}),!0)}function Rk(n,t,e,r){Lk(n,r),ce(n,t,function(){return n.activeTexture(n.TEXTURE0+r)}),ce(n,t,function(){return n.bindTexture(n.TEXTURE_2D,e)})}function Nk(n,t,e,r){return rs(n,t,function(){return n.getUniformLocation(e,r)},'uniform "'+r+'" not present in program.')}function Fk(n,t,e){return n.getUniformLocation(t,e)}function Pk(n,t,e,r,o,i){ce(n,t,function(){return Rk(n,t,r,i)}),ce(n,t,function(){return n.uniform1i(o,i)})}function Rg(n,t,e,r){ce(n,t,function(){return n.bindFramebuffer(n.FRAMEBUFFER,r)}),ce(n,t,function(){return n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0)})}function X0(n,t,e){ce(n,t,function(){return n.bindFramebuffer(n.FRAMEBUFFER,e)}),ce(n,t,function(){return n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,null,0)})}function uf(n){var t=n.checkFramebufferStatus(n.FRAMEBUFFER);if(t!==n.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+Ok(n,t))}function Ok(n,t){switch(t){case n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case n.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function rs(n,t,e,r){var o=ce(n,t,function(){return e()});if(null==o)throw new Error(r);return o}function Lk(n,t){var e=n.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+n.TEXTURE0;if(r<n.TEXTURE0||r>e)throw new Error("textureUnit must be in [gl.TEXTURE0, gl.TEXTURE"+e+"].")}function lf(n,t){return void 0===t&&(t=2),me(n.slice(0,n.length-t))}function cf(n){if(0===n.length)throw Error("Cannot get rows and columns of an empty shape array.");return[n.length>1?n[n.length-2]:1,n[n.length-1]]}function Ng(n){var t=[1,1,1];return 0===n.length||1===n.length&&1===n[0]||(t=[lf(n)].concat(cf(n))),t}function Bk(n,t){var e;void 0===t&&(t=!1);var r=$().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(r*=2,1===(n=n.map(function(l,c){return c>=n.length-2?M0(n[c]):n[c]})).length&&(n=[2,n[0]])),2!==n.length){var o=ea(n);n=o.newShape}var i=me(n);if(n.length<=1&&i<=r)return[1,i];if(2===n.length&&n[0]<=r&&n[1]<=r)return n;if(3===n.length&&n[0]*n[1]<=r&&n[2]<=r)return[n[0]*n[1],n[2]];if(3===n.length&&n[0]<=r&&n[1]*n[2]<=r)return[n[0],n[1]*n[2]];if(4===n.length&&n[0]*n[1]*n[2]<=r&&n[3]<=r)return[n[0]*n[1]*n[2],n[3]];if(4===n.length&&n[0]<=r&&n[1]*n[2]*n[3]<=r)return[n[0],n[1]*n[2]*n[3]];if(t){var s=lf(n),a=2,u=2;return n.length&&(a=(e=cf(n))[0],u=e[1]),Sg(i=s*(a/2)*(u/2)).map(function(l){return 2*l})}return Sg(i)}function Fg(n){return n%2==0}function df(n,t){if(pn(n=n.slice(-2),t=t.slice(-2))||!n.length||!t.length||0===n[0]||0===n[1]||0===t[0]||0===t[1])return!0;if(n.length!==t.length){var e=n.slice(-1)[0],r=t.slice(-1)[0];if(e===r||Fg(e)&&Fg(r)&&(1===n[0]||1===t[0]))return!0}return n[1]===t[1]&&Fg(n[0])&&Fg(t[0])}function Vk(n){if(null==Tg){var t=ci(n);Tg=t.getParameter(t.MAX_TEXTURE_SIZE)}return Tg}function Uk(n){if(null==Mg){var t=ci(n);Mg=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Mg)}function jk(n){if(0===n)return 0;var t=ci(n);return Gr(t,"EXT_disjoint_timer_query_webgl2")&&2===n?2:Gr(t,"EXT_disjoint_timer_query")?1:0}function Gr(n,t){return null!=n.getExtension(t)}function Y0(n){try{if(null!=ci(n))return!0}catch{return!1}return!1}function Hk(n){if(0===n)return!1;var t=ci(n);if(1===n){if(!Gr(t,"OES_texture_float"))return!1}else if(!Gr(t,"EXT_color_buffer_float"))return!1;return Q0(t)}function Wk(n){if(0===n)return!1;var t=ci(n);if(1!==n){if(Gr(t,"EXT_color_buffer_float"))return Q0(t);if(Gr(t,"EXT_color_buffer_half_float")){var e=t.getExtension("EXT_color_buffer_half_float");return function(r,o){var i=q0(r,o),s=r.createTexture();r.bindTexture(r.TEXTURE_2D,s),r.texImage2D(r.TEXTURE_2D,0,i.internalFormatHalfFloat,1,1,0,i.textureFormatFloat,i.textureTypeHalfFloat,null);var a=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,a),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,s,0);var u=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(s),r.deleteFramebuffer(a),u}(t,e)}return!1}return!!Gr(t,"OES_texture_float")&&!!Gr(t,"WEBGL_color_buffer_float")&&Q0(t)}function Q0(n){var t=q0(n),e=n.createTexture();n.bindTexture(n.TEXTURE_2D,e),n.texImage2D(n.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,r),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0);var o=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(e),n.deleteFramebuffer(r),o}function zk(n){return 2===n&&null!=ci(n).fenceSync}var LG=Object.freeze({callAndCheck:ce,canBeRepresented:_k,getWebGLErrorMessage:xk,getExtensionOrThrow:af,createVertexShader:Ck,createFragmentShader:Ek,createProgram:Dk,linkProgram:Sk,validateProgram:kg,createStaticVertexBuffer:Ik,createStaticIndexBuffer:Ak,getNumChannels:function(){return 2===$().getNumber("WEBGL_VERSION")?1:4},createTexture:Tk,validateTextureSize:Mk,createFramebuffer:kk,bindVertexBufferToProgramAttribute:K0,bindTextureUnit:Rk,unbindTextureUnit:function(n,t,e){Lk(n,e),ce(n,t,function(){return n.activeTexture(n.TEXTURE0+e)}),ce(n,t,function(){return n.bindTexture(n.TEXTURE_2D,null)})},getProgramUniformLocationOrThrow:Nk,getProgramUniformLocation:Fk,bindTextureToProgramUniformSampler:Pk,bindCanvasToFramebuffer:function(n,t){ce(n,t,function(){return n.bindFramebuffer(n.FRAMEBUFFER,null)}),ce(n,t,function(){return n.viewport(0,0,n.canvas.width,n.canvas.height)}),ce(n,t,function(){return n.scissor(0,0,n.canvas.width,n.canvas.height)})},bindColorTextureToFramebuffer:Rg,unbindColorTextureFromFramebuffer:X0,validateFramebuffer:uf,getFramebufferErrorMessage:Ok,getBatchDim:lf,getRowsCols:cf,getShapeAs3D:Ng,getTextureShapeFromLogicalShape:Bk,isReshapeFree:df,getWebGLMaxTextureSize:Vk,resetMaxTextureSize:function(){Tg=null},resetMaxTexturesInShader:function(){Mg=null},getMaxTexturesInShader:Uk,getWebGLDisjointQueryTimerVersion:jk,hasExtension:Gr,isWebGLVersionEnabled:Y0,isCapableOfRenderingToFloatTexture:Hk,isDownloadFloatTextureEnabled:Wk,isWebGLFenceEnabled:zk}),Ne=$();function $k(n){$().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(n+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function le(n,t){return N.tidy(n,t)}function Mr(n){z0(n).forEach(function(t){return t.dispose()})}function Pg(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];$().getBool("IS_TEST")||console.warn.apply(console,n)}function di(n,t){var e=n;if(Un(n))return"string"===t?[]:[n.length];if(!Array.isArray(n))return[];for(var r=[];Array.isArray(e)||Un(e)&&"string"!==t;)r.push(e.length),e=e[0];return Array.isArray(n)&&$().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function o(i,s,a){if(a=a||[],Array.isArray(i)||Un(i)){I(s.length>0,function(){return"Element arr["+a.join("][")+"] should be a primitive, but is an array of "+i.length+" elements"}),I(i.length===s[0],function(){return"Element arr["+a.join("][")+"] should have "+s[0]+" elements, but has "+i.length+" elements"});for(var u=s.slice(1),l=0;l<i.length;++l)o(i[l],u,a.concat(l))}else I(0===s.length,function(){return"Element arr["+a.join("][")+"] is a primitive, but should be an array/TypedArray of "+s[0]+" elements"})}(n,r,[]),r}function Gk(n,t,e,r){if(null!=n&&("numeric"!==n&&n!==t||"numeric"===n&&"string"===t))throw new Error("Argument '"+e+"' passed to '"+r+"' must be "+n+" tensor, but got "+t+" tensor")}function S(n,t,e,r){if(void 0===r&&(r="numeric"),n instanceof It)return Gk(r,n.dtype,t,e),n;var o=Il(n);if("string"!==o&&["bool","int32","float32"].indexOf(r)>=0&&(o=r),Gk(r,o,t,e),null==n||!Un(n)&&!Array.isArray(n)&&"number"!=typeof n&&"boolean"!=typeof n&&"string"!=typeof n)throw new Error("Argument '"+t+"' passed to '"+e+"' must be a Tensor or TensorLike, but got '"+(null==n?"null":n.constructor.name)+"'");var s=di(n,o);Un(n)||Array.isArray(n)||(n=[n]);var a="string"!==o?N0(n,o,$().getBool("DEBUG")):ts(n,[],!0);return N.makeTensor(a,s,o)}function ff(n,t,e,r){if(void 0===r&&(r="numeric"),!Array.isArray(n))throw new Error("Argument "+t+" passed to "+e+" must be a `Tensor[]` or `TensorLike[]`");return n.map(function(o,i){return S(o,t+"["+i+"]",e)},r)}function Z0(n,t){for(var e=0;e<n.length;++e)if(n[n.length-e-1]!==t-1-e)return!1;return!0}function qk(n,t,e){for(var r=n.length+t.length,o=[],i=0,s=0,a=0;a<r;a++)-1===e.indexOf(a)?o.push(n[i++]):o.push(t[s++]);return o}function jn(n,t){for(var e=[],r=n.length,o=0;o<r;o++)-1===t.indexOf(o)&&e.push(n[o]);return[e,t.map(function(i){return n[i]})]}function br(n,t){return qk(n,t.map(function(e){return 1}),t)}function kr(n,t,e){I(Z0(t,e),function(){return n+" supports only inner-most axes for now. Got axes "+t+" and rank-"+e+" input."})}function Oo(n,t){if(Z0(n,t))return null;for(var e=[],r=0;r<t;++r)-1===n.indexOf(r)&&e.push(r);return n.forEach(function(o){return e.push(o)}),e}function Og(n){return n.map(function(t,e){return[e,t]}).sort(function(t,e){return t[1]-e[1]}).map(function(t){return t[0]})}function Lo(n,t){for(var e=[],r=t-n;r<t;++r)e.push(r);return e}function Kk(n,t){var e=n[0].length;n.forEach(function(o,i){I(o.length===e,function(){return"Error in concat"+e+"D: rank of tensors["+i+"] must be the same as the rank of the rest ("+e+")"})}),I(t>=0&&t<e,function(){return"Error in concat"+e+"D: axis must be between 0 and "+(e-1)+"."});var r=n[0];n.forEach(function(o,i){for(var s=0;s<e;s++)I(s===t||o[s]===r[s],function(){return"Error in concat"+e+"D: Shape of tensors["+i+"] ("+o+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+i+"."})})}function Xa(n,t){for(var e=n[0].slice(),r=1;r<n.length;r++)e[t]+=n[r][t];return e}function F(n){var t=Object.keys(n);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var e=t[0],r=n[e];e.endsWith("_")&&(e=e.substring(0,e.length-1));var o=function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];N.startScope(e);try{var a=r.apply(void 0,i);return a instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),N.endScope(a),a}catch(u){throw N.endScope(null),u}};return Object.defineProperty(o,"name",{value:e,configurable:!0}),o}Ne.registerFlag("HAS_WEBGL",function(){return Ne.getNumber("WEBGL_VERSION")>0}),Ne.registerFlag("WEBGL_VERSION",function(){return Y0(2)?2:Y0(1)?1:0}),Ne.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return 2===Ne.get("WEBGL_VERSION")}),Ne.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),Ne.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),Ne.registerFlag("WEBGL_PACK",function(){return Ne.getBool("HAS_WEBGL")}),Ne.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return Ne.getBool("WEBGL_PACK")}),Ne.registerFlag("WEBGL_PACK_CLIP",function(){return Ne.getBool("WEBGL_PACK")}),Ne.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),Ne.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return Ne.getBool("WEBGL_PACK")}),Ne.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return Ne.getBool("WEBGL_PACK")}),Ne.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return Ne.getBool("WEBGL_PACK")}),Ne.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return Ne.getBool("WEBGL_PACK")}),Ne.registerFlag("WEBGL_PACK_REDUCE",function(){return Ne.getBool("WEBGL_PACK")}),Ne.registerFlag("WEBGL_LAZILY_UNPACK",function(){return Ne.getBool("WEBGL_PACK")}),Ne.registerFlag("WEBGL_CONV_IM2COL",function(){return Ne.getBool("WEBGL_PACK")}),Ne.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return Vk(Ne.getNumber("WEBGL_VERSION"))}),Ne.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return Uk(Ne.getNumber("WEBGL_VERSION"))}),Ne.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var n=Ne.getNumber("WEBGL_VERSION");return 0===n?0:jk(n)}),Ne.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return Ne.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(n=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(n.substr(0,4))));var n}),Ne.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return Hk(Ne.getNumber("WEBGL_VERSION"))}),Ne.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!Ne.getBool("WEBGL_FORCE_F16_TEXTURES")&&Ne.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),Ne.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return Wk(Ne.getNumber("WEBGL_VERSION"))}),Ne.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return zk(Ne.getNumber("WEBGL_VERSION"))}),Ne.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return Ne.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),gk=$k;var Hn=F({complex_:function(n,t){var e=S(n,"real","complex"),r=S(t,"imag","complex");return at(e.shape,r.shape,"real and imag shapes, "+e.shape+" and "+r.shape+", must match in call to tf.complex()."),N.runKernelFunc(function(o){return o.complex(e,r)},{$real:e,$imag:r})}}),fo=F({real_:function(n){var t=S(n,"input","real");return N.runKernelFunc(function(e){return e.real(t)},{$input:t})}}),fi=F({imag_:function(n){var t=S(n,"input","imag");return N.runKernelFunc(function(e){return e.imag(t)},{$input:t})}});function Wn(n,t,e){return ra(n,t,di(n,e),e)}function ra(n,t,e,r){if(null==r&&(r=Il(n)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Un(n)&&!Array.isArray(n)&&"number"!=typeof n&&"boolean"!=typeof n&&"string"!=typeof n)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){O0(t);var o=me(t),i=me(e);I(o===i,function(){return"Based on the provided shape, ["+t+"], the tensor should have "+o+" values but has "+i});for(var s=0;s<e.length;++s){var u=s!==e.length-1||e[s]!==me(t.slice(s));I(e[s]===t[s]||!u,function(){return"Error creating a new Tensor. Inferred shape ("+e+") does not match the provided shape ("+t+"). "})}}return Un(n)||Array.isArray(n)||(n=[n]),t=t||e,n="string"!==r?N0(n,r,$().getBool("DEBUG")):ts(n,[],!0),N.makeTensor(n,t,r)}function oe(n,t){if((Un(n)&&"string"!==t||Array.isArray(n))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&Un(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return ra(n,[],[],t)}function mn(n,t){Ga(n);var e=di(n,t);if(1!==e.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return ra(n,null,e,t)}function oa(n,t,e){if(Ga(n),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");var r=di(n,e);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return ra(n,t,r,e)}function J0(n,t,e){if(Ga(n),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");var r=di(n,e);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return ra(n,t,r,e)}function Rr(n,t,e){if(Ga(n),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");var r=di(n,e);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return ra(n,t,r,e)}function Ml(n,t){if(void 0===t&&(t="float32"),"complex64"===t){var e=Ml(n,"float32"),r=Ft(n,"float32");return Hn(e,r)}var o=P0(me(n),t);return N.makeTensor(o,n,t)}function Ft(n,t){if(void 0===t&&(t="float32"),"complex64"===t){var e=Ft(n,"float32"),r=Ft(n,"float32");return Hn(e,r)}var o=Al(me(n),t);return N.makeTensor(o,n,t)}function hi(n,t,e){return N.runKernelFunc(function(r){return r.fill(n,t,e)},{})}function Lg(n,t,e,r){if(void 0===e&&(e=1),void 0===r&&(r="float32"),0===e)throw new Error("Cannot have a step of zero");if(n===t||n<t&&e<0||t<n&&e>1)return Ft([0],r);var o=Al(Math.abs(Math.ceil((t-n)/e)),r);t<n&&1===e&&(e=-1),o[0]=n;for(var i=1;i<o.length;i++)o[i]=o[i-1]+e;return mn(o,r)}var Xk=F({onesLike_:function(n){var t=S(n,"x","onesLike");if("complex64"===t.dtype){var e=Xk(fo(t)),r=ut(fi(t));return Hn(e,r)}return N.runKernelFunc(function(o){return o.onesLike(t)},{$x:t},function(o,i){return{$x:function(){return ut(o)}}})}}),ut=F({zerosLike_:function(n){var t=S(n,"x","zerosLike");return N.runKernelFunc(function(e){return e.zerosLike(t)},{$x:t},function(e,r){return{$x:function(){return ut(e)}}})}}),Dn=F({concat_:function(n,t){void 0===t&&(t=0),I(n.length>=1,function(){return"Pass at least one tensor to concat"});var e=ff(n,"tensors","concat");"complex64"===e[0].dtype&&e.forEach(function(a){if("complex64"!==a.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype "+a.dtype+". ")}),t=gn(t,e[0].shape)[0];var r=Xa(e.map(function(a){return a.shape}),t);if(0===me(r))return Wn([],r);if(1===(e=e.filter(function(a){return a.size>0})).length)return e[0];var o=e.map(function(a){return a.shape});return Kk(o,t),N.runKernelFunc(function(a){return a.concat(e,t)},e,function(a){var u=o.map(function(l){return l[t]});return e_(a,u,t).map(function(l){return function(){return l}})},"Concat",{axis:t})}}),WG=F({concat1d_:function(n){return Dn(n,0)}}),zG=F({concat2d_:function(n,t){return Dn(n,t)}}),$G=F({concat3d_:function(n,t){return Dn(n,t)}}),GG=F({concat4d_:function(n,t){return Dn(n,t)}}),e_=F({split_:function(n,t,e){void 0===e&&(e=0);var r,o=S(n,"x","split");return e=gn(e,o.shape)[0],"number"==typeof t?(I(o.shape[e]%t==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(t).fill(o.shape[e]/t)):(I(o.shape[e]===t.reduce(function(i,s){return i+s}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=t),N.runKernelFunc(function(i){return i.split(o,r,e)},{$x:o},function(i){return{$x:function(){return Dn(i,e)}}})}});function Ya(n,t){return n(t={exports:{}},t.exports),t.exports}typeof globalThis<"u"||typeof window<"u"||typeof global<"u"&&global;var qG=Ya(function(n){!function(t,e,r){function o(a){var u,l=this,c=(u=4022871197,function(d){d=d.toString();for(var f=0;f<d.length;f++){var h=.02519603282416938*(u+=d.charCodeAt(f));h-=u=h>>>0,u=(h*=u)>>>0,u+=4294967296*(h-=u)}return 2.3283064365386963e-10*(u>>>0)});l.next=function(){var d=2091639*l.s0+2.3283064365386963e-10*l.c;return l.s0=l.s1,l.s1=l.s2,l.s2=d-(l.c=0|d)},l.c=1,l.s0=c(" "),l.s1=c(" "),l.s2=c(" "),l.s0-=c(a),l.s0<0&&(l.s0+=1),l.s1-=c(a),l.s1<0&&(l.s1+=1),l.s2-=c(a),l.s2<0&&(l.s2+=1),c=null}function i(a,u){return u.c=a.c,u.s0=a.s0,u.s1=a.s1,u.s2=a.s2,u}function s(a,u){var l=new o(a),c=u&&u.state,d=l.next;return d.int32=function(){return 4294967296*l.next()|0},d.double=function(){return d()+11102230246251565e-32*(2097152*d()|0)},d.quick=d,c&&("object"==typeof c&&i(c,l),d.state=function(){return i(l,{})}),d}e&&e.exports?e.exports=s:this.alea=s}(0,n)}),KG=Ya(function(n){!function(t,e,r){function o(a){var u=this,l="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var d=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^d^d>>>8},a===(0|a)?u.x=a:l+=a;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),u.next()}function i(a,u){return u.x=a.x,u.y=a.y,u.z=a.z,u.w=a.w,u}function s(a,u){var l=new o(a),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do{var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152}while(0===f);return f},d.int32=l.next,d.quick=d,c&&("object"==typeof c&&i(c,l),d.state=function(){return i(l,{})}),d}e&&e.exports?e.exports=s:this.xor128=s}(0,n)}),XG=Ya(function(n){!function(t,e,r){function o(a){var u=this,l="";u.next=function(){var d=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^d^d<<1)|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,a===(0|a)?u.x=a:l+=a;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),c==l.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function i(a,u){return u.x=a.x,u.y=a.y,u.z=a.z,u.w=a.w,u.v=a.v,u.d=a.d,u}function s(a,u){var l=new o(a),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do{var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152}while(0===f);return f},d.int32=l.next,d.quick=d,c&&("object"==typeof c&&i(c,l),d.state=function(){return i(l,{})}),d}e&&e.exports?e.exports=s:this.xorwow=s}(0,n)}),YG=Ya(function(n){!function(t,e,r){function o(a){var u=this;u.next=function(){var l,c,d=u.x,f=u.i;return l=d[f],c=(l^=l>>>7)^l<<24,c^=(l=d[f+1&7])^l>>>10,c^=(l=d[f+3&7])^l>>>3,c^=(l=d[f+4&7])^l<<7,l=d[f+7&7],c^=(l^=l<<13)^l<<9,d[f]=c,u.i=f+1&7,c},function(l,c){var d,f=[];if(c===(0|c))f[0]=c;else for(c=""+c,d=0;d<c.length;++d)f[7&d]=f[7&d]<<15^c.charCodeAt(d)+f[d+1&7]<<13;for(;f.length<8;)f.push(0);for(d=0;d<8&&0===f[d];++d);for(8==d&&(f[7]=-1),l.x=f,l.i=0,d=256;d>0;--d)l.next()}(u,a)}function i(a,u){return u.x=a.x.slice(),u.i=a.i,u}function s(a,u){null==a&&(a=+new Date);var l=new o(a),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do{var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152}while(0===f);return f},d.int32=l.next,d.quick=d,c&&(c.x&&i(c,l),d.state=function(){return i(l,{})}),d}e&&e.exports?e.exports=s:this.xorshift7=s}(0,n)}),QG=Ya(function(n){!function(t,e,r){function o(a){var u=this;u.next=function(){var l,c,d=u.w,f=u.X,h=u.i;return u.w=d=d+1640531527|0,c=f[h+34&127],l=f[h=h+1&127],c^=c<<13,l^=l<<17,c=f[h]=(c^=c>>>15)^(l^=l>>>12),u.i=h,c+(d^d>>>16)|0},function(l,c){var d,f,h,p,m,v=[],y=128;for(c===(0|c)?(f=c,c=null):(c+="\0",f=0,y=Math.max(y,c.length)),h=0,p=-32;p<y;++p)c&&(f^=c.charCodeAt((p+32)%c.length)),0===p&&(m=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,p>=0&&(h=0==(d=v[127&p]^=f+(m=m+1640531527|0))?h+1:0);for(h>=128&&(v[127&(c&&c.length||0)]=-1),h=127,p=512;p>0;--p)f=v[h+34&127],d=v[h=h+1&127],f^=f<<13,d^=d<<17,v[h]=(f^=f>>>15)^(d^=d>>>12);l.w=m,l.X=v,l.i=h}(u,a)}function i(a,u){return u.i=a.i,u.w=a.w,u.X=a.X.slice(),u}function s(a,u){null==a&&(a=+new Date);var l=new o(a),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do{var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152}while(0===f);return f},d.int32=l.next,d.quick=d,c&&(c.X&&i(c,l),d.state=function(){return i(l,{})}),d}e&&e.exports?e.exports=s:this.xor4096=s}(0,n)}),ZG=Ya(function(n){!function(t,e,r){function o(a){var u=this,l="";u.next=function(){var d=u.b,f=u.c,h=u.d,p=u.a;return d=d<<25^d>>>7^f,f=f-h|0,h=h<<24^h>>>8^p,p=p-d|0,u.b=d=d<<20^d>>>12^f,u.c=f=f-h|0,u.d=h<<16^f>>>16^p,u.a=p-d|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,a===Math.floor(a)?(u.a=a/4294967296|0,u.b=0|a):l+=a;for(var c=0;c<l.length+20;c++)u.b^=0|l.charCodeAt(c),u.next()}function i(a,u){return u.a=a.a,u.b=a.b,u.c=a.c,u.d=a.d,u}function s(a,u){var l=new o(a),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do{var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152}while(0===f);return f},d.int32=l.next,d.quick=d,c&&("object"==typeof c&&i(c,l),d.state=function(){return i(l,{})}),d}e&&e.exports?e.exports=s:this.tychei=s}(0,n)}),Qa=Ya(function(n){!function(t,e){var r,o=this,i=256,a="random",u=e.pow(i,6),l=e.pow(2,52),c=2*l,d=255;function f(y,_,b){var x=[],E=m(function R(A,M){var O,P=[],G=typeof A;if(M&&"object"==G)for(O in A)try{P.push(R(A[O],M-1))}catch{}return P.length?P:"string"==G?A:A+"\0"}((_=1==_?{entropy:!0}:_||{}).entropy?[y,v(t)]:y??function(){try{var R;return r&&(R=r.randomBytes)?R=R(i):(R=new Uint8Array(i),(o.crypto||o.msCrypto).getRandomValues(R)),v(R)}catch{var A=o.navigator,M=A&&A.plugins;return[+new Date,o,M,o.screen,v(t)]}}(),3),x),D=new h(x),k=function(){for(var R=D.g(6),A=u,M=0;R<l;)R=(R+M)*i,A*=i,M=D.g(1);for(;R>=c;)R/=2,A/=2,M>>>=1;return(R+M)/A};return k.int32=function(){return 0|D.g(4)},k.quick=function(){return D.g(4)/4294967296},k.double=k,m(v(D.S),t),(_.pass||b||function(R,A,M,O){return O&&(O.S&&p(O,D),R.state=function(){return p(D,{})}),M?(e[a]=R,A):R})(k,E,"global"in _?_.global:this==e,_.state)}function h(y){var _,b=y.length,x=this,E=0,D=x.i=x.j=0,k=x.S=[];for(b||(y=[b++]);E<i;)k[E]=E++;for(E=0;E<i;E++)k[E]=k[D=d&D+y[E%b]+(_=k[E])],k[D]=_;(x.g=function(R){for(var A,M=0,O=x.i,P=x.j,G=x.S;R--;)A=G[O=d&O+1],M=M*i+G[d&(G[O]=G[P=d&P+A])+(G[P]=A)];return x.i=O,x.j=P,M})(i)}function p(y,_){return _.i=y.i,_.j=y.j,_.S=y.S.slice(),_}function m(y,_){for(var b,x=y+"",E=0;E<x.length;)_[d&E]=d&(b^=19*_[d&E])+x.charCodeAt(E++);return v(_)}function v(y){return String.fromCharCode.apply(0,y)}if(e["seed"+a]=f,m(e.random(),t),n.exports){n.exports=f;try{r=sr(902)}catch{}}}([],Math)});Qa.alea=qG,Qa.xor128=KG,Qa.xorwow=XG,Qa.xorshift7=YG,Qa.xor4096=QG,Qa.tychei=ZG;var Bg=Qa.alea,t_=function(){function n(t,e,r,o,i){this.mean=t,this.stdDev=e,this.dtype=r,this.nextVal=NaN,this.truncated=o,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var s=i||Math.random();this.random=Bg(s.toString())}return n.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var e,r,o=!1;!o;){var i=void 0,s=void 0,a=void 0;do{a=(i=2*this.random()-1)*i+(s=2*this.random()-1)*s}while(a>=1||0===a);var u=Math.sqrt(-2*Math.log(a)/a);e=this.mean+this.stdDev*i*u,r=this.mean+this.stdDev*s*u,this.truncated&&!this.isValidTruncated(e)||(o=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(e)},n.prototype.convertValue=function(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)},n.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},n}(),JG=function(){function n(t,e,r,o){this.alpha=t,this.beta=1/e,this.dtype=r;var i=o||Math.random();this.randu=Bg(i.toString()),this.randn=new t_(0,1,r,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return n.prototype.nextValue=function(){for(var t,e,r,o,i,s;;){do{o=this.randn.nextValue(),s=1+this.c*o}while(s<=0);if(e=1-.331*(t=o*o)*t,r=.5*t+this.d*(1-(s*=s*s)+Math.log(s)),(i=this.randu())<e||Math.log(i)<r)break}return s*=1/this.beta*this.d,this.alpha<1&&(s*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(s)},n.prototype.convertValue=function(t){return"float32"===this.dtype?t:Math.round(t)},n}(),e8=function(){function n(t,e,r,o){var i=this;if(void 0===t&&(t=0),void 0===e&&(e=1),this.canReturnFloat=function(){return null==i.dtype||"float32"===i.dtype},this.min=t,this.range=e-t,this.dtype=r,null==o&&(o=Math.random()),"number"==typeof o&&(o=o.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+e+" <= 1 and dtype is not float");this.random=Bg(o)}return n.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},n.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},n}();function Ue(n,t,e){return void 0===t&&(t="float32"),t=t||"float32",O0(n),new tf(n,t,e)}var Yk=F({batchToSpaceND_:function(n,t,e){var r=S(n,"x","batchToSpaceND"),o=t.reduce(function(i,s){return i*s});return I(r.rank>=1+t.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+t.length}),I(e.length===t.length,function(){return"crops.length is "+e.length+" but should be equal to blockShape.length  "+t.length}),I(r.shape[0]%o==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+o}),N.runKernelFunc(function(i){return i.batchToSpaceND(r,t,e)},{$x:r},function(i){return{$x:function(){return i.spaceToBatchND(t,e)}}})}}),n8=F({broadcastTo_:function(n,t){var e=S(n,"broadcastTo","x"),r=e.shape;if(t.some(function(u){return!(u>0)||u%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<e.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+e.rank+".");if(t.length>e.rank){for(var o=e.shape.slice();o.length<t.length;)o.unshift(1);e=e.reshape(o)}for(var i=Array.from(t),s=t.length-1;s>=0;s--)if(e.shape[s]===t[s])i[s]=1;else if(1!==e.shape[s])throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var a=i.map(function(u,l){return u>1?l:-1}).filter(function(u){return u>=0});return 0===a.length?e.clone():N.runKernelFunc(function(u){return u.tile(e,i)},{input:e},function(u){return{input:function(){return u.sum(a,!0)}}})}}),r8=F({cast_:function(n,t){var e=S(n,"x","cast");if(!sk(t))throw new Error("Failed to cast to unknown dtype "+t);if("string"===t&&"string"!==e.dtype||"string"!==t&&"string"===e.dtype)throw new Error("Only strings can be casted to strings");return N.runKernelFunc(function(o){return o.cast(e,t)},{x:e},function(o){return{x:function(){return o.clone()}}},"Cast",{dtype:t})}}),o8=F({clone_:function(n){var t=S(n,"x","clone",null);return N.runKernelFunc(function(){return N.makeTensorFromDataId(t.dataId,t.shape,t.dtype)},{$x:t},function(e){return{$x:function(){return e.toFloat()}}})}}),i8=F({cumsum_:function(n,t,e,r){void 0===t&&(t=0),void 0===e&&(e=!1),void 0===r&&(r=!1);var o=S(n,"x","cumsum"),i=Oo([t|=0],o.rank),s=o;null!=i&&(s=o.transpose(i));var a=Lo(1,o.rank)[0],u=N.runKernelFunc(function(l){return l.cumsum(s,a,e,r)},{permutedX:s},function(l){return{permutedX:function(){return l.cumsum(t,e,!r)}}});return null!=i&&(u=u.transpose(i)),u}}),s8=F({depthToSpace_:function(n,t,e){void 0===e&&(e="NHWC");var r=S(n,"x","depthToSpace"),o="NHWC"===e?r.shape[1]:r.shape[2],i="NHWC"===e?r.shape[2]:r.shape[3],s="NHWC"===e?r.shape[3]:r.shape[1];return I(o*t>=0,function(){return"Negative dimension size caused by overflow when multiplying\n      "+o+" and "+t+"  for depthToSpace with input shape\n      "+r.shape}),I(i*t>=0,function(){return"Negative dimension size caused by overflow when multiplying\n      "+i+" and "+t+" for depthToSpace with input shape\n          "+r.shape}),I(s%(t*t)==0,function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+s+" for depthToSpace with input shape "+r.shape}),N.runKernelFunc(function(a){return a.depthToSpace(r,t,e)},{$x:r})}}),ho=F({expandDims_:function(n,t){void 0===t&&(t=0);var e=S(n,"x","expandDims",null);I(t<=e.rank,function(){return"Axis must be <= rank of the tensor"});var r=e.shape.slice();return t<0&&(I(-(e.rank+1)<=t,function(){return"Axis must be in the interval ["+-(e.rank+1)+", "+e.rank+"]"}),t=e.rank+t+1),r.splice(t,0,1),Bo(e,r)}}),Qk=F({eye_:function(n,t,e,r){void 0===r&&(r="float32"),null==t&&(t=n);for(var o=Ue([n,t],r),i=n<=t?n:t,s=0;s<i;++s)o.set(1,s,s);var a=o.toTensor().as2D(n,t);if(null==e)return a;if(1===e.length)return kl(ho(a,0),[e[0],1,1]);if(2===e.length)return kl(ho(ho(a,0),0),[e[0],e[1],1,1]);if(3===e.length)return kl(ho(ho(ho(a,0),0),0),[e[0],e[1],e[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+e.length+"D.")}}),a8=F({multinomial_:function(n,t,e,r){void 0===r&&(r=!1);var o=S(n,"logits","multinomial"),i=o.size,s=o.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(s>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+s);e=e||Math.random();var a=1===s?o.as2D(1,-1):o,u=N.runKernelFunc(function(l){return l.multinomial(a,r,t,e)},{logits2D:a});return 1===s?u.as1D():u}}),n_=F({oneHot_:function(n,t,e,r){if(void 0===e&&(e=1),void 0===r&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var o=S(n,"indices","oneHot","int32"),i=o.shape.concat([t]);return o=o.flatten(),N.runKernelFunc(function(s){return s.oneHot(o,t,e,r)},{$indices:o},function(s){return{$indices:function(){return Ft(o.shape,"float32")}}}).reshape(i)}}),Za=F({pad_:function(n,t,e){void 0===e&&(e=0);var r=S(n,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");return N.runKernelFunc(function(i){return i.pad(r,t,e)},{x:r},function(i){var s=t.map(function(a){return a[0]});return{x:function(){return i.slice(s,r.shape)}}},"PadV2",{paddings:t,constantValue:e})}}),u8=F({pad1d_:function(n,t,e){return void 0===e&&(e=0),I(2===t.length,function(){return"Invalid number of paddings. Must be length of 2."}),Za(n,[t],e)}}),l8=F({pad2d_:function(n,t,e){return void 0===e&&(e=0),I(2===t.length&&2===t[0].length&&2===t[1].length,function(){return"Invalid number of paddings. Must be length of 2 each."}),Za(n,t,e)}}),c8=F({pad3d_:function(n,t,e){return void 0===e&&(e=0),I(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,function(){return"Invalid number of paddings. Must be length of 2 each."}),Za(n,t,e)}}),d8=F({pad4d_:function(n,t,e){return void 0===e&&(e=0),I(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,function(){return"Invalid number of paddings. Must be length of 2 each."}),Za(n,t,e)}}),f8=F({rand_:function(n,t,e){var r=me(n),o=null;if(null==e||"float32"===e)o=new Float32Array(r);else if("int32"===e)o=new Int32Array(r);else{if("bool"!==e)throw new Error("Unknown data type "+e);o=new Uint8Array(r)}for(var i=0;i<r;i++)o[i]=t();return N.makeTensor(o,n,e)}}),h8=F({randomNormal_:function(n,t,e,r,o){if(void 0===t&&(t=0),void 0===e&&(e=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var i=new t_(t,e,r,!1,o),s=Ue(n,r),a=0;a<s.values.length;a++)s.values[a]=i.nextValue();return s.toTensor()}}),p8=F({randomGamma_:function(n,t,e,r,o){if(void 0===e&&(e=1),void 0===r&&(r="float32"),null==e&&(e=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type "+r);for(var i=new JG(t,e,r,o),s=Ue(n,r),a=0;a<s.values.length;a++)s.values[a]=i.nextValue();return s.toTensor()}}),Zk=F({randomUniform_:function(n,t,e,r,o){void 0===t&&(t=0),void 0===e&&(e=1),void 0===r&&(r="float32");for(var i=Ue(n,r),s=new e8(t,e,null,o),a=0;a<i.values.length;a++)i.values[a]=s.nextValue();return i.toTensor()}}),Bo=F({reshape_:function(n,t){var e=S(n,"x","reshape",null);return t=ok(t,e.size),I(e.size===me(t),function(){return"new shape and old shape must have the same number of elements."}),N.runKernelFunc(function(o){return o.reshape(e,t)},{x:e},function(o){return{x:function(){return o.reshape(e.shape)}}},"Reshape",{shape:t})}}),Jk=F({spaceToBatchND_:function(n,t,e){var r=S(n,"x","spaceToBatchND");return I(r.rank>=1+t.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+t.length}),I(e.length===t.length,function(){return"paddings.shape[0] "+e.length+" must be equal to [blockShape] "+t.length}),I(r.shape.reduce(function(o,i,s){return s>0&&s<=t.length?o&&(i+e[s-1][0]+e[s-1][1])%t[s-1]==0:o},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+e.toString()+" must be divisible by blockShapes "+t.toString()}),N.runKernelFunc(function(o){return o.spaceToBatchND(r,t,e)},{$x:r},function(o){return{$x:function(){return o.batchToSpaceND(t,e)}}})}}),eR=F({squeeze_:function(n,t){var e=S(n,"x","squeeze");return Bo(e,ea(e.shape,t).newShape)}}),qr=F({stack_:function(n,t){void 0===t&&(t=0);var e=ff(n,"tensors","stack");if(I(e.length>=1,function(){return"Pass at least one tensor to tf.stack"}),1===e.length)return e[0].expandDims(t);var o=e[0].shape,i=e[0].dtype;I(t<=e[0].rank,function(){return"Axis must be <= rank of the tensor"}),e.forEach(function(a){at(o,a.shape,"All tensors passed to stack must have matching shapes")}),e.forEach(function(a){I(i===a.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var s=e.map(function(a){return a.expandDims(t)});return Dn(s,t)}}),kl=F({tile_:function(n,t){var e=S(n,"x","tile",null);return I(e.rank===t.length,function(){return"Error in transpose: rank of input "+e.rank+" must match length of reps "+t+"."}),N.runKernelFunc(function(i,s){var a=i.tile(e,t);return s([e]),a},{x:e},function(i,s){var a=s[0];return{x:function(){var u=ut(a);if(1===a.rank)for(var l=0;l<t[0];++l)u=u.add(i.slice([l*a.shape[0]],[a.shape[0]]));else if(2===a.rank)for(l=0;l<t[0];++l)for(var c=0;c<t[1];++c)u=u.add(i.slice([l*a.shape[0],c*a.shape[1]],[a.shape[0],a.shape[1]]));else if(3===a.rank)for(l=0;l<t[0];++l)for(c=0;c<t[1];++c)for(var d=0;d<t[2];++d)u=u.add(i.slice([l*a.shape[0],c*a.shape[1],d*a.shape[2]],[a.shape[0],a.shape[1],a.shape[2]]));else{if(4!==a.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+a.rank+" tensors yet.");for(l=0;l<t[0];++l)for(c=0;c<t[1];++c)for(d=0;d<t[2];++d)for(var f=0;f<t[3];++f)u=u.add(i.slice([l*a.shape[0],c*a.shape[1],d*a.shape[2],f*a.shape[3]],[a.shape[0],a.shape[1],a.shape[2],a.shape[3]]))}return u}}},"Tile",{reps:t},[e])}}),g8=F({truncatedNormal_:function(n,t,e,r,o){if(void 0===t&&(t=0),void 0===e&&(e=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var i=new t_(t,e,r,!0,o),s=Ue(n,r),a=0;a<s.values.length;a++)s.values[a]=i.nextValue();return s.toTensor()}}),Sn=F({unstack_:function(n,t){void 0===t&&(t=0),t=t||0;var e=S(n,"x","unstack");return I(t>=-e.shape.length&&t<e.shape.length,function(){return"Axis = "+t+" is not in [-"+e.shape.length+", "+e.shape.length+")"}),t<0&&(t+=e.shape.length),N.runKernelFunc(function(o){return o.unstack(e,t)},{x:e},function(o){return{x:function(){return qr(o,t)}}},"Unpack",{axis:t})}});function Vg(n,t,e,r){void 0===r&&(r=!0);var o=[];if(r)(o=o.concat(t.slice(0))).push(n[0]/e),o=o.concat(n.slice(1));else{o=o.concat(n[0]);for(var i=t.length,s=0;s<i;++s)o=o.concat([n[s+1]/t[s],t[s]]);o=o.concat(n.slice(i+1))}return o}function Ug(n,t,e){void 0===e&&(e=!0);var r=[];if(e){r.push(t);for(var o=t+1;o<n;++o)o<=2*t?(r.push(o),r.push(o-(t+1))):r.push(o)}else{var i=[],s=[];for(o=1;o<n;++o)o>=2*t+1||o%2==1?s.push(o):i.push(o);r.push.apply(r,i),r.push(0),r.push.apply(r,s)}return r}function jg(n,t,e,r){void 0===r&&(r=!0);var o=[];o.push(r?n[0]/e:n[0]*e);for(var i=1;i<n.length;++i)o.push(i<=t.length?r?t[i-1]*n[i]:n[i]/t[i-1]:n[i]);return o}function tR(n,t){for(var e=[0],r=0;r<t;++r)e.push(n[r][0]);return e}function nR(n,t,e){for(var r=n.slice(0,1),o=0;o<e;++o)r.push(n[o+1]-t[o][0]-t[o][1]);return r}function r_(n,t){if(n.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+n.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>n.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+n.rank);if(0===n.size)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+n.shape+".");for(var e=t.shape,r=e[e.length-1],o=1,i=0;i<e.length-1;++i)o*=e[i];var s=n.shape,a=e.slice();a.pop();var u=1;for(i=r;i<n.rank;++i)u*=s[i],a.push(s[i]);var l=Fo(n.shape).map(function(c){return c/u}).concat([1]).slice(0,r);return[a,o,u,l]}function Hg(n){return n<=30?n:Ig(n,Math.floor(Math.sqrt(n)))}function rR(n,t,e){var r=t.rank>1?t.shape[t.rank-1]:1,o=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+e.shape+", indices.shape: "+t.shape+", shape: "+n+", sliceDim: "+r+", and batchDim: "+o+".";if(e.rank<o)throw new Error(i+" update.rank < "+o+". ");if(n.length<r+(e.rank-o))throw new Error(i+" Output shape length < "+(r+(e.rank-o)));if(e.rank!==o+n.length-r)throw new Error(i+" update.rank != "+(o+n.length-r));for(var s=0;s<o;++s)if(e.shape[s]!==t.shape[s])throw new Error(i+" updates.shape["+s+"] ("+e.shape[s]+") != indices.shape["+s+"] ("+t.shape[s]+").");for(s=0;s<e.rank-o;++s)if(e.shape[s+o]!==n[s+r])throw new Error(i+" updates.shape["+(s+o)+"] ("+e.shape[s+o]+") != shape["+(s+o)+"] ("+n[s+o]+")")}function oR(n,t,e){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(n.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+n.rank+".");if("int32"!==t.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(e.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+e);if(0===e.length){if(0===t.size)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(0===n.size)throw new Error("Updates specified for empty output. updates shape: "+n.shape)}rR(e,t,n)}function hf(n,t,e){for(var r=t.shape.length,o=r>1?t.shape[r-1]:1,i=e.length,s=1,a=o;a<i;++a)s*=e[a];var u=o<1?1:o;return{sliceRank:o,numUpdates:me(t.shape)/u,sliceSize:s,strides:Fo(e.slice(0,o)).concat([1]),outputSize:me(e)}}function iR(n,t,e){I(n.rank===t.length,function(){return"Error in slice"+n.rank+"D: Length of begin "+t+" must match the rank of the array ("+n.rank+")."}),I(n.rank===e.length,function(){return"Error in slice"+n.rank+"D: Length of size "+e+" must match the rank of the array ("+n.rank+")."});for(var r=function(i){I(t[i]+e[i]<=n.shape[i],function(){return"Error in slice"+n.rank+"D: begin["+i+"] + size["+i+"] ("+(t[i]+e[i])+") would overflow input.shape["+i+"] ("+n.shape[i]+")"})},o=0;o<n.rank;++o)r(o)}function i_(n){for(var t=[],e=0;n>0;)1&n&&t.push(e),n/=2,e++;return t}function Wg(n,t,e){for(var r=[],o=0;o<n.length;o++)r[o]=Math.ceil((t[o]-n[o])/e[o]);return r}function sR(n,t,e,r,o){var i=t[o];(n&1<<o||null==i)&&(i=(e[o]||1)>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var a=r[o];return i<0&&(i+=a),Dg(0,i,a-1)}function aR(n,t,e,r,o){var i=t[o],s=e[o]||1;(n&1<<o||null==i)&&(i=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var a=r[o];return i<0&&(i+=a),s>0?Dg(0,i,a):Dg(-1,i,a-1)}function s_(n,t,e){for(var r=e.length,o=0;o<e.length;o++)if(e[o]>1){r=o;break}for(o=r+1;o<e.length;o++)if(t[o]>0||e[o]!==n[o])return!1;return!0}function a_(n,t){for(var e=n.length>0?n[n.length-1]:1,r=0;r<n.length-1;r++)e+=n[r]*t[r];return e}function zg(n){return N.customGrad(n)}Object.freeze({prepareAndValidate:r_}),Object.freeze({validateUpdateShape:rR,validateInput:oR,calculateShapes:hf}),Object.freeze({assertParamsValid:iR,maskToAxes:i_,computeOutShape:Wg,startForAxis:sR,stopForAxis:aR,isSliceContinous:s_,computeFlatOffset:a_});var os=F({softmax_:function(n,t){void 0===t&&(t=-1);var e=S(n,"logits","softmax","float32");if(-1===t&&(t=e.rank-1),t!==e.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+e.rank+" and dim was "+t);return N.runKernelFunc(function(r,o){var i=r.softmax(e,t);return o([i]),i},{logits:e},function(r,o){var i=o[0],s=r.mul(i);return{logits:function(){return s.sub(s.sum([t],!0).mul(i))}}},"Softmax",{dim:t},[],[!0])}}),y8=F({logSoftmax_:function(n,t){void 0===t&&(t=-1);var e=S(n,"logits","logSoftmax");if(-1===t&&(t=e.rank-1),t!==e.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+e.rank+" and axis was "+t);return zg(function(r,o){var i=r.max(t,!0),s=r.sub(i),a=s.toFloat().sub(s.exp().sum(t,!0).log());return o([a]),{value:a,gradFunc:function(u,l){var c=l[0].exp();return u.sub(u.sum(t,!0).mul(c))}}})(e)}}),uR=function(){function n(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}return n.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},n.prototype.set=function(t,e){this.dataIdsCount++,this.data.set(t,e)},n.prototype.has=function(t){return this.data.has(t)},n.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},n.prototype.numDataIds=function(){return this.dataIdsCount},n}(),lR=function(){function n(){}return n.prototype.time=function(t){return j("time")},n.prototype.read=function(t){return j("read")},n.prototype.readSync=function(t){return j("readSync")},n.prototype.numDataIds=function(){return j("numDataIds")},n.prototype.disposeData=function(t){return j("disposeData")},n.prototype.write=function(t,e,r){return j("write")},n.prototype.move=function(t,e,r,o){return j("move")},n.prototype.memory=function(){return j("memory")},n.prototype.floatPrecision=function(){return j("floatPrecision")},n.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},n.prototype.batchMatMul=function(t,e,r,o){return j("batchMatMul")},n.prototype.fusedBatchMatMul=function(t){return j("fusedBatchMatMul")},n.prototype.slice=function(t,e,r){return j("slice")},n.prototype.stridedSlice=function(t,e,r,o){return j("stridedSlice")},n.prototype.unstack=function(t,e){return j("unstack")},n.prototype.reverse=function(t,e){return j("reverse")},n.prototype.concat=function(t,e){return j("concat")},n.prototype.neg=function(t){return j("neg")},n.prototype.add=function(t,e){return j("add")},n.prototype.addN=function(t){return j("addN")},n.prototype.subtract=function(t,e){return j("subtract")},n.prototype.multiply=function(t,e){return j("multiply")},n.prototype.realDivide=function(t,e){return j("realDivide")},n.prototype.floorDiv=function(t,e){return j("floorDiv")},n.prototype.sum=function(t,e){return j("sum")},n.prototype.prod=function(t,e){return j("prod")},n.prototype.unsortedSegmentSum=function(t,e,r){return j("unsortedSegmentSum")},n.prototype.argMin=function(t,e){return j("argMin")},n.prototype.argMax=function(t,e){return j("argMax")},n.prototype.equal=function(t,e){return j("equal")},n.prototype.notEqual=function(t,e){return j("notEqual")},n.prototype.less=function(t,e){return j("less")},n.prototype.lessEqual=function(t,e){return j("lessEqual")},n.prototype.greater=function(t,e){return j("greater")},n.prototype.greaterEqual=function(t,e){return j("greaterEqual")},n.prototype.logicalNot=function(t){return j("logicalNot")},n.prototype.logicalAnd=function(t,e){return j("logicalAnd")},n.prototype.logicalOr=function(t,e){return j("logicalOr")},n.prototype.where=function(t){return j("where")},n.prototype.select=function(t,e,r){return j("select")},n.prototype.topk=function(t,e,r){return j("topk")},n.prototype.min=function(t,e){return j("min")},n.prototype.minimum=function(t,e){return j("minimum")},n.prototype.mod=function(t,e){return j("mod")},n.prototype.max=function(t,e){return j("max")},n.prototype.maximum=function(t,e){return j("maximum")},n.prototype.all=function(t,e){return j("all")},n.prototype.any=function(t,e){return j("any")},n.prototype.squaredDifference=function(t,e){return j("squaredDifference")},n.prototype.ceil=function(t){return j("ceil")},n.prototype.floor=function(t){return j("floor")},n.prototype.round=function(t){return j("round")},n.prototype.sign=function(t){return j("sign")},n.prototype.isNaN=function(t){return j("isNaN")},n.prototype.isInf=function(t){return j("isInf")},n.prototype.isFinite=function(t){return j("isFinite")},n.prototype.pow=function(t,e){return j("pow")},n.prototype.exp=function(t){return j("exp")},n.prototype.expm1=function(t){return j("expm1")},n.prototype.softmax=function(t,e){return j("softmax")},n.prototype.log=function(t){return j("log")},n.prototype.log1p=function(t){return j("log1p")},n.prototype.sqrt=function(t){return j("sqrt")},n.prototype.rsqrt=function(t){return j("rsqrt")},n.prototype.square=function(t){return j("square")},n.prototype.reciprocal=function(t){return j("reciprocal")},n.prototype.relu=function(t){return j("relu")},n.prototype.relu6=function(t){return j("relu6")},n.prototype.prelu=function(t,e){return j("prelu")},n.prototype.elu=function(t){return j("elu")},n.prototype.eluDer=function(t,e){return j("eluDer")},n.prototype.selu=function(t){return j("selu")},n.prototype.int=function(t){return j("int")},n.prototype.clip=function(t,e,r){return j("clip")},n.prototype.abs=function(t){return j("abs")},n.prototype.complexAbs=function(t){return j("complexAbs")},n.prototype.sigmoid=function(t){return j("sigmoid")},n.prototype.softplus=function(t){return j("softplus")},n.prototype.sin=function(t){return j("sin")},n.prototype.cos=function(t){return j("cos")},n.prototype.tan=function(t){return j("tan")},n.prototype.asin=function(t){return j("asin")},n.prototype.acos=function(t){return j("acos")},n.prototype.atan=function(t){return j("atan")},n.prototype.atan2=function(t,e){return j("atan2")},n.prototype.sinh=function(t){return j("sinh")},n.prototype.cosh=function(t){return j("cosh")},n.prototype.tanh=function(t){return j("tanh")},n.prototype.asinh=function(t){return j("asinh")},n.prototype.acosh=function(t){return j("acosh")},n.prototype.atanh=function(t){return j("atanh")},n.prototype.erf=function(t){return j("erf")},n.prototype.step=function(t,e){return j("step")},n.prototype.fusedConv2d=function(t){return j("fusedConv2d")},n.prototype.conv2d=function(t,e,r){return j("conv2d")},n.prototype.conv2dDerInput=function(t,e,r){return j("conv2dDerInput")},n.prototype.conv2dDerFilter=function(t,e,r){return j("conv2dDerFilter")},n.prototype.fusedDepthwiseConv2D=function(t){return j("fusedDepthwiseConv2D")},n.prototype.depthwiseConv2D=function(t,e,r){return j("depthwiseConv2D")},n.prototype.depthwiseConv2DDerInput=function(t,e,r){return j("depthwiseConv2DDerInput")},n.prototype.depthwiseConv2DDerFilter=function(t,e,r){return j("depthwiseConv2DDerFilter")},n.prototype.conv3d=function(t,e,r){return j("conv3d")},n.prototype.conv3dDerInput=function(t,e,r){return j("conv3dDerInput")},n.prototype.conv3dDerFilter=function(t,e,r){return j("conv3dDerFilter")},n.prototype.maxPool=function(t,e){return j("maxPool")},n.prototype.maxPoolBackprop=function(t,e,r,o){return j("maxPoolBackprop")},n.prototype.avgPool=function(t,e){return j("avgPool")},n.prototype.avgPoolBackprop=function(t,e,r){return j("avgPoolBackprop")},n.prototype.avgPool3d=function(t,e){return j("avgPool3d")},n.prototype.avgPool3dBackprop=function(t,e,r){return j("avgPool3dBackprop")},n.prototype.maxPool3d=function(t,e){return j("maxPool3d")},n.prototype.maxPool3dBackprop=function(t,e,r,o){return j("maxPool3dBackprop")},n.prototype.reshape=function(t,e){return j("reshape")},n.prototype.cast=function(t,e){return j("cast")},n.prototype.tile=function(t,e){return j("tile")},n.prototype.pad=function(t,e,r){return j("pad")},n.prototype.transpose=function(t,e){return j("transpose")},n.prototype.gather=function(t,e,r){return j("gather")},n.prototype.gatherND=function(t,e){return j("gatherND")},n.prototype.scatterND=function(t,e,r){return j("scatterND")},n.prototype.batchToSpaceND=function(t,e,r){return j("batchToSpaceND")},n.prototype.spaceToBatchND=function(t,e,r){return j("spaceToBatchND")},n.prototype.resizeBilinear=function(t,e,r,o){return j("resizeBilinear")},n.prototype.resizeBilinearBackprop=function(t,e,r){return j("resizeBilinearBackprop")},n.prototype.resizeNearestNeighbor=function(t,e,r,o){return j("resizeNearestNeighbor")},n.prototype.resizeNearestNeighborBackprop=function(t,e,r){return j("resizeNearestNeighborBackprop")},n.prototype.batchNormalization=function(t,e,r,o,i,s){return j("batchNormalization")},n.prototype.localResponseNormalization4D=function(t,e,r,o,i){return j("localResponseNormalization4D")},n.prototype.LRNGrad=function(t,e,r,o,i,s,a){return j("LRNGrad")},n.prototype.multinomial=function(t,e,r,o){return j("multinomial")},n.prototype.oneHot=function(t,e,r,o){return j("oneHot")},n.prototype.cumsum=function(t,e,r,o){return j("cumsum")},n.prototype.nonMaxSuppression=function(t,e,r,o,i){return j("nonMaxSuppression")},n.prototype.fft=function(t){return j("fft")},n.prototype.ifft=function(t){return j("ifft")},n.prototype.complex=function(t,e){return j("complex")},n.prototype.real=function(t){return j("real")},n.prototype.imag=function(t){return j("imag")},n.prototype.cropAndResize=function(t,e,r,o,i,s){return j("cropAndResize")},n.prototype.depthToSpace=function(t,e,r){return j("depthToSpace")},n.prototype.split=function(t,e,r){return j("split")},n.prototype.sparseToDense=function(t,e,r,o){return j("sparseToDense")},n.prototype.diag=function(t){return j("diag")},n.prototype.fill=function(t,e,r){return j("fill")},n.prototype.onesLike=function(t){return j("onesLike")},n.prototype.zerosLike=function(t){return j("zerosLike")},n.prototype.linspace=function(t,e,r){return j("linspace")},n.prototype.dispose=function(){return j("dispose")},n}();function j(n){throw new Error("'"+n+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function is(n,t){for(var e=n.length,r=[],o=0;o<e;o++){var i=e-1-o;(t[t.length-1-o]||1)>1&&1===(n[i]||1)&&r.unshift(i)}return r}function vn(n,t){for(var e=[],r=0;r<t.length;r++){var o=n[n.length-r-1],i=t.length-r-1;(null==o||1===o&&t[i]>1)&&e.unshift(i)}return e}function Ze(n,t){for(var e=[],r=Math.max(n.length,t.length),o=0;o<r;o++){var i=n[n.length-o-1];null==i&&(i=1);var s=t[t.length-o-1];if(null==s&&(s=1),1===i)e.unshift(s);else if(1===s)e.unshift(i);else{if(i!==s)throw Error("Operands could not be broadcast together with shapes "+n+" and "+t+".");e.unshift(i)}}return e}function Rl(n,t,e,r,o,i,s){void 0===s&&(s="channelsLast");var a,u=Gg(t),l=u[0],c=u[1];if("channelsLast"===s)a=[l,c,n[3],n[3]];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);a=[l,c,n[1],n[1]]}return ia(n,a,e,r,o,i,!1,s)}function pf(n,t,e,r,o,i,s){void 0===s&&(s="NDHWC");var a,u,l=l_(t),c=l[0],d=l[1],f=l[2];if("NDHWC"===s)u="channelsLast",a=[c,d,f,n[4],n[4]];else{if("NCDHW"!==s)throw new Error("Unknown dataFormat "+s);u="channelsFirst",a=[c,d,f,n[1],n[1]]}return gf(n,a,e,r,o,!1,u,i)}function ia(n,t,e,r,o,i,s,a){void 0===s&&(s=!1),void 0===a&&(a="channelsLast");var u=[-1,-1,-1,-1],l=u[0],c=u[1],d=u[2],f=u[3];if("channelsLast"===a)l=n[0],c=n[1],d=n[2],f=n[3];else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat "+a);l=n[0],f=n[1],c=n[2],d=n[3]}var h,p=t[0],m=t[1],v=t[3],y=Gg(e),_=y[0],b=y[1],x=Gg(r),E=x[0],D=x[1],k=Nl(p,E),R=Nl(m,D),A=function(q,K,L,V,B,z,Y,ne){var se,ve,ge;if("number"==typeof q){se={top:q,bottom:q,left:q,right:q,type:0===q?"VALID":"NUMBER"};var We=function(Ye,Dt,mt,Jt,Gt){null==Jt&&(Jt=u_(Ye,Dt,mt));var bi=Ye[1],_i=mf((Ye[0]-Dt+2*Jt)/mt+1,Gt);I(zt(_i),function(){return"The output # of rows ("+_i+") must be an integer. Change the stride and/or zero pad parameters"});var Zr=mf((bi-Dt+2*Jt)/mt+1,Gt);return I(zt(Zr),function(){return"The output # of columns ("+Zr+") must be an integer. Change the stride and/or zero pad parameters"}),[_i,Zr]}([K,L],z,V,q,ne);ve=We[0],ge=We[1]}else if("same"===q){ve=Math.ceil(K/V),ge=Math.ceil(L/B);var Xe=Math.max(0,(ve-1)*V+z-K),Me=Math.max(0,(ge-1)*B+Y-L),He=Math.floor(Xe/2),Fe=Xe-He,kt=Math.floor(Me/2);se={top:He,bottom:Fe,left:kt,right:Me-kt,type:"SAME"}}else{if("valid"!==q)throw Error("Unknown padding parameter: "+q);se={top:0,bottom:0,left:0,right:0,type:"VALID"},ve=Math.ceil((K-z+1)/V),ge=Math.ceil((L-Y+1)/B)}return{padInfo:se,outHeight:ve,outWidth:ge}}(o,c,d,_,b,k,R,i),O=A.outHeight,P=A.outWidth,G=s?v*f:v;return"channelsFirst"===a?h=[l,G,O,P]:"channelsLast"===a&&(h=[l,O,P,G]),{batchSize:l,dataFormat:a,inHeight:c,inWidth:d,inChannels:f,outHeight:O,outWidth:P,outChannels:G,padInfo:A.padInfo,strideHeight:_,strideWidth:b,filterHeight:p,filterWidth:m,effectiveFilterHeight:k,effectiveFilterWidth:R,dilationHeight:E,dilationWidth:D,inShape:n,outShape:h,filterShape:t}}function gf(n,t,e,r,o,i,s,a){void 0===i&&(i=!1),void 0===s&&(s="channelsLast");var u=[-1,-1,-1,-1,-1],l=u[0],c=u[1],d=u[2],f=u[3],h=u[4];if("channelsLast"===s)l=n[0],c=n[1],d=n[2],f=n[3],h=n[4];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);l=n[0],h=n[1],c=n[2],d=n[3],f=n[4]}var p,m=t[0],v=t[1],y=t[2],_=t[4],b=l_(e),x=b[0],E=b[1],D=b[2],k=l_(r),R=k[0],A=k[1],M=k[2],O=Nl(m,R),P=Nl(v,A),G=Nl(y,M),q=function(Y,ne,se,ve,ge,We,Xe,Me,He,Fe,kt){var Ye,Dt,mt,Jt;if("number"==typeof Y){Ye={top:Y,bottom:Y,left:Y,right:Y,front:Y,back:Y,type:0===Y?"VALID":"NUMBER"};var Gt=function(Kl,vs,cx,Xl,xi,dx){null==xi&&(xi=u_(Kl,vs,Xl));var AJ=Kl[1],TJ=Kl[2],fx=mf((Kl[0]-vs+2*xi)/Xl+1,dx);I(zt(fx),function(){return"The output # of depths ("+fx+") must be an integer. Change the stride and/or zero pad parameters"});var hx=mf((AJ-vs+2*xi)/Xl+1,dx);I(zt(hx),function(){return"The output # of rows ("+hx+") must be an integer. Change the stride and/or zero pad parameters"});var px=mf((TJ-vs+2*xi)/Xl+1,dx);return I(zt(px),function(){return"The output # of columns ("+px+") must be an integer. Change the stride and/or zero pad parameters"}),[fx,hx,px,1]}([ne,se,ve,1],Me,0,ge,Y,kt);Dt=Gt[0],mt=Gt[1],Jt=Gt[2]}else if("same"===Y){var qt=((Dt=Math.ceil(ne/ge))-1)*ge+Me-ne,bi=((mt=Math.ceil(se/We))-1)*We+He-se,_i=((Jt=Math.ceil(ve/Xe))-1)*Xe+Fe-ve,Zr=Math.floor(qt/2),ql=qt-Zr,gs=Math.floor(bi/2),ma=bi-gs,ms=Math.floor(_i/2);Ye={top:gs,bottom:ma,left:ms,right:_i-ms,front:Zr,back:ql,type:"SAME"}}else{if("valid"!==Y)throw Error("Unknown padding parameter: "+Y);Ye={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},Dt=Math.ceil((ne-Me+1)/ge),mt=Math.ceil((se-He+1)/We),Jt=Math.ceil((ve-Fe+1)/Xe)}return{padInfo:Ye,outDepth:Dt,outHeight:mt,outWidth:Jt}}(o,c,d,f,x,E,D,O,P,G,a),L=q.outDepth,V=q.outHeight,B=q.outWidth,z=i?_*h:_;return"channelsFirst"===s?p=[l,z,L,V,B]:"channelsLast"===s&&(p=[l,L,V,B,z]),{batchSize:l,dataFormat:s,inDepth:c,inHeight:d,inWidth:f,inChannels:h,outDepth:L,outHeight:V,outWidth:B,outChannels:z,padInfo:q.padInfo,strideDepth:x,strideHeight:E,strideWidth:D,filterDepth:m,filterHeight:v,filterWidth:y,effectiveFilterDepth:O,effectiveFilterHeight:P,effectiveFilterWidth:G,dilationDepth:R,dilationHeight:A,dilationWidth:M,inShape:n,outShape:p,filterShape:t}}function u_(n,t,e,r){void 0===r&&(r=1);var o=Nl(t,r);return Math.floor((n[0]*(e-1)-e+o)/2)}function Gg(n){return"number"==typeof n?[n,n,n]:2===n.length?[n[0],n[1],1]:n}function l_(n){return"number"==typeof n?[n,n,n]:n}function Nl(n,t){return t<=1?n:n+(n-1)*(t-1)}function mf(n,t){if(!t)return n;switch(t){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error("Unknown roundingMode "+t)}}function Ja(n){var t=Gg(n);return 1===t[0]&&1===t[1]&&1===t[2]}function _r(n,t){return Ja(n)||Ja(t)}function qg(n){if("NHWC"===n)return"channelsLast";if("NCHW"===n)return"channelsFirst";throw new Error("Unknown dataFormat "+n)}function c_(n,t,e){if("complex64"===t){if("complex64"===n.dtype)return n.clone();var r=Ft(n.shape),o=n.toFloat(),i=e.complex(o,r);return r.dispose(),o.dispose(),i}if(!ak(n.dtype,t))return N.makeTensorFromDataId(n.dataId,n.shape,t);if("complex64"===n.dtype){var s=e.real(n);return i=s.cast(t),s.dispose(),i}if("int32"===t)return e.int(n);if("bool"===t){var a=oe(0,n.dtype);return i=e.notEqual(n,a),a.dispose(),i}throw new Error("Error in Cast: failed to cast "+n.dtype+" to "+t)}function Kg(n,t){return N.makeTensorFromDataId(n.dataId,t,n.dtype)}function d_(n,t,e){var r=(t-n)/(e-1),o=Al(e,"float32");o[0]=n;for(var i=1;i<o.length;i++)o[i]=o[i-1]+r;return mn(o,"float32")}function f_(n,t){if(n.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+n.length+", imag: "+t.length+".");for(var e=new Float32Array(2*n.length),r=0;r<e.length;r+=2)e[r]=n[r/2],e[r+1]=t[r/2];return e}function cR(n,t){return{real:n[2*t],imag:n[2*t+1]}}function w8(n,t,e,r){n[2*r]=t,n[2*r+1]=e}function b8(n,t,e){var r=(e?2:-2)*Math.PI*(n/t);return{real:Math.cos(r),imag:Math.sin(r)}}function _8(n,t,e){var r=function(u,l,c){for(var d=0,f=u.length,h=0,p=!1;d<f;){var m=c(l,u[h=d+(f-d>>>1)]);m>0?d=h+1:(f=h,p=!m)}return p?d:-d-1}(n,t,e||x8);n.splice(r<0?-(r+1):r,0,t)}function x8(n,t){return n>t?1:n<t?-1:0}function h_(n,t,e,r,o){return dR(n,t,e,r,o,0).selectedIndices}function p_(n,t,e,r,o,i){var s=dR(n,t,e,r,o,i,!0);return s.numValidOutputs.dispose(),{selectedIndices:s.selectedIndices,selectedScores:s.selectedScores}}function dR(n,t,e,r,o,i,s,a){void 0===s&&(s=!1),void 0===a&&(a=!1);for(var u=Array.from(t).map(function(x,E){return{score:x,boxIndex:E,suppressBeginIndex:0}}).filter(function(x){return x.score>o}).sort(fR),l=i>0?-.5/i:0,c=[],d=[];c.length<e&&u.length>0;){var f=u.pop(),h=f.score,p=f.boxIndex,m=f.suppressBeginIndex;if(h<o)break;for(var v=!1,y=c.length-1;y>=m;--y){var _=C8(n,p,c[y]);if(_>=r){v=!0;break}if(f.score=f.score*E8(r,l,_),f.score<=o)break}f.suppressBeginIndex=c.length,v||(f.score===h?(c.push(p),d.push(f.score)):f.score>o&&_8(u,f,fR))}var b=c.length;return a&&(c.fill(0,b),d.fill(0,b)),{selectedIndices:mn(c,"int32"),selectedScores:mn(d,"float32"),numValidOutputs:oe(b,"int32")}}function C8(n,t,e){var r=n.subarray(4*t,4*t+4),o=n.subarray(4*e,4*e+4),i=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),l=Math.min(o[0],o[2]),c=Math.min(o[1],o[3]),d=Math.max(o[0],o[2]),f=Math.max(o[1],o[3]),h=(a-i)*(u-s),p=(d-l)*(f-c);if(h<=0||p<=0)return 0;var m=Math.max(i,l),v=Math.max(s,c),y=Math.min(a,d),_=Math.min(u,f),b=Math.max(y-m,0)*Math.max(_-v,0);return b/(h+p-b)}function E8(n,t,e){var r=Math.exp(t*e*e);return e<=n?r:0}function fR(n,t){return n.score-t.score||n.score===t.score&&t.boxIndex-n.boxIndex}function hR(n,t,e){var r=new Array(n.rank).fill(0),o=n.shape.slice();return t.map(function(i){o[e]=i;var s=n.slice(r,o);return r[e]+=i,s})}function pR(n,t){for(var e=new Array(n.rank),r=0;r<e.length;r++)e[r]=n.shape[r]*t[r];var o=Ue(e,n.dtype);for(r=0;r<o.values.length;++r){for(var i=o.indexToLoc(r),s=new Array(n.rank),a=0;a<s.length;a++)s[a]=i[a]%n.shape[a];var u=n.locToIndex(s);o.values[r]=n.values[u]}return o.toTensor()}function gR(n,t,e,r,o){for(var i=t[t.length-1],s=[n.length/i,i],a=s[0],u=s[1],l=Sl(e,a*r),c=Sl("int32",a*r),d=0;d<a;d++){for(var f=d*u,h=n.subarray(f,f+u),p=[],m=0;m<h.length;m++)p.push({value:h[m],index:m});p.sort(function(x,E){return E.value-x.value});var v=d*r,y=l.subarray(v,v+r),_=c.subarray(v,v+r);for(m=0;m<r;m++)y[m]=p[m].value,_[m]=p[m].index}var b=t.slice();return b[b.length-1]=r,[Wn(l,b,e),Wn(c,b,"int32")]}function g_(n,t){for(var e=[],r=0;r<t.length;r++)t[r]&&e.push(r);var o=Ue(n,"int32"),i=Ue([e.length,n.length],"int32");for(r=0;r<e.length;r++){var s=o.indexToLoc(e[r]);i.values.set(s,r*n.length)}return i.toTensor()}Object.freeze({castTensor:c_,reshapeTensor:Kg,linspaceImpl:d_,upcastType:kn,axesAreInnerMostDims:Z0,combineLocations:qk,computeOutAndReduceShapes:jn,expandShapeToKeepDim:br,assertAxesAreInnerMostDims:kr,getAxesPermutation:Oo,getUndoAxesPermutation:Og,getInnerMostAxes:Lo,getBroadcastDims:is,getReductionAxes:vn,assertAndGetBroadcastShape:Ze,assertParamsConsistent:Kk,computeOutShape:Xa,computePool2DInfo:Rl,computePool3DInfo:pf,computeConv2DInfo:ia,computeConv3DInfo:gf,computeDefaultPad:u_,tupleValuesAreOne:Ja,eitherStridesOrDilationsAreOne:_r,convertConv2DDataFormat:qg,PARALLELIZE_THRESHOLD:30,computeOptimalWindowSize:Hg});var D8=function(n,t){this.outputShape=[],this.outputShape=n,this.variableNames=t.map(function(o,i){return"T"+i});var e=[];this.variableNames.forEach(function(o){e.push("float v"+o+" = get"+o+"AtOutCoords();")});var r=this.variableNames.map(function(o){return"v"+o}).join(" + ");this.userCode="\n      void main() {\n        "+e.join("\n        ")+"\n\n        float result = "+r+";\n        setOutput(result);\n      }\n    "},S8=function(n,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.variableNames=t.map(function(o,i){return"T"+i});var e=[];this.variableNames.forEach(function(o){e.push("vec4 v"+o+" = get"+o+"AtOutCoords();")});var r=this.variableNames.map(function(o){return"v"+o}).join(" + ");this.userCode="\n      void main() {\n        "+e.join("\n        ")+"\n\n        vec4 result = "+r+";\n        setOutput(result);\n      }\n    "},I8=function(n,t,e){this.variableNames=["A"];var r=n.windowSize,o=n.batchSize,s=Math.ceil(n.inSize/r);e||this.variableNames.push("bestIndicesA"),this.outputShape=[o,s],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+r+";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < "+r+"; i++) {\n          int inIdx = "+(e?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));")+";\n          float candidate = getA(batch, inIdx);\n          if (candidate "+("max"===t?">":"<")+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "};function mR(n,t){return["x","y","z","w","u","v"].slice(0,t).map(function(e){return n+"."+e})}function Nr(n,t){return 1===t?[n]:mR(n,t)}function tr(){var n,t,e,r,o,i,s,a,u,l;return 2===$().getNumber("WEBGL_VERSION")?(n="#version 300 es",t="in",e="out",r="in",o="texture",i="outputColor",s="out vec4 outputColor;",a="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",u="",l="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(n="",t="attribute",e="varying",r="varying",o="texture2D",i="gl_FragColor",s="",a="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",l="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:n,attribute:t,varyingVs:e,varyingFs:r,texture2D:o,output:i,defineOutput:s,defineSpecialNaN:a,defineSpecialInf:u,defineRound:l}}function eu(n,t,e){void 0===e&&(e="index");var r=Fo(t);return r.map(function(o,i){return"int "+n[i]+" = "+e+" / "+o+"; "+(i===r.length-1?"int "+n[i+1]+" = "+e+" - "+n[i]+" * "+o:"index -= "+n[i]+" * "+o)+";"}).join("")}function m_(n){var t=Fo(n).map(function(e){return e.toString()});return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * "+t[0]+" + coords.y * "+t[1]+" + coords.z;\n  }\n"}var vR="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n";function A8(n,t,e,r){var o=[];n.forEach(function(h){var p=me(h.shapeInfo.logicalShape);h.shapeInfo.isUniform?o.push("uniform float "+h.name+(p>1?"["+p+"]":"")+";"):(o.push("uniform sampler2D "+h.name+";"),o.push("uniform int offset"+h.name+";"))});var i,s,h,a=o.join("\n"),u=n.map(function(h){return function(p,m,v){void 0===v&&(v=!1);var y="";return y+=v?yR(p):Fl(p),p.shapeInfo.logicalShape.length<=m.logicalShape.length&&(y+=v?function(x,E){var D,L,k=x.name,R=k.charAt(0).toUpperCase()+k.slice(1),A="get"+R+"AtOutCoords",M=x.shapeInfo.logicalShape.length,O=E.logicalShape.length,P=is(x.shapeInfo.logicalShape,E.logicalShape),G=Mt(O),q=O-M,K=["x","y","z","w","u","v"];D=0===M?"":O<2&&P.length>=1?"coords = 0;":P.map(function(se){return"coords."+K[se+q]+" = 0;"}).join("\n"),L=O<2&&M>0?"coords":x.shapeInfo.logicalShape.map(function(se,ve){return"coords."+K[ve+q]}).join(", ");var V="return outputValue;",B=1===me(x.shapeInfo.logicalShape),z=1===me(E.logicalShape);if(1!==M||B||z){if(B&&!z)V=1===O?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(P.length){var Y=M-2,ne=M-1;P.indexOf(Y)>-1&&P.indexOf(ne)>-1?V="return vec4(outputValue.x);":P.indexOf(Y)>-1?V="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":P.indexOf(ne)>-1&&(V="return vec4(outputValue.xx, outputValue.zz);")}}else V="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 "+A+"() {\n      "+G+" coords = getOutputCoords();\n      "+D+"\n      vec4 outputValue = get"+R+"("+L+");\n      "+V+"\n    }\n  "}(p,m):function(x,E){var D=x.name,k=D.charAt(0).toUpperCase()+D.slice(1),R="get"+k+"AtOutCoords",O=x.shapeInfo.logicalShape.length,P=E.logicalShape.length;if(!x.shapeInfo.isUniform&&O===P&&null==x.shapeInfo.flatOffset&&pn(x.shapeInfo.texShape,E.texShape))return"\n      float "+R+"() {\n        return sampleTexture("+D+", resultUV);\n      }\n    ";var q=Mt(P),K=is(x.shapeInfo.logicalShape,E.logicalShape),L=P-O,V=["x","y","z","w","u","v"];return"\n    float "+R+"() {\n      "+q+" coords = getOutputCoords();\n      "+(0===O?"":P<2&&K.length>=1?"coords = 0;":K.map(function(z){return"coords."+V[z+L]+" = 0;"}).join("\n"))+"\n      return get"+k+"("+(P<2&&O>0?"coords":x.shapeInfo.logicalShape.map(function(z,Y){return"coords."+V[Y+L]}).join(", "))+");\n    }\n  "}(p,m)),y}(h,t,r)}).join("\n"),l=t.texShape,c=tr(),d="\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return "+c.texture2D+"(textureSampler, uv).r;\n    }\n  ",f=(h=c).version+"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    "+h.varyingFs+" vec2 resultUV;\n    "+h.defineOutput+"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    "+h.defineSpecialNaN+"\n    "+h.defineSpecialInf+"\n    "+h.defineRound+"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    "+T8+"\n    "+M8+"\n    "+k8+"\n  ";return t.isPacked?(i=function(h,p){switch(h.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return E=p,1===(D=[Math.ceil(E[0]/2),Math.ceil(E[1]/2)])[0]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * "+D[1]+".0);\n      }\n    ":1===D[1]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * "+D[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+D[0]+", "+D[1]+"));\n      return 2 * (resTexRC.x * "+D[1]+" + resTexRC.y);\n    }\n  ";case 2:return function(x,E){var D=[Math.ceil(E[0]/2),Math.ceil(E[1]/2)];if(pn(x,E))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2("+D[0]+", "+D[1]+"));\n      }\n    ";var k=Math.ceil(x[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+D[0]+", "+D[1]+"));\n\n      int index = resTexRC.x * "+D[1]+" + resTexRC.y;\n      int r = 2 * (index / "+k+");\n      int c = imod(index, "+k+") * 2;\n\n      return ivec2(r, c);\n    }\n  "}(h,p);case 3:return m=h,v=p,y=[Math.ceil(v[0]/2),Math.ceil(v[1]/2)],b=(_=Math.ceil(m[2]/2))*Math.ceil(m[1]/2),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+y[0]+", "+y[1]+"));\n      int index = resTexRC.x * "+y[1]+" + resTexRC.y;\n\n      int b = index / "+b+";\n      index -= b * "+b+";\n\n      int r = 2 * (index / "+_+");\n      int c = imod(index, "+_+") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";default:return function(x,E){for(var D=[Math.ceil(E[0]/2),Math.ceil(E[1]/2)],k=Math.ceil(x[x.length-1]/2),R=k*Math.ceil(x[x.length-2]/2),A=R,M="",O="b, r, c",P=2;P<x.length-1;P++)M="\n      int b"+P+" = index / "+(A*=x[x.length-P-1])+";\n      index -= b"+P+" * "+A+";\n    "+M,O="b"+P+", "+O;return"\n    ivec"+x.length+" getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+D[0]+", "+D[1]+"));\n      int index = resTexRC.x * "+D[1]+" + resTexRC.y;\n\n      "+M+"\n\n      int b = index / "+R+";\n      index -= b * "+R+";\n\n      int r = 2 * (index / "+k+");\n      int c = imod(index, "+k+") * 2;\n\n      return ivec"+x.length+"("+O+");\n    }\n  "}(h,p)}var E,D,m,v,y,_,b}(t.logicalShape,l),s=function(h){return"\n    void setOutput(vec4 val) {\n      "+h.output+" = val;\n    }\n  "}(c)):(i=function(h,p){switch(h.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return 1===(_=p)[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * "+_[1]+".0);\n      }\n    ":1===_[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * "+_[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+_[0]+", "+_[1]+"));\n      return resTexRC.x * "+_[1]+" + resTexRC.y;\n    }\n  ";case 2:return function(y,_){return pn(y,_)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+_[0]+", "+_[1]+"));\n      }\n    ":1===y[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+_[0]+", "+_[1]+"));\n        int index = resTexRC.x * "+_[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":1===y[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+_[0]+", "+_[1]+"));\n        int index = resTexRC.x * "+_[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+_[0]+", "+_[1]+"));\n      int index = resTexRC.x * "+_[1]+" + resTexRC.y;\n      int r = index / "+y[1]+";\n      int c = index - r * "+y[1]+";\n      return ivec2(r, c);\n    }\n  "}(h,p);case 3:return m=p,v=eu(["r","c","d"],h),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+m[0]+", "+m[1]+"));\n      int index = resTexRC.x * "+m[1]+" + resTexRC.y;\n      "+v+"\n      return ivec3(r, c, d);\n    }\n  ";case 4:return function(y,_){var b=eu(["r","c","d","d2"],y);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+_[0]+", "+_[1]+"));\n      int index = resTexRC.x * "+_[1]+" + resTexRC.y;\n      "+b+"\n      return ivec4(r, c, d, d2);\n    }\n  "}(h,p);case 5:return function(y,_){var b=eu(["r","c","d","d2","d3"],y);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2("+_[0]+",\n                             "+_[1]+"));\n\n      int index = resTexRC.x * "+_[1]+" + resTexRC.y;\n\n      "+b+"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  "}(h,p);case 6:return function(y,_){var b=eu(["r","c","d","d2","d3","d4"],y);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+_[0]+", "+_[1]+"));\n      int index = resTexRC.x * "+_[1]+" + resTexRC.y;\n\n      "+b+"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  "}(h,p);default:throw new Error(h.length+"-D output sampling is not yet supported")}var _,m,v}(t.logicalShape,l),s=function(h){return"\n    void setOutput(float val) {\n      "+h.output+" = vec4(val, 0, 0, 0);\n    }\n  "}(c)),r&&(f+=R8),[f,d,s,a,i,u,e].join("\n")}function Fl(n){var t=n.shapeInfo.logicalShape;switch(t.length){case 0:return function(e){var r=e.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1);if(e.shapeInfo.isUniform)return"float "+o+"() {return "+r+";}";var i=e.shapeInfo.texShape;if(1===i[0]&&1===i[1])return"\n      float "+o+"() {\n        return sampleTexture("+r+", halfCR);\n      }\n    ";var u=e.shapeInfo.texShape;return"\n    float "+o+"() {\n      vec2 uv = uvFromFlat("+u[0]+", "+u[1]+", "+tu(r)+");\n      return sampleTexture("+r+", uv);\n    }\n  "}(n);case 1:return function(e){var r=e.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1);if(e.shapeInfo.isUniform)return"\n      float "+o+"(int index) {\n        "+Pl(e)+"\n      }\n    ";var i=e.shapeInfo.texShape,s=i[0],a=i[1];if(1===a&&1===s)return"\n      float "+o+"(int index) {\n        return sampleTexture("+r+", halfCR);\n      }\n    ";var u=tu(r);return 1===a?"\n      float "+o+"(int index) {\n        vec2 uv = vec2(0.5, (float(index + "+u+") + 0.5) / "+s+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":1===s?"\n      float "+o+"(int index) {\n        vec2 uv = vec2((float(index + "+u+") + 0.5) / "+a+".0, 0.5);\n        return sampleTexture("+r+", uv);\n      }\n    ":"\n    float "+o+"(int index) {\n      vec2 uv = uvFromFlat("+s+", "+a+", index + "+u+");\n      return sampleTexture("+r+", uv);\n    }\n  "}(n);case 2:return function(e){var r=e.shapeInfo.logicalShape,o=e.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),s=e.shapeInfo.texShape;if(null!=s&&pn(r,s))return"\n    float "+i+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+s[1]+".0, "+s[0]+".0);\n      return sampleTexture("+o+", uv);\n    }\n  ";var l=ea(r),c=l.newShape,d=l.keptDims;if(c.length<r.length)return"\n      "+Fl(Ol(e,c))+"\n      float "+i+"(int row, int col) {\n        return "+i+"("+Ll(["row","col"],d)+");\n      }\n    ";if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2("+r[1]+", 1)));\n        "+Pl(e)+"\n      }\n    ";var p=s[0],m=s[1],v=tu(o);return 1===m?"\n    float "+i+"(int row, int col) {\n      float index = dot(vec3(row, col, "+v+"), vec3("+r[1]+", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / "+p+".0);\n      return sampleTexture("+o+", uv);\n    }\n  ":1===p?"\n    float "+i+"(int row, int col) {\n      float index = dot(vec3(row, col, "+v+"), vec3("+r[1]+", 1, 1));\n      vec2 uv = vec2((index + 0.5) / "+m+".0, 0.5);\n      return sampleTexture("+o+", uv);\n    }\n  ":"\n  float "+i+"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * "+r[1]+" + col + "+v+";\n    vec2 uv = uvFromFlat("+p+", "+m+", index);\n    return sampleTexture("+o+", uv);\n  }\n"}(n);case 3:return function(e){var r=e.shapeInfo.logicalShape,o=e.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),s=r[1]*r[2],a=r[2],u=ea(r),l=u.newShape,c=u.keptDims;if(l.length<r.length)return"\n        "+Fl(Ol(e,l))+"\n        float "+i+"(int row, int col, int depth) {\n          return "+i+"("+Ll(["row","col","depth"],c)+");\n        }\n      ";if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3("+s+", "+a+", 1)));\n        "+Pl(e)+"\n      }\n    ";var h=e.shapeInfo.texShape,p=h[0],m=h[1],v=e.shapeInfo.flatOffset;return m===s&&null==v?"\n        float "+i+"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2("+a+", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+m+".0, "+p+".0);\n          return sampleTexture("+o+", uv);\n        }\n      ":m===a&&null==v?"\n    float "+i+"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2("+r[1]+", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+m+".0, "+p+".0);\n      return sampleTexture("+o+", uv);\n    }\n  ":"\n      float "+i+"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * "+s+" + col * "+a+" + depth + "+tu(o)+";\n        vec2 uv = uvFromFlat("+p+", "+m+", index);\n        return sampleTexture("+o+", uv);\n      }\n  "}(n);case 4:return function(e){var r=e.shapeInfo.logicalShape,o=e.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),s=r[3],a=r[2]*s,u=r[1]*a,l=ea(r),c=l.newShape,d=l.keptDims;if(c.length<r.length)return"\n      "+Fl(Ol(e,c))+"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        return "+i+"("+Ll(["row","col","depth","depth2"],d)+");\n      }\n    ";if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4("+u+", "+a+", "+s+", 1)));\n        "+Pl(e)+"\n      }\n    ";var h=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,m=p[0],v=p[1];return v===u&&null==h?"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3("+a+", "+s+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+v+".0, "+m+".0);\n        return sampleTexture("+o+", uv);\n      }\n    ":v===s&&null==h?"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3("+r[1]*r[2]+", "+r[2]+", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+v+".0, "+m+".0);\n        return sampleTexture("+o+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+u+" + col * "+a+" +\n          depth * "+s+" + depth2;\n      vec2 uv = uvFromFlat("+m+", "+v+", index + "+tu(o)+");\n      return sampleTexture("+o+", uv);\n    }\n  "}(n);case 5:return function(e){var r=e.shapeInfo.logicalShape,o=e.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),s=r[4],a=r[3]*s,u=r[2]*a,l=r[1]*u,c=ea(r),d=c.newShape,f=c.keptDims;if(d.length<r.length)return"\n      "+Fl(Ol(e,d))+"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        return "+i+"("+Ll(["row","col","depth","depth2","depth3"],f)+");\n      }\n    ";if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+l+", "+u+", "+a+", "+s+")) +\n          depth3;\n        "+Pl(e)+"\n      }\n    ";var p=e.shapeInfo.flatOffset,m=e.shapeInfo.texShape,v=m[0],y=m[1];return y===l&&null==p?"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4("+u+", "+a+", "+s+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+y+".0, "+v+".0);\n        return sampleTexture("+o+", uv);\n      }\n    ":y===s&&null==p?"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+r[1]*r[2]*r[3]+",\n               "+r[2]*r[3]+", "+r[3]+", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+y+".0, "+v+".0);\n        return sampleTexture("+o+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+l+" + col * "+u+" + depth * "+a+" +\n          depth2 * "+s+" + depth3 + "+tu(o)+";\n      vec2 uv = uvFromFlat("+v+", "+y+", index);\n      return sampleTexture("+o+", uv);\n    }\n  "}(n);case 6:return function(e){var r=e.shapeInfo.logicalShape,o=e.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),s=ea(r),a=s.newShape,u=s.keptDims;if(a.length<r.length)return"\n      "+Fl(Ol(e,a))+"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return "+i+"("+Ll(["row","col","depth","depth2","depth3","depth4"],u)+");\n      }\n    ";var c=r[5],d=r[4]*c,f=r[3]*d,h=r[2]*f,p=r[1]*h;if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4("+p+", "+h+", "+f+", "+d+")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2("+c+", 1)));\n        "+Pl(e)+"\n      }\n    ";var m=e.shapeInfo.flatOffset,v=e.shapeInfo.texShape,y=v[0],_=v[1];return _===p&&null==m?"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4("+h+", "+f+", "+d+", "+c+")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+_+".0, "+y+".0);\n        return sampleTexture("+o+", uv);\n      }\n    ":_===c&&null==m?"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4("+r[1]*r[2]*r[3]*r[4]+",\n               "+r[2]*r[3]*r[4]+",\n               "+r[3]*r[4]+",\n               "+r[4]+")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+_+".0, "+y+".0);\n        return sampleTexture("+o+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+p+" + col * "+h+" + depth * "+f+" +\n          depth2 * "+d+" + depth3 * "+c+" + depth4 + "+tu(o)+";\n      vec2 uv = uvFromFlat("+y+", "+_+", index);\n      return sampleTexture("+o+", uv);\n    }\n  "}(n);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function yR(n){var t,o,i,s,a,u,l;switch(n.shapeInfo.logicalShape.length){case 0:return"\n    vec4 get"+(t=n.name).charAt(0).toUpperCase()+t.slice(1)+"() {\n      return "+tr().texture2D+"("+t+", halfCR);\n    }\n  ";case 1:return s="get"+(i=(o=n).name).charAt(0).toUpperCase()+i.slice(1),a=o.shapeInfo.texShape,u=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],l=tr(),"\n    vec4 "+s+"(int index) {\n      vec2 uv = packedUVfrom1D(\n        "+u[0]+", "+u[1]+", index);\n      return "+l.texture2D+"("+i+", uv);\n    }\n  ";case 2:return function(o){var i=o.shapeInfo.logicalShape,s=o.name,a="get"+s.charAt(0).toUpperCase()+s.slice(1),u=o.shapeInfo.texShape,l=u[0],c=u[1],d=tr();if(null!=u&&pn(i,u))return"\n      vec4 "+a+"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2("+c+".0, "+l+".0);\n\n        return "+d.texture2D+"("+s+", uv);\n      }\n    ";var f=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];return"\n    vec4 "+a+"(int row, int col) {\n      vec2 uv = packedUVfrom2D("+Math.ceil(i[1]/2)+", "+f[0]+", "+f[1]+", row, col);\n      return "+d.texture2D+"("+s+", uv);\n    }\n  "}(n);case 3:return function(o){var i=o.shapeInfo.logicalShape,s=o.name,a="get"+s.charAt(0).toUpperCase()+s.slice(1),u=o.shapeInfo.texShape,l=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];if(1===i[0])return"\n        "+yR(Ol(o,i.slice(1)))+"\n        vec4 "+a+"(int b, int row, int col) {\n          return "+a+"("+Ll(["b","row","col"],[1,2])+");\n        }\n      ";var f=l[0],h=l[1],p=Math.ceil(i[2]/2);return"\n    vec4 "+a+"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        "+f+", "+h+", "+p*Math.ceil(i[1]/2)+", "+p+", b, row, col);\n      return "+tr().texture2D+"("+s+", uv);\n    }\n  "}(n);default:return function(o){for(var i=o.shapeInfo.logicalShape,s=i.length,a=o.name,u="get"+a.charAt(0).toUpperCase()+a.slice(1),l=o.shapeInfo.texShape,c=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],d=c[0],f=c[1],h=Math.ceil(i[s-1]/2),p=h*Math.ceil(i[s-2]/2),m="int b, int row, int col",v="b * "+p+" + (row / 2) * "+h+" + (col / 2)",y=2;y<s-1;y++)m="int b"+y+", "+m,v="b"+y+" * "+(p*=i[s-y-1])+" + "+v;return"\n    vec4 "+u+"("+m+") {\n      int index = "+v+";\n      int texR = index / "+f+";\n      int texC = index - texR * "+f+";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+f+", "+d+");\n      return "+tr().texture2D+"("+a+", uv);\n    }\n  "}(n)}}var T8="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",M8="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",k8="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",R8="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function tu(n){return"offset"+n}function Pl(n){var t=n.name,e=me(n.shapeInfo.logicalShape);return e<2?"return "+t+";":"\n    for (int i = 0; i < "+e+"; i++) {\n      if (i == index) {\n        return "+t+"[i];\n      }\n    }\n  "}function Mt(n){if(n<=1)return"int";if(2===n)return"ivec2";if(3===n)return"ivec3";if(4===n)return"ivec4";if(5===n)return"ivec5";if(6===n)return"ivec6";throw Error("GPU for rank "+n+" is not yet supported")}function Ol(n,t){var e=JSON.parse(JSON.stringify(n));return e.shapeInfo.logicalShape=t,e}function Ll(n,t){return t.map(function(e){return n[e]}).join(", ")}var N8=function(n,t,e,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,I(n.length>2,function(){return"Packed arg"+(e.charAt(0).toUpperCase()+e.slice(1))+" supports only inputs with rank above 2."});var i=Math.ceil(n[n.length-1]/t);this.outputShape=n.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var s,a,u=this.outputShape,l=u.length,c=Mt(l),d=Nr("coords",l);if(1===i){var f=Mt(a=l+1);s="\n        "+f+" sourceLocR = "+f+"("+d.join()+", 0);\n        ++"+d[l-1]+";\n        "+f+" sourceLocG = "+f+"("+d.join()+", 0);\n        ++"+d[l-2]+";\n        "+f+" sourceLocA = "+f+"("+d.join()+", 0);\n        --"+d[l-1]+";\n        "+f+" sourceLocB = "+f+"("+d.join()+", 0);\n        --"+d[l-2]+";"}else a=l,s="\n        "+c+" sourceLocR = coords;\n        ++"+d[l-1]+";\n        "+c+" sourceLocG = coords;\n        ++"+d[l-2]+";\n        "+c+" sourceLocA = coords;\n        --"+d[l-1]+";\n        "+c+" sourceLocB = coords;\n        --"+d[l-2]+";";var h=["x","y","z","w","u","v"].slice(0,a),p="."+h[a-1],m=h.map(function(R){return"int "+R}),v=Nr("sourceLocR",a-1).concat("inIdx.r"),y=Nr("sourceLocG",a-1).concat("inIdx.g"),_=Nr("sourceLocB",a-1).concat("inIdx.b"),b=Nr("sourceLocA",a-1).concat("inIdx.a"),x="max"===e?"greaterThan":"lessThan",E=r?"":"\n          inIdx = round(vec4(getBestIndicesAChannel("+v.join()+"),\n                             getBestIndicesAChannel("+y.join()+"),\n                             getBestIndicesAChannel("+_.join()+"),\n                             getBestIndicesAChannel("+b.join()+")));",D="vec4(\n            getAChannel("+v.join()+"),\n            hasNextCol ? getAChannel("+y.join()+") : 0.,\n            hasNextRow ? getAChannel("+_.join()+") : 0.,\n            hasNextRow && hasNextCol ? getAChannel("+b.join()+") : 0.)",k=r?"":"\n      float getBestIndicesAChannel("+m.join()+") {\n        return getChannel(getBestIndicesA("+h.join()+"),\n                                          vec2("+h.slice(-2).join()+"));\n      }";this.userCode="\n      float getAChannel("+m.join()+") {\n        return getChannel(getA("+h.join()+"),\n                               vec2("+h.slice(-2).join()+"));\n      }\n      "+k+"\n      void main() {\n        "+c+" coords = getOutputCoords();\n        bool hasNextCol = "+d[l-1]+" < "+(u[l-1]-1)+";\n        bool hasNextRow = "+d[l-2]+" < "+(u[l-2]-1)+";\n        "+s+"\n        ivec4 srcIdx = ivec4(sourceLocR"+p+", sourceLocG"+p+",\n          sourceLocB"+p+", sourceLocA"+p+") * "+t+";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = "+D+";\n\n        for (int i = 0; i < "+t+"; i++) {\n          inIdx = srcIdx;\n          "+E+"\n          vec4 candidate = "+D+";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4("+x+"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    "},F8=function(n){this.variableNames=["dy"],this.outputShape=n.inShape;var a=n.effectiveFilterHeight,u=n.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(a-1-n.padInfo.top)+", "+(u-1-n.padInfo.left)+");\n      const float avgMultiplier = float("+1/(n.filterHeight*n.filterWidth)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+a+";\n            wR += "+n.dilationHeight+") {\n          float dyR = float(dyRCorner + wR) / "+n.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+n.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+u+";\n            wC+= "+n.dilationWidth+") {\n            float dyC = float(dyCCorner + wC) / "+n.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+n.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},P8=function(n){this.variableNames=["dy"],this.outputShape=n.inShape;var c=n.effectiveFilterDepth,d=n.effectiveFilterHeight,f=n.effectiveFilterWidth;this.userCode="\n      const ivec3 pads = ivec3("+(c-1-n.padInfo.front)+", "+(d-1-n.padInfo.top)+", "+(f-1-n.padInfo.left)+");\n      const float avgMultiplier = float("+1/(n.filterDepth*n.filterHeight*n.filterWidth)+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+c+";\n            wD += "+n.dilationDepth+") {\n          float dyD = float(dyDCorner + wD) / "+n.strideDepth+".0;\n\n          if (dyD < 0.0 || dyD >= "+n.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+d+";\n              wR += "+n.dilationHeight+") {\n            float dyR = float(dyRCorner + wR) / "+n.strideHeight+".0;\n\n            if (dyR < 0.0 || dyR >= "+n.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+f+";\n                wC += "+n.dilationWidth+") {\n              float dyC = float(dyCCorner + wC) / "+n.strideWidth+".0;\n\n              if (dyC < 0.0 || dyC >= "+n.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},O8=function(n,t,e,r,o,i){this.outputShape=[],this.variableNames=["x","mean","variance"],Ze(n,t),Ze(n,e);var s="0.0";null!=r&&(Ze(n,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var a="1.0";null!=o&&(Ze(n,o),this.variableNames.push("scale"),a="getScaleAtOutCoords()"),this.outputShape=n,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+s+";\n        float scale = "+a+";\n        float inv = scale * inversesqrt(variance + float("+i+"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    "},L8=function(n,t,e,r,o,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Ze(n,t),Ze(n,e);var s="vec4(0.0)";null!=r&&(Ze(n,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var a="vec4(1.0)";null!=o&&(Ze(n,o),this.variableNames.push("scale"),a="getScaleAtOutCoords()"),this.outputShape=n,this.userCode="\n      void main() {\n        vec4 offset = "+s+";\n        vec4 scale = "+a+";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4("+i+"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    "},wR=function(n,t,e){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Ze(t,e),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        "+n+"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    "},v_="return a + b;",y_="return a - b;",bR="return a * b;",_R="return (a < 0.) ? b * a : a;",Zt=function(n,t,e){this.variableNames=["A","B"],this.outputShape=Ze(t,e),this.userCode="\n      float binaryOperation(float a, float b) {\n        "+n+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "},xR="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",ss=function(n,t,e,r){void 0===r&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Ze(t,e);var o=this.outputShape.length,i="";if(r)if(0===o||1===me(this.outputShape))i="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(i="\n          "+Mt(o)+" coords = getOutputCoords();\n        ",1===o)i+="\n            result.y = (coords + 1) >= "+this.outputShape[0]+" ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ";else{var s=Nr("coords",o);i+="\n            bool nextRowOutOfBounds =\n              ("+s[o-2]+" + 1) >= "+this.outputShape[o-2]+";\n            bool nextColOutOfBounds =\n              ("+s[o-1]+" + 1) >= "+this.outputShape[o-1]+";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        "+n+"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        "+i+"\n\n        setOutput(result);\n      }\n    "},U8=function(){function n(t){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}return n.prototype.getCustomSetupFunc=function(t,e){var r=this;return function(o,i){null==r.minLoc&&(r.minLoc=o.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=o.getUniformLocationNoThrow(i,"maxVal")),o.gl.uniform1f(r.minLoc,t),o.gl.uniform1f(r.maxLoc,e)}},n}(),j8=function(){function n(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}return n.prototype.getCustomSetupFunc=function(t,e){var r=this;return function(o,i){null==r.minLoc&&(r.minLoc=o.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=o.getUniformLocationNoThrow(i,"maxVal")),o.gl.uniform1f(r.minLoc,t),o.gl.uniform1f(r.maxLoc,e)}},n}(),H8=function(n){this.variableNames=["real","imag"],this.outputShape=n,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "},W8=function(n){this.outputShape=[],this.outputShape=Xa(n,1),this.variableNames=n.map(function(a,u){return"T"+u});var t=new Array(n.length-1);t[0]=n[0][1];for(var e=1;e<t.length;e++)t[e]=t[e-1]+n[e][1];var r=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(e=1;e<t.length;e++)r.push("else if (yC < "+t[e]+") setOutput(getT"+e+"(yR, yC-"+t[e-1]+"));");r.push("else setOutput(getT"+t.length+"(yR, yC-"+t[t.length-1]+"));"),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        "+r.join("\n        ")+"\n      }\n    "},z8=function(n,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Xa(n,t);var e=this.outputShape,r=e.length,o=Mt(r),i=Nr("coords",r),s=["x","y","z","w","u","v"].slice(0,r);this.variableNames=n.map(function(v,y){return"T"+y});var a=new Array(n.length-1);a[0]=n[0][t];for(var u=1;u<a.length;u++)a[u]=a[u-1]+n[u][t];var l=s[t],c=s.slice(-2),d=s.join(),f="if ("+l+" < "+a[0]+") {\n        return getChannel(\n            getT0("+d+"), vec2("+c.join()+"));\n        }";for(u=1;u<a.length;u++){var h=a[u-1];f+="\n        if ("+l+" < "+a[u]+"  && "+l+" >= "+a[u-1]+") {\n          return getChannel(\n            getT"+u+"("+Xg(s,l,h)+"),\n            vec2("+Xg(c,l,h)+"));\n        }"}var m=a[a.length-1];f+="\n        return getChannel(\n          getT"+a.length+"("+Xg(s,l,m)+"),\n          vec2("+Xg(c,l,m)+"));",this.userCode="\n      float getValue("+s.map(function(v){return"int "+v})+") {\n        "+f+"\n      }\n\n      void main() {\n        "+o+" coords = getOutputCoords();\n        vec4 result = vec4(getValue("+i+"), 0., 0., 0.);\n\n        "+i[r-1]+" = "+i[r-1]+" + 1;\n        if ("+i[r-1]+" < "+e[r-1]+") {\n          result.g = getValue("+i+");\n        }\n\n        "+i[r-2]+" = "+i[r-2]+" + 1;\n        if ("+i[r-2]+" < "+e[r-2]+") {\n          result.a = getValue("+i+");\n        }\n\n        "+i[r-1]+" = "+i[r-1]+" - 1;\n        if ("+i[r-2]+" < "+e[r-2]+" &&\n            "+i[r-1]+" < "+e[r-1]+") {\n          result.b = getValue("+i+");\n        }\n        setOutput(result);\n      }\n    "};function Xg(n,t,e){var r=n.indexOf(t);return n.map(function(o,i){return i===r?o+" - "+e:o}).join()}var $8=function(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+n.batchSize+"; b++) {\n          for (int yR = 0; yR < "+n.outHeight+"; yR++) {\n            int xR = wR + yR * "+n.strideHeight+" - "+n.padInfo.top+";\n\n            if (xR < 0 || xR >= "+n.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+n.outWidth+"; yC++) {\n              int xC = wC + yC * "+n.strideWidth+" - "+n.padInfo.left+";\n\n              if (xC < 0 || xC >= "+n.inWidth+") {\n                continue;\n              }\n\n              if ("+("channelsLast"===n.dataFormat)+") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},G8=function(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;var t=n.filterHeight,e=n.filterWidth,i="channelsLast"===n.dataFormat;this.userCode="\n      const ivec2 pads = ivec2("+(t-1-n.padInfo.top)+", "+(e-1-n.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords["+(i?3:1)+"];\n\n        ivec2 dyCorner = ivec2(coords["+(i?1:2)+"], coords["+(i?2:3)+"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+n.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+n.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+t+" - 1 - wR;\n\n          for (int wC = 0; wC < "+e+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+n.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+n.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+e+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+n.outChannels+"; d2++) {\n\n              if ("+i+") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},q8=function(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape,this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+n.batchSize+"; b++) {\n          for (int yF = 0; yF < "+n.outDepth+"; yF++) {\n            int xF = wF + yF * "+n.strideDepth+" - "+n.padInfo.front+";\n\n            if (xF < 0 || xF >= "+n.inDepth+") {\n              continue;\n            }\n\n            for (int yR = 0; yR < "+n.outHeight+"; yR++) {\n              int xR = wR + yR * "+n.strideHeight+" - "+n.padInfo.top+";\n\n              if (xR < 0 || xR >= "+n.inHeight+") {\n                continue;\n              }\n\n              for (int yC = 0; yC < "+n.outWidth+"; yC++) {\n                int xC = wC + yC * "+n.strideWidth+" - "+n.padInfo.left+";\n\n                if (xC < 0 || xC >= "+n.inWidth+") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},K8=function(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;var t=n.filterDepth,e=n.filterHeight,r=n.filterWidth;this.userCode="\n      const ivec3 pads = ivec3("+(t-1-n.padInfo.front)+", "+(e-1-n.padInfo.top)+", "+(r-1-n.padInfo.left)+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+t+"; wF++) {\n          float dyF = float(dyFCorner + wF) / "+n.strideDepth+".0;\n\n          if (dyF < 0.0 || dyF >= "+n.outDepth+".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = "+t+" - 1 - wF;\n\n          for (int wR = 0; wR < "+e+"; wR++) {\n            float dyR = float(dyRCorner + wR) / "+n.strideHeight+".0;\n\n            if (dyR < 0.0 || dyR >= "+n.outHeight+".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = "+e+" - 1 - wR;\n\n            for (int wC = 0; wC < "+r+"; wC++) {\n              float dyC = float(dyCCorner + wC) / "+n.strideWidth+".0;\n\n              if (dyC < 0.0 || dyC >= "+n.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = "+r+" - 1 - wC;\n\n              for (int d2 = 0; d2 < "+n.outChannels+"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},X8=function(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * "+n.outChannels/n.inChannels+" + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < "+n.batchSize+"; b++) {\n          for (int yR = 0; yR < "+n.outHeight+"; yR++) {\n            int xR = wR + yR * "+n.strideHeight+" - "+n.padInfo.top+";\n\n            if (xR < 0 || xR >= "+n.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+n.outWidth+"; yC++) {\n              int xC = wC + yC * "+n.strideWidth+" - "+n.padInfo.left+";\n\n              if (xC < 0 || xC >= "+n.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Y8=function(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;var t=n.filterHeight,e=n.filterWidth,a=n.outChannels/n.inChannels;this.userCode="\n      const ivec2 pads = ivec2("+(t-1-n.padInfo.top)+", "+(e-1-n.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+n.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+n.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+t+" - 1 - wR;\n\n          for (int wC = 0; wC < "+e+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+n.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+n.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+e+" - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < "+a+"; dm++) {\n              int d2 = d1 * "+a+" + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},CR=function(n,t,e,r){void 0===t&&(t=!1),void 0===e&&(e=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=n.outShape;var o=n.padInfo.top,i=n.padInfo.left,s=n.strideHeight,a=n.strideWidth,u=n.dilationHeight,l=n.dilationWidth,c=n.filterHeight,d=n.filterWidth,f=4*Math.floor(n.inChannels/4),h=n.inChannels%4,p="channelsLast"===n.dataFormat,m=p?1:2,v=p?2:3,y=p?3:1,_="",b="";e&&(_=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+e+"\n        }":"\n          float activation(float x) {\n            "+e+"\n          }\n        ",b="result = activation(result);");var x=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+_+"\n\n      const ivec2 strides = ivec2("+s+", "+a+");\n      const ivec2 pads = ivec2("+o+", "+i+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords["+y+"];\n\n        ivec2 xRCCorner =\n            ivec2(coords["+m+"], coords["+v+"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+c+"; wR++) {\n          int xR = xRCorner + wR * "+u+";\n\n          if (xR < 0 || xR >= "+n.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+d+"; wC++) {\n            int xC = xCCorner + wC * "+l+";\n\n            if (xC < 0 || xC >= "+n.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+f+"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if ("+p+") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if ("+(1===h)+") {\n\n              if ("+p+") {\n                dotProd +=\n                    getX(batch, xR, xC, "+f+") *\n                    getW(wR, wC, "+f+", d2);\n              } else {\n                dotProd +=\n                    getX(batch, "+f+", xR, xC) *\n                    getW(wR, wC, "+f+", d2);\n              }\n\n            } else if ("+(2===h)+") {\n              vec2 wValues = vec2(\n                getW(wR, wC, "+f+", d2),\n                getW(wR, wC, "+f+" + 1, d2)\n              );\n\n              if ("+p+") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, "+f+"),\n                  getX(batch, xR, xC, "+f+" + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, "+f+", xR, xC),\n                  getX(batch, "+f+" + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if ("+(3===h)+") {\n              vec3 wValues = vec3(\n                getW(wR, wC, "+f+", d2),\n                getW(wR, wC, "+f+" + 1, d2),\n                getW(wR, wC, "+f+" + 2, d2)\n              );\n\n              if ("+p+") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, "+f+"),\n                  getX(batch, xR, xC, "+f+" + 1),\n                  getX(batch, xR, xC, "+f+" + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, "+f+", xR, xC),\n                  getX(batch, "+f+" + 1, xR, xC),\n                  getX(batch, "+f+" + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        "+x+"\n        "+b+"\n        setOutput(result);\n      }\n    "},Q8=function(n){this.variableNames=["x","W"],this.outputShape=n.outShape;var t=n.padInfo.front,e=n.padInfo.top,r=n.padInfo.left,o=n.strideDepth,i=n.strideHeight,s=n.strideWidth,a=n.dilationDepth,u=n.dilationHeight,l=n.dilationWidth,c=n.filterDepth,d=n.filterHeight,f=n.filterWidth,h=4*Math.floor(n.inChannels/4),p=n.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3("+o+", "+i+", "+s+");\n      const ivec3 pads = ivec3("+t+", "+e+", "+r+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+c+"; wF++) {\n          int xF = xFCorner + wF * "+a+";\n\n          if (xF < 0 || xF >= "+n.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+d+"; wR++) {\n            int xR = xRCorner + wR * "+u+";\n\n            if (xR < 0 || xR >= "+n.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+f+"; wC++) {\n              int xC = xCCorner + wC * "+l+";\n\n              if (xC < 0 || xC >= "+n.inWidth+") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < "+h+"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if ("+(1===p)+") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, "+h+") *\n                  getW(wF, wR, wC, "+h+", d2);\n              } else if ("+(2===p)+") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, "+h+"),\n                  getX(batch, xF, xR, xC, "+h+" + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, "+h+", d2),\n                  getW(wF, wR, wC, "+h+" + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if ("+(3===p)+") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, "+h+"),\n                  getX(batch, xF, xR, xC, "+h+" + 1),\n                  getX(batch, xF, xR, xC, "+h+" + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, "+h+", d2),\n                  getW(wF, wR, wC, "+h+" + 1, d2),\n                  getW(wF, wR, wC, "+h+" + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},ER=function(n,t,e,r){void 0===t&&(t=!1),void 0===e&&(e=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=n.outShape;var o=n.inHeight,i=n.inWidth,s=n.padInfo.top,a=n.padInfo.left,u=n.strideHeight,l=n.strideWidth,c=n.dilationHeight,d=n.dilationWidth,f=n.filterHeight,h=n.filterWidth,p=n.outChannels/n.inChannels,m="",v="";e&&(m=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+e+"\n        }":"\n          float activation(float x) {\n            "+e+"\n          }\n        ",v="result = activation(result);");var y=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+m+"\n\n      const ivec2 strides = ivec2("+u+", "+l+");\n      const ivec2 pads = ivec2("+s+", "+a+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+p+";\n        int q = d2 - d1 * "+p+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+f+"; wR++) {\n          int xR = xRCorner + wR * "+c+";\n\n          if (xR < 0 || xR >= "+o+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+h+"; wC++) {\n            int xC = xCCorner + wC * "+d+";\n\n            if (xC < 0 || xC >= "+i+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        "+y+"\n        "+v+"\n        setOutput(result);\n      }\n    "},DR=function(n,t,e,r){void 0===t&&(t=!1),void 0===e&&(e=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.outShape;for(var o=n.inHeight,i=n.inWidth,s=n.padInfo.top,a=n.padInfo.left,u=n.strideHeight,l=n.strideWidth,c=n.dilationHeight,d=n.dilationWidth,f=n.filterHeight,h=n.filterWidth,p=h,m="int xR; int xC; int xCOffset;",v=0;v<f;v++)for(var y=0;y<h;y++)m+="\n          vec4 xTexelR"+v+"C"+2*y+" = vec4(0.);\n          vec4 wR"+v+"C"+y+" = vec4(0.);\n          vec4 xR"+v+"C"+y+" = vec4(0.);";for(v=0;v<f;v++)for(var _=0;_<p;_++){if(m+="\n          xR = xRCorner + "+v*c+";\n          xC = xCCorner + "+(y=2*_)*d+";\n        ",1===l){if(y<h&&(m+=a%2==1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < "+o+" && xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+v+"C"+y+" = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+i+") {\n                    xTexelR"+v+"C"+y+".zw = vec2(0.);\n                  }\n                } else {\n                  xTexelR"+v+"C"+y+" = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < "+o+" && xCOffset >= 0 && xCOffset < "+i+") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+i+") {\n                    previous.zw = vec2(0.);\n                  }\n\n                  xR"+v+"C"+y+" = vec4(previous.zw, xTexelR"+v+"C"+y+".xy);\n                } else {\n                  xR"+v+"C"+y+" = vec4(0, 0, xTexelR"+v+"C"+y+".xy);\n                }\n              ":"\n                if(xR >= 0 && xR < "+o+" && xC >= 0 && xC < "+i+") {\n                  xTexelR"+v+"C"+y+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+v+"C"+y+" = vec4(0.);\n                }\n\n                xR"+v+"C"+y+" = xTexelR"+v+"C"+y+";\n              ",y+1<h)){var b=a%2==0?M0(d):d;d%2==0&&a%2==1||d%2!=0&&a%2!=1?(m+="\n                  xCOffset = xC + "+a%2+" + "+b+";\n\n                  if(xR >= 0 && xR < "+o+" &&\n                    xCOffset >= 0 && xCOffset < "+i+") {\n                    xTexelR"+v+"C"+(y+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n                ",d>1&&(m+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < "+o+" &&\n                      xCOffset >= 0 && xCOffset < "+i+") {\n                      xTexelR"+v+"C"+y+" = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR"+v+"C"+y+" = vec4(0.);\n                    }\n                  "),m+="\n                  xR"+v+"C"+(y+1)+" = vec4(\n                    xTexelR"+v+"C"+y+".zw, xTexelR"+v+"C"+(y+2)+".xy);\n                "):m+="\n                  xCOffset = xC + "+b+";\n\n                  if(xR >= 0 && xR < "+o+" &&\n                    xCOffset >= 0 && xCOffset < "+i+") {\n                    xTexelR"+v+"C"+(y+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR"+v+"C"+(y+1)+" = xTexelR"+v+"C"+(y+2)+";\n                "}}else y<h&&(m+="\n              if(xR >= 0 && xR < "+o+") {\n            ",a%2==1?(m+="\n                xCOffset = xC + 1 - "+l+";\n                if(xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+v+"C"+y+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+v+"C"+y+" = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < "+i+") {\n                  xTexelR"+v+"C"+(y+2)+" = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR"+v+"C"+(y+2)+" = vec4(0.);\n                }\n\n                xR"+v+"C"+y+" = vec4(\n                  xTexelR"+v+"C"+y+".zw, xTexelR"+v+"C"+(y+2)+".zw);\n              ",y+1<h&&(m+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + "+l+";\n                  if(xCOffset >= 0 && xCOffset < "+i+") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR"+v+"C"+(y+1)+" = vec4(xTexelR"+v+"C"+(y+2)+".xy, final.xy);\n                ")):(m+="\n                if(xC >= 0 && xC < "+i+") {\n                  xTexelR"+v+"C"+y+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+v+"C"+y+" = vec4(0.);\n                }\n\n                xCOffset = xC + "+l+";\n                if(xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+v+"C"+(y+2)+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+v+"C"+(y+2)+" = vec4(0.);\n                }\n\n                xR"+v+"C"+y+" = vec4(\n                  xTexelR"+v+"C"+y+".xy, xTexelR"+v+"C"+(y+2)+".xy);\n              ",y+1<h&&(m+="\n                  xR"+v+"C"+(y+1)+" = vec4(\n                    xTexelR"+v+"C"+y+".zw, xTexelR"+v+"C"+(y+2)+".zw);\n                ")),m+="}");y<h&&(m+="\n            vec4 wTexelR"+v+"C"+y+" = getW("+v+", "+y+", d1, q);\n            wR"+v+"C"+y+" = vec4(wTexelR"+v+"C"+y+".xz, wTexelR"+v+"C"+y+".xz);\n          ",y+1<h&&(m+="\n              vec4 wTexelR"+v+"C"+(y+1)+" = getW("+v+", "+(y+1)+", d1, q);\n              wR"+v+"C"+(y+1)+" =\n                vec4(wTexelR"+v+"C"+(y+1)+".xz, wTexelR"+v+"C"+(y+1)+".xz);"))}for(v=0;v<f;v++)for(y=0;y<h;y++)m+="dotProd += xR"+v+"C"+y+" * wR"+v+"C"+y+";";var x="",E="";e&&(x=r?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+e+"\n        }":"vec4 activation(vec4 x) {\n          "+e+"\n        }",E="result = activation(result);");var D=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+x+"\n\n      const ivec2 strides = ivec2("+u+", "+l+");\n      const ivec2 pads = ivec2("+s+", "+a+");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        "+m+"\n\n        vec4 result = dotProd;\n        "+D+"\n        "+E+"\n        setOutput(result);\n      }\n    "},Z8=function(n,t,e,r,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=n[0],s=n[1],a=n[2],c=e[0],d=e[1];this.outputShape=[t[0],c,d,n[3]];var h=[s-1+".0",a-1+".0"],p=h[0],m=h[1],v=c>1?[""+(s-1)/(c-1),"(y2-y1) * height_ratio","y1*"+p+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+p],x=d>1?[""+(a-1)/(d-1),"(x2-x1) * width_ratio","x1*"+m+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+m];this.userCode="\n      const float height_ratio = float("+v[0]+");\n      const float width_ratio = float("+x[0]+");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= "+i+") {\n          return;\n        }\n\n        float height_scale = "+v[1]+";\n        float width_scale = "+x[1]+";\n\n        float in_y = "+v[2]+";\n        if( in_y < 0.0 || in_y > "+p+" ) {\n          setOutput(float("+o+"));\n          return;\n        }\n        float in_x = "+x[2]+";\n        if( in_x < 0.0 || in_x > "+m+" ) {\n          setOutput(float("+o+"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if("+("bilinear"===r?1:0)+" == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    "},J8=function(n,t,e){this.variableNames=["x"],this.outputShape=n;var r=n.length,o=n[n.length-1],i=e?"<":">";this.userCode="\n      int getIndex(int i) {\n        "+(e?"return "+o+" -i - 1;":"return i;")+"\n      }\n\n      void main() {\n        "+Mt(r)+" coords = getOutputCoords();\n        int end = "+SR(r,"coords")+";\n        float val = 0.0;\n        for (int i = "+o+" - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx "+i+" end) {\n            continue;\n          }\n          if (idx == end && "+t+") {\n            continue;\n          }\n          "+SR(r,"coords")+" = idx;\n          val += getX("+function(s,a){if(1===s)return""+a;if(2===s)return a+".x, "+a+".y";if(3===s)return a+".x, "+a+".y, "+a+".z";if(4===s)return a+".x, "+a+".y, "+a+".z, "+a+".w";throw Error("Cumulative sum for rank "+s+" is not yet supported")}(r,"coords")+");\n        }\n        setOutput(val);\n      }\n    "};function SR(n,t){if(1===n)return""+t;if(2===n)return t+".y";if(3===n)return t+".z";if(4===n)return t+".w";throw Error("Cumulative sum for rank "+n+" is not yet supported")}var eq=function(n){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=nf.DENSE;var t=rf(n),e=tr();this.outputShape=n,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+eu(["r","c","d"],n)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+t[0]+", "+t[1]+"));\n        int index = 4 * (resTexRC.x * "+t[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        "+e.output+" = result;\n      }\n    "},tq=function(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=nf.DENSE;var t=rf(n),e=tr();this.outputShape=n,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+eu(["r","c","d"],n)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+t[0]+", "+t[1]+"));\n        int index = 4 * (resTexRC.x * "+t[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        "+e.output+" = result;\n      }\n    "},nq=function(){function n(t,e,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=r,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = "+this.getHeightCoordString()+";\n      int w = "+this.getWidthCoordString()+";\n      int d = "+this.getDepthCoordString()+";\n\n      int in_h = h / "+e+";\n      int offset_h = imod(h, "+e+");\n      int in_w = w / "+e+";\n      int offset_w = imod(w, "+e+");\n      int offset_d = (offset_h * "+e+" + offset_w) *\n        "+this.getOutputDepthSize()+";\n      int in_d = d + offset_d;\n\n      float result = "+this.getInputSamplingString()+";\n      setOutput(result);\n    }\n  "}return n.prototype.getHeightCoordString=function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"},n.prototype.getWidthCoordString=function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"},n.prototype.getDepthCoordString=function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"},n.prototype.getOutputDepthSize=function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]},n.prototype.getInputSamplingString=function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},n}(),rq=function(n){this.variableNames=["X"],this.outputShape=[n,n],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "},oq=function(n){this.variableNames=["A"],this.outTexUsage=zr.DOWNLOAD;var t=tr();this.outputShape=n,this.userCode="\n      "+vR+"\n\n      void main() {\n        float x = getAAtOutCoords();\n        "+t.output+" = encode_float(x);\n      }\n    "},iq=function(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=zr.DOWNLOAD;var t=tr();this.outputShape=n,this.userCode="\n      "+vR+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        "+t.output+" = encode_float(x);\n      }\n    "},sq=function(n,t,e){void 0===e&&(e=!1),this.variableNames=["A"];var r=tr(),o=t[0],i=t[1];this.outputShape=n;var s="result";e&&(s="floor(result * 255. + 0.5)"),this.userCode="\n      "+m_(n)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n        \n        int r = flatIndex / "+i+";\n        int c = imod(flatIndex, "+i+");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2("+i+".0, "+o+".0);\n        vec4 values = "+r.texture2D+"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        "+r.output+" = vec4("+s+", 0., 0., 0.);\n      }\n    "},aq=function(n,t,e){void 0===e&&(e=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=tr(),o=t[0],i=t[1];this.outputShape=n;var s="",a="result";e&&(a="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var l=0;l<=1;l++){var c=2*u+l;s+="\n          localCoords = coords;\n          if(localCoords[2] + "+l+" < "+n[2]+") {\n            localCoords[2] += "+l+";\n            if(localCoords[1] + "+u+" < "+n[1]+") {\n              localCoords[1] += "+u+";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / "+i+";\n              c = imod(flatIndex, "+i+");\n              uv = (vec2(c, r) + halfCR) / vec2("+i+".0, "+o+".0);\n              values = "+r.texture2D+"(A, uv);\n\n              if(offset == 0) {\n                result["+c+"] = values[0];\n              } else if(offset == 1) {\n                result["+c+"] = values[1];\n              } else if(offset == 2) {\n                result["+c+"] = values[2];\n              } else {\n                result["+c+"] = values[3];\n              }\n            }\n          }\n        "}this.userCode="\n      "+m_(n)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        "+s+"\n\n        "+r.output+" = "+a+";\n      }\n    "},IR=function(n,t,e){this.variableNames=["real","imag"];var r=t[1];this.outputShape=t;var o=e?"2.0 * "+Math.PI:"-2.0 * "+Math.PI;this.userCode="\n      const float exponentMultiplier = "+o+";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        "+n+"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float("+r+");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < "+r+"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / "+(e?r+".0":"1.0")+";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    "},cq=function(){function n(t,e){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return n.prototype.getCustomSetupFunc=function(t){var e=this;return function(r,o){null==e.valueLoc&&(e.valueLoc=r.getUniformLocationNoThrow(o,"value")),r.gl.uniform1f(e.valueLoc,t)}},n}(),dq=function(n,t,e){this.variableNames=["A","indices"];var r=n.slice();r[e]=t,this.outputShape=r,this.rank=r.length;var o=Mt(this.rank),i=function(s,a){var u=s.length;if(u>4)throw Error("Gather for rank "+u+" is not yet supported");if(1===u)return"int(getIndices(resRC))";for(var l=["resRC.x","resRC.y","resRC.z","resRC.w"],c=[],d=0;d<s.length;d++)c.push(d===a?"int(getIndices("+l[d]+"))":""+l[d]);return c.join()}(n,e);this.userCode="\n      void main() {\n        "+o+" resRC = getOutputCoords();\n        setOutput(getA("+i+"));\n      }\n    "},fq=function(n,t,e){this.sliceDim=n,this.strides=t,this.variableNames=["x","indices"],this.outputShape=e;var r=Mt(t.length),o=Mt(e.length);this.userCode="\n        "+r+" strides = "+r+"("+this.strides+");\n         void main() {\n          "+o+" coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < "+this.sliceDim+"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * "+(this.sliceDim>1?"strides[j]":"strides")+";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      "};function AR(n,t){var e=tr();return Ck(n,t,e.version+"\n    precision highp float;\n    "+e.attribute+" vec3 clipSpacePos;\n    "+e.attribute+" vec2 uv;\n    "+e.varyingVs+" vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }")}function TR(n,t){return Ik(n,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function MR(n,t){return Ak(n,t,new Uint16Array([0,1,2,2,1,3]))}function vf(n,t,e,r,o,i,s){Mk(e,r);var a=Tk(n,t),u=n.TEXTURE_2D;return ce(n,t,function(){return n.bindTexture(u,a)}),ce(n,t,function(){return n.texParameteri(u,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE)}),ce(n,t,function(){return n.texParameteri(u,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)}),ce(n,t,function(){return n.texParameteri(u,n.TEXTURE_MIN_FILTER,n.NEAREST)}),ce(n,t,function(){return n.texParameteri(u,n.TEXTURE_MAG_FILTER,n.NEAREST)}),ce(n,t,function(){return n.texImage2D(u,0,o,e,r,0,i,s,null)}),ce(n,t,function(){return n.bindTexture(n.TEXTURE_2D,null)}),a}function kR(n,t,e,r,o){var i=Ag(e,r);return vf(n,t,i[0],i[1],o.internalFormatFloat,o.textureFormatFloat,n.FLOAT)}function RR(n,t,e,r,o){var i=Ag(e,r);return vf(n,t,i[0],i[1],o.internalFormatHalfFloat,o.textureFormatFloat,o.textureTypeHalfFloat)}function NR(n,t,e,r,o){var i=Ag(e,r);return vf(n,t,i[0],i[1],n.RGBA,n.RGBA,n.UNSIGNED_BYTE)}function FR(n,t,e,r,o){var i=sf(e,r);return vf(n,t,i[0],i[1],o.internalFormatPackedFloat,n.RGBA,n.FLOAT)}function PR(n,t,e,r,o){var i=sf(e,r);return vf(n,t,i[0],i[1],o.internalFormatPackedHalfFloat,n.RGBA,o.textureTypeHalfFloat)}function OR(n,t,e,r){return ce(n,t,function(){return n.bindBuffer(n.ARRAY_BUFFER,r)}),K0(n,t,e,"clipSpacePos",r,3,20,0)&&K0(n,t,e,"uv",r,2,20,12)}function LR(n,t,e,r,o,i,s){var a,u,l;ce(n,t,function(){return n.bindTexture(n.TEXTURE_2D,e)}),i instanceof Uint8Array?(a=new Uint8Array(r*o*4),u=n.UNSIGNED_BYTE,l=n.RGBA):(a=new Float32Array(r*o*4),u=n.FLOAT,l=s.internalFormatPackedFloat),a.set(i),ce(n,t,function(){return n.texImage2D(n.TEXTURE_2D,0,l,r,o,0,n.RGBA,u,a)}),ce(n,t,function(){return n.bindTexture(n.TEXTURE_2D,null)})}function BR(n,t,e,r){ce(n,t,function(){return n.bindTexture(n.TEXTURE_2D,e)}),r.data instanceof Uint8Array?ce(n,t,function(){return n.texImage2D(n.TEXTURE_2D,0,n.RGBA,r.width,r.height,0,n.RGBA,n.UNSIGNED_BYTE,r.data)}):ce(n,t,function(){return n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r)}),ce(n,t,function(){return n.bindTexture(n.TEXTURE_2D,null)})}function VR(n,t,e,r,o){var i=n.createBuffer();ce(n,t,function(){return n.bindBuffer(n.PIXEL_PACK_BUFFER,i)});var s=16*e*r;return ce(n,t,function(){return n.bufferData(n.PIXEL_PACK_BUFFER,s,n.STREAM_READ)}),ce(n,t,function(){return n.readPixels(0,0,r,e,n.RGBA,n.FLOAT,0)}),ce(n,t,function(){return n.bindBuffer(n.PIXEL_PACK_BUFFER,null)}),i}function UR(n,t,e){var r=n,o=new Float32Array(e);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,o),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),o}function jR(n,t,e,r,o){var i=Ag(e,r),s=i[0],a=i[1],u=new Uint8Array(e*r*4);return ce(n,t,function(){return n.readPixels(0,0,s,a,o.downloadTextureFormat,n.UNSIGNED_BYTE,u)}),new Float32Array(u.buffer)}function HR(n,t,e,r,o,i,s,a){var f,u=n,l=new Float32Array((f=sf(i,s))[0]*f[1]*4);return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function WR(n,t,e,r){var o=new Float32Array(e*r*4);return ce(n,t,function(){return n.readPixels(0,0,r,e,n.RGBA,n.FLOAT,o)}),o}var hq=Object.freeze({createVertexShader:AR,createVertexBuffer:TR,createIndexBuffer:MR,createFloat32MatrixTexture:kR,createFloat16MatrixTexture:RR,createUnsignedBytesMatrixTexture:NR,createPackedMatrixTexture:FR,createFloat16PackedMatrixTexture:PR,bindVertexProgramAttributeStreams:OR,uploadDenseMatrixToTexture:LR,uploadPixelDataToTexture:BR,createBufferFromOutputTexture:VR,downloadFloat32MatrixFromBuffer:UR,downloadByteEncodedFloatMatrixFromOutputTexture:jR,downloadPackedMatrixFromBuffer:HR,downloadMatrixFromPackedOutputTexture:WR}),zR=function(){function n(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var e=$().getNumber("WEBGL_VERSION");null!=t?(this.gl=t,bk(e,t)):this.gl=ci(e);var r="WEBGL_color_buffer_float";if(1===$().getNumber("WEBGL_VERSION")){if(this.textureFloatExtension=af(this.gl,this.debug,"OES_texture_float"),Gr(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=af(this.gl,this.debug,"OES_texture_half_float");else if($().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Gr(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=af(this.gl,this.debug,"EXT_color_buffer_half_float");else if($().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(Gr(this.gl,r="EXT_color_buffer_float"))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!Gr(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=TR(this.gl,this.debug),this.indexBuffer=MR(this.gl,this.debug),this.framebuffer=kk(this.gl,this.debug),this.textureConfig=q0(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(n.prototype,"debug",{get:function(){return $().getBool("DEBUG")},enumerable:!0,configurable:!0}),n.prototype.dispose=function(){var t=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var e=this.gl;ce(e,this.debug,function(){return e.finish()}),ce(e,this.debug,function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)}),ce(e,this.debug,function(){return e.deleteFramebuffer(t.framebuffer)}),ce(e,this.debug,function(){return e.bindBuffer(e.ARRAY_BUFFER,null)}),ce(e,this.debug,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)}),ce(e,this.debug,function(){return e.deleteBuffer(t.indexBuffer)}),this.disposed=!0}},n.prototype.createFloat32MatrixTexture=function(t,e){return this.throwIfDisposed(),kR(this.gl,this.debug,t,e,this.textureConfig)},n.prototype.createFloat16MatrixTexture=function(t,e){return this.throwIfDisposed(),RR(this.gl,this.debug,t,e,this.textureConfig)},n.prototype.createUnsignedBytesMatrixTexture=function(t,e){return this.throwIfDisposed(),NR(this.gl,this.debug,t,e)},n.prototype.uploadPixelDataToTexture=function(t,e){this.throwIfDisposed(),BR(this.gl,this.debug,t,e)},n.prototype.uploadDenseMatrixToTexture=function(t,e,r,o){this.throwIfDisposed(),LR(this.gl,this.debug,t,e,r,o,this.textureConfig)},n.prototype.createFloat16PackedMatrixTexture=function(t,e){return this.throwIfDisposed(),PR(this.gl,this.debug,t,e,this.textureConfig)},n.prototype.createPackedMatrixTexture=function(t,e){return this.throwIfDisposed(),FR(this.gl,this.debug,t,e,this.textureConfig)},n.prototype.deleteMatrixTexture=function(t){var e=this;this.throwIfDisposed(),this.outputTexture===t&&(X0(this.gl,this.debug,this.framebuffer),this.outputTexture=null),ce(this.gl,this.debug,function(){return e.gl.deleteTexture(t)})},n.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,e,r){var o=this;return this.downloadMatrixDriver(t,function(){return jR(o.gl,o.debug,e,r,o.textureConfig)})},n.prototype.downloadPackedMatrixFromBuffer=function(t,e,r,o,i,s){return HR(this.gl,t,0,0,0,i,s)},n.prototype.downloadFloat32MatrixFromBuffer=function(t,e){return UR(this.gl,t,e)},n.prototype.createBufferFromTexture=function(t,e,r){this.bindTextureToFrameBuffer(t);var o=VR(this.gl,this.debug,e,r);return this.unbindTextureToFrameBuffer(),o},n.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},n.prototype.createFence=function(t){var e,r,o=this;if($().getBool("WEBGL_FENCE_API_ENABLED")){var i=t,s=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),r=function(){var a=i.clientWaitSync(s,0,0);return a===i.ALREADY_SIGNALED||a===i.CONDITION_SATISFIED},e=s}else $().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),r=function(){return o.isQueryAvailable(e,$().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):r=function(){return!0};return{query:e,isFencePassed:r}},n.prototype.downloadMatrixFromPackedTexture=function(t,e,r){var o=this;return this.downloadMatrixDriver(t,function(){return WR(o.gl,o.debug,e,r)})},n.prototype.createProgram=function(t){this.throwIfDisposed();var e=this.gl,r=Ek(e,this.debug,t),o=AR(e,this.debug),i=Dk(e,this.debug);return ce(e,this.debug,function(){return e.attachShader(i,o)}),ce(e,this.debug,function(){return e.attachShader(i,r)}),Sk(e,this.debug,i),this.debug&&kg(e,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=OR(e,this.debug,this.program,this.vertexBuffer)),i},n.prototype.deleteProgram=function(t){var e=this;this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&ce(this.gl,this.debug,function(){return e.gl.deleteProgram(t)})},n.prototype.setProgram=function(t){var e=this;this.throwIfDisposed(),this.program=t,null!=this.program&&this.debug&&kg(this.gl,this.debug,this.program),ce(this.gl,this.debug,function(){return e.gl.useProgram(t)})},n.prototype.getUniformLocation=function(t,e,r){return void 0===r&&(r=!0),this.throwIfDisposed(),r?Nk(this.gl,this.debug,t,e):Fk(this.gl,t,e)},n.prototype.getAttributeLocation=function(t,e){var r=this;return this.throwIfDisposed(),ce(this.gl,this.debug,function(){return r.gl.getAttribLocation(t,e)})},n.prototype.getUniformLocationNoThrow=function(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)},n.prototype.setInputMatrixTexture=function(t,e,r){this.throwIfDisposed(),this.throwIfNoProgram(),Pk(this.gl,this.debug,0,t,e,r)},n.prototype.setOutputMatrixTexture=function(t,e,r){this.setOutputMatrixTextureDriver(t,r,e)},n.prototype.setOutputPackedMatrixTexture=function(t,e,r){this.throwIfDisposed();var o=sf(e,r);this.setOutputMatrixTextureDriver(t,o[0],o[1])},n.prototype.setOutputMatrixWriteRegion=function(t,e,r,o){this.setOutputMatrixWriteRegionDriver(r,t,o,e)},n.prototype.setOutputPackedMatrixWriteRegion=function(t,e,r,o){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},n.prototype.debugValidate=function(){null!=this.program&&kg(this.gl,this.debug,this.program),uf(this.gl)},n.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),ce(t,this.debug,function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)})},n.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),ce(this.gl,this.debug,function(){return t.gl.finish()})},n.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=af(this.gl,this.debug,2===$().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},n.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},n.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},n.prototype.beginQuery=function(){if(2===$().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var t=this.gl,e=this.getQueryTimerExtensionWebGL2(),r=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,r),r}var o=this.getQueryTimerExtensionWebGL1(),i=o.createQueryEXT();return o.beginQueryEXT(o.TIME_ELAPSED_EXT,i),i},n.prototype.endQuery=function(){if(2!==$().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var e=this.gl,r=this.getQueryTimerExtensionWebGL2();e.endQuery(r.TIME_ELAPSED_EXT)}},n.prototype.waitForQueryAndGetTime=function(t){return he(this,void 0,void 0,function(){var e=this;return pe(this,function(r){switch(r.label){case 0:return[4,k0(function(){return e.disposed||e.isQueryAvailable(t,$().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return r.sent(),[2,this.getQueryTime(t,$().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},n.prototype.getQueryTime=function(t,e){if(0===e)return null;if(2===e){var r=this.gl;return r.getQueryParameter(t,r.QUERY_RESULT)/1e6}var o=this.getQueryTimerExtensionWebGL1();return o.getQueryObjectEXT(t,o.QUERY_RESULT_EXT)/1e6},n.prototype.isQueryAvailable=function(t,e){if(0===e)return!0;if(2===e){var r=this.gl,o=this.getQueryTimerExtensionWebGL2(),i=r.getQueryParameter(t,r.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(o=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,o.QUERY_RESULT_AVAILABLE_EXT),null==this.disjoint&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),i&&!this.disjoint},n.prototype.pollFence=function(t){var e=this;return new Promise(function(r){e.addItemToPoll(function(){return t.isFencePassed()},function(){return r()})})},n.prototype.pollItems=function(){for(var t=function(r){for(var o=0;o<r.length&&r[o]();++o);return o-1}(this.itemsToPoll.map(function(r){return r.isDoneFn})),e=0;e<=t;++e)(0,this.itemsToPoll[e].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},n.prototype.addItemToPoll=function(t,e){var r=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1||k0(function(){return r.pollItems(),0===r.itemsToPoll.length})},n.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),Rg(this.gl,this.debug,t,this.framebuffer),this.debug&&uf(this.gl)},n.prototype.unbindTextureToFrameBuffer=function(){null!=this.outputTexture?(Rg(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&uf(this.gl)):X0(this.gl,this.debug,this.framebuffer)},n.prototype.downloadMatrixDriver=function(t,e){this.bindTextureToFrameBuffer(t);var r=e();return this.unbindTextureToFrameBuffer(),r},n.prototype.setOutputMatrixTextureDriver=function(t,e,r){this.throwIfDisposed();var o=this.gl;Rg(o,this.debug,t,this.framebuffer),this.debug&&uf(o),this.outputTexture=t,ce(o,this.debug,function(){return o.viewport(0,0,e,r)}),ce(o,this.debug,function(){return o.scissor(0,0,e,r)})},n.prototype.setOutputMatrixWriteRegionDriver=function(t,e,r,o){var i=this;this.throwIfDisposed(),ce(this.gl,this.debug,function(){return i.gl.scissor(t,e,r,o)})},n.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},n.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error("No GPU program is currently set.")},n}();function $R(n,t){if(n.length!==t.length)throw Error("Binary was compiled with "+n.length+" inputs, but was executed with "+t.length+" inputs");n.forEach(function(e,r){var o=e.logicalShape,i=t[r],s=i.shape;if(!pn(o,s))throw Error("Binary was compiled with different shapes than the current args. Shapes "+o+" and "+s+" must match");if(!e.isUniform||!i.isUniform){var a=e.texShape,u=i.isUniform?null:i.texData.texShape;if(!pn(a,u))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+a+" and "+u+" must match")}})}var pq=function(n,t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n;for(var o=e.inChannels,i=e.strideWidth,s=e.strideHeight,a=e.padInfo,u=e.outWidth,l=e.dilationWidth,c=e.dilationHeight,d=e.dataFormat,f=a.left,h=a.top,p=o*e.filterWidth,m=tr(),v="channelsLast"===d,y=v?0:1,_=v?1:2,b="",x=0;x<=1;x++)for(var E=0;E<=1;E++)b+="\n          blockIndex = rc.y + "+E+";\n          pos = rc.x + "+x+";\n\n          if(blockIndex < "+n[1]+" && pos < "+n[0]+") {\n            offsetY = int(blockIndex / ("+u+")) * "+s+" - "+h+";\n            d0 = offsetY + "+c+" * (pos / "+p+");\n\n            if(d0 < "+t[y]+" && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), "+u+".) * "+i+". - "+f+".);\n              d1 = offsetX + "+l+" * (int(mod(float(pos), "+p+".) / "+o+".));\n\n              if(d1 < "+t[_]+" && d1 >= 0) {\n\n                ch = int(mod(float(pos), "+o+".));\n\n                if ("+v+") {\n                  innerDims = vec2(d1, ch);\n                  result["+(2*x+E)+"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result["+(2*x+E)+"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ";this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        "+b+"\n\n        "+m.output+" = result;\n      }\n    "},gq=function(n,t,e,r,o){this.variableNames=["x"],this.outputShape=[];var s=t,a=n[3]-1;this.outputShape=n;var u="float("+e+") + float("+r+") * sum";this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -"+s+"; j <= "+s+"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  "+a+") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * "+(.5===o?"inversesqrt("+u+")":1===o?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));")+";\n        setOutput(val);\n      }\n    "},mq=function(n,t,e,r,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=n,this.depth=n[3],this.depthRadius=t,this.bias=e,this.alpha=r,this.beta=o,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < "+this.depth+"; ++d) {\n          int depthBegin = int(max(0.0, float(d - "+t+")));\n          int depthEnd = int(min(float("+this.depth+"),\n              float(d + "+t+" + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = "+this.depth+";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float("+r+") * norm + float("+e+");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float("+r+")\n                * float("+o+")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * "+o+");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    "},vq=function(n,t,e,r,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var s=t,a=n[3]-1;this.outputShape=n;var u="float("+e+") + float("+r+") * sum";this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < "+this.outputShape[3]+";\n        bool hasNextRow = c < "+this.outputShape[2]+";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - "+s+";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - "+s+"; j <= "+s+"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2("+a+"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * "+(.5===o?"inversesqrt("+u+")":1===o?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));")+";\n        setOutput(result);\n      }\n    "},yq=function(n){this.variableNames=["dy","maxPos"],this.outputShape=n.inShape;var o=n.effectiveFilterHeight,i=n.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(o-1-n.padInfo.top)+", "+(i-1-n.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+o+";\n          wR += "+n.dilationHeight+") {\n          float dyR = float(dyRCorner + wR) / "+n.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+n.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+i+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+n.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+n.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+(o*i-1)+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+i+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},wq=function(n){this.variableNames=["dy","maxPos"],this.outputShape=n.inShape;var a=n.effectiveFilterDepth,u=n.effectiveFilterHeight,l=n.effectiveFilterWidth;this.userCode="\n      const ivec3 pads = ivec3("+(a-1-n.padInfo.front)+", "+(u-1-n.padInfo.top)+", "+(l-1-n.padInfo.left)+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+a+";\n           wD += "+n.dilationDepth+") {\n          float dyD = float(dyDCorner + wD) / "+n.strideDepth+".0;\n\n          if (dyD < 0.0 || dyD >= "+n.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+u+";\n              wR += "+n.dilationHeight+") {\n            float dyR = float(dyRCorner + wR) / "+n.strideHeight+".0;\n\n            if (dyR < 0.0 || dyR >= "+n.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+l+";\n                wC += "+n.dilationWidth+") {\n              float dyC = float(dyCCorner + wC) / "+n.strideWidth+".0;\n\n              if (dyC < 0.0 || dyC >= "+n.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = "+(a*u*l-1)+" -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * "+u+" * "+l+" +\n                  wR * "+l+" + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},w_=function(n,t,e,r,o,i,s){void 0===e&&(e=!1),void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===i&&(i=null),void 0===s&&(s=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var u=Math.ceil((e?n[1]:n[2])/2),l=e?"i * 2, rc.y":"rc.y, i * 2",c=r?"rc.z, i * 2":"i * 2, rc.z",d=e?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],h="",p="";i&&(h=s?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+i+"\n        }":"vec4 activation(vec4 x) {\n          "+i+"\n        }",p="result = activation(result);");var m=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+h+"\n\n      const float sharedDimension = "+u+".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < "+u+"; i++) {\n          vec4 a = getMatrixA(rc.x, "+l+");\n          vec4 b = getMatrixB(rc.x, "+c+");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += ("+d[0]+" * "+f[0]+");\n          result += ("+d[1]+" * "+f[1]+");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        "+m+"\n\n        "+p+"\n\n        setOutput(result);\n      }\n    "},bq=function(){function n(t,e,r){this.variableNames=["probs"],this.outputShape=[t,r],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(e-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(e-1)+"));\n      }\n    "}return n.prototype.getCustomSetupFunc=function(t){var e=this;return function(r,o){null==e.seedLoc&&(e.seedLoc=r.getUniformLocation(o,"seed")),r.gl.uniform1f(e.seedLoc,t)}},n}(),_q=function(n,t,e,r){this.variableNames=["indices"],this.outputShape=[n,t],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+r+"), float("+e+"),\n                      float(index == coords.y)));\n      }\n    "},xq=function(n){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=n;var a,l,c,t=n.length;if(0===t)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var e=Nr("rc",t),r=Mt(t),o=function(a,u,l){if(1===a)return"rc > "+u[0];for(var c="",d=a-2;d<a;d++)c+=l[d]+" >= "+u[d],d<a-1&&(c+="||");return c}(t,n,e),i=function(a,u,l,c){if(1===a)return"";var d=c.slice(-2);return"\n    int r = "+d[0]+";\n    int c = "+d[1]+";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= "+u+";\n    bool rEdge = rp1 >= "+l+";\n  "}(t,n[n.length-1],n[n.length-2],e),s=(c=function(d,f){for(var h=[],p=0;p<=1;p++)for(var m=0;m<=1;m++){for(var v=(0===p?"r":"rp1")+", "+(0===m?"c":"cp1"),y=2;y<d;y++)v=f[f.length-1-y]+","+v;h.push(v)}return h}(l=(a=n).length,e),1===l?"getA(rc),\n            rc + 1 >= "+a[0]+" ? 0. : getA(rc + 1),\n            0, 0":"getA("+c[0]+"),\n          cEdge ? 0. : getA("+c[1]+"),\n          rEdge ? 0. : getA("+c[2]+"),\n          rEdge || cEdge ? 0. : getA("+c[3]+")");this.userCode="\n        void main() {\n          "+r+" rc = getOutputCoords();\n\n          if("+o+") {\n            setOutput(vec4(0));\n          } else {\n            "+i+"\n\n            setOutput(vec4("+s+"));\n          }\n        }\n      "}},Cq=function(n,t,e){this.variableNames=["x"],this.outputShape=t.map(function(u,l){return u[0]+n[l]+u[1]});var r=n.length,o=Mt(r),i=t.map(function(u){return u[0]}).join(","),s=t.map(function(u,l){return u[0]+n[l]}).join(","),a=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      "+o+" start = "+o+"("+i+");\n      "+o+" end = "+o+"("+s+");\n\n      void main() {\n        "+o+" outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float("+e+"));\n        } else {\n          "+o+" coords = outC - start;\n          setOutput(getX("+a+"));\n        }\n      }\n    ":"\n        int start = "+i+";\n        int end = "+s+";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float("+e+"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      "},Eq=function(n,t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(function(v,y){return v[0]+n[y]+v[1]});for(var r=n.length,o=Mt(r),i=t.map(function(v){return v[0]}).join(","),s=t.map(function(v,y){return v[0]+n[y]}).join(","),a=Nr("rc",r),u=Nr("source",r),l=a[r-1]+" < "+this.outputShape[r-1],c=1===r?"source":"vec2("+u.slice(-2).join()+")",d=[o+" rc = outputLoc;",a[r-1]+" += 1;\n       if("+l+") {\n      ",1===r?"":"}\n       rc = outputLoc;\n       "+a[r-2]+" += 1;\n       if("+a[r-2]+" < "+this.outputShape[r-2]+") {",1===r?"":"  "+a[r-1]+" += 1;\n         if("+l+") {"],f=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",h="",p=0,m=1===r?2:4;p<m;p++)h+="\n        "+d[p]+"\n        if ("+f+") {\n          result["+p+"] = float("+e+");\n        } else {\n          "+o+" source = rc - start;\n          result["+p+"] = getChannel(getX("+u.join()+"), "+c+");\n        }\n      ";this.userCode="\n      const "+o+" start = "+o+"("+i+");\n      const "+o+" end = "+o+"("+s+");\n\n      void main() {\n        "+o+" outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        "+(h+=1===r?"} ":"}}")+"\n        setOutput(result);\n      }\n    "},b_=function(n,t,e){if(this.variableNames=["x"],"avg"===t&&e)throw new Error("Cannot compute positions for average pool.");var r=n.filterWidth,o=n.strideHeight,i=n.strideWidth,s=n.dilationHeight,a=n.dilationWidth,u=n.effectiveFilterHeight,l=n.effectiveFilterWidth,c=n.padInfo.top,d=n.padInfo.left;this.outputShape=n.outShape;var f="avg"===t,h="0.0";if(f||(h="-1.0 / 1e-20"),e)this.userCode="\n        const ivec2 strides = ivec2("+o+", "+i+");\n        const ivec2 pads = ivec2("+c+", "+d+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+u+";\n              wR += "+s+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+n.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+l+";\n                wC += "+a+") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+n.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = wR * "+l+" + wC;\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var p=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(p="avgValue / count");var m=4*Math.floor(r/4),v=r%4,y="\n      if ("+f+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec2 strides = ivec2("+o+", "+i+");\n      const ivec2 pads = ivec2("+c+", "+d+");\n      const float initializationValue = "+h+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+n.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+h+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < "+u+";\n            wR += "+s+") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+n.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+m+"; wC += 4) {\n            int xC = xCCorner + wC * "+a+";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+a+", d),\n              getValue(batch, xR, xC + 2 * "+a+", d),\n              getValue(batch, xR, xC + 3 * "+a+", d)\n            );\n\n            "+y+"\n          }\n\n          int xC = xCCorner + "+m+";\n          if ("+(1===v)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            "+y+"\n          } else if ("+(2===v)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+a+", d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+y+"\n          } else if ("+(3===v)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+a+", d),\n              getValue(batch, xR, xC + 2 * "+a+", d),\n              initializationValue\n            );\n\n            "+y+"\n          }\n        }\n        setOutput("+p+");\n      }\n    "}},__=function(n,t,e){if(this.variableNames=["x"],"avg"===t&&e)throw new Error("Cannot compute positions for average pool.");var r=n.filterWidth,o=n.strideDepth,i=n.strideHeight,s=n.strideWidth,a=n.dilationDepth,u=n.dilationHeight,l=n.dilationWidth,c=n.effectiveFilterDepth,d=n.effectiveFilterHeight,f=n.effectiveFilterWidth,h=n.padInfo.front,p=n.padInfo.top,m=n.padInfo.left;this.outputShape=n.outShape;var v="avg"===t,y="0.0";if(v||(y="-1.0 / 1e-20"),e)this.userCode="\n        const ivec3 strides =\n            ivec3("+o+", "+i+", "+s+");\n        const ivec3 pads = ivec3("+h+", "+p+", "+m+");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < "+c+";\n              wD += "+a+") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= "+n.inDepth+") {\n              continue;\n            }\n\n            for (int wR = 0; wR < "+d+";\n                wR += "+u+") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= "+n.inHeight+") {\n                continue;\n              }\n\n              for (int wC = 0; wC < "+f+";\n                  wC += "+l+") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= "+n.inWidth+") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value >= currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition =\n                      wD * "+d+" * "+f+" +\n                      wR * "+f+" + wC;;\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var _=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(_="avgValue / count");var b=4*Math.floor(r/4),x=r%4,E="\n      if ("+v+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec3 strides =\n        ivec3("+o+", "+i+", "+s+");\n      const ivec3 pads = ivec3("+h+", "+p+", "+m+");\n      const float initializationValue = "+y+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= "+n.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+y+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < "+c+";\n            wD += "+a+") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= "+n.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+d+";\n            wR += "+u+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+n.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+b+"; wC += 4) {\n              int xC = xCCorner + wC * "+l+";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+l+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+l+", ch),\n                getValue(batch, xD, xR, xC + 3 * "+l+", ch)\n              );\n\n              "+E+"\n            }\n\n            int xC = xCCorner + "+b+";\n            if ("+(1===x)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              "+E+"\n            } else if ("+(2===x)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+l+", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              "+E+"\n            } else if ("+(3===x)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+l+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+l+", ch),\n                initializationValue\n              );\n\n              "+E+"\n            }\n          }\n          setOutput("+_+");\n        }\n      }\n    "}},Dq=function(n,t){this.variableNames=["x"];var e=n.windowSize,r=n.batchSize,o=n.inSize,i=Math.ceil(o/e);this.outputShape=[r,i];var s="0.0",a="";"prod"===t?s="1.0":"min"===t?(s="1.0 / 1e-20",a="min"):"max"===t&&(s="-1.0 / 1e-20",a="max");var u=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===t?u="sumValue":"prod"===t?u="prodValue":"all"===t?u="allValue":"any"===t&&(u="anyValue");var l=4*Math.floor(e/4),c=e%4,d="\n      if ("+("sum"===t)+") {\n        sumValue += dot(values, ones);\n      } else if ("+("prod"===t)+") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = "+a+"(values, minMaxValue);\n      }\n    ",f="vec4";"all"===t?(s="1.0",d="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",f="bvec4"):"any"===t&&(s="0.0",d="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",f="bvec4");var h="";o%e>0&&(h="\n        if (inIdx < 0 || inIdx >= "+o+") {\n          return initializationValue;\n        }\n      "),this.userCode="\n      const float initializationValue = "+s+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+h+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+e+";\n\n        vec4 minMaxValue = vec4("+s+");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < "+l+"; i += 4) {\n          int inIdx = inOffset + i;\n          "+f+" values = "+f+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+d+"\n        }\n\n        int inIdx = inOffset + "+l+";\n        if ("+(1===c)+") {\n          "+f+" values = "+f+"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          "+d+"\n        } else if ("+(2===c)+") {\n          "+f+" values = "+f+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          "+d+"\n        } else if ("+(3===c)+") {\n          "+f+" values = "+f+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          "+d+"\n        }\n        setOutput("+u+");\n      }\n    "},Sq=function(n,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n;for(var e="",r=0;r<4;r++){var o="thisRC = rc;";r%2==1&&(o+="thisRC.z += 1;"),r>1&&(o+="thisRC.y += 1;"),e+="\n        "+o+"\n        "+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+"\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result["+r+"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        "+(r>0?"}":"")+"\n      "}this.userCode="\n      \n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      "+eu(["r","c","d"],t)+"\n      return ivec3(r, c, d);\n    }\n  \n      "+m_(n)+"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = "+n[1]+";\n        int cols = "+n[2]+";\n\n        "+e+"\n\n        setOutput(result);\n      }\n    "},Iq=function(n,t,e){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,o=r[1],i=r[2],s=n.shape,a=s[1],u=s[2],l=[e&&a>1?o-1:o,e&&u>1?i-1:i],c=[e&&a>1?a-1:a,e&&u>1?u-1:u],d=l[0]/c[0],f=l[1]/c[1],h=1/d,p=1/f,m=2*Math.ceil(h)+2,v=2*Math.ceil(p)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+d+");\n        const float widthScale = float("+f+");\n\n        const float invHeightScale = float("+h+");\n        const float invWidthScale = float("+p+");\n\n        const int winHeight = int("+m+");\n        const int winWidth = int("+v+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+a+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), "+(o-1)+".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), "+(i-1)+".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},Aq=function(n,t,e,r){this.variableNames=["A"],this.outputShape=[];var i=n[1],s=n[2];this.outputShape=[n[0],t,e,n[3]];var u=[r&&t>1?i-1:i,r&&e>1?s-1:s],l=[r&&t>1?t-1:t,r&&e>1?e-1:e];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+u[0]/l[0]+",\n          "+u[1]/l[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+s+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "},Tq=function(n,t,e,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var i=n[1],s=n[2],a=n[3];this.outputShape=[n[0],t,e,a];var u=[r&&t>1?i-1:i,r&&e>1?s-1:s],l=[r&&t>1?t-1:t,r&&e>1?e-1:e];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          "+u[0]/l[0]+",\n          "+u[1]/l[1]+",\n          "+u[1]/l[1]+");\n      const vec3 inputShapeRC = vec3("+i+".0, "+s+".0,\n                                     "+s+".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < "+(a-1)+";\n        bool hasNextRow = coords.z < "+(e-1)+";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    "},Mq=function(n,t,e){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,o=r[1],i=r[2],s=n.shape,a=s[1],u=s[2],l=[e&&a>1?o-1:o,e&&u>1?i-1:i],c=[e&&a>1?a-1:a,e&&u>1?u-1:u],d=l[0]/c[0],f=l[1]/c[1],h=1/d,p=1/f,m=2*Math.ceil(h)+2,v=2*Math.ceil(p)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+d+");\n        const float widthScale = float("+f+");\n\n        const float invHeightScale = float("+h+");\n        const float invWidthScale = float("+p+");\n\n        const int winHeight = int("+m+");\n        const int winWidth = int("+v+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+a+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float("+l[0]+") *\n                (float(dyR) / float("+c[0]+"));\n\n            float sourceFracCol =\n                float("+l[1]+") *\n                  (float(dyC) / float("+c[1]+"));\n\n            int sourceNearestRow = int(min(\n                float(int("+o+") - 1),\n                "+e+" ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int("+i+") - 1),\n                "+e+" ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},kq=function(n,t,e,r){this.variableNames=["A"],this.outputShape=[];var i=n[1],s=n[2];this.outputShape=[n[0],t,e,n[3]];var u=[r&&t>1?i-1:i,r&&e>1?s-1:s],l=[r&&t>1?t-1:t,r&&e>1?e-1:e];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+u[0]/l[0]+",\n          "+u[1]/l[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+s+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + "+(r?"0.5":"0.0")+")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    "},Rq=function(n,t){this.variableNames=["x"];var e=n.length;if(e>4)throw new Error("WebGL backend: Reverse of rank-"+e+" tensor is not yet supported");if(this.outputShape=n,1!==e){var r=n.map(function(i,s){return-1!==t.indexOf(a=s)&&1!==n[a]?n[a]+" - coords["+a+"] - 1":"coords["+a+"]";var a}).join(","),o=Mt(e);this.userCode="\n      void main() {\n        "+o+" coords = getOutputCoords();\n        setOutput(getX("+r+"));\n      }\n    "}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX("+n[0]+" - coord - 1));\n        }\n      "},Nq=function(n,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var e=n.length;if(e>4)throw new Error("WebGL backend: Reverse of rank-"+e+" tensor is not yet supported");this.outputShape=n;var u,r=Nr("rc",e),o=r[e-1]+" + 1 < "+this.outputShape[e-1],i=r[e-2]+" + 1 < "+this.outputShape[e-2],s=Mt(e);function a(u){var l=n.map(function(c,d){return h=u,-1!==t.indexOf(f=d)&&1!==n[f]?n[f]+" - "+h[f]+" - 1":""+h[f];var f,h});return"getChannel(getX("+l.join(",")+"), vec2("+l.slice(-2).join(",")+"))"}this.userCode=1===e?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX("+n[0]+" - rc - 1),\n            "+n[0]+" - rc - 1);\n          if("+o+"){\n              result.g = getChannel(getX("+n[0]+" - (rc  + 1) - 1),\n                "+n[0]+" - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      ":"\n        void main() {\n          "+s+" rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = "+a(r.slice())+";\n          if("+o+"){\n            result.g = "+((u=r.slice())[e-1]="("+u[e-1]+" + 1)",a(u)+";\n          }\n          if(")+i+") {\n            result.b = "+function(u){return u[e-2]="("+u[e-2]+" + 1)",a(u)}(r.slice())+";\n            if("+o+") {\n              result.a = "+function(u){return u[e-1]="("+u[e-1]+" + 1)",u[e-2]="("+u[e-2]+" + 1)",a(u)}(r.slice())+";\n            }\n          }\n          setOutput(result);\n        }\n    "},GR=function(n,t,e,r,o,i,s){void 0===s&&(s=!0),this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var a=Mt(o.length),u=Mt(i.length),l="";1===e?l="i":2===e&&(l="i, j");var d="";1===r?d="i":2===r&&(d="i, coords[1]"),this.userCode="\n        "+a+" strides = "+a+"("+o+");\n\n        void main() {\n          "+u+" coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < "+n+"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < "+t+"; j++) {\n              int index = round(getIndices("+l+"));\n              flattenedIndex += index * "+(t>1?"strides[j]":"strides")+";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += getUpdates("+d+");\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      "},Fq=function(n,t){this.variableNames=["x","segmentIds"];var e=n.windowSize,r=n.batchSize,o=n.inSize,i=n.numSegments,s=i*Math.ceil(o/e);this.outputShape=[r,s];var a=4*Math.floor(e/4),u=e%4,l="\n        sumValue += dot(values, segFilter);\n    ",c="";o%e>0&&(c="\n        if (inIdx < 0 || inIdx >= "+o+") {\n          return initializationValue;\n        }\n      ");var d="";o%e>0&&(d="\n        if (inIdx < 0 || inIdx >= "+o+") {\n          return -1.0;\n        }\n      "),this.userCode="\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        "+c+"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        "+d+"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          "+i+")) * float("+e+"));\n        int currentSeg = int(mod(float(outIdx), float("+i+")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+a+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          "+l+"\n        }\n\n        int inIdx = inOffset + "+a+";\n        if ("+(1===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          "+l+"\n        } else if ("+(2===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          "+l+"\n        } else if ("+(3===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          "+l+"\n        }\n        setOutput(sumValue);\n      }\n    "},Pq=function(n,t,e){var r,o;if(this.variableNames=["c","a","b"],this.outputShape=t,e>4)throw Error("Where for rank "+e+" is not yet supported");if(1===e)o="resRC",r="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],a=[],u=0;u<t.length;u++)a.push(""+i[u]),u<n&&s.push(""+i[u]);r=s.join(),o=a.join()}var l=Mt(e);this.userCode="\n      void main() {\n        "+l+" resRC = getOutputCoords();\n        float cVal = getC("+r+");\n        if (cVal >= 1.0) {\n          setOutput(getA("+o+"));\n        } else {\n          setOutput(getB("+o+"));\n        }\n      }\n    "},Oq=function(){function n(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var e,r=Mt(this.rank),o="uniform int start["+this.rank+"];",i=function(s){if(1===s)return"sourceLoc";if(s<=6)return x_.slice(0,s).map(function(a){return"sourceLoc."+a}).join(",");throw Error("Slicing for rank "+s+" is not yet supported")}(this.rank);e="\n        "+r+" sourceLoc;\n        "+r+" coords = getOutputCoords();\n        "+t.map(function(s,a){return"sourceLoc."+x_[a]+" = start["+a+"] + coords."+x_[a]+";"}).join("\n")+"\n      ",this.userCode="\n      "+o+"\n      void main() {\n        "+e+"\n        setOutput(getSource("+i+"));\n      }\n    "}return n.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,o){null==e.startLoc&&(e.startLoc=r.getUniformLocationNoThrow(o,"start"),null==e.startLoc)||r.gl.uniform1iv(e.startLoc,t)}},n}(),x_=["x","y","z","w","u","v"],Lq=function(){function n(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var e=Mt(this.rank),r=Nr("coords",this.rank),o=Nr("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":"vec2("+o.slice(-2).join()+")",s="getChannel(getSource("+o.join()+"), "+i+")",a="\n      result.x = "+s+";\n      if (++"+r[this.rank-1]+" < "+t[this.rank-1]+") {\n        ++"+o[this.rank-1]+";\n        result.y = "+s+";\n        --"+o[this.rank-1]+";\n      }\n    ",u=1===this.rank?"":"\n      --"+r[this.rank-1]+";\n      if (++"+r[this.rank-2]+" < "+t[this.rank-2]+") {\n        ++"+o[this.rank-2]+";\n        result.z = "+s+";\n        if (++"+r[this.rank-1]+" < "+t[this.rank-1]+") {\n          ++"+o[this.rank-1]+";\n          result.w = "+s+";\n        }\n      }\n    ",l=this.rank<=4?"sourceLoc = coords +\n            "+e+"("+t.map(function(c,d){return"start["+d+"]"}).join()+");":t.map(function(c,d){return o[d]+" = "+r[d]+" + start["+d+"];"}).join("\n");this.userCode="\n      uniform int start["+this.rank+"];\n      void main() {\n        "+e+" coords = getOutputCoords();\n        "+e+" sourceLoc;\n        "+l+"\n        vec4 result = vec4(0.);\n        "+a+"\n        "+u+"\n        setOutput(result);\n      }\n    "}return n.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,o){null==e.startLoc&&(e.startLoc=r.getUniformLocationNoThrow(o,"start"),null==e.startLoc)||r.gl.uniform1iv(e.startLoc,t)}},n}(),Bq=function(n,t,e){this.variableNames=["x"],this.outputShape=e;var r=e.length,o=Mt(e.length),i=Mt(e.length),s="";if(1===r)s="coords * strides + begin";else{var a=0;s=e.map(function(u,l){return a++,1===e.length?"coords * strides["+l+"] + begin["+l+"]":"coords["+(a-1)+"] * strides["+l+"] + begin["+l+"]"}).join(",")}this.userCode="\n      "+o+" begin = "+o+"("+n+");\n      "+o+" strides = "+o+"("+t+");\n\n      void main() {\n        "+i+" coords = getOutputCoords();\n        setOutput(getX("+s+"));\n      }\n    "},Vq=function(){function n(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return n.prototype.acquireTexture=function(t,e,r){var o,i=qR(e,r),s=KR(t,i,r);if(s in this.freeTextures||(this.freeTextures[s]=[]),s in this.usedTextures||(this.usedTextures[s]=[]),this.freeTextures[s].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var a=this.freeTextures[s].shift();return this.usedTextures[s].push(a),a}return this.numUsedTextures++,this.log(),i===$r.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===$r.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===$r.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===$r.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===$r.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[s].push(o),o},n.prototype.releaseTexture=function(t,e,r,o){if(null!=this.freeTextures){var i=KR(e,qR(r,o),o);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(t),this.numFreeTextures++,this.numUsedTextures--;var s=this.usedTextures[i],a=s.indexOf(t);if(a<0)throw new Error("Cannot release a texture that was never provided by this texture manager");s.splice(a,1),this.log()}},n.prototype.log=function(){this.logEnabled&&console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+(this.numFreeTextures+this.numUsedTextures)+")")},n.prototype.getNumUsedTextures=function(){return this.numUsedTextures},n.prototype.getNumFreeTextures=function(){return this.numFreeTextures},n.prototype.dispose=function(){var t=this;if(null!=this.freeTextures){for(var e in this.freeTextures)this.freeTextures[e].forEach(function(r){t.gpgpu.deleteMatrixTexture(r)});for(var e in this.usedTextures)this.usedTextures[e].forEach(function(o){t.gpgpu.deleteMatrixTexture(o)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},n}();function qR(n,t){if(n===zr.UPLOAD)return $r.PACKED_2X2_FLOAT32;if(n===zr.RENDER||null==n)return e=t,$().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?$r.PACKED_2X2_FLOAT32:$r.UNPACKED_FLOAT32:e?$r.PACKED_2X2_FLOAT16:$r.UNPACKED_FLOAT16;var e;if(n===zr.DOWNLOAD||n===zr.PIXELS)return $r.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+n)}function KR(n,t,e){return n[0]+"_"+n[1]+"_"+t+"_"+e}var Uq=function(n,t){this.variableNames=["A"];for(var e=new Array(n.length),r=0;r<e.length;r++)e[r]=n[r]*t[r];this.outputShape=e,this.rank=e.length;var o=Mt(this.rank),i=function(s){var a=s.length;if(a>5)throw Error("Tile for rank "+a+" is not yet supported");if(1===a)return"imod(resRC, "+s[0]+")";for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],l=[],c=0;c<s.length;c++)l.push("imod("+u[c]+", "+s[c]+")");return l.join()}(n);this.userCode="\n      void main() {\n        "+o+" resRC = getOutputCoords();\n        setOutput(getA("+i+"));\n      }\n    "},jq=function(n,t){this.variableNames=["A"];for(var e=new Array(n.length),r=0;r<e.length;r++)e[r]=n[t[r]];this.outputShape=e,this.rank=e.length;var o=Mt(this.rank),i=function(s){var a=s.length;if(a>6)throw Error("Transpose for rank "+a+" is not yet supported");for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],l=new Array(a),c=0;c<s.length;c++)l[s[c]]=u[c];return l.join()}(t);this.userCode="\n    void main() {\n      "+o+" resRC = getOutputCoords();\n      setOutput(getA("+i+"));\n    }\n    "},Hq=function(n,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var e=new Array(n.length),r=0;r<e.length;r++)e[r]=n[t[r]];if(this.outputShape=e,this.rank=e.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var o=Mt(this.rank),i=mR("rc",this.rank),s=new Array(this.rank);for(r=0;r<t.length;r++)s[t[r]]=i[r];var a="vec2("+s.slice(-2).join()+")",u="++"+i[this.rank-1]+" < "+e[this.rank-1],l="getChannel(getA("+s.join()+"), "+a+")";this.userCode="\n    void main() {\n      "+o+" rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = "+l+";\n      if("+u+") {\n        result[1] = "+l+";\n      }\n      --"+i[this.rank-1]+";\n      if(++"+i[this.rank-2]+" < "+e[this.rank-2]+") {\n        result[2] = "+l+";\n        if("+u+") {\n          result[3] = "+l+";\n        }\n      }\n      setOutput(result);\n    }\n    "},$e=function(n,t){this.variableNames=["A"],this.outputShape=n,this.userCode="\n      float unaryOperation(float x) {\n        "+t+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},Vo="if (isnan(x)) return x;",XR="return abs(x);",YR=Vo+"\n  return (x < 0.0) ? 0.0 : x;\n",QR=Vo+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",ZR="return (x >= 0.0) ? x : (exp(x) - 1.0);",JR="return -x;",eN="return ceil(x);",tN="return floor(x);",nN="return exp(x);",rN="return exp(x) - 1.0;",Yg="return x;",oN="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",iN="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",sN="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",yf=function(n,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        "+t+"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},e7=function(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=n;var t=n.length,e=Nr("rc",t),r=Mt(t),o=function(a,u){if(1===a)return"rc";for(var l="",c=0;c<a;c++)l+=u[c],c<a-1&&(l+=",");return l}(t,e),i=e.slice(-2),s=t<=1?"rc":"vec2("+i.join(",")+")";this.userCode="\n      void main() {\n        "+r+" rc = getOutputCoords();\n        vec4 packedInput = getA("+o+");\n\n        setOutput(getChannel(packedInput, "+s+"));\n      }\n    "},Qg={};function Zg(n,t){if(void 0===t&&(t=!1),"linear"===n)return"return x;";if("relu"===n)return t?oN:YR;if("elu"===n)return t?sN:ZR;if("relu6"===n)return t?iN:QR;if("prelu"===n)return t?xR:_R;throw new Error("Activation "+n+" has not been implemented for the WebGL backend.")}var aN=function(n){function t(e){var r,o=n.call(this)||this;if(o.pendingRead=new WeakMap,o.pendingDisposal=new WeakSet,o.dataRefCount=new WeakMap,o.numBytesInGPU=0,o.uploadWaitMs=0,o.downloadWaitMs=0,o.warnedAboutMemory=!1,o.pendingDeletes=0,o.disposed=!1,!$().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==e){var i=ci($().getNumber("WEBGL_VERSION"));o.binaryCache=((r=$().getNumber("WEBGL_VERSION"))in Qg||(Qg[r]={}),Qg[r]),o.gpgpu=new zR(i),o.canvas=i.canvas,o.gpgpuCreatedLocally=!0}else o.gpgpu=e,o.binaryCache={},o.gpgpuCreatedLocally=!1,o.canvas=e.gl.canvas;return o.textureManager=new Vq(o.gpgpu),o.numMBBeforeWarning=null==$().global.screen?1024:$().global.screen.height*$().global.screen.width*window.devicePixelRatio*600/1024/1024,o.texData=new uR(o,N),o}return No(t,n),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(e,r,o){if($().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===o&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var i={};return this.texData.set(i,{shape:r,dtype:o,values:e,usage:zr.UPLOAD}),i},t.prototype.move=function(e,r,o,i){if($().getBool("DEBUG")&&this.checkNumericalProblems(r),"complex64"===i)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:o,dtype:i,values:r,usage:zr.UPLOAD})},t.prototype.readSync=function(e){var r=this.texData.get(e),o=r.values,i=r.dtype,s=r.complexTensors,u=r.shape;if(null!=r.slice){var c;c=r.isPacked?new yf(u,Yg):new $e(u,Yg);var d=this.runWebGLProgram(c,[{dataId:e,shape:u,dtype:i}],i),f=this.readSync(d.dataId);return this.disposeData(d.dataId),f}if(null!=o)return this.convertAndCacheOnCPU(e);if("string"===i)return o;var h,p,m=null!=this.activeTimers;return m&&(h=Po()),p="complex64"===i?f_(s.real.dataSync(),s.imag.dataSync()):this.getValuesFromTexture(e),m&&(this.downloadWaitMs+=Po()-h),this.convertAndCacheOnCPU(e,p)},t.prototype.read=function(e){return he(this,void 0,void 0,function(){var r,o,i,s,u,l,c,d,f,h,p,m,v,y,_,E,D,k,R;return pe(this,function(A){switch(A.label){case 0:if(this.pendingRead.has(e))return r=this.pendingRead.get(e),[2,new Promise(function(M){return r.push(M)})];if(o=this.texData.get(e),i=o.values,s=o.shape,u=o.dtype,l=o.complexTensors,c=o.isPacked,null!=o.slice)return d=c?new yf(s,Yg):new $e(s,Yg),f=this.runWebGLProgram(d,[{dataId:e,shape:s,dtype:u}],u),h=this.read(f.dataId),this.disposeData(f.dataId),[2,h];if(null!=i)return[2,this.convertAndCacheOnCPU(e)];if(!$().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===$().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return p=null,"complex64"!==u&&$().get("WEBGL_BUFFER_SUPPORTED")&&(m=this.decode(e),v=this.texData.get(m.dataId),p=(R=this.gpgpu).createBufferFromTexture.apply(R,[v.texture].concat(rf(s)))),this.pendingRead.set(e,[]),"complex64"===u?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:A.sent(),A.label=2;case 2:return"complex64"!==u?[3,4]:[4,Promise.all([l.real.data(),l.imag.data()])];case 3:return _=A.sent(),y=f_(_[0],_[1]),[3,5];case 4:null==p?y=this.getValuesFromTexture(e):(E=me(s),y=this.gpgpu.downloadFloat32MatrixFromBuffer(p,E)),A.label=5;case 5:return null!=m&&this.disposeData(m.dataId),D=this.convertAndCacheOnCPU(e,y),k=this.pendingRead.get(e),this.pendingRead.delete(e),k.forEach(function(M){return M(D)}),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e),this.pendingDeletes--),[2,D]}})})},t.prototype.checkNumericalProblems=function(e){if(null!=e)for(var r=0;r<e.length;r++){var o=e[r];if(!_k(o))throw $().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+o+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+o+" cannot be represented on this device.")}},t.prototype.getValuesFromTexture=function(e){var r,o=this.texData.get(e),i=o.shape,s=o.dtype,a=o.isPacked,u=me(i);if($().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var l=this.decode(e),c=this.texData.get(l.dataId),d=(r=this.gpgpu).downloadMatrixFromPackedTexture.apply(r,[c.texture].concat(rf(i))).subarray(0,u);return this.disposeData(l.dataId),d}var f=$().getBool("WEBGL_PACK")&&!0===a,h=f?Ng(i):i,p=f?new iq(h):new oq(h),m=this.runWebGLProgram(p,[{shape:h,dtype:s,dataId:e}],"float32"),v=this.texData.get(m.dataId),y=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(v.texture,v.texShape[0],v.texShape[1]).subarray(0,u);return this.disposeData(m.dataId),y},t.prototype.time=function(e){return he(this,void 0,void 0,function(){var r,o,i,s,a,u,l;return pe(this,function(c){switch(c.label){case 0:return r=this.activeTimers,o=[],i=!1,null==this.programTimersStack?(this.programTimersStack=o,i=!0):this.activeTimers.push(o),this.activeTimers=o,e(),s=ts(this.activeTimers.map(function(d){return d.query})).filter(function(d){return null!=d}),a=ts(this.activeTimers.map(function(d){return d.name})).filter(function(d){return null!=d}),this.activeTimers=r,i&&(this.programTimersStack=null),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},$().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(s)]:[3,2];case 1:return l=c.sent(),u.kernelMs=nk(l),u.getExtraProfileInfo=function(){return l.map(function(d,f){return{name:a[f],ms:d}}).map(function(d){return d.name+": "+d.ms}).join(", ")},[3,3];case 2:u.kernelMs={error:"WebGL query timers are not supported in this environment."},c.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,u]}})})},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return $().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Po(),endMs:null}},t.prototype.endTimer=function(e){return $().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Po(),e)},t.prototype.getQueryTime=function(e){return he(this,void 0,void 0,function(){var r;return pe(this,function(o){return $().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(e)]:[2,(r=e).endMs-r.startMs]})})},t.prototype.disposeData=function(e){if(!this.pendingDisposal.has(e)){if(this.pendingRead.has(e))return this.pendingDisposal.add(e),void this.pendingDeletes++;if(this.texData.has(e)){this.releaseGPUData(e);var r=this.texData.get(e).complexTensors;null!=r&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(e)}}},t.prototype.releaseGPUData=function(e){var r=this.texData.get(e),o=r.texture,i=r.dtype,s=r.texShape,a=r.usage,u=r.isPacked,l=r.slice,c=l&&l.origDataId||e,d=this.dataRefCount.get(c);d>1?this.dataRefCount.set(c,d-1):(this.dataRefCount.delete(c),null!=o&&(this.numBytesInGPU-=this.computeBytes(s,i),this.textureManager.releaseTexture(o,s,a,u)));var f=this.texData.get(e);f.texture=null,f.texShape=null,f.isPacked=!1,f.slice=null},t.prototype.getTexture=function(e){return this.uploadToGPU(e),this.texData.get(e).texture},t.prototype.getDataInfo=function(e){return this.texData.get(e)},t.prototype.getCPUBackend=function(){return $().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=N.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(e,r){var o=this;return void 0===r&&(r=128),null!=this.getCPUBackend()&&e.every(function(i){return null==o.texData.get(i.dataId).texture&&i.size<r})},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(e,r){var o=this.makeOutput(e.shape,"complex64");return this.texData.get(o.dataId).complexTensors={real:N.keep(e.clone()),imag:N.keep(r.clone())},o},t.prototype.real=function(e){return this.texData.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.texData.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,r,o){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.slice(e,r,o);if(0===me(o))return Wn([],o,e.dtype);var i=this.texData.get(e.dataId).isPacked,s=s_(e.shape,r,o);if(i||!s){var a=$().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Lq(o):new Oq(o),u=a.getCustomSetupFunc(r);return this.compileAndRun(a,[e],null,u)}return this.uploadToGPU(e.dataId),this.shallowSlice(e,r,o)},t.prototype.shallowSlice=function(e,r,o){var i=this.texData.get(e.dataId),s=this.makeOutput(o,e.dtype),a=this.texData.get(s.dataId);Object.assign(a,i),a.shape=o,a.dtype=e.dtype;var u=a_(r,e.strides);i.slice&&(u+=i.slice.flatOffset),a.slice={flatOffset:u,origDataId:i.slice&&i.slice.origDataId||e.dataId};var l=this.dataRefCount.get(a.slice.origDataId)||1;return this.dataRefCount.set(a.slice.origDataId,l+1),s},t.prototype.stridedSlice=function(e,r,o,i){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.stridedSlice(e,r,o,i);var s=Wg(r,o,i);if(s.some(function(u){return 0===u}))return Wn([],s);var a=new Bq(r,i,s);return this.compileAndRun(a,[e])},t.prototype.reverse=function(e,r){var o=$().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Nq(e.shape,r):new Rq(e.shape,r);return this.compileAndRun(o,[e])},t.prototype.concat=function(e,r){if("complex64"===e[0].dtype){var o=e.map(function(h){return fo(h)}),i=e.map(function(h){return fi(h)});return Hn(this.concat(o,r),this.concat(i,r))}if(this.shouldExecuteOnCPU(e))return this.cpuBackend.concat(e,r);if(1===e.length)return e[0];if(e.length>$().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var s=Math.floor(e.length/2),a=this.concat(e.slice(0,s),r),u=this.concat(e.slice(s),r);return this.concat([a,u],r)}if($().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].rank>1){var l=new z8(e.map(function(h){return h.shape}),r);return this.compileAndRun(l,e)}var c=Xa(e.map(function(h){return h.shape}),r),d=e.map(function(h){return h.as2D(-1,me(h.shape.slice(r)))}),f=new W8(d.map(function(h){return h.shape}));return this.compileAndRun(f,d).reshape(c)},t.prototype.neg=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.neg(e);if($().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,JR,e.dtype);var r=new $e(e.shape,JR);return this.compileAndRun(r,[e])},t.prototype.batchMatMul=function(e,r,o,i){var s=o?e.shape[2]:e.shape[1],a=i?r.shape[1]:r.shape[2],u=o?e.shape[1]:e.shape[2],l=e.shape[0];if((1===s||1===a)&&u>1e3){o&&(e=e.transpose([0,2,1])),i&&(r=r.transpose([0,2,1]));var c=1===a?e:e.as3D(l,u,1),d=1===a?2:1,f=1===a?r.as3D(l,1,u):r;return this.multiply(c,f).sum(d,!0)}var h=kn(e.dtype,r.dtype),p=new w_(e.shape,[l,s,a],o,i);return this.compileAndRun(p,[e,r],h)},t.prototype.fusedBatchMatMul=function(e){var r=e.a,o=e.b,i=e.transposeA,s=e.transposeB,a=e.bias,u=e.activation,l=e.preluActivationWeights,c=i?r.shape[2]:r.shape[1],d=s?o.shape[1]:o.shape[2],f=r.shape[0],h=kn(r.dtype,o.dtype),p=null!=a,m=null!=l,v=u?Zg(u,!0):null,y=new w_(r.shape,[f,c,d],i,s,p,v,m),_=[r,o];return a&&_.push(a),l&&_.push(l),this.compileAndRun(y,_,h)},t.prototype.multiply=function(e,r){if("complex64"===e.dtype){var o=this.texData.get(e.dataId),i=this.texData.get(r.dataId),s=new wR("return areal * breal - aimag * bimag;",e.shape,r.shape),a=new wR("return areal * bimag + aimag * breal;",e.shape,r.shape),u=[this.makeComplexComponentTensorInfo(e,o.complexTensors.real),this.makeComplexComponentTensorInfo(e,o.complexTensors.imag),this.makeComplexComponentTensorInfo(r,i.complexTensors.real),this.makeComplexComponentTensorInfo(r,i.complexTensors.imag)],l=this.compileAndRun(s,u),c=this.compileAndRun(a,u),d=this.complex(l,c);return l.dispose(),c.dispose(),d}if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.multiply(e,r);if($().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,bR,e.dtype);var f=new Zt(bR,e.shape,r.shape);return this.compileAndRun(f,[e,r],e.dtype)},t.prototype.batchNormalization=function(e,r,o,i,s,a){var u=[e,r,o],l=null;null!=a&&(l=a.shape,u.push(a));var c=null;if(null!=s&&(c=s.shape,u.push(s)),$().getBool("WEBGL_PACK_NORMALIZATION")){var d=new L8(e.shape,r.shape,o.shape,l,c,i);return this.compileAndRun(d,u)}var f=new O8(e.shape,r.shape,o.shape,l,c,i);return this.compileAndRun(f,u)},t.prototype.localResponseNormalization4D=function(e,r,o,i,s){var a=$().getBool("WEBGL_PACK_NORMALIZATION")?new vq(e.shape,r,o,i,s):new gq(e.shape,r,o,i,s);return this.compileAndRun(a,[e])},t.prototype.LRNGrad=function(e,r,o,i,s,a,u){var l=new mq(r.shape,i,s,a,u);return this.compileAndRun(l,[r,o,e])},t.prototype.tile=function(e,r){if("string"===e.dtype){var o=this.readSync(e.dataId).map(function(s){return Qd(s)});return pR(Ue(e.shape,e.dtype,o),r)}var i=new Uq(e.shape,r);return this.compileAndRun(i,[e])},t.prototype.pad=function(e,r,o){var i=$().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Eq(e.shape,r,o):new Cq(e.shape,r,o);return this.compileAndRun(i,[e])},t.prototype.transpose=function(e,r){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.transpose(e,r);var o=$().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Hq(e.shape,r):new jq(e.shape,r);return this.compileAndRun(o,[e])},t.prototype.gather=function(e,r,o){if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.gather(e,r,o);var i=new dq(e.shape,r.size,o);return this.compileAndRun(i,[e,r])},t.prototype.batchToSpaceND=function(e,r,o){I(e.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(d,f){return d*f}),s=Vg(e.shape,r,i),a=Ug(s.length,r.length),u=jg(e.shape,r,i),l=tR(o,r.length),c=nR(u,o,r.length);return e.reshape(s).transpose(a).reshape(u).slice(l,c)},t.prototype.spaceToBatchND=function(e,r,o){I(e.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(f,h){return f*h}),s=[[0,0]];s.push.apply(s,o);for(var a=1+r.length;a<e.shape.length;++a)s.push([0,0]);var u=e.pad(s),l=Vg(u.shape,r,i,!1),c=Ug(l.length,r.length,!1),d=jg(u.shape,r,i,!1);return u.reshape(l).transpose(c).reshape(d)},t.prototype.reduce=function(e,r,o){var i=e.shape[0],s=e.shape[1],a=Hg(s),u=new Dq({windowSize:a,inSize:s,batchSize:i},r),l=this.compileAndRun(u,[e],o);return 1===l.shape[1]?l:this.reduce(l,r,o)},t.prototype.argReduce=function(e,r,o){void 0===o&&(o=null);var i=e.shape[0],s=e.shape[1];null!=o&&(i=o.shape[0],s=o.shape[1]);var a=Hg(s),u=new I8({windowSize:a,inSize:s,batchSize:i},r,null==o),l=[e];null!=o&&l.push(o);var c=this.compileAndRun(u,l,"int32");return 1===c.shape[1]?c:this.argReduce(e,r,c)},t.prototype.argReducePacked=function(e,r,o){void 0===o&&(o=null);var i=null!=o?o.shape:e.shape,s=Hg(i[i.length-1]),a=new N8(i,s,r,null==o),l=this.compileAndRun(a,null==o?[e]:[e,o],"int32");return l.rank===e.rank?this.argReducePacked(e,r,l):l},t.prototype.sum=function(e,r){kr("sum",r,e.rank);var o=jn(e.shape,r),i=o[0],s=me(o[1]),a=e.as2D(-1,s),u=W0(e.dtype);return this.reduce(a,"sum",u).reshape(i)},t.prototype.prod=function(e,r){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.prod(e,r);var o=jn(e.shape,r),i=o[0],s=me(o[1]),a=e.as2D(-1,s),u=W0(e.dtype);return this.reduce(a,"prod",u).reshape(i)},t.prototype.unsortedSegmentSum=function(e,r,o){var i=0,s=Oo([i],e.rank),a=e;null!=s&&(a=e.transpose(s),i=Lo(1,e.rank)[0]);var u=function(h,p,m){for(var v=[],y=h.length,_=0;_<y;_++)v.push(_!==p?h[_]:m);return v}(a.shape,i,o),l=me([a.shape[i]]),c=a.as2D(-1,l),d=W0(e.dtype),f=this.segOpCompute(c,"unsortedSegmentSum",r,d,o).reshape(u);return null!=s&&(f=f.transpose(Og(s))),f},t.prototype.segOpCompute=function(e,r,o,i,s){var a=e.shape[0],u=e.shape[1],l=function(f,h){var p,m=!1;for(f<=30?(p=f,m=!0):p=Ig(f,Math.floor(Math.sqrt(f)));!m;)p>h||p===f?m=!0:p=Ig(f,p+1);return p}(u,s),c=new Fq({windowSize:l,inSize:u,batchSize:a,numSegments:s},r),d=this.compileAndRun(c,[e,o],i);return d.shape[1]===s?d:(o=Lg(0,s).tile([u/l]),this.segOpCompute(d,r,o,i,s))},t.prototype.argMinMaxReduce=function(e,r,o){var i=[r];if(kr("arg"+o.charAt(0).toUpperCase()+o.slice(1),i,e.rank),!$().getBool("WEBGL_PACK_REDUCE")||e.rank<=2){var s=jn(e.shape,i),a=s[0],u=me(s[1]),l=e.as2D(-1,u);return this.argReduce(l,o).reshape(a)}return this.argReducePacked(e,o)},t.prototype.argMin=function(e,r){return this.argMinMaxReduce(e,r,"min")},t.prototype.argMax=function(e,r){return this.argMinMaxReduce(e,r,"max")},t.prototype.cumsum=function(e,r,o,i){if(r!==e.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(e.rank-1)+" but got axis="+r);var s=new J8(e.shape,o,i);return this.compileAndRun(s,[e])},t.prototype.equal=function(e,r){if($().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,"\n  return vec4(equal(a, b));\n","bool");var o=new Zt("return float(a == b);",e.shape,r.shape);return this.compileAndRun(o,[e,r],"bool")},t.prototype.notEqual=function(e,r){if($().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,"\n  return vec4(notEqual(a, b));\n","bool");var o=new Zt("return float(a != b);",e.shape,r.shape);return this.compileAndRun(o,[e,r],"bool")},t.prototype.less=function(e,r){if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.less(e,r);if($().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,"\n  return vec4(lessThan(a, b));\n","bool");var o=new Zt("return float(a < b);",e.shape,r.shape);return this.compileAndRun(o,[e,r],"bool")},t.prototype.lessEqual=function(e,r){if($().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,"\n  return vec4(lessThanEqual(a, b));\n","bool");var o=new Zt("return float(a <= b);",e.shape,r.shape);return this.compileAndRun(o,[e,r],"bool")},t.prototype.greater=function(e,r){if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.greater(e,r);if($().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,"\n  return vec4(greaterThan(a, b));\n","bool");var o=new Zt("return float(a > b);",e.shape,r.shape);return this.compileAndRun(o,[e,r],"bool")},t.prototype.greaterEqual=function(e,r){if($().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,"\n  return vec4(greaterThanEqual(a, b));\n","bool");var o=new Zt("return float(a >= b);",e.shape,r.shape);return this.compileAndRun(o,[e,r],"bool")},t.prototype.logicalNot=function(e){var r=new $e(e.shape,"return float(!(x >= 1.0));");return this.compileAndRun(r,[e])},t.prototype.logicalAnd=function(e,r){if($().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");var o=new Zt("return float(a >= 1.0 && b >= 1.0);",e.shape,r.shape);return this.compileAndRun(o,[e,r],"bool")},t.prototype.logicalOr=function(e,r){if($().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");var o=new Zt("return float(a >= 1.0 || b >= 1.0);",e.shape,r.shape);return this.compileAndRun(o,[e,r],"bool")},t.prototype.select=function(e,r,o){var i=new Pq(e.rank,r.shape,r.rank);return this.compileAndRun(i,[e,r,o],kn(r.dtype,o.dtype))},t.prototype.where=function(e){Pg("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var r=e.dataSync();return g_(e.shape,r)},t.prototype.topk=function(e,r,o){return gR(e.dataSync(),e.shape,e.dtype,r)},t.prototype.min=function(e,r){kr("min",r,e.rank);var o=jn(e.shape,r),i=o[0],s=me(o[1]),a=e.as2D(-1,s);return this.reduce(a,"min",a.dtype).reshape(i)},t.prototype.minimum=function(e,r){if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.minimum(e,r);var o=$().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ss("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,r.shape):new Zt("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",e.shape,r.shape);return this.compileAndRun(o,[e,r])},t.prototype.mod=function(e,r){var o=$().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ss("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,r.shape):new Zt("if (b == 0.0) return NAN;\n  return mod(a, b);",e.shape,r.shape);return this.compileAndRun(o,[e,r])},t.prototype.max=function(e,r){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.max(e,r);kr("max",r,e.rank);var o=jn(e.shape,r),i=o[0],s=me(o[1]),a=e.as2D(-1,s);return this.reduce(a,"max",a.dtype).reshape(i)},t.prototype.maximum=function(e,r){if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.maximum(e,r);var o=$().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ss("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,r.shape):new Zt("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",e.shape,r.shape);return this.compileAndRun(o,[e,r])},t.prototype.all=function(e,r){kr("all",r,e.rank);var o=jn(e.shape,r),i=o[0],s=me(o[1]),a=e.as2D(-1,s);return this.reduce(a,"all",a.dtype).reshape(i)},t.prototype.any=function(e,r){kr("any",r,e.rank);var o=jn(e.shape,r),i=o[0],s=me(o[1]),a=e.as2D(-1,s);return this.reduce(a,"any",a.dtype).reshape(i)},t.prototype.realDivide=function(e,r){if($().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n","float32",!0);var o=new Zt("\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",e.shape,r.shape);return this.compileAndRun(o,[e,r],"float32")},t.prototype.floorDiv=function(e,r){if($().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n","int32");var o=new Zt("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",e.shape,r.shape);return this.compileAndRun(o,[e,r],"int32")},t.prototype.add=function(e,r){if("complex64"===e.dtype&&"complex64"===r.dtype)return this.complexSeparableBinaryOp(e,r,v_);if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.add(e,r);var o=kn(e.dtype,r.dtype);if($().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,v_,o);var i=new Zt(v_,e.shape,r.shape);return this.compileAndRun(i,[e,r],o)},t.prototype.packedUnaryOp=function(e,r,o){var i=new yf(e.shape,r);return this.compileAndRun(i,[e],o)},t.prototype.packedBinaryOp=function(e,r,o,i,s){void 0===s&&(s=!1);var a=new ss(o,e.shape,r.shape,s);return this.compileAndRun(a,[e,r],i)},t.prototype.complexSeparableBinaryOp=function(e,r,o){var i=this,s=this.texData.get(e.dataId),a=this.texData.get(r.dataId),u=[[s.complexTensors.real,a.complexTensors.real],[s.complexTensors.imag,a.complexTensors.imag]].map(function(f){var h=f[0],p=f[1],m=i.makeComplexComponentTensorInfo(e,h),v=i.makeComplexComponentTensorInfo(r,p),y=new Zt(o,e.shape,r.shape);return i.compileAndRun(y,[m,v],kn(h.dtype,p.dtype))}),l=u[0],c=u[1],d=this.complex(l,c);return l.dispose(),c.dispose(),d},t.prototype.makeComplexComponentTensorInfo=function(e,r){return{dataId:r.dataId,dtype:r.dtype,shape:e.shape}},t.prototype.addN=function(e){if(1===e.length)return e[0];if(e.length>$().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var r=Math.floor(e.length/2),o=this.addN(e.slice(0,r)),i=this.addN(e.slice(r));return this.addN([o,i])}var s=e.map(function(l){return l.dtype}).reduce(function(l,c){return kn(l,c)}),a=e.map(function(l){return l.shape}),u=$().getBool("WEBGL_PACK")?new S8(e[0].shape,a):new D8(e[0].shape,a);return this.compileAndRun(u,e,s)},t.prototype.subtract=function(e,r){if("complex64"===e.dtype&&"complex64"===r.dtype)return this.complexSeparableBinaryOp(e,r,y_);if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.subtract(e,r);var o=kn(e.dtype,r.dtype);if($().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,y_,e.dtype);var i=new Zt(y_,e.shape,r.shape);return this.compileAndRun(i,[e,r],o)},t.prototype.pow=function(e,r){var o=$().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ss("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,r.shape):new Zt("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nif (b == 0.0) {\n  return 1.0;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",e.shape,r.shape),i=kn(e.dtype,r.dtype);return this.compileAndRun(o,[e,r],i)},t.prototype.ceil=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.ceil(e);if($().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,eN,e.dtype);var r=new $e(e.shape,eN);return this.compileAndRun(r,[e])},t.prototype.floor=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.floor(e);if($().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,tN,e.dtype);var r=new $e(e.shape,tN);return this.compileAndRun(r,[e])},t.prototype.sign=function(e){var r=new $e(e.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(r,[e])},t.prototype.isNaN=function(e){var r=new $e(e.shape,"return float(isnan(x));");return this.compileAndRun(r,[e],"bool")},t.prototype.isInf=function(e){var r=new $e(e.shape,"return float(isinf(x));");return this.compileAndRun(r,[e],"bool")},t.prototype.isFinite=function(e){var r=new $e(e.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(r,[e],"bool")},t.prototype.round=function(e){var r=new $e(e.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(r,[e])},t.prototype.exp=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.exp(e);if($().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,nN,e.dtype);var r=new $e(e.shape,nN);return this.compileAndRun(r,[e])},t.prototype.expm1=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.expm1(e);if($().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,rN,e.dtype);var r=new $e(e.shape,rN);return this.compileAndRun(r,[e])},t.prototype.softmax=function(e,r){var o=gn([r],e.shape),i=this.max(e,o),s=br(i.shape,o),a=this.subtract(e,i.reshape(s)),u=this.exp(a),l=this.sum(u,o).reshape(s);return this.realDivide(u,l)},t.prototype.log=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.log(e);if($().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",e.dtype);var r=new $e(e.shape,"if (x < 0.0) return NAN;\n  return log(x);");return this.compileAndRun(r,[e])},t.prototype.log1p=function(e){var r=new $e(e.shape,"return log(1.0 + x);");return this.compileAndRun(r,[e])},t.prototype.sqrt=function(e){var r=new $e(e.shape,"return sqrt(x);");return this.compileAndRun(r,[e])},t.prototype.rsqrt=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.rsqrt(e);var r=new $e(e.shape,"return inversesqrt(x);");return this.compileAndRun(r,[e])},t.prototype.reciprocal=function(e){var r=new $e(e.shape,"return 1.0 / x;");return this.compileAndRun(r,[e])},t.prototype.relu=function(e){var r;return r=$().getBool("WEBGL_PACK")?new yf(e.shape,oN):new $e(e.shape,YR),this.compileAndRun(r,[e])},t.prototype.relu6=function(e){var r;return r=$().getBool("WEBGL_PACK")?new yf(e.shape,iN):new $e(e.shape,QR),this.compileAndRun(r,[e])},t.prototype.prelu=function(e,r){var o=$().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ss(xR,e.shape,r.shape):new Zt(_R,e.shape,r.shape);return this.compileAndRun(o,[e,r])},t.prototype.elu=function(e){if($().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,sN,e.dtype);var r=new $e(e.shape,ZR);return this.compileAndRun(r,[e])},t.prototype.eluDer=function(e,r){var o=$().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ss("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",e.shape,r.shape):new Zt("return (b >= 1.0) ? a : a * (b + 1.0);",e.shape,r.shape);return this.compileAndRun(o,[e,r])},t.prototype.selu=function(e){var r=new $e(e.shape,"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = 1.7580993408473768;\n  float scale = 1.0507009873554805;\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n");return this.compileAndRun(r,[e])},t.prototype.int=function(e){var r=new $e(e.shape,"return float(int(x));");return this.compileAndRun(r,[e],"int32")},t.prototype.clip=function(e,r,o){var i,s=(i=$().getBool("WEBGL_PACK_CLIP")?new j8(e.shape):new U8(e.shape)).getCustomSetupFunc(r,o);return this.compileAndRun(i,[e],null,s)},t.prototype.abs=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.abs(e);if($().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,XR,e.dtype);var r=new $e(e.shape,XR);return this.compileAndRun(r,[e])},t.prototype.complexAbs=function(e){var r=this.texData.get(e.dataId),o=new H8(e.shape),i=[this.makeComplexComponentTensorInfo(e,r.complexTensors.real),this.makeComplexComponentTensorInfo(e,r.complexTensors.imag)];return this.compileAndRun(o,i)},t.prototype.sigmoid=function(e){var r=new $e(e.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(r,[e])},t.prototype.softplus=function(e){var r=new $e(e.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(r,[e])},t.prototype.sin=function(e){var r=new $e(e.shape,"if (isnan(x)) return x;\n  return sin(x);\n");return this.compileAndRun(r,[e])},t.prototype.cos=function(e){var r=new $e(e.shape,"if (isnan(x)) return x;\n  return cos(x);\n");return this.compileAndRun(r,[e])},t.prototype.tan=function(e){var r=new $e(e.shape,"return tan(x);");return this.compileAndRun(r,[e])},t.prototype.asin=function(e){var r=new $e(e.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n");return this.compileAndRun(r,[e])},t.prototype.acos=function(e){var r=new $e(e.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n");return this.compileAndRun(r,[e])},t.prototype.atan=function(e){var r=new $e(e.shape,"if (isnan(x)) return x;\n  return atan(x);\n");return this.compileAndRun(r,[e])},t.prototype.atan2=function(e,r){var o=$().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ss("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,r.shape):new Zt("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",e.shape,r.shape);return this.compileAndRun(o,[e,r])},t.prototype.sinh=function(e){var r=new $e(e.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(r,[e])},t.prototype.cosh=function(e){var r=new $e(e.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(r,[e])},t.prototype.tanh=function(e){var r=new $e(e.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(r,[e])},t.prototype.asinh=function(e){var r=new $e(e.shape,"if (isnan(x)) return x;return log(x + sqrt(x * x + 1.0));");return this.compileAndRun(r,[e])},t.prototype.acosh=function(e){var r=new $e(e.shape,"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));");return this.compileAndRun(r,[e])},t.prototype.atanh=function(e){var r=new $e(e.shape,"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;");return this.compileAndRun(r,[e])},t.prototype.erf=function(e){var r=new $e(e.shape,'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = 0.3275911;\n  float a1 = 0.254829592;\n  float a2 = -0.284496736;\n  float a3 = 1.421413741;\n  float a4 = -1.453152027;\n  float a5 = 1.061405429;\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n');return this.compileAndRun(r,[e])},t.prototype.step=function(e,r){var i,o=new $e(e.shape,(void 0===(i=r)&&(i=0),Vo+"\n    return x > 0.0 ? 1.0 : float("+i+");\n  "));return this.compileAndRun(o,[e])},t.prototype.conv2dByMatMul=function(e,r,o,i,s,a){var u=e.shape,l=this.texData.get(e.dataId),h="channelsLast"===o.dataFormat,m=u[2]%2!=0&&!!l.isPacked;if((1==u[0]*u[1]*u[2]||1===o.outChannels)&&o.inChannels>1e3||!$().getBool("WEBGL_LAZILY_UNPACK")||!$().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!m){var y=this.reshape(e,[1,h?u[0]*u[1]*u[2]:u[0]*u[2]*u[3],o.inChannels]),_=this.reshape(r,[1,o.inChannels,o.outChannels]);return this.reshape(this.fusedBatchMatMul({a:y,b:_,transposeA:!1,transposeB:!1,bias:i,activation:s,preluActivationWeights:a}),o.outShape)}var x={dataId:e.dataId,shape:[1,h?u[0]*u[1]*(u[2]+1):u[0]*u[2]*(u[3]+1),o.inChannels],dtype:e.dtype},E=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,I(df(l.shape,x.shape),function(){return"packed reshape "+l.shape+" to "+x.shape+" isn't free"});var D=this.reshape(r,[1,o.inChannels,o.outChannels]),k=this.fusedBatchMatMul({a:x,b:D,transposeA:!1,transposeB:!1,bias:i,activation:s,preluActivationWeights:a}),R=this.texData.get(k.dataId);return I(R.isPacked,function(){return"batchMatMul result is expected to be packed"}),l.shape=E,R.shape=o.outShape,N.makeTensorFromDataId(k.dataId,o.outShape,k.dtype)},t.prototype.conv2dWithIm2Row=function(e,r,o,i,s,a){var d=o.outWidth,f=o.outHeight,h="channelsLast"===o.dataFormat,p=o.filterWidth*o.filterHeight*o.inChannels,m=f*d,v=[p,m],y=e.squeeze([0]),_=r.reshape([1,p,-1]),b=new pq(v,y.shape,o),x=this.compileAndRun(b,[y]).reshape([1,v[0],v[1]]),E=null!=i,D=null!=a,k=s?Zg(s,!0):null,R=new w_(x.shape,[1,m,o.outChannels],!0,!1,E,k,D),A=[x,_];return i&&A.push(i),D&&A.push(a),this.compileAndRun(R,A).reshape(h?[1,f,d,o.outChannels]:[1,o.outChannels,f,d])},t.prototype.fusedConv2d=function(e){var r=e.input,o=e.filter,i=e.convInfo,s=e.bias,a=e.activation,u=e.preluActivationWeights;if(1===i.filterHeight&&1===i.filterWidth&&1===i.dilationHeight&&1===i.dilationWidth&&1===i.strideHeight&&1===i.strideWidth&&("SAME"===i.padInfo.type||"VALID"===i.padInfo.type))return this.conv2dByMatMul(r,o,i,s,a,u);if($().getBool("WEBGL_CONV_IM2COL")&&1===r.shape[0])return this.conv2dWithIm2Row(r,o,i,s,a,u);var l=null!=s,c=null!=u,d=a?Zg(a,!1):null,f=new CR(i,l,d,c),h=[r,o];return s&&h.push(s),u&&h.push(u),this.compileAndRun(f,h)},t.prototype.conv2d=function(e,r,o){if(1===o.filterHeight&&1===o.filterWidth&&1===o.dilationHeight&&1===o.dilationWidth&&1===o.strideHeight&&1===o.strideWidth&&("SAME"===o.padInfo.type||"VALID"===o.padInfo.type))return this.conv2dByMatMul(e,r,o);if($().getBool("WEBGL_CONV_IM2COL")&&1===e.shape[0])return this.conv2dWithIm2Row(e,r,o);var i=new CR(o);return this.compileAndRun(i,[e,r])},t.prototype.conv2dDerInput=function(e,r,o){var i=new G8(o);return this.compileAndRun(i,[e,r])},t.prototype.conv2dDerFilter=function(e,r,o){var i=new $8(o);return this.compileAndRun(i,[e,r])},t.prototype.fusedDepthwiseConv2D=function(e){var r,o=e.input,i=e.filter,s=e.convInfo,a=e.bias,u=e.activation,l=e.preluActivationWeights,c=$().getBool("WEBGL_PACK_DEPTHWISECONV")&&s.strideWidth<=2&&s.outChannels/s.inChannels==1,d=u?Zg(u,c):null,f=[o,i],h=null!=a,p=null!=l;return h&&f.push(a),p&&f.push(l),c?(r=new DR(s,h,d,p),this.compileAndRun(r,f)):(r=new ER(s,h,d,p),this.compileAndRun(r,f))},t.prototype.depthwiseConv2D=function(e,r,o){var i;return $().getBool("WEBGL_PACK_DEPTHWISECONV")&&o.strideWidth<=2&&o.outChannels/o.inChannels==1?(i=new DR(o),this.compileAndRun(i,[e,r])):(i=new ER(o),this.compileAndRun(i,[e,r]))},t.prototype.depthwiseConv2DDerInput=function(e,r,o){var i=new Y8(o);return this.compileAndRun(i,[e,r])},t.prototype.depthwiseConv2DDerFilter=function(e,r,o){var i=new X8(o);return this.compileAndRun(i,[e,r])},t.prototype.conv3d=function(e,r,o){var i=new Q8(o);return this.compileAndRun(i,[e,r])},t.prototype.conv3dDerInput=function(e,r,o){var i=new K8(o);return this.compileAndRun(i,[e,r])},t.prototype.conv3dDerFilter=function(e,r,o){var i=new q8(o);return this.compileAndRun(i,[e,r])},t.prototype.maxPool=function(e,r){var o=new b_(r,"max",!1);return this.compileAndRun(o,[e])},t.prototype.avgPool=function(e,r){var o=new b_(r,"avg",!1);return this.compileAndRun(o,[e],"float32")},t.prototype.maxPoolBackprop=function(e,r,o,i){var s=new b_(i,"max",!0),a=this.compileAndRun(s,[r]),u=new yq(i),l=this.compileAndRun(u,[e,a],r.dtype);return a.dispose(),l},t.prototype.avgPoolBackprop=function(e,r,o){var i=new F8(o);return this.compileAndRun(i,[e],r.dtype)},t.prototype.cast=function(e,r){return c_(e,r,this)},t.prototype.unstack=function(e,r){for(var o=e.shape[r],i=new Array(e.rank-1),s=0,a=0;a<e.rank;a++)a!==r&&(i[s++]=e.shape[a]);var u=new Array(e.rank).fill(0),l=e.shape.slice();l[r]=1;var c=new Array(o);for(a=0;a<c.length;a++)u[r]=a,c[a]=this.slice(e,u,l).reshape(i);return c},t.prototype.avgPool3d=function(e,r){var o=new __(r,"avg",!1);return this.compileAndRun(o,[e],"float32")},t.prototype.avgPool3dBackprop=function(e,r,o){var i=new P8(o);return this.compileAndRun(i,[e],r.dtype)},t.prototype.maxPool3d=function(e,r){var o=new __(r,"max",!1);return this.compileAndRun(o,[e],"float32")},t.prototype.maxPool3dBackprop=function(e,r,o,i){var s=new __(i,"max",!0),a=this.compileAndRun(s,[r]),u=new wq(i),l=this.compileAndRun(u,[e,a],r.dtype);return a.dispose(),l},t.prototype.reshape=function(e,r){var o=this.texData.get(e.dataId);if(o.isPacked&&!df(e.shape,r)&&(null===o.texture||!df(o.shape,r))){var i=this.packedReshape(e,r);return N.makeTensorFromDataId(i.dataId,i.shape,i.dtype)}return Kg(e,r)},t.prototype.resizeBilinear=function(e,r,o,i){var s=$().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Tq(e.shape,r,o,i):new Aq(e.shape,r,o,i);return this.compileAndRun(s,[e],"float32")},t.prototype.resizeBilinearBackprop=function(e,r,o){var i=new Iq(e,r,o);return this.compileAndRun(i,[e])},t.prototype.resizeNearestNeighbor=function(e,r,o,i){var s=new kq(e.shape,r,o,i);return this.compileAndRun(s,[e])},t.prototype.resizeNearestNeighborBackprop=function(e,r,o){var i=new Mq(e,r,o);return this.compileAndRun(i,[e])},t.prototype.multinomial=function(e,r,o,i){var s=r?e:os(e),l=new bq(s.shape[0],s.shape[1],o),c=l.getCustomSetupFunc(i);return this.compileAndRun(l,[s],"int32",c)},t.prototype.oneHot=function(e,r,o,i){var s=new _q(e.size,r,o,i);return this.compileAndRun(s,[e])},t.prototype.diag=function(e){var r=new rq(e.size);return this.compileAndRun(r,[e])},t.prototype.nonMaxSuppression=function(e,r,o,i,s){return Pg("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),h_(e.dataSync(),r.dataSync(),o,i,s)},t.prototype.cropAndResize=function(e,r,o,i,s,a){var u=new Z8(e.shape,r.shape,i,s,a);return this.compileAndRun(u,[e,r,o],"float32")},t.prototype.depthToSpace=function(e,r,o){I(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});var i=e.shape[0],l=("NHWC"===o?e.shape[1]:e.shape[2])*r,c=("NHWC"===o?e.shape[2]:e.shape[3])*r,d=("NHWC"===o?e.shape[3]:e.shape[1])/(r*r),f=new nq("NHWC"===o?[i,l,c,d]:[i,d,l,c],r,o);return this.compileAndRun(f,[e])},t.prototype.split=function(e,r,o){return hR(e,r,o)},t.prototype.scatterND=function(e,r,o){var i=hf(0,e,o),s=i.sliceRank,a=i.numUpdates,u=i.sliceSize,l=i.strides,c=i.outputSize,d=[c/u,u],f=e.reshape([a,s]),h=r.reshape([a,u]);if(0===c)return Kg(Wn([]),o);var p=oe(0),m=new GR(a,s,f.rank,h.rank,l,d);return this.compileAndRun(m,[h,f,p]).reshape(o)},t.prototype.sparseToDense=function(e,r,o,i){var s=hf(0,e,o),d=new GR(s.numUpdates,s.sliceRank,e.rank,r.rank,s.strides,[s.outputSize,1],!1);return this.compileAndRun(d,[r,e,i]).reshape(o)},t.prototype.fft=function(e){return this.fftImpl(e,!1)},t.prototype.ifft=function(e){return this.fftImpl(e,!0)},t.prototype.fftImpl=function(e,r){var o=this.texData.get(e.dataId),i=new IR("return real * expR - imag * expI;",e.shape,r),s=new IR("return real * expI + imag * expR;",e.shape,r),a=[this.makeComplexComponentTensorInfo(e,o.complexTensors.real),this.makeComplexComponentTensorInfo(e,o.complexTensors.imag)],u=this.compileAndRun(i,a),l=this.compileAndRun(s,a),c=this.complex(u,l).as2D(e.shape[0],e.shape[1]);return u.dispose(),l.dispose(),c},t.prototype.gatherND=function(e,r){var o=r.shape,i=o[o.length-1],s=r_(e,r),a=s[0],u=s[1],l=s[2],c=s[3],d=r.reshape([u,i]),f=e.reshape([e.size/l,l]),h=new fq(i,c,[u,l]);return this.compileAndRun(h,[f,d]).reshape(a)},t.prototype.fill=function(e,r,o){if("string"===(o=o||Il(r))){var i=Yd(o,me(e));return i.fill(r),N.makeTensor(i,e,o,this)}var s=new cq(e,r),a=s.getCustomSetupFunc(r);return this.compileAndRun(s,[],o,a)},t.prototype.onesLike=function(e){if("string"===e.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){return this.fill(e.shape,"string"===e.dtype?"":0,e.dtype)},t.prototype.linspace=function(e,r,o){return d_(e,r,o)},t.prototype.makeTensorInfo=function(e,r){var o=this.write(null,e,r);return this.texData.get(o).usage=null,{dataId:o,shape:e,dtype:r}},t.prototype.makeOutput=function(e,r){var o=this.makeTensorInfo(e,r).dataId;return N.makeTensorFromDataId(o,e,r,this)},t.prototype.unpackTensor=function(e){var r=new e7(e.shape);return this.runWebGLProgram(r,[e],e.dtype)},t.prototype.packTensor=function(e){var r=new xq(e.shape);return this.runWebGLProgram(r,[e],e.dtype,null,!0)},t.prototype.packedReshape=function(e,r){var o=[lf(e.shape)].concat(cf(e.shape)),i={dtype:e.dtype,shape:o,dataId:e.dataId},s=[lf(r)].concat(cf(r)),a=new Sq(s,o),u=this.runWebGLProgram(a,[i],e.dtype,null,!0);return{dataId:u.dataId,shape:r,dtype:u.dtype}},t.prototype.decode=function(e){var r,o=this.texData.get(e),i=o.isPacked,s=o.shape,a=o.dtype,u=Ng(s);return r=i?new tq(u):new eq(u),{dtype:a,shape:s,dataId:this.runWebGLProgram(r,[{shape:u,dtype:a,dataId:e}],a,null,!0).dataId}},t.prototype.runWebGLProgram=function(e,r,o,i,s){var a=this;void 0===s&&(s=!1);var u=this.makeTensorInfo(e.outputShape,o),l=this.texData.get(u.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===nf.DENSE){var c=rf(e.outputShape);l.texShape=c.map(function(b){return 2*b})}if(null!=e.outTexUsage&&(l.usage=e.outTexUsage),0===me(u.shape))return l.values=Sl(u.dtype,0),u;var d=[],f=r.map(function(b){if("complex64"===b.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var x=a.texData.get(b.dataId);if(null==x.texture){if(!e.packedInputs&&me(b.shape)<=$().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:b.shape,texData:null,isUniform:!0,uniformValues:x.values};e.packedInputs&&(x.isPacked=!0,x.shape=b.shape)}else if(!!x.isPacked!=!!e.packedInputs)b=x.isPacked?a.unpackTensor(b):a.packTensor(b),d.push(b),x=a.texData.get(b.dataId);else if(x.isPacked&&!df(x.shape,b.shape)){var E=b,D=b.shape;b.shape=x.shape,b=a.packedReshape(b,D),d.push(b),x=a.texData.get(b.dataId),E.shape=D}return a.uploadToGPU(b.dataId),{shape:b.shape,texData:x,isUniform:!1}});this.uploadToGPU(u.dataId);var h,b,D,p={shape:u.shape,texData:l,isUniform:!1},m=(b=e,D="",f.concat(p).forEach(function(A){D+=A.shape+"_"+(A.isUniform?"uniform":A.texData.texShape)+"_"+(null!=A.texData&&null!=A.texData.slice&&A.texData.slice.flatOffset>0)}),b.constructor.name+"_"+D+"_"+b.userCode),v=this.getAndSaveBinary(m,function(){return function(b,x,E,D){var k=x.userCode,R=E.map(function(B,z){var Y={logicalShape:B.shape,texShape:B.isUniform?null:B.texData.texShape,isUniform:B.isUniform,isPacked:!B.isUniform&&B.texData.isPacked,flatOffset:null};return null!=B.texData&&null!=B.texData.slice&&B.texData.slice.flatOffset>0&&(Y.flatOffset=B.texData.slice.flatOffset),{name:x.variableNames[z],shapeInfo:Y}}),A=R.map(function(B){return B.shapeInfo}),M={logicalShape:D.shape,texShape:D.texData.texShape,isUniform:!1,isPacked:D.texData.isPacked,flatOffset:null},O=A8(R,M,k,x.packedInputs),P=b.createProgram(O),G=null,q=b.getUniformLocation(P,"NAN",!1);1===$().getNumber("WEBGL_VERSION")&&(G=b.getUniformLocation(P,"INFINITY",!1));for(var K={},L=0;L<x.variableNames.length;L++){var V=x.variableNames[L];K[V]=b.getUniformLocation(P,V,!1),K["offset"+V]=b.getUniformLocation(P,"offset"+V,!1)}return{program:x,source:O,webGLProgram:P,uniformLocations:K,inShapeInfos:A,outShapeInfo:M,infLoc:G,nanLoc:q}}(a.gpgpu,e,f,p)}),y=null!=this.activeTimers;if(y&&(h=this.startTimer()),function(b,x,E,D,k){$R(x.inShapeInfos,E),$R([x.outShapeInfo],[D]);var R=D.texData.texture,A=D.texData.texShape;D.texData.isPacked?b.setOutputPackedMatrixTexture(R,A[0],A[1]):b.setOutputMatrixTexture(R,A[0],A[1]),b.setProgram(x.webGLProgram),1===$().getNumber("WEBGL_VERSION")&&null!==x.infLoc&&b.gl.uniform1f(x.infLoc,1/0),null!==x.nanLoc&&b.gl.uniform1f(x.nanLoc,NaN),E.forEach(function(M,O){var P=x.program.variableNames[O],G=x.uniformLocations[P],q=x.uniformLocations["offset"+P];if(null!=G)if(M.isUniform)if(me(M.shape)<2)b.gl.uniform1f(G,M.uniformValues[0]);else{var K=M.uniformValues;K instanceof Float32Array||(K=new Float32Array(K)),b.gl.uniform1fv(G,K)}else null!=M.texData.slice&&null!=q&&b.gl.uniform1i(q,M.texData.slice.flatOffset),b.setInputMatrixTexture(M.texData.texture,G,O)}),k?.(b,x.webGLProgram),b.executeProgram()}(this.gpgpu,v,f,p,i),d.forEach(function(b){return a.disposeData(b.dataId)}),y&&(h=this.endTimer(h),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(h)})),!$().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&!1===s){var _=this.unpackTensor(u);return this.disposeData(u.dataId),_}return u},t.prototype.compileAndRun=function(e,r,o,i,s){void 0===s&&(s=!1);var a=this.runWebGLProgram(e,r,o=o||r[0].dtype,i,s);return N.makeTensorFromDataId(a.dataId,a.shape,a.dtype)},t.prototype.getAndSaveBinary=function(e,r){return e in this.binaryCache||(this.binaryCache[e]=r()),this.binaryCache[e]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var e=this;this.disposed||($().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(r){e.gpgpu.deleteProgram(e.binaryCache[r].webGLProgram),delete e.binaryCache[r]}),this.textureManager.dispose(),null!=this.canvas&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var e=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=le(function(){if(!$().get("WEBGL_RENDER_FLOAT32_ENABLED")){var r=$().getBool("DEBUG");$().set("DEBUG",!1);var o=e.abs(oe(1e-8)).dataSync()[0];if($().set("DEBUG",r),o>0)return 32}return 16})),this.floatPrecisionValue},t.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},t.prototype.uploadToGPU=function(e){var r,o=this.texData.get(e),i=o.shape,s=o.dtype,a=o.values,l=o.usage,c=o.isPacked;if(null==o.texture){var d,f=null!=this.activeTimers;f&&(d=Po());var h=o.texShape;if(null==h&&(h=Bk(i,c),o.texShape=h),null!=a){var p=Ng(i),m=void 0,v=h[1],y=h[0],_=a instanceof Uint8Array;c?(v=(r=sf(h[0],h[1]))[0],m=new aq(p,[y=r[1],v],_)):m=new sq(p,[y,v],_);var b=this.makeTensorInfo([y,v],s);this.texData.get(b.dataId).usage=_?zr.PIXELS:zr.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(b.dataId),v,y,a);var x=this.runWebGLProgram(m,[b],s,null,!0),E=this.texData.get(x.dataId);o.texture=E.texture,o.texShape=E.texShape,o.isPacked=E.isPacked,o.usage=E.usage,this.disposeData(b.dataId),this.texData.delete(x.dataId),o.values=null,f&&(this.uploadWaitMs+=Po()-d)}else{var D=this.acquireTexture(h,l,s,c);o.texture=D}}},t.prototype.convertAndCacheOnCPU=function(e,r){var o=this.texData.get(e),i=o.dtype;return this.releaseGPUData(e),null!=r&&(o.values=function(s,a){if("float32"===a||"complex64"===a)return s;if("int32"===a||"bool"===a){for(var u="int32"===a?new Int32Array(s.length):new Uint8Array(s.length),l=0;l<u.length;++l)u[l]=Math.round(s[l]);return u}throw new Error("Unknown dtype "+a)}(r,i)),o.values},t.prototype.acquireTexture=function(e,r,o,i){if(this.numBytesInGPU+=this.computeBytes(e,o),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var s=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+s+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(e,r,i)},t.prototype.computeBytes=function(e,r){return e[0]*e[1]*R0(r)},t}(lR);wk()&&N.registerBackend("webgl",function(){return new aN},2);var n7=F({square_:function(n){var t=S(n,"x","square");return N.runKernelFunc(function(r,o){return o([t]),r.square(t)},{x:t},null,"Square",{},[t],[])}}),wf="SquaredDifference",uN=F({squaredDifference_:function(n,t){var e,r=S(n,"a","squaredDifference"),o=S(t,"b","squaredDifference");return e=Bt(r,o),Ze((r=e[0]).shape,(o=e[1]).shape),N.runKernelFunc(function(a,u){var l=a.squaredDifference(r,o);return u([r,o]),l},{a:r,b:o},function(a,u){var l=u[0],c=u[1],d=oe(2);return{a:function(){return a.mul(l.sub(c).mul(d))},b:function(){return a.mul(c.sub(l).mul(d))}}},wf,{},[r,o],[])}}),r7=F({abs_:function(n){var t=S(n,"x","abs");return"complex64"===t.dtype?N.runKernelFunc(function(e){return e.complexAbs(t)},{$x:t}):N.runKernelFunc(function(e,r){var o=e.abs(t);return r([t]),o},{x:t},function(e,r){var o=r[0];return{x:function(){return e.mul(o.toFloat().step(-1))}}},"Abs")}}),o7=F({acos_:function(n){var t=S(n,"x","acos");return N.runKernelFunc(function(e,r){var o=e.acos(t);return r([t]),o},{$x:t},function(e,r){var o=r[0];return{$x:function(){return e.divStrict(oe(1).sub(o.toFloat().square()).sqrt()).neg()}}})}}),i7=F({acosh_:function(n){var t=S(n,"x","acosh");return N.runKernelFunc(function(e,r){var o=e.acosh(t);return r([t]),o},{$x:t},function(e,r){var o=r[0];return{$x:function(){return e.divStrict(o.toFloat().square().sub(1).sqrt())}}})}}),s7=F({asin_:function(n){var t=S(n,"x","asin");return N.runKernelFunc(function(e,r){var o=e.asin(t);return r([t]),o},{$x:t},function(e,r){var o=r[0];return{$x:function(){return e.divStrict(oe(1).sub(o.toFloat().square()).sqrt())}}})}}),a7=F({asinh_:function(n){var t=S(n,"x","asinh");return N.runKernelFunc(function(e,r){var o=e.asinh(t);return r([t]),o},{$x:t},function(e,r){var o=r[0];return{$x:function(){return e.divStrict(oe(1).add(o.toFloat().square()).sqrt())}}})}}),u7=F({atan_:function(n){var t=S(n,"x","atan");return N.runKernelFunc(function(e,r){var o=e.atan(t);return r([t]),o},{$x:t},function(e,r){var o=r[0];return{$x:function(){return e.div(o.toFloat().square().add(1))}}})}}),l7=F({atanh_:function(n){var t=S(n,"x","atanh");return N.runKernelFunc(function(e,r){var o=e.atanh(t);return r([t]),o},{$x:t},function(e,r){var o=r[0];return{$x:function(){return e.div(oe(1).sub(o.toFloat().square()))}}})}}),c7=F({ceil_:function(n){var t=S(n,"x","ceil");return N.runKernelFunc(function(e){return e.ceil(t)},{$x:t},function(e){return{$x:function(){return ut(e)}}})}}),D_=F({clipByValue_:function(n,t,e){var r=S(n,"x","clipByValue");return I(t<=e,function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+e+")."}),N.runKernelFunc(function(s,a){var u=s.clip(r,t,e);return a([r]),u},{x:r},function(s,a){var u=a[0];return{x:function(){return s.where(u.greaterEqual(t).logicalAnd(u.lessEqual(e)),ut(s))}}},"ClipByValue",{min:t,max:e},[r])}}),d7=F({cos_:function(n){var t=S(n,"x","cos");return N.runKernelFunc(function(r,o){var i=r.cos(t);return o([t]),i},{x:t},function(r,o){var i=o[0];return{x:function(){return i.toFloat().sin().neg().mul(r)}}},"Cos",{},[t])}}),f7=F({cosh_:function(n){var t=S(n,"x","cosh");return N.runKernelFunc(function(e,r){var o=e.cosh(t);return r([t]),o},{$x:t},function(e,r){var o=r[0];return{$x:function(){return o.toFloat().sinh().mulStrict(e)}}})}}),h7=F({erf_:function(n){var t=S(n,"x","erf");return I("int32"===t.dtype||"float32"===t.dtype,function(){return"Input dtype must be `int32` or `float32`."}),"int32"===t.dtype&&(t=t.toFloat()),N.runKernelFunc(function(e,r){var o=e.erf(t);return r([t]),o},{$x:t},function(e,r){var o=r[0];return{$x:function(){return e.mul(o.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),S_=F({exp_:function(n){var t=S(n,"x","exp");return N.runKernelFunc(function(e,r){var o=e.exp(t);return r([o]),o},{x:t},function(e,r){return{x:function(){return e.mulStrict(r[0])}}},"Exp",{},[],[!0])}}),p7=F({expm1_:function(n){var t=S(n,"x","expm1");return N.runKernelFunc(function(e,r){var o=e.expm1(t);return r([t]),o},{$x:t},function(e,r){var o=r[0];return{$x:function(){return e.mul(o.exp())}}})}}),g7=F({floor_:function(n){var t=S(n,"x","floor");return N.runKernelFunc(function(e){return e.floor(t)},{$x:t},function(e){return{$x:function(){return ut(e)}}})}}),m7=F({log_:function(n){var t=S(n,"x","log");return N.runKernelFunc(function(r,o){var i=r.log(t);return o([t]),i},{x:t},function(r,o){var i=o[0];return{x:function(){return r.div(i.toFloat())}}},"Log",{},[t])}}),v7=F({log1p_:function(n){var t=S(n,"x","log1p");return N.runKernelFunc(function(e,r){var o=e.log1p(t);return r([t]),o},{$x:t},function(e,r){var o=r[0];return{$x:function(){return e.div(o.add(1))}}})}}),y7=F({logSigmoid_:function(n){var t=S(n,"x","logSigmoid");return N.runKernelFunc(function(e,r){var o=e.softplus(t.neg()).neg();return r([t]),o},{$x:t},function(e,r){var o=r[0];return{$x:function(){return e.mul(o.neg().sigmoid())}}})}}),Jg=F({neg_:function(n){var t=S(n,"x","neg");return N.runKernelFunc(function(r){return r.neg(t)},{x:t},function(r){return{x:function(){return r.neg()}}},"Neg",{},[t])}}),w7=F({reciprocal_:function(n){var t=S(n,"x","reciprocal");return N.runKernelFunc(function(e,r){var o=e.reciprocal(t);return r([t]),o},{$x:t},function(e,r){var o=r[0];return{$x:function(){return e.div(o.square().neg())}}})}}),b7=F({round_:function(n){var t=S(n,"x","round");return N.runKernelFunc(function(e){return e.round(t)},{$x:t},function(e){return{$x:function(){return ut(e)}}})}}),lN=F({rsqrt_:function(n){var t=S(n,"x","rsqrt");return N.runKernelFunc(function(r,o){var i=r.rsqrt(t);return o([t]),i},{x:t},function(r,o){var i=o[0];return{x:function(){return r.div(i.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},[t])}}),cN=F({sigmoid_:function(n){var t=S(n,"x","sigmoid");return N.runKernelFunc(function(e,r){var o=e.sigmoid(t);return r([o]),o},{x:t},function(e,r){var o=r[0];return{x:function(){return e.mul(o.mul(oe(1).sub(o)))}}},"Sigmoid")}}),_7=F({sign_:function(n){var t=S(n,"x","sign");return N.runKernelFunc(function(e){return e.sign(t)},{$x:t},function(e){return{$x:function(){return ut(e)}}})}}),x7=F({isNaN_:function(n){var t=S(n,"x","isNaN");return N.runKernelFunc(function(e){return e.isNaN(t)},{$x:t},function(e){return{$x:function(){return ut(e)}}})}}),C7=F({isInf_:function(n){var t=S(n,"x","isInf");return N.runKernelFunc(function(e){return e.isInf(t)},{$x:t},function(e){return{$x:function(){return ut(e)}}})}}),E7=F({isFinite_:function(n){var t=S(n,"x","isFinite");return N.runKernelFunc(function(e){return e.isFinite(t)},{$x:t},function(e){return{$x:function(){return ut(e)}}})}}),D7=F({sin_:function(n){var t=S(n,"x","sin");return N.runKernelFunc(function(r,o){var i=r.sin(t);return o([t]),i},{x:t},function(r,o){var i=o[0];return{x:function(){return i.toFloat().cos().mul(r)}}},"Sin",{},[t])}}),S7=F({sinh_:function(n){var t=S(n,"x","sinh");return N.runKernelFunc(function(e,r){var o=e.sinh(t);return r([t]),o},{$x:t},function(e,r){var o=r[0];return{$x:function(){return o.toFloat().cosh().mulStrict(e)}}})}}),I7=F({softplus_:function(n){var t=S(n,"x","softplus");return N.runKernelFunc(function(e,r){var o=e.softplus(t);return r([t]),o},{$x:t},function(e,r){var o=r[0];return{$x:function(){return e.mul(o.sigmoid())}}})}}),A7=F({sqrt_:function(n){var t=S(n,"x","sqrt");return N.runKernelFunc(function(e,r){var o=e.sqrt(t);return r([t]),o},{$x:t},function(e,r){var o=r[0];return{$x:function(){return e.div(o.toFloat().sqrt().mul(2))}}})}}),T7=F({step_:function(n,t){void 0===t&&(t=0);var e=S(n,"x","step");return N.runKernelFunc(function(r){return r.step(e,t)},{$x:e},function(r){return{$x:function(){return ut(r)}}})}}),M7=F({tan_:function(n){var t=S(n,"x","tan");return N.runKernelFunc(function(e,r){var o=e.tan(t);return r([t]),o},{$x:t},function(e,r){var o=r[0];return{$x:function(){return e.div(o.cos().square())}}})}}),k7=F({tanh_:function(n){var t=S(n,"x","tanh");return N.runKernelFunc(function(e,r){var o=e.tanh(t);return r([o]),o},{x:t},function(e,r){var o=r[0];return{x:function(){return oe(1).sub(o.square()).mulStrict(e)}}},"Tanh",{},null,[!0])}});function dN(n,t,e,r,o,i){var s,a,u=S(n,"x","batchNorm"),l=S(t,"mean","batchNorm"),c=S(e,"variance","batchNorm");return null!=o&&(s=S(o,"scale","batchNorm")),null!=r&&(a=S(r,"offset","batchNorm")),I(2===u.rank,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),I(2===l.rank||1===l.rank,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+l.rank+"."}),I(2===c.rank||1===c.rank,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+c.rank+"."}),null!=s&&I(2===s.rank||1===s.rank,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+s.rank+"."}),null!=a&&I(2===a.rank||1===a.rank,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+a.rank+"."}),bf(u,l,c,a,s,i)}function fN(n,t,e,r,o,i){var s,a,u=S(n,"x","batchNorm"),l=S(t,"mean","batchNorm"),c=S(e,"variance","batchNorm");return null!=o&&(s=S(o,"scale","batchNorm")),null!=r&&(a=S(r,"offset","batchNorm")),I(3===u.rank,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),I(3===l.rank||1===l.rank,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+l.rank+"."}),I(3===c.rank||1===c.rank,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+c.rank+"."}),null!=s&&I(3===s.rank||1===s.rank,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+s.rank+"."}),null!=a&&I(3===a.rank||1===a.rank,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+a.rank+"."}),bf(u,l,c,a,s,i)}function hN(n,t,e,r,o,i){var s,a,u=S(n,"x","batchNorm"),l=S(t,"mean","batchNorm"),c=S(e,"variance","batchNorm");return null!=o&&(s=S(o,"scale","batchNorm")),null!=r&&(a=S(r,"offset","batchNorm")),I(4===u.rank,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."}),I(4===l.rank||1===l.rank,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+l.rank+"."}),I(4===c.rank||1===c.rank,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+c.rank+"."}),null!=s&&I(4===s.rank||1===s.rank,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+s.rank+"."}),null!=a&&I(4===a.rank||1===a.rank,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+a.rank+"."}),bf(u,l,c,a,s,i)}function bf(n,t,e,r,o,i){null==i&&(i=.001);var s,a,u,l=S(n,"x","batchNorm"),c=S(t,"mean","batchNorm"),d=S(e,"variance","batchNorm");return null!=o&&(s=S(o,"scale","batchNorm")),null!=r&&(a=S(r,"offset","batchNorm")),I(c.rank===d.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),I(null==a||c.rank===a.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),I(null==s||c.rank===s.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),u=0===l.rank||1===l.rank?l.as4D(1,1,1,l.size):2===l.rank?l.as4D(1,1,l.shape[0],l.shape[1]):3===l.rank?l.as4D(1,l.shape[0],l.shape[1],l.shape[2]):l,N.runKernelFunc(function(h,p){var m=h.batchNormalization(u,em(c),em(d),i,em(s),em(a));return p([l,c,d,s]),m},{x:l,mean:c,variance:d,scale:s,offset:a},function(h,p){var v=p[0],y=p[1],_=p[2],x=p[3]??oe(1),E=vn(y.shape,u.shape),D=[];if(1===y.rank){for(var k=0;k<u.shape.length-1;++k)D.push(u.shape[k]);D.push(1)}var R=v.sub(y),A=h.mul(x),M=lN(_.add(oe(i))),O=M.mul(M).mul(M).mul(oe(-.5));return{x:function(){return 1===y.rank?h.mul(kl(M.as4D(1,1,1,y.shape[0]),D)).mul(x).reshape(v.shape):h.mul(M).mul(x).reshape(v.shape)},mean:function(){var P=M.mul(oe(-1)).mul(A);return 1===y.rank&&(P=P.sum(E)),P.reshape(y.shape)},variance:function(){var P=O.mul(R).mul(A);return 1===y.rank&&(P=P.sum(E)),P.reshape(y.shape)},scale:function(){var P=R.mul(M),G=h.mul(P);return 1===y.rank&&(G=G.sum(E)),G.reshape(y.shape)},offset:function(){var P=h;return 1===y.rank&&(P=P.sum(E)),P.reshape(y.shape)}}},"BatchNormalization",{varianceEpsilon:i},[l,c,d,s]).reshape(l.shape)}function em(n){return null==n?null:0===n.rank?n.as1D():1===n.rank?n:2===n.rank?n.as4D(1,1,n.shape[0],n.shape[1]):3===n.rank?n.as4D(1,n.shape[0],n.shape[1],n.shape[2]):n}function tm(){$k("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var R7=F({batchNormalization2d_:function(n,t,e,r,o,i){return void 0===r&&(r=.001),tm(),dN(n,t,e,i,o,r)}}),N7=F({batchNormalization3d_:function(n,t,e,r,o,i){return void 0===r&&(r=.001),tm(),fN(n,t,e,i,o,r)}}),F7=F({batchNormalization4d_:function(n,t,e,r,o,i){return void 0===r&&(r=.001),tm(),hN(n,t,e,i,o,r)}}),P7=F({batchNormalization_:function(n,t,e,r,o,i){return void 0===r&&(r=.001),tm(),bf(n,t,e,i,o,r)}}),pN=F({batchNorm_:bf}),O7=F({batchNorm2d_:dN}),L7=F({batchNorm3d_:fN}),B7=F({batchNorm4d_:hN}),nm=F({logicalAnd_:function(n,t){var e=S(n,"a","logicalAnd","bool"),r=S(t,"b","logicalAnd","bool");return Ze(e.shape,r.shape),N.runKernelFunc(function(o){return o.logicalAnd(e,r)},{a:e,b:r},null,"LogicalAnd")}}),V7=F({logicalNot_:function(n){var t=S(n,"x","logicalNot","bool");return N.runKernelFunc(function(e){return e.logicalNot(t)},{$x:t})}}),gN=F({logicalOr_:function(n,t){var e=S(n,"a","logicalOr","bool"),r=S(t,"b","logicalOr","bool");return Ze(e.shape,r.shape),N.runKernelFunc(function(o){return o.logicalOr(e,r)},{$a:e,$b:r})}}),U7=F({logicalXor_:function(n,t){var e=S(n,"a","logicalXor","bool"),r=S(t,"b","logicalXor","bool");return Ze(e.shape,r.shape),gN(n,t).logicalAnd(nm(n,t).logicalNot())}}),nu=F({where_:function(n,t,e){var r=S(t,"a","where"),o=S(e,"b","where"),i=S(n,"condition","where","bool");return at(r.shape,o.shape,"Error in where: "),1===i.rank?I(i.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):at(i.shape,o.shape,"Error in where: "),N.runKernelFunc(function(s,a){var u=s.select(i,r,o);return a([i]),u},{$condition:i,$a:r,$b:o},function(s,a){var u=a[0];return{$condition:function(){return ut(u).toFloat()},$a:function(){return s.mul(u.cast(s.dtype))},$b:function(){return s.mul(u.logicalNot().cast(s.dtype))}}})}}),mN=function(n){return he(this,void 0,void 0,function(){var t,e,r;return pe(this,function(o){switch(o.label){case 0:return[4,(t=S(n,"condition","whereAsync","bool")).data()];case 1:return e=o.sent(),r=g_(t.shape,e),n!==t&&t.dispose(),[2,r]}})})},Je=F({add_:function(n,t){var e,r=S(n,"a","add"),o=S(t,"b","add");e=Bt(r,o);var i=Ze((r=e[0]).shape,(o=e[1]).shape);return N.runKernelFunc(function(s){return s.add(r,o)},{a:r,b:o},function(s){return{a:function(){var a=s,u=vn(r.shape,i);return u.length>0&&(a=a.sum(u)),a.reshape(r.shape)},b:function(){var a=s,u=vn(o.shape,i);return u.length>0&&(a=a.sum(u)),a.reshape(o.shape)}}},"Add")}}),j7=F({addN_:function(n){I(Array.isArray(n),function(){return"The argument passed to tf.addN() must be a list of tensors"}),I(n.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+n.length});var t=n.map(function(o,i){return S(o,"tensors"+i,"addN")}),e=t[0];return t.forEach(function(o){if(o.dtype!==e.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(function(o){if(!pn(o.shape,e.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}),N.runKernelFunc(function(o){return o.addN(t)},t,function(o){var i={};return t.forEach(function(s,a){i[a]=function(){return o.clone()}}),i},"AddN")}}),H7=F({addStrict_:function(n,t){var e=S(n,"a","addStrict"),r=S(t,"b","addStrict");return at(e.shape,r.shape,"Error in addStrict: "),e.add(r)}}),W7=F({atan2_:function(n,t){var e,r=S(n,"a","atan2"),o=S(t,"b","atan2");e=Bt(r,o);var i=Ze((r=e[0]).shape,(o=e[1]).shape);return N.runKernelFunc(function(s,a){var u=s.atan2(r,o);return a([r,o]),u},{$a:r,$b:o},function(s,a){var u=a[0],l=a[1];return{$a:function(){var c=Je(u.square(),l.square()),d=s.mul(l.div(c)),f=vn(u.shape,i);return f.length>0&&(d=d.sum(f)),d.reshape(u.shape)},$b:function(){var c=Je(u.square(),l.square()),d=Jg(s.mul(u.div(c))),f=vn(l.shape,i);return f.length>0&&(d=d.sum(f)),d.reshape(l.shape)}}})}}),Uo=F({div_:function(n,t){var e,r=S(n,"a","div"),o=S(t,"b","div");if(e=Bt(r,o),o=e[1],"int32"===(r=e[0]).dtype&&"int32"===o.dtype)return vN(r,o);var i=Ze(r.shape,o.shape);return N.runKernelFunc(function(s,a){var u=s.realDivide(r,o);return a([r,o]),u},{a:r,b:o},function(s,a){var u=a[0],l=a[1];return{a:function(){var c=s.div(l.toFloat()),d=vn(u.shape,i);return d.length>0?c.sum(d).reshape(u.shape):c},b:function(){var c=s.mul(u.toFloat()),d=vn(l.shape,i);d.length>0&&(c=c.sum(d).reshape(l.shape));var f=l.square();return c.div(f.toFloat()).neg()}}},"Div")}}),z7=F({divNoNan_:function(n,t){var e,r=S(n,"a","div"),o=S(t,"b","div");r=(e=Bt(r,o))[0];var i=Uo(r,o=e[1]),s=ut(i),a=o.equal(s);return nu(a,s,i)}}),$7=F({divStrict_:function(n,t){var e=S(n,"a","div"),r=S(t,"b","div");return at(e.shape,r.shape,"Error in divideStrict: "),e.div(r)}}),vN=F({floorDiv_:function(n,t){var e,r=S(n,"a","floorDiv"),o=S(t,"b","floorDiv");e=Bt(r,o);var i=Ze((r=e[0]).shape,(o=e[1]).shape);return N.runKernelFunc(function(s,a){var u=s.floorDiv(r,o);return a([r,o]),u},{a:r,b:o},function(s,a){var u=a[0],l=a[1];return{a:function(){var c=s.div(l.toFloat()),d=vn(u.shape,i);return d.length>0?c.sum(d).reshape(u.shape):c},b:function(){var c=s.mul(u.toFloat()),d=vn(l.shape,i);d.length>0&&(c=c.sum(d).reshape(l.shape));var f=l.square();return c.div(f.toFloat()).neg()}}},"FloorDiv")}}),I_=F({maximum_:function(n,t){var e,r=S(n,"a","maximum"),o=S(t,"b","maximum");return e=Bt(r,o),o=e[1],"bool"===(r=e[0]).dtype&&(r=r.toInt(),o=o.toInt()),Ze(r.shape,o.shape),N.runKernelFunc(function(i,s){var a=i.maximum(r,o);return s([r,o]),a},{a:r,b:o},function(i,s){var a=s[0],u=s[1];return{a:function(){return i.mul(a.greaterEqual(u).toFloat())},b:function(){return i.mul(a.less(u).toFloat())}}},"Maximum")}}),G7=F({maximumStrict_:function(n,t){var e=S(n,"a","maximumStrict"),r=S(t,"b","maximumStrict");return at(e.shape,r.shape,"Error in maximumStrict: "),e.maximum(r)}}),yN=F({minimum_:function(n,t){var e,r=S(n,"a","minimum"),o=S(t,"b","minimum");return e=Bt(r,o),o=e[1],"bool"===(r=e[0]).dtype&&(r=r.toInt(),o=o.toInt()),Ze(r.shape,o.shape),N.runKernelFunc(function(i,s){var a=i.minimum(r,o);return s([r,o]),a},{a:r,b:o},function(i,s){var a=s[0],u=s[1];return{a:function(){return i.mul(a.lessEqual(u).toFloat())},b:function(){return i.mul(a.greater(u).toFloat())}}},"Minimum")}}),q7=F({minimumStrict_:function(n,t){var e=S(n,"a","minimumStrict"),r=S(t,"b","minimumStrict");return at(e.shape,r.shape,"Error in minimumStrict: "),e.minimum(r)}}),K7=F({mod_:function(n,t){var e,r=S(n,"a","mod"),o=S(t,"b","mod");e=Bt(r,o);var i=Ze((r=e[0]).shape,(o=e[1]).shape);return N.runKernelFunc(function(s,a){var u=s.mod(r,o);return a([r,o]),u},{$a:r,$b:o},function(s,a){var u=a[0],l=a[1];return{$a:function(){var c=vn(u.shape,i);return c.length>0?s.sum(c).reshape(u.shape):s},$b:function(){var c=s.mul(u.div(l).floor().neg()),d=vn(l.shape,i);return d.length>0?c.sum(d).reshape(l.shape):c}}})}}),X7=F({modStrict_:function(n,t){var e=S(n,"a","modStrict"),r=S(t,"b","modStrict");return at(e.shape,r.shape,"Error in modStrict: "),e.mod(r)}}),nr=F({mul_:function(n,t){var e,r=S(n,"a","mul"),o=S(t,"b","mul");e=Bt(r,o);var i=Ze((r=e[0]).shape,(o=e[1]).shape);return N.runKernelFunc(function(s,a){var u=s.multiply(r,o);return a([r,o]),u},{a:r,b:o},function(s,a){var u=a[0],l=a[1];return{a:function(){var c=s.mul(l.toFloat()),d=vn(u.shape,i);return d.length>0?c.sum(d).reshape(u.shape):c},b:function(){var c=s.mul(u.toFloat()),d=vn(l.shape,i);return d.length>0?c.sum(d).reshape(l.shape):c}}},"Mul")}}),Y7=F({mulStrict_:function(n,t){var e=S(n,"a","mul"),r=S(t,"b","mul");return at(e.shape,r.shape,"Error in multiplyStrict: "),e.mul(r)}}),rm=F({pow_:function(n,t){var e,r=S(n,"base","pow"),o=S(t,"exp","pow");e=Bt(r,o);var i=Ze((r=e[0]).shape,(o=e[1]).shape);return N.runKernelFunc(function(a,u){var l=a.pow(r,o);return u([r,o,l]),l},{a:r,b:o},function(a,u){var l=u[0],c=u[1],d=u[2];return{a:function(){var f=c.toFloat(),h=a.mul(f.mul(l.pow(f.sub(oe(1))))),p=vn(l.shape,i);return p.length>0&&(h=h.sum(p)),h.reshape(l.shape)},b:function(){var f=l.greater(0),h=l.log().where(f,ut(l)),p=a.mul(d.mul(h)),m=vn(c.shape,i);return m.length>0&&(p=p.sum(m)),p.reshape(c.shape)}}},"Pow",{},[r,o],[!0])}}),Q7=F({powStrict_:function(n,t){return at(n.shape,t.shape,"Error in powStrict: "),n.pow(t)}}),Z7=F({squaredDifferenceStrict_:function(n,t){var e=S(n,"a","squaredDifferenceStrict"),r=S(t,"b","squaredDifferenceStrict");return at(e.shape,r.shape,"Error in squaredDifferenceStrict: "),e.squaredDifference(r)}}),In=F({sub_:function(n,t){var e,r=S(n,"a","sub"),o=S(t,"b","sub");e=Bt(r,o);var i=Ze((r=e[0]).shape,(o=e[1]).shape);return N.runKernelFunc(function(s){return s.subtract(r,o)},{a:r,b:o},function(s){return{a:function(){var a=s,u=vn(r.shape,i);return u.length>0&&(a=a.sum(u)),a.reshape(r.shape)},b:function(){var a=s,u=vn(o.shape,i);return u.length>0&&(a=a.sum(u)),a.neg().reshape(o.shape)}}},"Sub")}}),J7=F({subStrict_:function(n,t){var e=S(n,"a","subStrict"),r=S(t,"b","subStrict");return at(e.shape,r.shape,"Error in subStrict: "),e.sub(r)}}),wN=F({equal_:function(n,t){var e,r=S(n,"a","equal"),o=S(t,"b","equal");return e=Bt(r,o),Ze((r=e[0]).shape,(o=e[1]).shape),N.runKernelFunc(function(i){return i.equal(r,o)},{$a:r,$b:o})}}),e9=F({equalStrict_:function(n,t){var e=S(n,"a","equalStrict"),r=S(t,"b","equalStrict");return at(e.shape,r.shape,"Error in equalStrict: "),e.equal(r)}}),t9=F({greater_:function(n,t){var e,r=S(n,"a","greater"),o=S(t,"b","greater");return e=Bt(r,o),Ze((r=e[0]).shape,(o=e[1]).shape),N.runKernelFunc(function(i){return i.greater(r,o)},{a:r,b:o},null,"Greater")}}),bN=F({greaterEqual_:function(n,t){var e,r=S(n,"a","greaterEqual"),o=S(t,"b","greaterEqual");return e=Bt(r,o),Ze((r=e[0]).shape,(o=e[1]).shape),N.runKernelFunc(function(i,s){var a=i.greaterEqual(r,o);return s([r,o]),a},{a:r,b:o},function(i,s){var a=s[0],u=s[1];return{a:function(){return ut(a)},b:function(){return ut(u)}}},"GreaterEqual")}}),n9=F({greaterEqualStrict_:function(n,t){var e=S(n,"a","greaterEqualStrict"),r=S(t,"b","greaterEqualStrict");return at(e.shape,r.shape,"Error in greaterEqualStrict: "),e.greaterEqual(r)}}),r9=F({greaterStrict_:function(n,t){var e=S(n,"a","greaterStrict"),r=S(t,"b","greaterStrict");return at(e.shape,r.shape,"Error in greaterStrict: "),e.greater(r)}}),o9=F({less_:function(n,t){var e,r=S(n,"a","less"),o=S(t,"b","less");return e=Bt(r,o),Ze((r=e[0]).shape,(o=e[1]).shape),N.runKernelFunc(function(i){return i.less(r,o)},{a:r,b:o},null,"Less")}}),i9=F({lessEqual_:function(n,t){var e,r=S(n,"a","lessEqual"),o=S(t,"b","lessEqual");return e=Bt(r,o),Ze((r=e[0]).shape,(o=e[1]).shape),N.runKernelFunc(function(i,s){var a=i.lessEqual(r,o);return s([r,o]),a},{a:r,b:o},null,"LessEqual")}}),s9=F({lessEqualStrict_:function(n,t){var e=S(n,"a","lessEqualStrict"),r=S(t,"b","lessEqualStrict");return at(e.shape,r.shape,"Error in lessEqualStrict: "),e.lessEqual(r)}}),a9=F({lessStrict_:function(n,t){var e=S(n,"a","lessStrict"),r=S(t,"b","lessStrict");return at(e.shape,r.shape,"Error in lessStrict: "),e.less(r)}}),u9=F({notEqual_:function(n,t){var e,r=S(n,"a","notEqual"),o=S(t,"b","notEqual");return e=Bt(r,o),Ze((r=e[0]).shape,(o=e[1]).shape),N.runKernelFunc(function(i){return i.notEqual(r,o)},{a:r,b:o},null,"NotEqual")}}),l9=F({notEqualStrict_:function(n,t){var e=S(n,"a","notEqualStrict"),r=S(t,"b","notEqualStrict");return at(e.shape,r.shape,"Error in notEqualStrict: "),e.notEqual(r)}});function _N(n,t){for(var e=[],r=n;r<t;++r)e.push(r);return e}function xN(n){for(var t=[],e=0;e<n.length;++e)for(var r=0;r<n[e].length;++r)t.push(n[e][r]);return t}var A_=F({gather_:function(n,t,e){void 0===e&&(e=0);var r=S(n,"x","gather"),o=S(t,"indices","gather","int32");e=gn(e,r.shape)[0];var i=function(s,a,u){for(var l=s.shape[u],c=[],d=1,f=1,h=0;h<u;h++)c.push(s.shape[h]),d*=s.shape[h];for(h=0;h<a.rank;h++)c.push(a.shape[h]);for(h=u+1;h<s.rank;h++)c.push(s.shape[h]),f*=s.shape[h];return{batchSize:d,sliceSize:f,dimSize:l,outputShape:c}}(r,o,e);return N.runKernelFunc(function(s,a){var u=s.gather(r,o.flatten(),e);return a([o]),u},{x:r,indices:o},function(s,a){var u=a[0];return{x:function(){var l=r.shape,c=u.size,d=l.slice(0,e),f=d.length,h=l.slice(e,l.length).slice(1),p=h.length,m=_N(0,f),v=_N(f+1,f+1+p),y=xN([d,[c],h]),_=s.reshape(y),b=u.reshape([c]),x=xN([[f],m,v]),E=_.transpose(x),D=CN(E,b,r.shape[e]),k=Og(x);return D.transpose(k)},indices:function(){return u}}},"Gather",{axis:e}).reshape(i.outputShape)}}),CN=F({unsortedSegmentSum_:function(n,t,e){var r=S(n,"x","unsortedSegmentSum"),o=S(t,"segmentIds","unsortedSegmentSum","int32");return I(zt(e),function(){return"numSegments must be of dtype int"}),N.runKernelFunc(function(i,s){var a=i.unsortedSegmentSum(r,o,e);return s([o]),a},{$x:r},function(i,s){var a=s[0];return{$x:function(){return function(u,l){for(var c=I_(l,ut(l)),d=A_(u,c),f=bN(l,oe(0,"int32")),h=d.rank-f.rank,p=0;p<h;++p)f=ho(f,p+1);f=nm(f,Ml(d.shape,"bool"));var m=ut(d);return nu(f,d,m)}(i,a)}}})}});function EN(n,t,e,r,o,i,s){void 0===i&&(i="NHWC"),I(n.length===t.rank,function(){return"Length of inShape ("+n.length+") and rank of dy ("+t.rank+") must match"});var a=n,u=t,l=!1;3===t.rank&&(l=!0,u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),a=[1,n[0],n[1],n[2]]),I(4===a.length,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+a.length+"."}),I(4===u.rank,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank}),I(4===e.rank,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+e.rank});var c="NHWC"===i?a[3]:a[1],d="NHWC"===i?u.shape[3]:u.shape[1];I(c===e.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+c+") must match input depth for filter "+e.shape[2]+"."}),I(d===e.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+d+") must match output depth for filter "+e.shape[3]+"."}),null!=s&&I(zt(o),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+o+"."});var f=qg(i),h=ia(a,e.shape,r,1,o,s,!1,f),p=N.runKernelFunc(function(m,v){var y=m.conv2dDerInput(u,e,h);return v([e,u]),y},{dy4D:u,filter:e},function(m,v){var y=v[0],_=v[1];return{dy4D:function(){return po(m,y,r,o,i,1,s)},filter:function(){return M_(m,_,y.shape,r,o,i,s)}}});return l?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}function T_(n){var i,t="number"==typeof(i=n)?[i,i,i]:2===i.length?[i[0],i[1],1]:i;return 1===t[0]&&1===t[1]&&1===t[2]}function DN(n,t,e,r,o){I(n.length===t.rank,function(){return"Length of inShape ("+n.length+") and rank of dy ("+t.rank+") must match"});var i=n,s=t,a=!1;4===t.rank&&(a=!0,s=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),i=[1,n[0],n[1],n[2],n[3]]);var u=i[4],l=s.shape[4];I(5===i.length,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."}),I(5===s.rank,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+s.rank}),I(5===e.rank,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+e.rank}),I(u===e.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+e.shape[3]+"."}),I(l===e.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+l+") must match output depth for filter "+e.shape[4]+"."});var c=gf(i,e.shape,r,1,o),d=N.runKernelFunc(function(f){return f.conv3dDerInput(s,e,c)},{dy5D:s});return a?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}var d9=F({conv1d_:function(n,t,e,r,o,i,s){void 0===o&&(o="NWC"),void 0===i&&(i=1);var a=S(n,"x","conv1d"),u=S(t,"filter","conv1d"),l=a,c=!1;2===a.rank&&(c=!0,l=a.as3D(1,a.shape[0],a.shape[1])),I(3===l.rank,function(){return"Error in conv1d: input must be rank 3, but got rank "+l.rank+"."}),I(3===u.rank,function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."}),null!=s&&I(zt(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+r+"."}),I(l.shape[2]===u.shape[1],function(){return"Error in conv1d: depth of input ("+l.shape[2]+") must match input depth for filter "+u.shape[1]+"."}),I(_r(e,i),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+e+" and dilation '"+i+"'"}),I("NWC"===o,function(){return"Error in conv1d: got dataFormat of "+o+" but only NWC is currently supported."});var d=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),f=l.as4D(l.shape[0],1,l.shape[1],l.shape[2]),h=po(f,d,[1,e],r,"NHWC",[1,i],s);return c?h.as2D(h.shape[2],h.shape[3]):h.as3D(h.shape[0],h.shape[2],h.shape[3])}}),po=F({conv2d_:function(n,t,e,r,o,i,s){void 0===o&&(o="NHWC"),void 0===i&&(i=[1,1]);var a=S(n,"x","conv2d"),u=S(t,"filter","conv2d"),l=a,c=!1;3===a.rank&&(c=!0,l=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),I(4===l.rank,function(){return"Error in conv2d: input must be rank 4, but got rank "+l.rank+"."}),I(4===u.rank,function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."}),null!=s&&I(zt(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+r+"."});var d="NHWC"===o?l.shape[3]:l.shape[1];I(d===u.shape[2],function(){return"Error in conv2d: depth of input ("+d+") must match input depth for filter "+u.shape[2]+"."}),I(_r(e,i),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+i+"'"});var f=qg(o),h=ia(l.shape,u.shape,e,i,r,s,!1,f),m=N.runKernelFunc(function(v,y){var _=v.conv2d(l,u,h);return y([u,l]),_},{x:l,filter:u},function(v,y){var b=y[0],x=y[1];return I(Ja(i),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}),{x:function(){return SN(x.shape,v,b,e,r,o)},filter:function(){return M_(x,v,b.shape,e,r,o)}}},"Conv2D",h,[u,l]);return c?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),f9=F({conv3d_:function(n,t,e,r,o,i){void 0===o&&(o="NDHWC"),void 0===i&&(i=[1,1,1]);var h,s=S(n,"x","conv3d"),a=S(t,"filter","conv3d"),u=s,l=!1;4===s.rank&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),I(5===u.rank,function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."}),I(5===a.rank,function(){return"Error in conv3d: filter must be rank 5, but got rank "+a.rank+"."}),I(u.shape[4]===a.shape[3],function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+a.shape[3]+"."}),I((h=i,T_(e)||T_(h)),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+i+"'"}),I("NDHWC"===o,function(){return"Error in conv3d: got dataFormat of "+o+" but only NDHWC is currently supported."});var c=gf(u.shape,a.shape,e,i,r),d=N.runKernelFunc(function(f,h){var p=f.conv3d(u,a,c);return h([u,a]),p},{x:u,$filter:a},function(f,h){I(T_(i),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"});var p=h[0],m=h[1];return{x:function(){return DN(p.shape,f,m,e,r)},$filter:function(){return function(v,y,_,b,x){var E=v;4===v.rank&&(E=v.as5D(1,v.shape[0],v.shape[1],v.shape[2],v.shape[3]));var D=y;4===D.rank&&(D=y.as5D(1,y.shape[0],y.shape[1],y.shape[2],y.shape[3])),I(5===E.rank,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+E.shape+"."}),I(5===D.rank,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+D.shape+"."}),I(5===_.length,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+_+"."}),I(E.shape[4]===_[3],function(){return"Error in conv3dDerFilter: depth of input "+E.shape[4]+") must match input depth in filter ("+_[3]+"."}),I(D.shape[4]===_[4],function(){return"Error in conv3dDerFilter: depth of dy ("+D.shape[4]+") must match output depth for filter ("+_[4]+")."});var k=gf(E.shape,_,b,1,x);return N.runKernelFunc(function(R){return R.conv3dDerFilter(E,D,k)},{x5D:E,dy5D:D})}(p,f,m.shape,e,r)}}});return l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),M_=F({conv2dDerFilter_:function(n,t,e,r,o,i,s){void 0===i&&(i="NHWC");var a=n;3===n.rank&&(a=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var u=t;3===u.rank&&(u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),I(4===a.rank,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+a.shape+"."}),I(4===u.rank,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."}),I(4===e.length,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+e+"."});var l="NHWC"===i?a.shape[3]:a.shape[1],c="NHWC"===i?u.shape[3]:u.shape[1];I(l===e[2],function(){return"Error in conv2dDerFilter: depth of input "+l+") must match input depth in filter ("+e[2]+"."}),I(c===e[3],function(){return"Error in conv2dDerFilter: depth of dy ("+c+") must match output depth for filter ("+e[3]+")."}),null!=s&&I(zt(o),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+o+"."});var d=qg(i),f=ia(a.shape,e,r,1,o,s,!1,d);return N.runKernelFunc(function(h){return h.conv2dDerFilter(a,u,f)},{x4D:a,dy4D:u})}}),SN=F({conv2dDerInput_:EN}),om=F({depthwiseConv2d_:function(n,t,e,r,o,i,s){void 0===o&&(o="NHWC"),void 0===i&&(i=[1,1]);var a=S(n,"x","depthwiseConv2d"),u=S(t,"filter","depthwiseConv2d"),l=a,c=!1;3===a.rank&&(c=!0,l=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),I(4===l.rank,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+l.rank+"."}),I(4===u.rank,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."}),I(l.shape[3]===u.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+l.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."}),null==i&&(i=[1,1]),I(_r(e,i),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+i+"'"}),null!=s&&I(zt(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+r+"."});var d=ia(l.shape,u.shape,e,i,r,s,!0),h=N.runKernelFunc(function(p,m){var v=p.depthwiseConv2D(l,u,d);return m([l,u]),v},{x:l,filter:u},function(p,m){I(Ja(i),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"});var v=m[0],y=m[1];return{x:function(){return IN(v.shape,p,y,d)},filter:function(){return AN(v,p,y.shape,d)}}},"DepthwiseConv2dNative",d,[l,u]);return c?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}}),IN=F({depthwiseConv2dDerInput_:function(n,t,e,r){var o=t,i=!1;3===t.rank&&(i=!0,o=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var s=N.runKernelFunc(function(a){return a.depthwiseConv2DDerInput(o,e,r)},{dy4D:o});return i?s.as3D(s.shape[1],s.shape[2],s.shape[3]):s}}),AN=F({depthwiseConv2dDerFilter_:function(n,t,e,r){var o=n;3===n.rank&&(o=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var i=t;return 3===i.rank&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),N.runKernelFunc(function(s){return s.depthwiseConv2DDerFilter(o,i,r)},{x4D:o,dy4D:i})}}),k_=F({separableConv2d_:function(n,t,e,r,o,i,s){void 0===i&&(i=[1,1]),void 0===s&&(s="NHWC");var a=S(n,"x","separableConv2d"),u=S(t,"depthwiseFilter","separableConv2d"),l=S(e,"pointwiseFilter","separableConv2d"),c=a,d=!1;if(3===a.rank&&(d=!0,c=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),"NCHW"===s)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");I(4===c.rank,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+c.rank+"."}),I(4===u.rank,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."}),I(4===l.rank,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."}),I(1===l.shape[0],function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+l.shape[0]+"."}),I(1===l.shape[1],function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+l.shape[1]+"."});var f=u.shape[2],h=u.shape[3];I(l.shape[2]===f*h,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+f*h+", but got "+l.shape[2]+"."});var p=om(c,u,r,o,s,i),m=po(p,l,1,"valid",s);return d?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),h9=F({conv2dTranspose_:function(n,t,e,r,o,i){return EN(e,S(n,"x","conv2dTranspose"),S(t,"filter","conv2dTranspose"),r,o,"NHWC",i)}}),p9=F({conv3dTranspose_:function(n,t,e,r,o){return DN(e,S(n,"x","conv3dTranspose"),S(t,"filter","conv3dTranspose"),r,o)}}),im=F({matMul_:function(n,t,e,r){var o;void 0===e&&(e=!1),void 0===r&&(r=!1);var i=S(n,"a","matMul"),s=S(t,"b","matMul");o=Bt(i,s),i=o[0],s=o[1];var a=e?i.shape[i.rank-2]:i.shape[i.rank-1],u=r?s.shape[s.rank-1]:s.shape[s.rank-2],l=e?i.shape[i.rank-1]:i.shape[i.rank-2],c=r?s.shape[s.rank-2]:s.shape[s.rank-1],d=i.shape.slice(0,-2),f=s.shape.slice(0,-2),h=me(d),p=me(f);I(i.rank>=2&&s.rank>=2&&i.rank===s.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+s.rank+"."}),I(pn(d,f),function(){return"Error in matMul: outer dimensions ("+d+") and ("+f+") of Tensors with shapes "+i.shape+" and "+s.shape+" must match."}),I(a===u,function(){return"Error in matMul: inner shapes ("+a+") and ("+u+") of Tensors with shapes "+i.shape+" and "+s.shape+" and transposeA="+e+" and transposeB="+r+" must match."});var m=i.shape.slice(0,-2).concat([l,c]),v=e?i.as3D(h,a,l):i.as3D(h,l,a),y=r?s.as3D(p,c,u):s.as3D(p,u,c);return N.runKernelFunc(function(b,x){var E=b.batchMatMul(v,y,e,r);return x([v,y]),E},{a:v,b:y},function(b,x){var D=x[0],k=x[1];return e||r?!e&&r?{a:function(){return b.matMul(k,!1,!1)},b:function(){return b.matMul(D,!0,!1)}}:e&&!r?{a:function(){return k.matMul(b,!1,!0)},b:function(){return D.matMul(b,!1,!1)}}:{a:function(){return k.matMul(b,!0,!0)},b:function(){return b.matMul(D,!0,!0)}}:{a:function(){return b.matMul(k,!1,!0)},b:function(){return D.matMul(b,!0,!1)}}},"BatchMatMul",{transposeA:e,transposeB:r}).reshape(m)}}),g9=F({dot_:function(n,t){var e=S(n,"t1","dot"),r=S(t,"t2","dot");I(!(1!==e.rank&&2!==e.rank||1!==r.rank&&2!==r.rank),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+e.rank+" and "+r.rank+"."});var o=1===e.rank?e.size:e.shape[1],i=1===r.rank?r.size:r.shape[0];return I(o===i,function(){return"Error in dot: inner dimensions of inputs must match, but got "+o+" and "+i+"."}),1===e.rank&&1===r.rank?e.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():1===e.rank&&2===r.rank?e.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():2===e.rank&&1===r.rank?e.matMul(r.as2D(-1,1)).as1D():e.matMul(r.as2D(r.shape[0],r.shape[1]))}}),m9=F({outerProduct_:function(n,t){var e=S(n,"v1","outerProduct"),r=S(t,"v2","outerProduct");return I(1===e.rank&&1===r.rank,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+e.rank+" and "+r.rank+"."}),e.as2D(-1,1).matMul(r.as2D(1,-1))}}),_f=F({reverse_:function(n,t){var e=S(n,"x","reverse");if(0===e.rank)return e.clone();var r=gn(t,e.shape);return N.runKernelFunc(function(o){return o.reverse(e,r)},{$x:e},function(o){return{$x:function(){return o.reverse(r)}}}).reshapeAs(e)}}),v9=F({reverse1d_:function(n){var t=S(n,"x","reverse");return I(1===t.rank,function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."}),_f(t,0)}}),y9=F({reverse2d_:function(n,t){var e=S(n,"x","reverse");return I(2===e.rank,function(){return"Error in reverse2D: x must be rank 2 but got rank "+e.rank+"."}),_f(e,t)}}),w9=F({reverse3d_:function(n,t){var e=S(n,"x","reverse");return I(3===e.rank,function(){return"Error in reverse3D: x must be rank 3 but got rank "+e.rank+"."}),_f(e,t)}}),b9=F({reverse4d_:function(n,t){var e=S(n,"x","reverse");return I(4===e.rank,function(){return"Error in reverse4D: x must be rank 4 but got rank "+e.rank+"."}),_f(e,t)}});function TN(n,t,e,r,o,i){var s=S(n,"x","maxPool"),a=s,u=!1;3===s.rank&&(u=!0,a=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),null==r&&(r=[1,1]),I(4===a.rank,function(){return"Error in maxPool: input must be rank 4 but got rank "+a.rank+"."}),I(_r(e,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+r+"'"}),null!=i&&I(zt(o),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."});var l=Rl(a.shape,t,e,r,o,i);if(1===l.filterWidth&&1===l.filterHeight&&pn(l.inShape,l.outShape))return s.clone();var d=N.runKernelFunc(function(f,h){var p=f.maxPool(a,l);return h([a,p]),p},{x:a},function(f,h){var p=h[0],m=h[1];return{x:function(){return function(v,y,_,b,x,E,D,k){var R=S(v,"dy","maxPoolBackprop"),A=S(y,"input","maxPoolBackprop"),M=S(_,"output","maxPoolBackprop");I(A.rank===R.rank,function(){return"Rank of input ("+A.rank+") does not match rank of dy ("+R.rank+")"}),null==E&&(E=[1,1]),I(_r(x,E),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+x+" and dilations '"+E+"'"}),I(4===R.rank,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+R.rank+"."}),I(4===A.rank,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+A.rank+"."});var O=Rl(A.shape,b,x,E,D,void 0);return N.runKernelFunc(function(P){return P.maxPoolBackprop(R,A,M,O)},{$dy:R,$input:A})}(f,p,m,t,e,r,o)}}},"MaxPool",l,[a]);return u?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}function MN(n,t,e,r,o,i){var s=S(n,"x","avgPool","float32");null==r&&(r=[1,1]),I(_r(e,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+r+"'"});var a=s,u=!1;3===s.rank&&(u=!0,a=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),I(4===a.rank,function(){return"Error in avgPool: x must be rank 4 but got rank "+a.rank+"."}),null!=i&&I(zt(o),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."});var l=Rl(a.shape,t,e,r,o,i);if(1===l.filterWidth&&1===l.filterHeight&&pn(l.inShape,l.outShape))return s.clone();var c=N.runKernelFunc(function(d){return d.avgPool(a,l)},{x:a},function(d){return{x:function(){return function(f,h,p,m,v,y){var _=S(f,"dy","avgPoolBackprop"),b=S(h,"input","avgPoolBackprop");I(b.rank===_.rank,function(){return"Rank of input ("+b.rank+") does not match rank of dy ("+_.rank+")"}),null==v&&(v=[1,1]),I(_r(m,v),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+m+" and dilations '"+v+"'"});var x=b,E=_,D=!1;3===b.rank&&(D=!0,x=b.as4D(1,b.shape[0],b.shape[1],b.shape[2]),E=_.as4D(1,_.shape[0],_.shape[1],_.shape[2])),I(4===E.rank,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+E.rank+"."}),I(4===x.rank,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+x.rank+"."});var k=Rl(x.shape,p,m,v,y),R=N.runKernelFunc(function(A){return A.avgPoolBackprop(E,x,k)},{dy4D:E,input4D:x});return D?R.as3D(R.shape[1],R.shape[2],R.shape[3]):R}(d,a,t,e,r,o)}}},"AvgPool",l);return c=c.cast(s.dtype),u?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}var Rn=F({maxPool_:function(n,t,e,r,o){return TN(n,t,e,1,r,o)}}),xf=F({avgPool_:function(n,t,e,r,o){return MN(n,t,e,1,r,o)}}),_9=F({pool_:function(n,t,e,r,o,i){null==o&&(o=[1,1]),null==i&&(i=1),0===r&&(r="valid");var s=S(n,"x","maxPool"),a=s,u=!1;3===s.rank&&(u=!0,a=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),I(_r(i,o),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+o+"'"});var l,E,D,k,R,c=Rl(a.shape,t,i,o,r),d=[c.dilationHeight,c.dilationWidth];l="same"===r?(E=d,D=[c.filterHeight,c.filterWidth].map(function(A,M){return A+(A-1)*(E[M]-1)}).map(function(A){return A-1}),k=D.map(function(A){return Math.floor(A/2)}),R=D.map(function(A,M){return A-k[M]}),D.map(function(A,M){return[k[M],R[M]]})):[[0,0],[0,0]];var f=1===d[0]&&1===d[1],h=function(x,E,D){var k=D.map(function(q){return q[0]}),R=D.map(function(q){return q[1]}),A=x.concat(k,R),M=E.map(function(q,K){return(q-A[K]%q)%q}),O=R.map(function(q,K){return q+M[K]});return[E.map(function(q,K){return[k[K],O[K]]}),E.map(function(q,K){return[0,M[K]]})]}([c.inHeight,c.inWidth],d,l),m=h[1],v=f?r:"valid",y=f?a:Jk(a,d,h[0]),_=("avg"===e?function(){return MN(y,t,i,1,v)}:function(){return TN(y,t,i,1,v)})(),b=f?_:Yk(_,d,m);return u?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),x9=F({maxPool3d_:function(n,t,e,r,o,i,s){void 0===i&&(i="NDHWC");var a=S(n,"x","maxPool3d"),u=a,l=!1;4===a.rank&&(l=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),null==s&&(s=[1,1,1]),I(5===u.rank,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."}),I("NDHWC"===i,function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),I(_r(e,s),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+s+"'"}),null!=o&&I(zt(r),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var c=pf(u.shape,t,e,s,r,o,i),d=N.runKernelFunc(function(f,h){var p=f.maxPool3d(u,c);return h([u,p]),p},{x:u},function(f,h){var p=h[0],m=h[1];return{x:function(){return function(v,y,_,b,x,E,D,k){var R=S(v,"dy","maxPool3dBackprop"),A=S(y,"input","maxPool3dBackprop"),M=S(_,"output","maxPool3dBackprop"),O=R,P=A,G=M,q=!1;4===A.rank&&(q=!0,O=R.as5D(1,R.shape[0],R.shape[1],R.shape[2],R.shape[3]),P=A.as5D(1,A.shape[0],A.shape[1],A.shape[2],A.shape[3]),G=M.as5D(1,M.shape[0],M.shape[1],M.shape[2],M.shape[3])),I(5===O.rank,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+O.rank+"."}),I(5===P.rank,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+P.rank+"."}),I(5===G.rank,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+G.rank+"."}),null==E&&(E=[1,1,1]),I(_r(x,E),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+x+" and dilations '"+E+"'"}),null!=k&&I(zt(D),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+k+" but got pad "+D+"."});var K=pf(P.shape,b,x,E,D,k),L=N.runKernelFunc(function(V){return V.maxPool3dBackprop(O,P,G,K)},{dy5D:O,input5D:P});return q?L.as4D(L.shape[1],L.shape[2],L.shape[3],L.shape[4]):L}(f,p,m,t,e,s,r,o)}}});return l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),C9=F({avgPool3d_:function(n,t,e,r,o,i,s){void 0===i&&(i="NDHWC");var a=S(n,"x","avgPool3d","float32"),u=a,l=!1;4===a.rank&&(l=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),null==s&&(s=[1,1,1]),I(5===u.rank,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."}),I("NDHWC"===i,function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),I(_r(e,s),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+s+"'"}),null!=o&&I(zt(r),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var c=pf(u.shape,t,e,s,r,o,i),d=N.runKernelFunc(function(f){return f.avgPool3d(u,c)},{x:u},function(f){return{x:function(){return function(h,p,m,v,y,_,b){var x=S(h,"dy","avgPool3dBackprop"),E=S(p,"input","avgPool3dBackprop"),D=x,k=E,R=!1;4===E.rank&&(R=!0,D=x.as5D(1,x.shape[0],x.shape[1],x.shape[2],x.shape[3]),k=E.as5D(1,E.shape[0],E.shape[1],E.shape[2],E.shape[3])),I(5===D.rank,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+D.rank+"."}),I(5===k.rank,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+k.rank+"."}),null==y&&(y=[1,1,1]),I(_r(v,y),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+v+" and dilations '"+y+"'"}),null!=b&&I(zt(_),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+b+" but got pad "+_+"."});var A=pf(k.shape,m,v,y,_,b),M=N.runKernelFunc(function(O){return O.avgPool3dBackprop(D,k,A)},{dy5D:D,input5D:k});return R?M.as4D(M.shape[1],M.shape[2],M.shape[3],M.shape[4]):M}(f,u,t,e,s,r,o)}}});return d=d.cast(u.dtype),l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),pi=F({slice_:function(n,t,e){var r,o,i=S(n,"x","slice");if(0===i.rank)throw new Error("Slicing scalar is not possible");(r="number"==typeof t?[t].concat(new Array(i.rank-1).fill(0)):t.length<i.rank?t.concat(new Array(i.rank-t.length).fill(0)):t.slice()).forEach(function(u){I(-1!==u,function(){return"slice() does not support negative begin indexing."})}),o=(o=null==e?new Array(i.rank).fill(-1):"number"==typeof e?[e].concat(new Array(i.rank-1).fill(-1)):e.length<i.rank?e.concat(new Array(i.rank-e.length).fill(-1)):e).map(function(u,l){return u>=0?u:(I(-1===u,function(){return"Negative size values should be exactly -1 but got "+u+" for the slice() size at index "+l+"."}),i.shape[l]-r[l])}),iR(i,r,o);var s=i.shape;return N.runKernelFunc(function(u){return u.slice(i,r,o)},{x:i},function(u){for(var l=[],c=0;c<u.rank;c++)l.push([r[c],s[c]-r[c]-o[c]]);return{x:function(){return u.pad(l)}}},"Slice",{begin:r,size:o})}}),E9=F({slice1d_:function(n,t,e){var r=S(n,"x","slice1d");return I(1===r.rank,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),pi(r,[t],[e])}}),D9=F({slice2d_:function(n,t,e){var r=S(n,"x","slice2d");return I(2===r.rank,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),pi(r,t,e)}}),kN=F({slice3d_:function(n,t,e){var r=S(n,"x","slice3d");return I(3===r.rank,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),pi(r,t,e)}}),S9=F({slice4d_:function(n,t,e){var r=S(n,"x","slice4d");return I(4===r.rank,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),pi(r,t,e)}});function RN(n,t,e,r,o){return t.rank<e.rank&&(t=t.reshape(br(t.shape,r))),n.rank<e.rank&&(n=n.reshape(br(n.shape,r))),{x:function(){var i=n.mul(e.equal(t).cast(n.dtype));return null==o?i:i.transpose(o)}}}var I9=F({all_:function(n,t,e){void 0===t&&(t=null),void 0===e&&(e=!1);var r=S(n,"x","all","bool"),o=gn(t,r.shape),i=o,s=Oo(i,r.rank);null!=s&&(r=r.transpose(s),i=Lo(i.length,r.rank));var a=N.runKernelFunc(function(l){return l.all(r,i)},{$x:r});if(e){var u=br(a.shape,o);return a.reshape(u)}return a}}),A9=F({any_:function(n,t,e){void 0===t&&(t=null),void 0===e&&(e=!1);var r=S(n,"x","any","bool"),o=gn(t,r.shape),i=o,s=Oo(i,r.rank);null!=s&&(r=r.transpose(s),i=Lo(i.length,r.rank));var a=N.runKernelFunc(function(l){return l.any(r,i)},{$x:r});if(e){var u=br(a.shape,o);return a.reshape(u)}return a}}),T9=F({argMax_:function(n,t){void 0===t&&(t=0);var e=S(n,"x","argMax");null==t&&(t=0);var r=gn(t,e.shape),o=Oo(r,e.rank);return null!=o&&(e=e.transpose(o),r=Lo(r.length,e.rank)),N.runKernelFunc(function(a,u){var l=a.argMax(e,r[0]);return u([e]),l},{x:e},function(a,u){var l=u[0];return{x:function(){return ut(l)}}},"ArgMax",{axis:r[0]},[e])}}),M9=F({argMin_:function(n,t){void 0===t&&(t=0);var e=S(n,"x","argMin");null==t&&(t=0);var r=gn(t,e.shape),o=Oo(r,e.rank);return null!=o&&(e=e.transpose(o),r=Lo(r.length,e.rank)),N.runKernelFunc(function(i,s){var a=i.argMin(e,r[0]);return s([e]),a},{$x:e},function(i,s){var a=s[0];return{$x:function(){return ut(a)}}})}}),k9=F({logSumExp_:function(n,t,e){void 0===t&&(t=null),void 0===e&&(e=!1);var r=S(n,"x","logSumExp"),o=gn(t,r.shape),i=r.max(o,!0),s=r.sub(i).exp().sum(o).log(),a=i.reshape(s.shape).add(s);if(e){var u=br(a.shape,o);return a.reshape(u)}return a}}),sm=F({max_:function(n,t,e){void 0===t&&(t=null),void 0===e&&(e=!1);var r=S(n,"x","max"),o=r,i=gn(t,r.shape),s=i,a=Oo(s,r.rank);null!=a&&(r=r.transpose(a),s=Lo(s.length,r.rank));var l=N.runKernelFunc(function(d,f){var h=d.max(r,s);return f([o,h]),h},{x:r},function(d,f){return RN(d,f[1],f[0],i,a)},"Max",{axes:s},[r],[!0]);if(e){var c=br(l.shape,i);l=l.reshape(c)}return l}}),R9=F({mean_:function(n,t,e){void 0===t&&(t=null),void 0===e&&(e=!1);var r=S(n,"x","mean"),o=gn(t,r.shape),i=me(jn(r.shape,o)[1]);return zg(function(s){var a=oe(i);return{value:(a.dtype===s.dtype?s:s.cast(a.dtype)).div(a).sum(t,e),gradFunc:function(u){var l=s.shape.slice();return o.forEach(function(c){l[c]=1}),u.reshape(l).mul(Ml(s.shape,"float32")).div(i)}}})(r)}}),N9=F({min_:function(n,t,e){void 0===t&&(t=null),void 0===e&&(e=!1);var r=S(n,"x","min"),o=r,i=gn(t,r.shape),s=i,a=Oo(s,r.rank);null!=a&&(r=r.transpose(a),s=Lo(s.length,r.rank));var l=N.runKernelFunc(function(d,f){var h=d.min(r,s);return f([o,h]),h},{x:r},function(d,f){return RN(d,f[1],f[0],i,a)},"Min",{axes:s},[r],[!0]);if(e){var c=br(l.shape,i);l=l.reshape(c)}return l}}),F9=F({moments_:function(n,t,e){void 0===t&&(t=null),void 0===e&&(e=!1);var r=gn(t,(n=S(n,"x","moments")).shape),o=n.mean(r,e),i=o.shape;e||(i=br(o.shape,r));var s=n.toFloat().sub(o.reshape(i)).square();return{mean:o,variance:s.mean(r,e)}}}),NN=F({sum_:function(n,t,e){void 0===t&&(t=null),void 0===e&&(e=!1);var r=S(n,"x","sum");"bool"===r.dtype&&(r=r.toInt());var o=gn(t,r.shape);return zg(function(i){var s=Oo(o,i.rank),a=o,u=i;null!=s&&(u=i.transpose(s),a=Lo(a.length,i.rank));var l=function(h){var p=i.shape.slice();return o.forEach(function(m){p[m]=1}),h.reshape(p).mul(Ml(i.shape,"float32"))},d=N.runKernelFunc(function(h){return h.sum(u,a)},{x:u},function(h){return{x:function(){return l(h)}}},"Sum",{axes:a});if(e){var f=br(d.shape,o);d=d.reshape(f)}return{value:d,gradFunc:l}})(r)}}),P9=F({prod_:function(n,t,e){void 0===t&&(t=null),void 0===e&&(e=!1);var r=S(n,"x","prod");"bool"===r.dtype&&(r=r.toInt());var o=gn(t,r.shape),i=Oo(o,r.rank),s=o,a=r;null!=i&&(a=r.transpose(i),s=Lo(s.length,r.rank));var u=N.runKernelFunc(function(c){return c.prod(a,s)},{permutedX:a});if(e){var l=br(u.shape,o);u=u.reshape(l)}return u}}),FN=F({elu_:function(n){var t=S(n,"x","elu");return N.runKernelFunc(function(e,r){var o=e.elu(t);return r([o]),o},{$x:t},function(e,r){var o=r[0];return{$x:function(){return N.runKernelFunc(function(i){return i.eluDer(e,o)},{dy:e,y:o})}}})}}),O9=F({leakyRelu_:function(n,t){void 0===t&&(t=.2);var e=S(n,"x","leakyRelu");return I_(oe(t).mul(e),e)}}),PN=F({prelu_:function(n,t){var e=S(n,"x","prelu"),r=S(t,"alpha","prelu");return N.runKernelFunc(function(o,i){var s=o.prelu(e,r);return i([e,r]),s},{x:e,alpha:r},function(o,i){var s=i[0],a=i[1],u=s.greater(0);return{x:function(){return nu(u,o,o.mul(a))},alpha:function(){var l=nu(u,ut(o),o.mul(s)),c=vn(a.shape,o.shape);return c.length>0&&(l=l.sum(c)),l.reshape(a.shape)}}},"Prelu")}}),$t=F({relu_:function(n){var t=S(n,"x","relu");return"bool"===t.dtype?t.toInt():N.runKernelFunc(function(e,r){var o=e.relu(t);return r([t]),o},{x:t},function(e,r){var o=r[0];return{x:function(){return e.mulStrict(o.step().toFloat())}}},"Relu")}}),ON=F({relu6_:function(n){var t=S(n,"x","relu6");return"bool"===t.dtype?t.toInt():N.runKernelFunc(function(e,r){var o=e.relu6(t);return r([t]),o},{x:t},function(e,r){var o=r[0],i=o.lessEqual(6).mul(o.step());return{x:function(){return e.mulStrict(i.toFloat())}}},"Relu6")}}),L9=F({selu_:function(n){var t=S(n,"x","selu");return N.runKernelFunc(function(e,r){var o=e.selu(t);return r([t]),o},{$x:t},function(e,r){var o=r[0];return{$x:function(){var i=o.greater(oe(0)),s=oe(1.7580993408473768),a=oe(1.0507009873554805),u=e.mul(a),l=e.mul(s).mul(o.toFloat().exp());return nu(i,u,l)}}})}}),sa=F({transpose_:function(n,t){var e=S(n,"x","transpose");return null==t&&(t=e.shape.map(function(o,i){return i}).reverse()),I(e.rank===t.length,function(){return"Error in transpose: rank of input "+e.rank+" must match length of perm "+t+"."}),t.forEach(function(o){I(o>=0&&o<e.rank,function(){return"All entries in 'perm' must be between 0 and "+(e.rank-1)+" but got "+t})}),e.rank<=1?e.clone():N.runKernelFunc(function(o){return o.transpose(e,t)},{x:e},function(o){var i=Og(t);return{x:function(){return o.transpose(i)}}},"Transpose",{perm:t})}}),B9=F({localResponseNormalization_:function(n,t,e,r,o){void 0===t&&(t=5),void 0===e&&(e=1),void 0===r&&(r=1),void 0===o&&(o=.5);var i=S(n,"x","localResponseNormalization");I(4===i.rank||3===i.rank,function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank "+i.rank+"."}),I(zt(t),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."});var s=i,a=!1;3===i.rank&&(a=!0,s=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var u=N.runKernelFunc(function(l,c){var d=l.localResponseNormalization4D(s,t,e,r,o);return c([s,d]),d},{x4D:s},function(l,c){var d=c[0],f=c[1];return{x4D:function(){return N.runKernelFunc(function(h){return h.LRNGrad(l,d,f,t,e,r,o)},{})}}});return a?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),LN=F({norm_:function(n,t,e,r){void 0===t&&(t="euclidean"),void 0===e&&(e=null),void 0===r&&(r=!1);var o=function a(u,l,c){if(void 0===c&&(c=null),0===u.rank)return u.abs();if(1!==u.rank&&null===c)return a(u.reshape([-1]),l,c);if(1===u.rank||"number"==typeof c||Array.isArray(c)&&1===c.length){if(1===l)return u.abs().sum(c);if(l===1/0)return u.abs().max(c);if(l===-1/0)return u.abs().min(c);if("euclidean"===l||2===l)return u.abs().pow(oe(2,"int32")).sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}if(Array.isArray(c)&&2===c.length){if(1===l)return u.abs().sum(c[0]).max(c[1]-1);if(l===1/0)return u.abs().sum(c[1]).max(c[0]);if(l===-1/0)return u.abs().sum(c[1]).min(c[0]);if("fro"===l||"euclidean"===l)return u.square().sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}throw new Error("Error in norm: invalid axis: "+c)}(n=S(n,"x","norm"),t,e),i=o.shape;if(r){var s=gn(e,n.shape);i=br(o.shape,s)}return o.reshape(i)}}),V9=F({basicLSTMCell_:function(n,t,e,r,o,i){var s=S(n,"forgetBias","basicLSTMCell"),a=S(t,"lstmKernel","basicLSTMCell"),u=S(e,"lstmBias","basicLSTMCell"),l=S(r,"data","basicLSTMCell"),c=S(o,"c","basicLSTMCell"),d=S(i,"h","basicLSTMCell"),f=l.concat(d,1).matMul(a).add(u),p=f.shape[1]/4,m=[f.shape[0],p],v=f.slice([0,0],m),y=f.slice([0,p],m),_=f.slice([0,2*p],m),b=f.slice([0,3*p],m),x=v.sigmoid().mulStrict(y.tanh()).addStrict(c.mulStrict(s.add(_).sigmoid())),E=x.tanh().mulStrict(b.sigmoid());return[x,E]}}),U9=F({multiRNNCell_:function(n,t,e,r){for(var o=S(t,"data","multiRNNCell"),i=ff(e,"c","multiRNNCell"),s=ff(r,"h","multiRNNCell"),a=o,u=[],l=0;l<n.length;l++){var c=n[l](a,i[l],s[l]);u.push(c[0]),u.push(c[1]),a=c[1]}var d=[],f=[];for(l=0;l<u.length;l+=2)d.push(u[l]),f.push(u[l+1]);return[d,f]}}),j9=F({movingAverage_:function(n,t,e,r,o){void 0===o&&(o=!0);var i=S(n,"v","movingAverage"),s=S(t,"x","movingAverage"),a=S(e,"decay","movingAverage");vk(i,s),I(pn(i.shape,s.shape),function(){return"Shape mismatch in v and x"});var u=oe(1),l=u.sub(a),c=s.sub(i).mul(l);if(o){I(null!=r,function(){return"When using zeroDebias: true, step is required."});var d=S(r,"step","movingAverage");c=c.div(u.sub(rm(a,d)))}return i.add(c)}}),H9=F({stridedSlice_:function(n,t,e,r,o,i,s,a,u){if(void 0===o&&(o=0),void 0===i&&(i=0),void 0===s&&(s=0),void 0===a&&(a=0),void 0===u&&(u=0),null==r&&(r=new Array(t.length)),0!==s)throw new Error("ellipsis mask is not yet supported");var l=S(n,"x","stridedSlice"),c=i_(a),d=l.shape.slice();c.forEach(function(v){t[v]=0,e[v]=1,d.splice(v,0,1)}),l=l.reshape(d);for(var f=0;f<l.rank;f++)t[f]=sR(o,t,r,l.shape,f),e[f]=aR(i,e,r,l.shape,f),r[f]=r[f]||1;var h=i_(u);h.forEach(function(v){e[v]=t[v]+1,r[v]=1});var p=Wg(t,e,r),m=p.filter(function(v,y){return-1===h.indexOf(y)});return r.every(function(v){return 1===v})?pi(l,t,p).reshape(m):N.runKernelFunc(function(v){return v.stridedSlice(l,t,e,r)},{$x:l}).reshape(m)}}),W9=F({topk_:function(n,t,e){void 0===t&&(t=1),void 0===e&&(e=!0);var r=S(n,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var o=r.shape[r.shape.length-1];if(t>o)throw new Error("'k' passed to topk() must be <= the last dimension ("+o+") but got "+t);var i=N.runKernelFunc(function(s){return s.topk(r,t,e)},{$x:r});return{values:i[0],indices:i[1]}}}),z9=F({scatterND_:function(n,t,e){var r=S(n,"indices","scatterND","int32"),o=S(t,"updates","scatterND");return oR(o,r,e),N.runKernelFunc(function(i){return i.scatterND(r,o,e)},{indices:r,updates:o},null,"ScatterNd",{shape:e})}}),R_=F({fft_:function(n){I("complex64"===n.dtype,function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+n.dtype+"."});var t=n.shape[n.shape.length-1],r=n.as2D(n.size/t,t);return N.runKernelFunc(function(o){return o.fft(r)},{input:n}).reshape(n.shape)}}),am=F({ifft_:function(n){I("complex64"===n.dtype,function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+n.dtype+"."});var t=n.shape[n.shape.length-1],r=n.as2D(n.size/t,t);return N.runKernelFunc(function(o){return o.ifft(r)},{input:n}).reshape(n.shape)}}),N_=F({rfft_:function(n,t){I("float32"===n.dtype,function(){return"The dtype for rfft() must be real value but got "+n.dtype});var e,r=n.shape[n.shape.length-1],o=n.size/r;if(null!=t&&t<r){var i=n.shape.map(function(y){return 0}),s=n.shape.map(function(y){return y});s[n.shape.length-1]=t,e=n.slice(i,s),r=t}else if(null!=t&&t>r){var a=n.shape.map(function(y){return y});a[n.shape.length-1]=t-r,e=n.concat(Ft(a),n.shape.length-1),r=t}else e=n;var u=e.zerosLike(),l=Hn(e,u).as2D(o,r),c=R_(l),d=Math.floor(r/2)+1,f=fo(c),h=fi(c),p=f.split([d,r-d],f.shape.length-1),m=h.split([d,r-d],h.shape.length-1),v=e.shape.slice();return v[e.shape.length-1]=d,Hn(p[0],m[0]).reshape(v)}}),BN=F({irfft_:function(n){var t=n.shape[n.shape.length-1],e=n.size/t;if(t<=2){var r=n.as2D(e,t),o=am(r);return fo(o)}var i=[e,2*(t-1)],s=fo(n).as2D(e,t),a=fi(n).as2D(e,t),u=s.slice([0,1],[e,t-2]).reverse(1),l=a.slice([0,1],[e,t-2]).reverse(1).mul(oe(-1)),c=s.concat(u,1),d=a.concat(l,1);return r=Hn(c,d).as2D(i[0],i[1]),o=am(r),fo(o)}}),$9=Object.freeze({fft:R_,ifft:am,rfft:N_,irfft:BN}),G9=F({sparseToDense_:function(n,t,e,r){void 0===r&&(r=0);var o=S(n,"sparseIndices","sparseToDense","int32"),i=S(t,"sparseValues","sparseToDense"),s=S(r,"defaultValue","sparseToDense",i.dtype);return function(a,u,l,c){if("int32"!==a.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+a.dtype+".");if(a.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+a.shape+".");var d=a.rank>0?a.shape[0]:1,f=a.rank>1?a.shape[1]:1;if(l.length!==f)throw new Error("outputShape has incorrect number of elements:, "+l.length+", should be: "+f+".");if(0!==u.rank&&(1!==u.rank||u.size!==d))throw new Error("sparseValues has incorrect shape "+u.shape+", should be [] or ["+d+"]");if(u.dtype!==c.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(o,i,e,s),N.runKernelFunc(function(a){return a.sparseToDense(o,i,e,s)},{$sparseIndices:o,$sparseValues:i,$defaultValue:s})}}),q9=F({gatherND_:function(n,t){var e=S(t,"indices","gatherND","int32"),r=S(n,"x","gatherND");return N.runKernelFunc(function(o){return o.gatherND(r,e)},{x:r,indices:e},null,"GatherNd")}}),K9=F({diag_:function(n){var t=S(n,"x","diag").flatten(),e=n.shape.concat(n.shape);return N.runKernelFunc(function(r){return r.diag(t)},{$x:t}).reshape(e)}}),X9=F({dropout_:function(n,t,e,r){var o=S(n,"x","dropout");if(I("float32"===o.dtype,function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+o.dtype+" tensor instead."}),I(t>=0&&t<1,function(){return"rate must be a float in the range [0, 1), but got "+t+"."}),0===t)return n instanceof It?o.clone():o;var i=function(u,l){if(null==l)return u.shape.slice();if(pn(u.shape,l))return l;if(u.shape.length===l.length){for(var c=[],d=0;d<u.shape.length;d++)c.push(null==l[d]&&null!=u.shape[d]?u.shape[d]:l[d]);return c}return l}(o,e),s=1-t,a=Zk(i,0,1,"float32",r).add(s).floor().div(s);return o.mul(a)}});function VN(n,t,e){for(var r=1-n%2,o=new Float32Array(n),i=0;i<n;++i){var s=2*Math.PI*i/(n+r-1);o[i]=t-e*Math.cos(s)}return mn(o,"float32")}var rr,F_=F({hannWindow_:function(n){return VN(n,.5,.5)}}),UN=F({hammingWindow_:function(n){return VN(n,.54,.46)}}),P_=F({frame_:function(n,t,e,r,o){void 0===r&&(r=!1),void 0===o&&(o=0);for(var i=0,s=[];i+t<=n.size;)s.push(pi(n,i,t)),i+=e;if(r)for(;i<n.size;){var a=i+t-n.size,u=Dn([pi(n,i,t-a),hi([a],o)]);s.push(u),i+=e}return 0===s.length?oa([],[0,t]):Dn(s).as2D(s.length,t)}}),jN=F({stft_:function(n,t,e,r,o){void 0===o&&(o=F_),null==r&&(r=Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2)))));for(var s=P_(n,t,e),a=nr(s,o(t)),u=[],l=0;l<s.shape[0];l++)u.push(N_(a.slice([l,0],[1,t]),r));return Dn(u)}}),Y9=Object.freeze({hannWindow:F_,hammingWindow:UN,frame:P_,stft:jN});!function(n){n[n.NONE=0]="NONE",n[n.MEAN=1]="MEAN",n[n.SUM=2]="SUM",n[n.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(rr||(rr={}));var Z9=F({absoluteDifference_:function(n,t,e,r){void 0===r&&(r=rr.SUM_BY_NONZERO_WEIGHTS);var o=S(n,"labels","absoluteDifference"),i=S(t,"predictions","absoluteDifference"),s=null;null!=e&&(s=S(e,"weights","absoluteDifference")),at(o.shape,i.shape,"Error in absoluteDifference: ");var a=o.sub(i).abs();return as(a,s,r)}}),as=F({computeWeightedLoss_:function(n,t,e){void 0===e&&(e=rr.SUM_BY_NONZERO_WEIGHTS);var r=S(n,"losses","computeWeightedLoss"),o=null;null!=t&&(o=S(t,"weights","computeWeightedLoss"));var i=null==o?r:r.mul(o);if(e===rr.NONE)return i;if(e===rr.SUM)return i.sum();if(e===rr.MEAN){if(null==o)return i.mean();var s=r.size/o.size,a=i.sum().div(o.sum());return s>1?a.div(oe(s)):a}if(e===rr.SUM_BY_NONZERO_WEIGHTS){if(null==o)return i.sum().div(oe(r.size));var u=o.mul(Ml(r.shape)).notEqual(oe(0)).sum().toFloat();return i.sum().div(u)}throw Error("Unknown reduction: "+e)}}),J9=F({cosineDistance_:function(n,t,e,r,o){void 0===o&&(o=rr.SUM_BY_NONZERO_WEIGHTS);var i=S(n,"labels","cosineDistance"),s=S(t,"predictions","cosineDistance"),a=null;null!=r&&(a=S(r,"weights","cosineDistance")),at(i.shape,s.shape,"Error in cosineDistance: ");var u=oe(1).sub(i.mul(s).sum(e,!0));return as(u,a,o)}}),eK=F({hingeLoss_:function(n,t,e,r){void 0===r&&(r=rr.SUM_BY_NONZERO_WEIGHTS);var o=S(n,"labels","hingeLoss"),i=S(t,"predictions","hingeLoss"),s=null;null!=e&&(s=S(e,"weights","hingeLoss")),at(o.shape,i.shape,"Error in hingeLoss: ");var a=oe(1);o=oe(2).mul(o).sub(a);var u=a.sub(o.mul(i)).relu();return as(u,s,r)}}),tK=F({huberLoss_:function(n,t,e,r,o){void 0===r&&(r=1),void 0===o&&(o=rr.SUM_BY_NONZERO_WEIGHTS);var i=S(n,"labels","huberLoss"),s=S(t,"predictions","huberLoss"),a=null;null!=e&&(a=S(e,"weights","huberLoss")),at(i.shape,s.shape,"Error in huberLoss: ");var u=oe(r),l=s.sub(i).abs(),c=yN(l,u),d=l.sub(c),f=oe(.5).mul(c.square()).add(u.mul(d));return as(f,a,o)}}),nK=F({logLoss_:function(n,t,e,r,o){void 0===r&&(r=1e-7),void 0===o&&(o=rr.SUM_BY_NONZERO_WEIGHTS);var i=S(n,"labels","logLoss"),s=S(t,"predictions","logLoss"),a=null;null!=e&&(a=S(e,"weights","logLoss")),at(i.shape,s.shape,"Error in logLoss: ");var u=oe(1),l=oe(r),c=i.mul(s.add(l).log()).neg().sub(u.sub(i).mul(u.sub(s).add(l).log()));return as(c,a,o)}}),rK=F({meanSquaredError_:function(n,t,e,r){void 0===r&&(r=rr.SUM_BY_NONZERO_WEIGHTS);var o=S(n,"labels","meanSquaredError"),i=S(t,"predictions","meanSquaredError"),s=null;null!=e&&(s=S(e,"weights","meanSquaredError")),at(o.shape,i.shape,"Error in meanSquaredError: ");var a=o.squaredDifference(i);return as(a,s,r)}}),oK=F({sigmoidCrossEntropy_:function(n,t,e,r,o){void 0===r&&(r=0),void 0===o&&(o=rr.SUM_BY_NONZERO_WEIGHTS);var i=S(n,"multiClassLabels","sigmoidCrossEntropy"),s=S(t,"logits","sigmoidCrossEntropy"),a=null;if(null!=e&&(a=S(e,"weights","sigmoidCrossEntropy")),at(i.shape,s.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=oe(r),l=oe(1),c=oe(.5);i=i.mul(l.sub(u)).add(c.mul(u))}var d=function(f,h){var p=S(f,"labels","sigmoidCrossEntropyWithLogits"),m=S(h,"logits","sigmoidCrossEntropyWithLogits");at(p.shape,m.shape,"Error in sigmoidCrossEntropyWithLogits: ");var v=m.relu(),y=m.mul(p),_=m.abs().neg().exp().log1p();return v.sub(y).add(_)}(i,s);return as(d,a,o)}}),iK=F({softmaxCrossEntropy_:function(n,t,e,r,o){void 0===r&&(r=0),void 0===o&&(o=rr.SUM_BY_NONZERO_WEIGHTS);var i=S(n,"onehotLabels","softmaxCrossEntropy"),s=S(t,"logits","softmaxCrossEntropy"),a=null;if(null!=e&&(a=S(e,"weights","softmaxCrossEntropy")),at(i.shape,s.shape,"Error in softmaxCrossEntropy: "),r>0){var u=oe(r),l=oe(1),c=oe(i.shape[1]);i=i.mul(l.sub(u)).add(u.div(c))}var d=function(f,h,p){if(void 0===p&&(p=-1),-1===p&&(p=h.rank-1),p!==h.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+h.rank+" and dim was "+p);return zg(function(m,v,y){var _=v.logSumExp([p],!0),b=v.toFloat().sub(_);return y([m,b]),{value:b.mul(m).neg().sum([p]),gradFunc:function(x,E){var D=E[0],k=E[1],R=br(x.shape,[p]);return[x.reshape(R).mul(D.toFloat().sub(k.exp())),x.reshape(R).mul(k.exp().sub(D.toFloat()))]}}})(f,h)}(i,s);return as(d,a,o)}}),sK=Object.freeze({get Reduction(){return rr},absoluteDifference:Z9,computeWeightedLoss:as,cosineDistance:J9,hingeLoss:eK,huberLoss:tK,logLoss:nK,meanSquaredError:rK,sigmoidCrossEntropy:oK,softmaxCrossEntropy:iK});function HN(n,t){return void 0===t&&(t=!1),N.tidy(function(){if(2!==n.shape.length)throw new Error("qr2d() requires a 2D Tensor, but got a "+n.shape.length+"D Tensor.");for(var e=n.shape[0],r=n.shape[1],o=Qk(e),i=n.clone(),s=oa([[1]],[1,1]),a=s.clone(),u=e>=r?r:e,l=function(d){var f,h=i,p=a,m=o;f=N.tidy(function(){var v=i.slice([d,d],[e-d,1]),y=v.norm(),_=i.slice([d,d],[1,1]),b=oa([[-1]]).where(_.greater(0),oa([[1]])),x=_.sub(b.mul(y)),E=v.div(x);a=1===E.shape[0]?s.clone():s.concat(E.slice([1,0],[E.shape[0]-1,E.shape[1]]),0);var D=b.matMul(x).div(y).neg(),k=i.slice([d,0],[e-d,r]),R=D.mul(a);if(0===d)i=k.sub(R.matMul(a.transpose().matMul(k)));else{var A=k.sub(R.matMul(a.transpose().matMul(k)));i=i.slice([0,0],[d,r]).concat(A,0)}var M=o.slice([0,d],[e,o.shape[1]-d]);if(0===d)o=M.sub(M.matMul(a).matMul(R.transpose()));else{var O=M.sub(M.matMul(a).matMul(R.transpose()));o=o.slice([0,0],[e,d]).concat(O,1)}return[a,i,o]}),a=f[0],i=f[1],o=f[2],Mr([h,p,m])},c=0;c<u;++c)l(c);return!t&&e>r&&(o=o.slice([0,0],[e,r]),i=i.slice([0,0],[r,r])),[o,i]})}var aK=F({bandPart_:function(n,t,e){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(e%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+e+".");var r=S(n,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var o=r.shape,i=r.shape.slice(-2),s=i[0],a=i[1];if(!(t<=s))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+s+").");if(!(e<=a))throw new Error("bandPart(): numUpper ("+e+") must not be greater than the number of columns ("+a+").");t<0&&(t=s),e<0&&(e=a);var u=Lg(0,s,1,"int32").reshape([-1,1]),l=Lg(0,a,1,"int32"),c=In(u,l),d=nm(c.lessEqual(oe(+t,"int32")),c.greaterEqual(oe(-e,"int32"))),f=Ft([s,a],r.dtype);return qr(Sn(r.reshape([-1,s,a])).map(function(h){return nu(d,h,f)})).reshape(o)}}),uK=F({gramSchmidt_:function(n){var t;if(Array.isArray(n)){t=!1,I(null!=n&&n.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var e=n[0].shape[0],r=function(u){I(n[u].shape[0]===e,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+n[u].shape[0]+" vs. "+e+")"})},o=1;o<n.length;++o)r(o)}else t=!0,n=e_(n,n.shape[0],0).map(function(u){return eR(u,[0])});I(n.length<=n[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+n.length+") exceeds number of dimensions ("+n[0].shape[0]+")."});var i=[],s=n,a=function(u){i.push(N.tidy(function(){var l=s[u];if(u>0)for(var c=0;c<u;++c){var d=NN(i[c].mulStrict(l)).mul(i[c]);l=l.sub(d)}return l.div(LN(l,"euclidean"))}))};for(o=0;o<n.length;++o)a(o);return t?qr(i,0):i}}),lK=F({qr_:function(n,t){if(void 0===t&&(t=!1),n.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+n.rank);if(2===n.rank)return HN(n,t);var e=n.shape.slice(0,n.shape.length-2).reduce(function(s,a){return s*a}),r=Sn(n.reshape([e,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),o=[],i=[];return r.forEach(function(s){var a=HN(s,t),l=a[1];o.push(a[0]),i.push(l)}),[qr(o,0).reshape(n.shape),qr(i,0).reshape(n.shape)]}}),cK=Object.freeze({bandPart:aK,gramSchmidt:uK,qr:lK});function um(n,t,e,r,o,i){null==r&&(r=.5),null==o&&(o=Number.NEGATIVE_INFINITY),null==i&&(i=0);var s=n.shape[0];return e=Math.min(e,s),I(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),I(2===n.rank,function(){return"boxes must be a 2D tensor, but was of rank '"+n.rank+"'"}),I(4===n.shape[1],function(){return"boxes must have 4 columns, but 2nd dimension was "+n.shape[1]}),I(1===t.rank,function(){return"scores must be a 1D tensor"}),I(t.shape[0]===s,function(){return"scores has incompatible shape with boxes. Expected "+s+", but was "+t.shape[0]}),I(0<=i&&i<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+i+"'"}),{maxOutputSize:e,iouThreshold:r,scoreThreshold:o,softNmsSigma:i}}var dK=F({resizeBilinear_:function(n,t,e){void 0===e&&(e=!1);var r=S(n,"images","resizeBilinear");I(3===r.rank||4===r.rank,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),I(2===t.length,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."});var o=r,i=!1;3===r.rank&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var s=t[0],a=t[1],u=N.runKernelFunc(function(l,c){return c([o]),l.resizeBilinear(o,s,a,e)},{x:o},function(l,c){return{x:function(){return N.runKernelFunc(function(d){return d.resizeBilinearBackprop(l,c[0],e)},{})}}},"ResizeBilinear",{alignCorners:e,newHeight:s,newWidth:a});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),fK=F({resizeNearestNeighbor_:function(n,t,e){void 0===e&&(e=!1);var r=S(n,"images","resizeNearestNeighbor");I(3===r.rank||4===r.rank,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),I(2===t.length,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."}),I("float32"===r.dtype||"int32"===r.dtype,function(){return"`images` must have `int32` or `float32` as dtype"});var o=r,i=!1;3===r.rank&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var s=t[0],a=t[1],u=N.runKernelFunc(function(l,c){return c([o]),l.resizeNearestNeighbor(o,s,a,e)},{batchImages:o},function(l,c){return{batchImages:function(){return N.runKernelFunc(function(d){return d.resizeNearestNeighborBackprop(l,c[0],e)},{})}}});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),hK=F({nonMaxSuppression_:function(n,t,e,r,o){void 0===r&&(r=.5),void 0===o&&(o=Number.NEGATIVE_INFINITY);var i=S(n,"boxes","nonMaxSuppression"),s=S(t,"scores","nonMaxSuppression"),a=um(i,s,e,r,o);return N.runKernelFunc(function(l){return l.nonMaxSuppression(i,s,e,r,o)},{boxes:i,scores:s},null,"NonMaxSuppressionV3",{maxOutputSize:e=a.maxOutputSize,iouThreshold:r=a.iouThreshold,scoreThreshold:o=a.scoreThreshold})}}),gK=F({nonMaxSuppressionWithScore_:function(n,t,e,r,o,i){void 0===r&&(r=.5),void 0===o&&(o=Number.NEGATIVE_INFINITY),void 0===i&&(i=0);var s=S(n,"boxes","nonMaxSuppression"),a=S(t,"scores","nonMaxSuppression"),u=um(s,a,e,r,o,i),l={maxOutputSize:e=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:o=u.scoreThreshold,softNmsSigma:i=u.softNmsSigma},c=N.runKernel("NonMaxSuppressionV5",{boxes:s,scores:a},l);return{selectedIndices:c[0],selectedScores:c[1]}}}),vK=F({cropAndResize_:function(n,t,e,r,o,i){var s=S(n,"image","cropAndResize"),a=S(t,"boxes","cropAndResize","float32"),u=S(e,"boxInd","cropAndResize","int32");o=o||"bilinear",i=i||0;var l=a.shape[0];return I(4===s.rank,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+s.rank+"."}),I(2===a.rank&&4===a.shape[1],function(){return"Error in cropAndResize: boxes must be have size ["+l+",4] but had shape "+a.shape+"."}),I(1===u.rank&&u.shape[0]===l,function(){return"Error in cropAndResize: boxInd must be have size ["+l+"] but had shape "+a.shape+"."}),I(2===r.length,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),I(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),I("bilinear"===o||"nearest"===o,function(){return"method must be bilinear or nearest, but was "+o}),N.runKernelFunc(function(c,d){return c.cropAndResize(s,a,u,r,o,i)},{images:s,boxes:a,boxInd:u},null,"CropAndResize",{method:o,extrapolationValue:i,cropSize:r})}}),O_=Object.freeze({resizeBilinear:dK,resizeNearestNeighbor:fK,nonMaxSuppression:hK,nonMaxSuppressionAsync:function(n,t,e,r,o){return void 0===r&&(r=.5),void 0===o&&(o=Number.NEGATIVE_INFINITY),he(this,void 0,void 0,function(){var i,s,a,u,d;return pe(this,function(f){switch(f.label){case 0:return i=S(n,"boxes","nonMaxSuppressionAsync"),s=S(t,"scores","nonMaxSuppressionAsync"),a=um(i,s,e,r,o),e=a.maxOutputSize,r=a.iouThreshold,o=a.scoreThreshold,[4,Promise.all([i.data(),s.data()])];case 1:return u=f.sent(),d=h_(u[0],u[1],e,r,o),i!==n&&i.dispose(),s!==t&&s.dispose(),[2,d]}})})},nonMaxSuppressionWithScore:gK,nonMaxSuppressionWithScoreAsync:function(n,t,e,r,o,i){return void 0===r&&(r=.5),void 0===o&&(o=Number.NEGATIVE_INFINITY),void 0===i&&(i=0),he(this,void 0,void 0,function(){var s,a,u,l,f;return pe(this,function(h){switch(h.label){case 0:return s=S(n,"boxes","nonMaxSuppressionAsync"),a=S(t,"scores","nonMaxSuppressionAsync"),u=um(s,a,e,r,o,i),e=u.maxOutputSize,r=u.iouThreshold,o=u.scoreThreshold,i=u.softNmsSigma,[4,Promise.all([s.data(),a.data()])];case 1:return l=h.sent(),f=p_(l[0],l[1],e,r,o,i),s!==n&&s.dispose(),a!==t&&a.dispose(),[2,f]}})})},cropAndResize:vK}),L_=function(n,t){return!(n>0)||"linear"===t},B_=function(n,t,e){if(null==e||"linear"===e)return n;if("relu"===e)return n.mul(t.step());throw new Error("Gradient for activation "+e+" has not been implemented yet.")},V_=function(n,t){var e=t,r=vn(n.shape,t.shape);return r.length>0&&(e=e.sum(r)),e.reshape(n.shape)},U_=function(n,t,e){if("linear"===t)return n;if("relu"===t)return $t(n);if("elu"===t)return FN(n);if("relu6"===t)return ON(n);if("prelu"===t)return PN(n,e);throw new Error("Unknown fused activation "+t+".")},yK=F({fusedMatMul_:function(n){var t,e=n.a,r=n.b,o=n.transposeA,i=void 0!==o&&o,s=n.transposeB,a=void 0!==s&&s,u=n.bias,l=n.activation,c=void 0===l?"linear":l,d=n.preluActivationWeights;if(!1===L_(N.state.gradientDepth,c)){var f=im(e,r,i,a);return null!=u&&(f=Je(f,u)),U_(f,c,d)}var h=S(e,"a","fused matMul"),p=S(r,"b","fused matMul");t=Bt(h,p),h=t[0],p=t[1];var m=i?h.shape[h.rank-2]:h.shape[h.rank-1],v=a?p.shape[p.rank-1]:p.shape[p.rank-2],y=i?h.shape[h.rank-1]:h.shape[h.rank-2],_=a?p.shape[p.rank-2]:p.shape[p.rank-1],b=h.shape.slice(0,-2),x=p.shape.slice(0,-2),E=me(b),D=me(x);I(h.rank>=2&&p.rank>=2&&h.rank===p.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+h.rank+" and "+p.rank+"."}),I(pn(b,x),function(){return"Error in fused matMul: outer dimensions ("+b+") and ("+x+") of Tensors with shapes "+h.shape+" and "+p.shape+" must match."}),I(m===v,function(){return"Error in fused matMul: inner shapes ("+m+") and ("+v+") of Tensors with shapes "+h.shape+" and "+p.shape+" and transposeA="+i+" and transposeB="+a+" must match."});var k,R,A=h.shape.slice(0,-2).concat([y,_]),M=i?h.as3D(E,m,y):h.as3D(E,y,m),O=a?p.as3D(D,_,v):p.as3D(D,v,_);null!=u&&Ze(A,(k=Bt(k=S(u,"bias","fused matMul"),h)[0]).shape),null!=d&&(R=S(d,"prelu weights","fused matMul"));var P={a:M,b:O};return null!=u&&(P.bias=k),null!=d&&(P.preluActivationWeights=R),N.runKernelFunc(function(q,K){var L=q.fusedBatchMatMul({a:M,b:O,transposeA:i,transposeB:a,bias:k,activation:c,preluActivationWeights:R});return K([M,O,L]),L},P,function(q,K){var L=K[0],V=K[1],z=B_(q,K[2],c),Y={};return null!=u&&(Y={bias:function(){return V_(k,z)}}),Object.assign(i||a?!i&&a?{a:function(){return z.matMul(V,!1,!1)},b:function(){return z.matMul(L,!0,!1)}}:i&&!a?{a:function(){return V.matMul(z,!1,!0)},b:function(){return L.matMul(z,!1,!1)}}:{a:function(){return V.matMul(z,!0,!0)},b:function(){return z.matMul(L,!0,!0)}}:{a:function(){return z.matMul(V,!1,!0)},b:function(){return L.matMul(z,!0,!1)}},Y)},"_FusedMatMul",{transposeA:i,transposeB:a,activation:c},[M,O],[!0]).reshape(A)}}),wK=F({fusedConv2d_:function(n){var t=n.x,e=n.filter,r=n.strides,o=n.pad,i=n.dataFormat,s=void 0===i?"NHWC":i,a=n.dilations,u=void 0===a?[1,1]:a,l=n.dimRoundingMode,c=n.bias,d=n.activation,f=void 0===d?"linear":d,h=n.preluActivationWeights;if(!1===L_(N.state.gradientDepth,f=f||"linear")){var p=po(t,e,r,o,s,u,l);return null!=c&&(p=Je(p,c)),U_(p,f,h)}var m=S(t,"x","conv2d"),v=S(e,"filter","conv2d"),y=m,_=!1;3===m.rank&&(_=!0,y=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),I(4===y.rank,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+y.rank+"."}),I(4===v.rank,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+v.rank+"."}),null!=l&&I(zt(o),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+l+" but got pad "+o+"."}),I(y.shape[3]===v.shape[2],function(){return"Error in conv2d: depth of input ("+y.shape[3]+") must match input depth for filter "+v.shape[2]+"."}),I(_r(r,u),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),I("NHWC"===s,function(){return"Error in conv2d: got dataFormat of "+s+" but only NHWC is currently supported."});var b,x,E=ia(y.shape,v.shape,r,u,o,l);null!=c&&(b=Bt(b=S(c,"bias","fused conv2d"),m)[0],Ze(E.outShape,b.shape)),null!=h&&(x=S(h,"prelu weights","fused conv2d"));var D={x:y,filter:v};null!=c&&(D.bias=b),null!=h&&(D.preluActivationWeights=x);var R=N.runKernelFunc(function(A,M){var O=A.fusedConv2d({input:y,filter:v,convInfo:E,bias:b,activation:f,preluActivationWeights:x});return M([v,y,O]),O},D,function(A,M){var P=M[0],G=M[1],K=B_(A,M[2],f);I(Ja(u),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"});var L={};return null!=c&&(L={bias:function(){return V_(b,K)}}),Object.assign({x:function(){return SN(G.shape,K,P,r,o)},filter:function(){return M_(G,K,P.shape,r,o)}},L)},"FusedConv2D",{convInfo:E,activation:f},[v,y],[!0]);return _?R.as3D(R.shape[1],R.shape[2],R.shape[3]):R}}),bK=F({fusedDepthwiseConv2d_:function(n){var t=n.x,e=n.filter,r=n.strides,o=n.pad,i=n.dataFormat,s=void 0===i?"NHWC":i,a=n.dilations,u=void 0===a?[1,1]:a,l=n.dimRoundingMode,c=n.bias,d=n.activation,f=void 0===d?"linear":d,h=n.preluActivationWeights;if(!1===L_(N.state.gradientDepth,f)){var p=om(t,e,r,o,s,u,l);return null!=c&&(p=Je(p,c)),U_(p,f,h)}var m=S(t,"x","depthwiseConv2d"),v=S(e,"filter","depthwiseConv2d"),y=m,_=!1;3===m.rank&&(_=!0,y=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),I(4===y.rank,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+y.rank+"."}),I(4===v.rank,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+v.rank+"."}),I(y.shape[3]===v.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+y.shape[3]+") must match the inChannels dimension in filter "+v.shape[2]+"."}),null==u&&(u=[1,1]),I(_r(r,u),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),null!=l&&I(zt(o),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+l+" but got pad "+o+"."});var b,x,E=ia(y.shape,v.shape,r,u,o,l,!0);null!=c&&(b=Bt(b=S(c,"bias","fused conv2d"),m)[0],Ze(E.outShape,b.shape)),null!=h&&(x=S(h,"prelu weights","fused depthwiseConv2d"));var D={x:y,filter:v};null!=c&&(D.bias=b),null!=h&&(D.preluActivationWeights=x);var R=N.runKernelFunc(function(A,M){var O=A.fusedDepthwiseConv2D({input:y,filter:v,convInfo:E,bias:b,activation:f,preluActivationWeights:x});return M([v,y,O]),O},D,function(A,M){I(Ja(u),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"});var O=M[0],P=M[1],q=B_(A,M[2],f),K={};return null!=c&&(K={bias:function(){return V_(b,q)}}),Object.assign({x:function(){return IN(P.shape,q,O,E)},filter:function(){return AN(P,q,O.shape,E)}},K)},"FusedDepthwiseConv2D",{convInfo:E,activation:f},[v,y],[!0]);return _?R.as3D(R.shape[1],R.shape[2],R.shape[3]):R}}),_K=Object.freeze({matMul:yK,conv2d:wK,depthwiseConv2d:bK}),xK=Object.freeze({image:O_,linalg:cK,losses:sK,spectral:$9,fused:_K,signal:Y9,square:n7,squaredDifference:uN,conv1d:d9,conv2d:po,conv3d:f9,depthwiseConv2d:om,separableConv2d:k_,conv2dTranspose:h9,conv3dTranspose:p9,op:F,batchNormalization2d:R7,batchNormalization3d:N7,batchNormalization4d:F7,batchNormalization:P7,batchNorm:pN,batchNorm2d:O7,batchNorm3d:L7,batchNorm4d:B7,booleanMaskAsync:function(n,t,e){return he(this,void 0,void 0,function(){var r,o,i,s,a,u,l,c,d,f,h,p,m;return pe(this,function(v){switch(v.label){case 0:for(r=S(n,"tensor","boolMask"),o=S(t,"mask","boolMask","bool"),i=e??0,a=r.shape,I((s=o.rank)>0,function(){return"mask cannot be scalar"}),at(a.slice(i,i+s),o.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,l=i;l<i+s;l++)u*=a[l];return c=a.slice(0,i).concat([u],a.slice(i+s)),d=r.reshape(c),f=o.reshape([-1]),[4,mN(f)];case 1:return h=v.sent(),p=h.squeeze([1]),m=A_(d,p,i),n!==r&&r.dispose(),t!==o&&o.dispose(),p.dispose(),d.dispose(),f.dispose(),h.dispose(),[2,m]}})})},complex:Hn,real:fo,imag:fi,concat:Dn,concat1d:WG,concat2d:zG,concat3d:$G,concat4d:GG,split:e_,matMul:im,dot:g9,outerProduct:m9,reverse:_f,reverse1d:v9,reverse2d:y9,reverse3d:w9,reverse4d:b9,maxPool:Rn,avgPool:xf,pool:_9,maxPool3d:x9,avgPool3d:C9,slice:pi,slice1d:E9,slice2d:D9,slice3d:kN,slice4d:S9,abs:r7,acos:o7,acosh:i7,asin:s7,asinh:a7,atan:u7,atanh:l7,ceil:c7,clipByValue:D_,cos:d7,cosh:f7,erf:h7,exp:S_,expm1:p7,floor:g7,log:m7,log1p:v7,logSigmoid:y7,neg:Jg,reciprocal:w7,round:b7,rsqrt:lN,sigmoid:cN,sign:_7,isNaN:x7,isInf:C7,isFinite:E7,sin:D7,sinh:S7,softplus:I7,sqrt:A7,step:T7,tan:M7,tanh:k7,all:I9,any:A9,argMax:T9,argMin:M9,logSumExp:k9,max:sm,mean:R9,min:N9,moments:F9,sum:NN,prod:P9,equal:wN,equalStrict:e9,greater:t9,greaterEqual:bN,greaterEqualStrict:n9,greaterStrict:r9,less:o9,lessEqual:i9,lessEqualStrict:s9,lessStrict:a9,notEqual:u9,notEqualStrict:l9,add:Je,addN:j7,addStrict:H7,atan2:W7,div:Uo,divNoNan:z7,divStrict:$7,floorDiv:vN,maximum:I_,maximumStrict:G7,minimum:yN,minimumStrict:q7,mod:K7,modStrict:X7,mul:nr,mulStrict:Y7,pow:rm,powStrict:Q7,squaredDifferenceStrict:Z7,sub:In,subStrict:J7,elu:FN,leakyRelu:O9,prelu:PN,relu:$t,relu6:ON,selu:L9,logicalAnd:nm,logicalNot:V7,logicalOr:gN,logicalXor:U7,where:nu,whereAsync:mN,buffer:Ue,print:function t8(n,t){void 0===t&&(t=!1),console.log(n.toString(t))},batchToSpaceND:Yk,broadcastTo:n8,cast:r8,clone:o8,cumsum:i8,depthToSpace:s8,expandDims:ho,eye:Qk,multinomial:a8,oneHot:n_,pad:Za,pad1d:u8,pad2d:l8,pad3d:c8,pad4d:d8,rand:f8,randomNormal:h8,randomGamma:p8,randomUniform:Zk,reshape:Bo,spaceToBatchND:Jk,squeeze:eR,stack:qr,tile:kl,truncatedNormal:g8,unstack:Sn,setdiff1dAsync:function(n,t){return he(this,void 0,void 0,function(){var e,r,o,i,s,a,u,l,c,d;return pe(this,function(f){switch(f.label){case 0:return e=S(n,"x","setdiff1d"),r=S(t,"y","setdiff1d"),I(e.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+e.dtype+") and y ("+r.dtype+")."}),I(1===e.rank,function(){return"x should be 1D tensor, but got x ("+e.shape+")."}),I(1===r.rank,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,e.data()];case 1:return o=f.sent(),[4,r.data()];case 2:for(i=f.sent(),s=new Set(i),a=0,c=0;c<o.length;c++)s.has(o[c])||a++;for(u=new tf([a],e.dtype),l=new tf([a],"int32"),c=0,d=0;c<o.length;c++)s.has(o[c])||(u.values[d]=o[c],l.values[d]=c,d++);return[2,[u.toTensor(),l.toTensor()]]}})})},fill:hi,linspace:function HG(n,t,e){if(e<=0)throw new Error("The number of values should be positive.");return N.runKernelFunc(function(r){return r.linspace(n,t,e)},{})},ones:Ml,range:Lg,scalar:oe,tensor:Wn,tensor1d:mn,tensor2d:oa,tensor3d:J0,tensor4d:Rr,tensor5d:function VG(n,t,e){if(Ga(n),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");var r=di(n,e);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return ra(n,t,r,e)},tensor6d:function UG(n,t,e){if(Ga(n),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");var r=di(n,e);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return ra(n,t=t||r,r,e)},variable:function jG(n,t,e,r){return void 0===t&&(t=!0),N.makeVariable(n,t,e,r)},zeros:Ft,onesLike:Xk,zerosLike:ut,transpose:sa,softmax:os,logSoftmax:y8,localResponseNormalization:B9,norm:LN,gather:A_,unsortedSegmentSum:CN,basicLSTMCell:V9,multiRNNCell:U9,movingAverage:j9,stridedSlice:H9,topk:W9,scatterND:z9,fft:R_,ifft:am,rfft:N_,irfft:BN,sparseToDense:G9,gatherND:q9,diag:K9,dropout:X9,hannWindow:F_,hammingWindow:UN,frame:P_,stft:jN,inTopKAsync:function(n,t,e){return void 0===e&&(e=1),he(this,void 0,void 0,function(){var r,o,i,s,a,u,l,c,d,f,h,p,m,v;return pe(this,function(y){switch(y.label){case 0:return r=S(n,"predictions","inTopK"),o=S(t,"targets","inTopK"),I(r.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank}),I(r.rank-1===o.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+o.rank}),at(r.shape.slice(0,r.shape.length-1),o.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=r.shape[r.shape.length-1],I(e>0&&e<=i,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+e}),[4,r.data()];case 1:return s=y.sent(),[4,o.data()];case 2:for(a=y.sent(),c=(u=[s.length/i,i])[1],d=Sl("bool",l=u[0]),f=0;f<l;f++){for(p=s.subarray(h=f*c,h+c),m=[],v=0;v<p.length;v++)m.push({value:p[v],index:v});for(m.sort(function(_,b){return b.value-_.value}),d[f]=0,v=0;v<e;v++)if(m[v].index===a[f]){d[f]=1;break}}return n!==r&&r.dispose(),t!==o&&o.dispose(),[2,Wn(d,o.shape,"bool")]}})})}});function J(n,t){Array.isArray(n)||(n=[n]),n.forEach(function(e){null!=e&&I("complex64"!==e.dtype,function(){return t+" does not support complex64 tensors."})})}function j_(n,t,e,r){if("linear"===e)return n.linear(t);if("relu"===e)return n.relu(t);if("elu"===e)return n.elu(t);if("relu6"===e)return n.relu6(t);if("prelu"===e)return n.prelu(t,r);throw new Error("Activation "+e+" has not been implemented for the CPU backend.")}var CK=function(n){function t(){var e=n.call(this)||this;return e.blockSize=48,e.firstUse=!0,e.data=new uR(e,N),e}return No(t,n),t.prototype.write=function(e,r,o){this.firstUse&&(this.firstUse=!1,$().get("IS_NODE")&&Pg("\n============================\nHi there \u{1f44b}. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================"));var i={};return this.data.set(i,{values:e,dtype:o}),i},t.prototype.move=function(e,r,o,i){this.data.set(e,{values:r,dtype:i})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(e){return he(this,void 0,void 0,function(){return pe(this,function(r){return[2,this.readSync(e)]})})},t.prototype.readSync=function(e){var r=this.data.get(e),i=r.complexTensors;return"complex64"===r.dtype?f_(this.readSync(i.real.dataId),this.readSync(i.imag.dataId)):this.data.get(e).values},t.prototype.bufferSync=function(e){var r=this.readSync(e.dataId),o=r;if("string"===e.dtype)try{o=r.map(function(i){return Qd(i)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Ue(e.shape,e.dtype,o)},t.prototype.makeOutput=function(e,r,o){var i=this.write(e,r,o);return N.makeTensorFromDataId(i,r,o,this)},t.prototype.disposeData=function(e){if(this.data.has(e)){var r=this.data.get(e).complexTensors;null!=r&&(r.real.dispose(),r.imag.dispose()),this.data.delete(e)}},t.prototype.time=function(e){return he(this,void 0,void 0,function(){var r;return pe(this,function(o){return r=Po(),e(),[2,{kernelMs:Po()-r}]})})},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(e,r){var o=this.makeOutput(null,e.shape,"complex64");return this.data.get(o.dataId).complexTensors={real:N.keep(e.clone()),imag:N.keep(r.clone())},o},t.prototype.real=function(e){return this.data.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.data.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,r,o){if(J(e,"slice"),s_(e.shape,r,o)){var i=a_(r,e.strides),s=me(o);return Wn(this.readSync(e.dataId).subarray(i,i+s),o,e.dtype)}for(var a=Ue(o,e.dtype),u=this.bufferSync(e),l=0;l<a.size;++l){var c=a.indexToLoc(l).map(function(d,f){return d+r[f]});a.values[l]=u.get.apply(u,c)}return a.toTensor()},t.prototype.stridedSlice=function(e,r,o,i){J(e,"stridedSlice");var s=Wg(r,o,i);if(s.some(function(h){return 0===h}))return Wn([],s);for(var a=Ue(s,e.dtype),u=this.bufferSync(e),l=0;l<a.size;l++){for(var c=a.indexToLoc(l),d=new Array(c.length),f=0;f<d.length;f++)d[f]=c[f]*i[f]+r[f];a.set.apply(a,[u.get.apply(u,d)].concat(c))}return a.toTensor()},t.prototype.diag=function(e){for(var r=this.readSync(e.dataId),o=Ue([e.size,e.size],e.dtype),i=o.values,s=0;s<r.length;s++)i[s*e.size+s]=r[s];return o.toTensor()},t.prototype.unstack=function(e,r){for(var o=e.shape[r],i=new Array(e.rank-1),s=0,a=0;a<e.rank;a++)a!==r&&(i[s++]=e.shape[a]);var u=new Array(e.rank).fill(0),l=e.shape.slice();l[r]=1;var c=new Array(o);for(a=0;a<c.length;a++)u[r]=a,c[a]=this.slice(e,u,l).reshape(i);return c},t.prototype.reverse=function(e,r){J(e,"reverse");for(var o=Ue(e.shape,e.dtype),i=this.bufferSync(e),s=function(u){var l=o.indexToLoc(u),c=l.slice();r.forEach(function(d){return c[d]=e.shape[d]-1-c[d]}),o.set.apply(o,[i.get.apply(i,c)].concat(l))},a=0;a<o.size;a++)s(a);return o.toTensor()},t.prototype.concat=function(e,r){var o=this;if("complex64"===e[0].dtype){var i=e.map(function(h){return fo(h)}),s=e.map(function(h){return fi(h)});return Hn(this.concat(i,r),this.concat(s,r))}var a=e.map(function(h){var p=me(h.shape.slice(r));return h.as2D(-1,p)}),u=Xa(a.map(function(h){return h.shape}),1),l=Ue(u,e[0].dtype).values;if(1===a[0].shape[0]){var c=0;a.forEach(function(h){l.set(o.readSync(h.dataId),c),c+=h.size})}else{var d=0;a.forEach(function(h){for(var p=o.readSync(h.dataId),m=0,v=0;v<h.shape[0];++v)for(var y=v*u[1]+d,_=0;_<h.shape[1];++_)l[y+_]=p[m++];d+=h.shape[1]})}var f=Xa(e.map(function(h){return h.shape}),r);return Wn(l,f,e[0].dtype)},t.prototype.neg=function(e){return J(e,"neg"),this.multiply(oe(-1),e)},t.prototype.add=function(e,r){return"complex64"===e.dtype||"complex64"===r.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),r.cast("complex64"),function(o,i,s,a){return{real:o+s,imag:i+a}}):this.broadcastedBinaryOp(e,r,kn(e.dtype,r.dtype),function(o,i){return o+i})},t.prototype.addN=function(e){var r=this;J(e,"addN");for(var o=e.map(function(c){return r.readSync(c.dataId)}),i=Ue(e[0].shape,e[0].dtype),s=i.values,a=0;a<e.length;a++)for(var u=o[a],l=0;l<s.length;l++)s[l]+=u[l];return i.toTensor()},t.prototype.softmax=function(e,r){var o=gn([r],e.shape),i=this.max(e,o),s=br(i.shape,o),a=this.subtract(e,i.reshape(s)),u=this.exp(a),l=this.sum(u,o).reshape(s);return this.realDivide(u,l)},t.prototype.subtract=function(e,r){return"complex64"===e.dtype||"complex64"===r.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),r.cast("complex64"),function(o,i,s,a){return{real:o-s,imag:i-a}}):this.broadcastedBinaryOp(e,r,kn(e.dtype,r.dtype),function(o,i){return o-i})},t.prototype.pow=function(e,r){return J([e,r],"pow"),this.broadcastedBinaryOp(e,r,e.dtype,function(o,i){return Math.pow(o,i)})},t.prototype.batchMatMul=function(e,r,o,i){J([e,r],"matMul");for(var s=o?e.shape[1]:e.shape[2],a=o?e.shape[2]:e.shape[1],u=i?r.shape[1]:r.shape[2],l=e.shape[0],c=this.readSync(e.dataId),d=this.readSync(r.dataId),f=o?[e.strides[0],1,e.strides[1]]:[e.strides[0],e.strides[1],1],h=f[0],p=f[1],m=f[2],v=i?[1,r.strides[1],r.strides[0]]:[r.strides[1],1,r.strides[0]],y=v[0],_=v[1],b=v[2],x=a*u,E=Ue([l,a,u],e.dtype),D=E.values,k=this.blockSize,R=0;R<l;R++)for(var A=0;A<a;A+=k)for(var M=0;M<u;M+=k)for(var O=0;O<s;O+=k)for(var P=Math.min(A+k,a),G=Math.min(M+k,u),q=Math.min(O+k,s),K=A;K<P;K++)for(var L=M;L<G;L++){for(var V=0,B=O;B<q;B++)V+=c[R*h+K*p+B*m]*d[B*y+L*_+R*b];D[R*x+(K*u+L)]+=V}return E.toTensor()},t.prototype.fusedBatchMatMul=function(e){var a=e.bias,u=e.activation,l=e.preluActivationWeights,c=this.batchMatMul(e.a,e.b,e.transposeA,e.transposeB);return a&&(c=this.add(c,a)),u&&(c=j_(this,c,u,l)),c},t.prototype.multiply=function(e,r){return"complex64"===e.dtype||"complex64"===r.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),r.cast("complex64"),function(o,i,s,a){return{real:o*s-i*a,imag:o*a+i*s}}):this.broadcastedBinaryOp(e,r,kn(e.dtype,r.dtype),function(o,i){return o*i})},t.prototype.realDivide=function(e,r){return J([e,r],"realDivide"),this.broadcastedBinaryOp(e,r,"float32",function(o,i){return o/i})},t.prototype.floorDiv=function(e,r){return J([e,r],"floorDiv"),this.broadcastedBinaryOp(e,r,"int32",function(o,i){return Math.floor(o/i)})},t.prototype.sum=function(e,r){J(e,"sum"),kr("sum",r,e.rank);for(var o=jn(e.shape,r),s=o[1],a=Ft(o[0],kn(e.dtype,"int32")),u=me(s),l=this.readSync(a.dataId),c=this.readSync(e.dataId),d=0;d<l.length;++d){for(var f=d*u,h=0,p=0;p<u;++p)h+=c[f+p];l[d]=h}return a},t.prototype.prod=function(e,r){J(e,"sum");for(var o=jn(e.shape,r),s=o[1],a=Ft(o[0],kn(e.dtype,"int32")),u=me(s),l=this.readSync(a.dataId),c=this.readSync(e.dataId),d=0;d<l.length;++d){for(var f=d*u,h=1,p=0;p<u;++p)h*=c[f+p];l[d]=h}return a},t.prototype.unsortedSegmentSum=function(e,r,o){J(e,"unsortedSegmentSum");for(var i=[],s=e.rank-r.rank,a=0;a<s;++a)r=r.expandDims(a+1);for(a=0;a<o;++a){var u=oe(a,"int32"),l=wN(u,r).asType("float32").mul(e).sum(0);i.push(l)}return qr(i)},t.prototype.argMin=function(e,r){J(e,"argMin");var o=[r];kr("argMin",o,e.rank);for(var i=jn(e.shape,o),a=i[1],u=Ft(i[0],"int32"),l=me(a),c=this.readSync(u.dataId),d=this.readSync(e.dataId),f=0;f<c.length;++f){for(var h=f*l,p=d[h],m=0,v=0;v<l;++v){var y=d[h+v];y<p&&(p=y,m=v)}c[f]=m}return u},t.prototype.argMax=function(e,r){J(e,"argMax");var o=[r];kr("argMax",o,e.rank);for(var i=jn(e.shape,o),a=i[1],u=Ft(i[0],"int32"),l=me(a),c=this.readSync(u.dataId),d=this.readSync(e.dataId),f=0;f<c.length;++f){for(var h=f*l,p=d[h],m=0,v=0;v<l;++v){var y=d[h+v];y>p&&(p=y,m=v)}c[f]=m}return u},t.prototype.cumsum=function(e,r,o,i){if(J(e,"cumsum"),r!==e.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(e.rank-1)+" but got axis="+r);for(var s=kn(e.dtype,"int32"),a=Ft(e.shape,s),u=this.readSync(a.dataId),l=this.readSync(e.dataId),c=e.shape[e.rank-1],d=i?function(v,y){return v+c-y-1}:function(v,y){return v+y},f=0;f<l.length;f+=c)for(var h=0;h<c;h++){var p=d(f,h);if(0===h)u[p]=o?0:l[p];else{var m=d(f,h-1);u[p]=o?l[m]+u[m]:l[p]+u[m]}}return a},t.prototype.equal=function(e,r){return J([e,r],"equal"),this.broadcastedBinaryOp(e,r,"bool",function(o,i){return o===i?1:0})},t.prototype.notEqual=function(e,r){return J([e,r],"notEqual"),this.broadcastedBinaryOp(e,r,"bool",function(o,i){return o!==i?1:0})},t.prototype.less=function(e,r){return J([e,r],"less"),this.broadcastedBinaryOp(e,r,"bool",function(o,i){return o<i?1:0})},t.prototype.lessEqual=function(e,r){return J([e,r],"lessEqual"),this.broadcastedBinaryOp(e,r,"bool",function(o,i){return o<=i?1:0})},t.prototype.greater=function(e,r){return J([e,r],"greater"),this.broadcastedBinaryOp(e,r,"bool",function(o,i){return o>i?1:0})},t.prototype.greaterEqual=function(e,r){return J([e,r],"greaterEqual"),this.broadcastedBinaryOp(e,r,"bool",function(o,i){return o>=i?1:0})},t.prototype.logicalNot=function(e){J(e,"logicalNot");for(var r=this.readSync(e.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)o[i]=r[i]?0:1;return this.makeOutput(o,e.shape,"bool")},t.prototype.logicalAnd=function(e,r){return J([e,r],"logicalAnd"),this.broadcastedBinaryOp(e,r,"bool",function(o,i){return o&&i})},t.prototype.logicalOr=function(e,r){return J([e,r],"logicalOr"),this.broadcastedBinaryOp(e,r,"bool",function(o,i){return o||i})},t.prototype.select=function(e,r,o){J([e,r,o],"select");for(var i=this.readSync(e.dataId),s=this.readSync(r.dataId),a=this.readSync(o.dataId),u=Ft(r.shape,kn(r.dtype,o.dtype)),l=this.readSync(u.dataId),c=0,d=0===e.rank||e.rank>1||1===r.rank?1:me(r.shape.slice(1)),f=0;f<i.length;f++)for(var h=0;h<d;h++)l[c++]=1===i[f]?s[f]:a[f];return u},t.prototype.where=function(e){J([e],"where");var r=this.readSync(e.dataId);return g_(e.shape,r)},t.prototype.topk=function(e,r,o){return J(e,"topk"),gR(this.readSync(e.dataId),e.shape,e.dtype,r)},t.prototype.min=function(e,r){J(e,"min"),kr("min",r,e.rank);for(var o=jn(e.shape,r),s=o[1],a=Ft(o[0],e.dtype),u=me(s),l=this.readSync(a.dataId),c=this.readSync(e.dataId),d=0;d<l.length;++d){for(var f=d*u,h=c[f],p=0;p<u;++p){var m=c[f+p];m<h&&(h=m)}l[d]=h}return a},t.prototype.minimum=function(e,r){return J([e,r],"minimum"),this.broadcastedBinaryOp(e,r,e.dtype,function(o,i){return Math.min(o,i)})},t.prototype.mod=function(e,r){return J([e,r],"mod"),this.broadcastedBinaryOp(e,r,e.dtype,function(o,i){var s=o%i;return o<0&&i<0||o>=0&&i>=0?s:(s+i)%i})},t.prototype.max=function(e,r){J(e,"max"),kr("max",r,e.rank);for(var o=jn(e.shape,r),s=o[1],a=Ft(o[0],e.dtype),u=me(s),l=this.readSync(a.dataId),c=this.readSync(e.dataId),d=0;d<l.length;++d){for(var f=d*u,h=c[f],p=0;p<u;++p){var m=c[f+p];m>h&&(h=m)}l[d]=h}return a},t.prototype.maximum=function(e,r){return J([e,r],"maximum"),this.broadcastedBinaryOp(e,r,e.dtype,function(o,i){return Math.max(o,i)})},t.prototype.all=function(e,r){J(e,"all"),kr("all",r,e.rank);for(var o=jn(e.shape,r),s=o[1],a=Ft(o[0],e.dtype),u=me(s),l=this.readSync(a.dataId),c=this.readSync(e.dataId),d=0;d<l.length;++d){for(var f=d*u,h=c[f],p=0;p<u;++p)h=h&&c[f+p];l[d]=h}return a},t.prototype.any=function(e,r){J(e,"any"),kr("any",r,e.rank);for(var o=jn(e.shape,r),s=o[1],a=Ft(o[0],e.dtype),u=me(s),l=this.readSync(a.dataId),c=this.readSync(e.dataId),d=0;d<l.length;++d){for(var f=d*u,h=c[f],p=0;p<u;++p)h=h||c[f+p];l[d]=h}return a},t.prototype.squaredDifference=function(e,r){return J([e,r],"squaredDifference"),this.broadcastedBinaryOp(e,r,e.dtype,function(o,i){var s=o-i;return s*s})},t.prototype.ceil=function(e){J(e,"ceil");for(var r=this.readSync(e.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.ceil(r[i]);return this.makeOutput(o,e.shape,"float32")},t.prototype.floor=function(e){J(e,"floor");for(var r=this.readSync(e.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.floor(r[i]);return this.makeOutput(o,e.shape,"float32")},t.prototype.sign=function(e){J(e,"x");for(var r=this.readSync(e.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=r[i]<0?-1:r[i]>0?1:0;return this.makeOutput(o,e.shape,"float32")},t.prototype.isNaN=function(e){J(e,"x");for(var r=this.readSync(e.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isNaN(r[i])&&(o[i]=1);return this.makeOutput(o,e.shape,"bool")},t.prototype.isInf=function(e){J(e,"x");for(var r=this.readSync(e.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Math.abs(r[i])===1/0&&(o[i]=1);return this.makeOutput(o,e.shape,"bool")},t.prototype.isFinite=function(e){J(e,"x");for(var r=this.readSync(e.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isFinite(r[i])&&(o[i]=1);return this.makeOutput(o,e.shape,"bool")},t.prototype.round=function(e){J(e,"round");for(var r=this.readSync(e.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var s=Math.floor(r[i]);o[i]=r[i]-s<.5?Math.floor(r[i]):r[i]-s>.5?Math.ceil(r[i]):s%2==0?s:s+1}return this.makeOutput(o,e.shape,"float32")},t.prototype.exp=function(e){J(e,"exp");for(var r=this.readSync(e.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.exp(r[i]);return this.makeOutput(o,e.shape,"float32")},t.prototype.expm1=function(e){J(e,"expm1");for(var r=this.readSync(e.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.expm1(r[i]);return this.makeOutput(o,e.shape,"float32")},t.prototype.log=function(e){J(e,"log");for(var r=this.readSync(e.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.log(r[i]);return this.makeOutput(o,e.shape,"float32")},t.prototype.log1p=function(e){J(e,"log1p");for(var r=this.readSync(e.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.log1p(r[i]);return this.makeOutput(o,e.shape,"float32")},t.prototype.sqrt=function(e){J(e,"sqrt");for(var r=this.readSync(e.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.sqrt(r[i]);return this.makeOutput(o,e.shape,"float32")},t.prototype.rsqrt=function(e){J(e,"rsqrt");for(var r=this.readSync(e.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=1/Math.sqrt(r[i]);return this.makeOutput(o,e.shape,"float32")},t.prototype.reciprocal=function(e){J(e,"reciprocal");for(var r=this.readSync(e.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=1/r[i];return this.makeOutput(o,e.shape,"float32")},t.prototype.linear=function(e){return e},t.prototype.relu=function(e){J(e,"relu");for(var r=Ft(e.shape,e.dtype),o=this.readSync(r.dataId),i=this.readSync(e.dataId),s=0;s<i.length;++s)o[s]=Math.max(0,i[s]);return r},t.prototype.relu6=function(e){J(e,"relu");for(var r=Ft(e.shape,e.dtype),o=this.readSync(r.dataId),i=this.readSync(e.dataId),s=0;s<i.length;++s)o[s]=Math.min(Math.max(0,i[s]),6);return r},t.prototype.prelu=function(e,r){return J([e,r],"prelu"),this.broadcastedBinaryOp(e,r,e.dtype,function(o,i){return o<0?i*o:o})},t.prototype.elu=function(e){J(e,"elu");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i){var s=o[i];r[i]=s>=0?s:Math.exp(s)-1}return this.makeOutput(r,e.shape,"float32")},t.prototype.eluDer=function(e,r){J([e,r],"eluDer");for(var o=new Float32Array(r.size),i=this.readSync(r.dataId),s=this.readSync(e.dataId),a=0;a<i.length;++a){var u=i[a];o[a]=u>=1?s[a]:s[a]*(u+1)}return this.makeOutput(o,r.shape,"float32")},t.prototype.selu=function(e){J(e,"selu");for(var i=new Float32Array(e.size),s=this.readSync(e.dataId),a=0;a<s.length;++a){var u=s[a];i[a]=u>=0?1.0507009873554805*u:1.7580993408473768*(Math.exp(u)-1)}return this.makeOutput(i,e.shape,"float32")},t.prototype.clip=function(e,r,o){J(e,"clip");for(var i=new Float32Array(e.size),s=this.readSync(e.dataId),a=0;a<s.length;++a){var u=s[a];i[a]=u>o?o:u<r?r:u}return this.makeOutput(i,e.shape,"float32")},t.prototype.abs=function(e){for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i)r[i]=Math.abs(o[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.complexAbs=function(e){for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<e.size;++i)r[i]=Math.hypot(o[2*i],o[2*i+1]);return this.makeOutput(r,e.shape,"float32")},t.prototype.int=function(e){J(e,"int");for(var r=new Int32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i)r[i]=o[i];return this.makeOutput(r,e.shape,"int32")},t.prototype.sigmoid=function(e){J(e,"sigmoid");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i)r[i]=1/(1+Math.exp(-o[i]));return this.makeOutput(r,e.shape,"float32")},t.prototype.softplus=function(e){J(e,"softplus");for(var r=Math.log(1.1920928955078125e-7)+2,o=new Float32Array(e.size),i=this.readSync(e.dataId),s=0;s<i.length;++s){var c,a=i[s]>-r,u=i[s]<r,l=Math.exp(i[s]);c=u?l:a?i[s]:Math.log(1+l),o[s]=c}return this.makeOutput(o,e.shape,"float32")},t.prototype.sin=function(e){J(e,"sin");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i)r[i]=Math.sin(o[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.cos=function(e){J(e,"cos");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i)r[i]=Math.cos(o[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.tan=function(e){J(e,"tan");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i)r[i]=Math.tan(o[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.asin=function(e){J(e,"asin");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i)r[i]=Math.asin(o[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.acos=function(e){J(e,"acos");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i)r[i]=Math.acos(o[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.atan=function(e){J(e,"atan");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i)r[i]=Math.atan(o[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.atan2=function(e,r){return J([e,r],"atan2"),this.broadcastedBinaryOp(e,r,e.dtype,function(o,i){return Math.atan2(o,i)})},t.prototype.sinh=function(e){J(e,"sinh");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i)r[i]=Math.sinh(o[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.cosh=function(e){J(e,"cosh");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i)r[i]=Math.cosh(o[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.tanh=function(e){J(e,"tanh");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i)r[i]=rk(o[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.asinh=function(e){J(e,"asinh");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i)r[i]=Math.asinh(o[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.acosh=function(e){J(e,"acosh");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i)r[i]=Math.acosh(o[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.atanh=function(e){J(e,"atanh");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i)r[i]=Math.atanh(o[i]);return this.makeOutput(r,e.shape,"float32")},t.prototype.erf=function(e){J(e,"erf");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i){var s=Math.sign(o[i]),a=Math.abs(o[i]),u=1/(1+.3275911*a);r[i]=s*(1-((((1.061405429*u-1.453152027)*u+1.421413741)*u-.284496736)*u+.254829592)*u*Math.exp(-a*a))}return this.makeOutput(r,e.shape,"float32")},t.prototype.step=function(e,r){void 0===r&&(r=0),J(e,"step");for(var o=new Float32Array(e.size),i=this.readSync(e.dataId),s=0;s<i.length;++s){var a=i[s];o[s]=isNaN(a)?NaN:a>0?1:r}return this.makeOutput(o,e.shape,"float32")},t.prototype.fusedConv2d=function(e){var s=e.bias,a=e.activation,u=e.preluActivationWeights,l=this.conv2d(e.input,e.filter,e.convInfo);return s&&(l=this.add(l,s)),a&&(l=j_(this,l,a,u)),l},t.prototype.conv2d=function(e,r,o){J([e,r],"conv2d");for(var i=o.filterHeight,s=o.filterWidth,a=o.dilationHeight,u=o.dilationWidth,l=o.padInfo.left,c=o.padInfo.top,d="channelsLast"===o.dataFormat,f=Ue(o.outShape,e.dtype),h=e.strides[0],p=d?e.strides[1]:e.strides[2],m=d?e.strides[2]:1,v=d?1:e.strides[1],y=f.strides[0],_=d?f.strides[1]:f.strides[2],b=d?f.strides[2]:1,x=d?1:f.strides[1],E=this.readSync(e.dataId),D=this.readSync(r.dataId),k=f.values,R=0;R<o.batchSize;++R)for(var A=R*h,M=R*y,O=0;O<o.outHeight;++O)for(var P=M+O*_,G=O*o.strideHeight-c,q=0;q<i;q++){var K=G+q*a;if(!(K<0||K>=o.inHeight))for(var L=q*r.strides[0],V=A+K*p,B=0;B<o.outWidth;++B)for(var z=P+B*b,Y=B*o.strideWidth-l,ne=0;ne<s;ne++){var se=Y+ne*u;if(!(se<0||se>=o.inWidth))for(var ve=V+se*m,ge=L+ne*r.strides[1],We=0;We<o.inChannels;++We){for(var Xe=E[ve+We*v],Me=0;Me<o.outChannels;++Me)k[z+Me*x]+=Xe*D[ge+Me];ge+=o.outChannels}}}return f.toTensor()},t.prototype.conv3d=function(e,r,o){for(var i=o.filterDepth,s=o.filterHeight,a=o.filterWidth,u=o.dilationDepth,l=o.dilationHeight,c=o.dilationWidth,d=o.padInfo.front,f=o.padInfo.left,h=o.padInfo.top,p=Ue(o.outShape,e.dtype),m=this.readSync(e.dataId),v=this.readSync(r.dataId),y=p.values,_=0;_<o.batchSize;++_)for(var b=_*e.strides[0],x=_*p.strides[0],E=0;E<o.outDepth;++E)for(var D=x+E*p.strides[1],k=E*o.strideDepth-d,R=0;R<i;R++){var A=k+R*u;if(!(A<0||A>=o.inDepth))for(var M=R*r.strides[0],O=b+A*e.strides[1],P=0;P<o.outHeight;++P)for(var G=D+P*p.strides[2],q=P*o.strideHeight-h,K=0;K<s;K++){var L=q+K*l;if(!(L<0||L>=o.inHeight))for(var V=M+K*r.strides[1],B=O+L*e.strides[2],z=0;z<o.outWidth;++z)for(var Y=G+z*o.outChannels,ne=z*o.strideWidth-f,se=0;se<a;se++){var ve=ne+se*c;if(!(ve<0||ve>=o.inWidth))for(var We=B+ve*o.inChannels,Xe=V+se*r.strides[2],Me=0;Me<o.inChannels;++Me){for(var He=m[We+Me],Fe=0;Fe<o.outChannels;++Fe)y[Y+Fe]+=He*v[Xe+Fe];Xe+=o.outChannels}}}}return p.toTensor()},t.prototype.conv2dDerInput=function(e,r,o){J([e,r],"conv2dDerInput");for(var i=Ue(o.inShape,"float32"),s=i.values,a=this.readSync(e.dataId),u=this.readSync(r.dataId),l=r.strides,c=l[0],d=l[1],f=l[2],h=o.batchSize,p=o.filterHeight,m=o.filterWidth,v=o.inChannels,y=o.inHeight,_=o.inWidth,b=o.outChannels,x=o.outHeight,E=o.outWidth,D=o.strideHeight,k=o.strideWidth,A=p-1-o.padInfo.top,M=m-1-o.padInfo.left,O="channelsLast"===o.dataFormat,P=i.strides[0],G=O?i.strides[1]:i.strides[2],q=O?i.strides[2]:1,K=O?1:i.strides[1],L=e.strides[0],V=O?e.strides[1]:e.strides[2],B=O?e.strides[2]:1,z=O?1:e.strides[1],Y=0;Y<h;++Y)for(var ne=0;ne<v;++ne)for(var se=0;se<y;++se)for(var ve=se-A,ge=Math.max(0,Math.ceil(ve/D)),We=Math.min(x,(p+ve)/D),Xe=0;Xe<_;++Xe){for(var Me=Xe-M,He=Math.max(0,Math.ceil(Me/k)),Fe=Math.min(E,(m+Me)/k),kt=0,Ye=ge;Ye<We;++Ye)for(var Dt=Ye*D-ve,mt=He;mt<Fe;++mt)for(var Jt=L*Y+V*Ye+B*mt,Gt=c*(p-1-Dt)+d*(m-1-(mt*k-Me))+f*ne,qt=0;qt<b;++qt)kt+=a[Jt+z*qt]*u[Gt+qt];s[P*Y+G*se+q*Xe+K*ne]=kt}return i.toTensor()},t.prototype.conv3dDerInput=function(e,r,o){for(var i=Ue(o.inShape,"float32"),s=i.values,a=i.strides,u=a[0],l=a[1],c=a[2],d=a[3],f=this.readSync(e.dataId),h=e.strides,p=h[0],m=h[1],v=h[2],y=h[3],_=this.readSync(r.dataId),b=r.strides,x=b[0],E=b[1],D=b[2],k=b[3],R=o.batchSize,A=o.filterDepth,M=o.filterHeight,O=o.filterWidth,P=o.inChannels,G=o.inDepth,q=o.inHeight,K=o.inWidth,L=o.outChannels,V=o.outDepth,B=o.outHeight,z=o.outWidth,Y=o.strideDepth,ne=o.strideHeight,se=o.strideWidth,ve=A-1-o.padInfo.front,ge=M-1-o.padInfo.top,We=O-1-o.padInfo.left,Xe=0;Xe<R;++Xe)for(var Me=0;Me<P;++Me)for(var He=0;He<G;++He)for(var Fe=He-ve,kt=Math.max(0,Math.ceil(Fe/Y)),Ye=Math.min(V,(A+Fe)/Y),Dt=0;Dt<q;++Dt)for(var mt=Dt-ge,Jt=Math.max(0,Math.ceil(mt/ne)),Gt=Math.min(B,(M+mt)/ne),qt=0;qt<K;++qt){for(var bi=qt-We,_i=Math.max(0,Math.ceil(bi/se)),Zr=Math.min(z,(O+bi)/se),ql=0,gs=kt;gs<Ye;++gs)for(var ma=gs*Y-Fe,ms=Jt;ms<Gt;++ms)for(var Kl=ms*ne-mt,vs=_i;vs<Zr;++vs)for(var cx=p*Xe+m*gs+v*ms+y*vs,Xl=x*(A-1-ma)+E*(M-1-Kl)+D*(O-1-(vs*se-bi))+k*Me,xi=0;xi<L;++xi)ql+=f[cx+xi]*_[Xl+xi];s[u*Xe+l*He+c*Dt+d*qt+Me]=ql}return i.toTensor()},t.prototype.conv2dDerFilter=function(e,r,o){J([e,r],"conv2dDerFilter");for(var i=o.strideHeight,s=o.strideWidth,a=o.filterHeight,u=o.filterWidth,l="channelsLast"===o.dataFormat,c=Ue(o.filterShape,"float32"),d=o.padInfo.left,f=o.padInfo.top,h=this.bufferSync(e),p=this.bufferSync(r),m=0;m<a;++m)for(var v=Math.max(0,Math.ceil((f-m)/i)),y=Math.min(o.outHeight,(o.inHeight+f-m)/i),_=0;_<u;++_)for(var b=Math.max(0,Math.ceil((d-_)/s)),x=Math.min(o.outWidth,(o.inWidth+d-_)/s),E=0;E<o.inChannels;++E)for(var D=0;D<o.outChannels;++D){for(var k=0,R=0;R<o.batchSize;++R)for(var A=v;A<y;++A)for(var M=m+A*i-f,O=b;O<x;++O){var P=_+O*s-d;k+=l?h.get(R,M,P,E)*p.get(R,A,O,D):h.get(R,E,M,P)*p.get(R,D,A,O)}c.set(k,m,_,E,D)}return c.toTensor()},t.prototype.conv3dDerFilter=function(e,r,o){for(var i=o.strideDepth,s=o.strideHeight,a=o.strideWidth,u=o.filterDepth,l=o.filterHeight,c=o.filterWidth,d=Ue(o.filterShape,"float32"),f=d.values,h=d.strides,p=h[0],m=h[1],v=h[2],y=h[3],_=this.readSync(r.dataId),b=r.strides,x=b[0],E=b[1],D=b[2],k=b[3],R=this.readSync(e.dataId),A=e.strides,M=A[0],O=A[1],P=A[2],G=A[3],q=o.padInfo.front,K=o.padInfo.left,L=o.padInfo.top,V=0;V<u;++V)for(var B=Math.max(0,Math.ceil((q-V)/i)),z=Math.min(o.outDepth,(o.inDepth+q-V)/i),Y=V*p,ne=0;ne<l;++ne)for(var se=Math.max(0,Math.ceil((L-ne)/s)),ve=Math.min(o.outHeight,(o.inHeight+L-ne)/s),ge=ne*m+Y,We=0;We<c;++We)for(var Xe=Math.max(0,Math.ceil((K-We)/a)),Me=Math.min(o.outWidth,(o.inWidth+K-We)/a),He=We*v+ge,Fe=0;Fe<o.inChannels;++Fe)for(var kt=Fe*y+He,Ye=0;Ye<o.outChannels;++Ye){for(var Dt=0,mt=0;mt<o.batchSize;++mt)for(var Jt=mt*M,Gt=mt*x,qt=B;qt<z;++qt)for(var bi=(V+qt*i-q)*O+Jt,_i=qt*E+Gt,Zr=se;Zr<ve;++Zr)for(var ql=(ne+Zr*s-L)*P+bi,gs=Zr*D+_i,ma=Xe;ma<Me;++ma)Dt+=R[(We+ma*a-K)*G+ql+Fe]*_[ma*k+gs+Ye];f[kt+Ye]=Dt}return d.toTensor()},t.prototype.fusedDepthwiseConv2D=function(e){var s=e.bias,a=e.activation,u=e.preluActivationWeights,l=this.depthwiseConv2D(e.input,e.filter,e.convInfo);return s&&(l=this.add(l,s)),a&&(l=j_(this,l,a,u)),l},t.prototype.depthwiseConv2D=function(e,r,o){J([e,r],"depthwiseConv2D");for(var i=o.filterHeight,s=o.filterWidth,a=o.dilationHeight,u=o.dilationWidth,l=o.padInfo.left,c=o.padInfo.top,d=o.outChannels/o.inChannels,f=Ue(o.outShape,e.dtype),h=this.readSync(e.dataId),p=this.readSync(r.dataId),m=f.values,v=0;v<o.batchSize;++v)for(var y=v*e.strides[0],_=v*f.strides[0],b=0;b<o.outHeight;++b)for(var x=_+b*f.strides[1],E=b*o.strideHeight-l,D=0;D<i;++D){var k=E+D*a;if(!(k<0||k>=o.inHeight))for(var R=D*r.strides[0],A=y+k*e.strides[1],M=0;M<o.outWidth;++M)for(var O=x+M*f.strides[2],P=M*o.strideWidth-c,G=0;G<s;++G){var q=P+G*u;if(!(q<0||q>=o.inWidth))for(var L=A+q*o.inChannels,V=O,B=R+G*r.strides[1],z=0;z<o.inChannels;++z){for(var Y=h[L+z],ne=0;ne<d;++ne)m[V+ne]+=Y*p[B+ne];V+=d,B+=d}}}return f.toTensor()},t.prototype.depthwiseConv2DDerInput=function(e,r,o){J([e,r],"depthwiseConv2DDerInput");for(var i=Ue(o.inShape,"float32"),s=i.values,a=i.strides,u=a[0],l=a[1],c=a[2],d=this.readSync(e.dataId),f=e.strides,h=f[0],p=f[1],m=f[2],v=this.readSync(r.dataId),y=r.strides,_=y[0],b=y[1],x=y[2],E=o.batchSize,D=o.filterHeight,k=o.filterWidth,R=o.inChannels,A=o.inHeight,M=o.inWidth,P=o.outHeight,G=o.outWidth,q=o.strideHeight,K=o.strideWidth,L=D-1-o.padInfo.top,V=k-1-o.padInfo.left,B=o.outChannels/R,z=0;z<E;++z)for(var Y=0;Y<R;++Y)for(var ne=0;ne<A;++ne)for(var se=ne-L,ve=Math.max(0,Math.ceil(se/q)),ge=Math.min(P,(D+se)/q),We=0;We<M;++We){for(var Xe=We-V,Me=Math.max(0,Math.ceil(Xe/K)),He=Math.min(G,(k+Xe)/K),Fe=0,kt=ve;kt<ge;++kt)for(var Ye=kt*q-se,Dt=Me;Dt<He;++Dt)for(var mt=h*z+p*kt+m*Dt,Jt=_*(D-1-Ye)+b*(k-1-(Dt*K-Xe))+x*Y,Gt=0;Gt<B;++Gt)Fe+=d[mt+(Y*B+Gt)]*v[Jt+Gt];s[u*z+l*ne+c*We+Y]=Fe}return i.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(e,r,o){J([e,r],"depthwiseConv2DDerFilter");for(var i=o.strideHeight,s=o.strideWidth,a=o.filterHeight,u=o.filterWidth,l=Ue(o.filterShape,"float32"),c=o.padInfo.left,d=o.padInfo.top,f=o.outChannels/o.inChannels,h=this.bufferSync(e),p=this.bufferSync(r),m=0;m<a;++m)for(var v=Math.max(0,Math.ceil((d-m)/i)),y=Math.min(o.outHeight,(o.inHeight+d-m)/i),_=0;_<u;++_)for(var b=Math.max(0,Math.ceil((c-_)/s)),x=Math.min(o.outWidth,(o.inWidth+c-_)/s),E=0;E<o.outChannels;++E){for(var D=Math.trunc(E/f),k=E%f,R=0,A=0;A<o.batchSize;++A)for(var M=v;M<y;++M)for(var O=m+M*i-d,P=b;P<x;++P)R+=h.get(A,O,_+P*s-c,D)*p.get(A,M,P,E);l.set(R,m,_,D,k)}return l.toTensor()},t.prototype.tile=function(e,r){return J(e,"tile"),pR(this.bufferSync(e),r)},t.prototype.pad=function(e,r,o){J(e,"pad");var i=r.map(function(f,h){return f[0]+e.shape[h]+f[1]}),s=r.map(function(f){return f[0]}),a=this.bufferSync(e),u=Ue(i,e.dtype);0!==o&&u.values.fill(o);for(var l=0;l<e.size;l++){var c=a.indexToLoc(l),d=c.map(function(f,h){return f+s[h]});u.set.apply(u,[a.get.apply(a,c)].concat(d))}return u.toTensor()},t.prototype.transpose=function(e,r){J(e,"transpose");for(var o=new Array(e.rank),i=0;i<o.length;i++)o[i]=e.shape[r[i]];var s=this.readSync(e.dataId),a=Ue(o,e.dtype),u=this.bufferSync(e);for(i=0;i<e.size;++i){for(var l=u.indexToLoc(i),c=new Array(l.length),d=0;d<c.length;d++)c[d]=l[r[d]];var f=a.locToIndex(c);a.values[f]=s[i]}return a.toTensor()},t.prototype.gather=function(e,r,o){J([e,r],"gather");var i=e.shape.slice(),s=this.readSync(r.dataId);i[o]=s.length;for(var a=Ue(i,e.dtype),u=this.bufferSync(e),l=0;l<a.size;++l){var c=a.indexToLoc(l),d=c.slice();d[o]=s[c[o]];var f=u.locToIndex(d);a.values[l]=u.values[f]}return a.toTensor()},t.prototype.batchToSpaceND=function(e,r,o){J([e],"batchToSpaceND");var i=r.reduce(function(d,f){return d*f}),s=Vg(e.shape,r,i),a=Ug(s.length,r.length),u=jg(e.shape,r,i),l=tR(o,r.length),c=nR(u,o,r.length);return e.reshape(s).transpose(a).reshape(u).slice(l,c)},t.prototype.spaceToBatchND=function(e,r,o){J([e],"spaceToBatchND");var i=r.reduce(function(f,h){return f*h}),s=[[0,0]];s.push.apply(s,o);for(var a=1+r.length;a<e.shape.length;++a)s.push([0,0]);var u=e.pad(s),l=Vg(u.shape,r,i,!1),c=Ug(l.length,r.length,!1),d=jg(u.shape,r,i,!1);return u.reshape(l).transpose(c).reshape(d)},t.prototype.pool=function(e,r,o){J(e,"pool");for(var i=r.strideHeight,s=r.strideWidth,a=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,c=r.effectiveFilterWidth,d=r.padInfo.top,f=r.padInfo.left,h="max"===o?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,p=this.readSync(e.dataId),m=Ue(r.outShape,e.dtype),v=m.values,y=r.outShape[1]*r.outShape[2]*r.outShape[3],_=r.outShape[2]*r.outShape[3],b=r.outShape[3],x=0;x<r.batchSize;++x)for(var E=x*y,D=x*e.strides[0],k=0;k<r.inChannels;++k)for(var R=0;R<r.outHeight;++R)for(var A=R*i-d,M=Math.max(0,A),O=Math.min(r.inHeight,l+A),P=E+R*_,G=0;G<r.outWidth;++G){for(var q=G*s-f,K=Math.max(0,q),L=Math.min(r.inWidth,c+q),V=h,B=0,z=0,Y=M;Y<O;Y+=a){for(var ne=D+Y*e.strides[1],se=K;se<L;se+=u){var ve=p[ne+se*e.strides[2]+k];"max"===o&&ve>V?V=ve:"avg"===o&&(B+=ve,z++)}if(isNaN(V))break}v[P+G*b+k]="avg"===o?B/z:V}return m.toTensor()},t.prototype.maxPool=function(e,r){return this.pool(e,r,"max")},t.prototype.maxPoolPositions=function(e,r){for(var o=Ue(r.outShape,"int32"),i=r.strideHeight,s=r.strideWidth,a=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,c=r.effectiveFilterWidth,d=r.padInfo.top,f=r.padInfo.left,h=this.bufferSync(e),p=0;p<r.batchSize;++p)for(var m=0;m<r.inChannels;++m)for(var v=0;v<r.outHeight;++v){for(var y=v*i-d,_=y;_<0;)_+=a;for(var b=Math.min(r.inHeight,l+y),x=0;x<r.outWidth;++x){for(var E=x*s-f,D=E;D<0;)D+=u;for(var k=Math.min(r.inWidth,c+E),R=Number.NEGATIVE_INFINITY,A=-1,M=_;M<b;M+=a)for(var O=M-y,P=D;P<k;P+=u){var G=P-E,q=h.get(p,M,P,m);q>R&&(R=q,A=O*c+G)}o.set(A,p,v,x,m)}}return o.toTensor()},t.prototype.maxPoolBackprop=function(e,r,o,i){J([r,o],"maxPoolBackprop");for(var s=this.maxPoolPositions(r,i),a=i.strideHeight,u=i.strideWidth,l=i.dilationHeight,c=i.dilationWidth,d=i.effectiveFilterHeight,f=i.effectiveFilterWidth,h=f-1-i.padInfo.left,p=d-1-i.padInfo.top,m=Ue(r.shape,"float32"),v=this.bufferSync(s),y=this.bufferSync(e),_=0;_<i.batchSize;++_)for(var b=0;b<i.inChannels;++b)for(var x=0;x<i.inHeight;++x)for(var E=0;E<i.inWidth;++E){for(var D=x-p,k=E-h,R=0,A=0;A<d;A+=l){var M=(D+A)/a;if(!(M<0||M>=i.outHeight||Math.floor(M)!==M))for(var O=0;O<f;O+=c){var P=(k+O)/u;if(!(P<0||P>=i.outWidth||Math.floor(P)!==P)){var G=d*f-1-v.get(_,M,P,b)===A*f+O?1:0;0!==G&&(R+=y.get(_,M,P,b)*G)}}}m.set(R,_,x,E,b)}return m.toTensor()},t.prototype.avgPoolBackprop=function(e,r,o){J([e,r],"avgPoolBackprop");for(var i=o.strideHeight,s=o.strideWidth,a=o.filterHeight,u=o.filterWidth,l=o.dilationHeight,c=o.dilationWidth,d=o.effectiveFilterHeight,f=o.effectiveFilterWidth,h=f-1-o.padInfo.left,p=d-1-o.padInfo.top,m=Ue(r.shape,"float32"),v=1/(a*u),y=this.bufferSync(e),_=0;_<o.batchSize;++_)for(var b=0;b<o.inChannels;++b)for(var x=0;x<o.inHeight;++x)for(var E=0;E<o.inWidth;++E){for(var D=x-p,k=E-h,R=0,A=0;A<d;A+=l){var M=(D+A)/i;if(!(M<0||M>=o.outHeight||Math.floor(M)!==M))for(var O=0;O<f;O+=c){var P=(k+O)/s;P<0||P>=o.outWidth||Math.floor(P)!==P||(R+=y.get(_,M,P,b))}}m.set(R*v,_,x,E,b)}return m.toTensor()},t.prototype.pool3d=function(e,r,o){J(e,"pool3d");for(var i=r.strideDepth,s=r.strideHeight,a=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,d=r.effectiveFilterDepth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.front,m=r.padInfo.top,v=r.padInfo.left,y="max"===o?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,_=this.readSync(e.dataId),b=Ue(r.outShape,e.dtype),x=b.values,E=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],D=r.outShape[2]*r.outShape[3]*r.outShape[4],k=r.outShape[3]*r.outShape[4],R=r.outShape[4],A=0;A<r.batchSize;++A)for(var M=A*E,O=A*e.strides[0],P=0;P<r.inChannels;++P)for(var G=0;G<r.outDepth;++G){for(var q=G*i-p,K=q;K<0;)K+=u;for(var L=Math.min(r.inDepth,d+q),V=M+G*D,B=0;B<r.outHeight;++B){for(var z=B*s-m,Y=z;Y<0;)Y+=l;for(var ne=Math.min(r.inHeight,f+z),se=V+B*k,ve=0;ve<r.outWidth;++ve){for(var ge=ve*a-v,We=ge;We<0;)We+=c;for(var Xe=Math.min(r.inWidth,h+ge),Me=se+ve*R,He=y,Fe=0,kt=0,Ye=K;Ye<L;Ye+=u){for(var Dt=O+Ye*e.strides[1],mt=Y;mt<ne;mt+=l){for(var Jt=Dt+mt*e.strides[2],Gt=We;Gt<Xe;Gt+=c){var qt=_[Jt+Gt*e.strides[3]+P];if("max"===o&&qt>He?He=qt:"avg"===o&&(Fe+=qt,kt++),isNaN(He))break}if(isNaN(He))break}if(isNaN(He))break}x[Me+P]="avg"===o?Fe/kt:He}}}return b.toTensor()},t.prototype.avgPool3d=function(e,r){return J(e,"avgPool3d"),this.pool3d(e,r,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(e,r,o){J([e,r],"avgPool3dBackprop");for(var i=o.strideDepth,s=o.strideHeight,a=o.strideWidth,u=o.filterDepth,l=o.filterHeight,c=o.filterWidth,d=o.dilationDepth,f=o.dilationHeight,h=o.dilationWidth,p=o.effectiveFilterDepth,m=o.effectiveFilterHeight,v=o.effectiveFilterWidth,y=p-1-o.padInfo.front,_=v-1-o.padInfo.left,b=m-1-o.padInfo.top,x=Ue(r.shape,"float32"),E=1/(u*l*c),D=this.bufferSync(e),k=0;k<o.batchSize;++k)for(var R=0;R<o.inChannels;++R)for(var A=0;A<o.inDepth;++A)for(var M=0;M<o.inHeight;++M)for(var O=0;O<o.inWidth;++O){for(var P=A-y,G=M-b,q=O-_,K=0,L=0;L<p;L+=d){var V=(P+L)/i;if(!(V<0||V>=o.outDepth||Math.floor(V)!==V))for(var B=0;B<m;B+=f){var z=(G+B)/s;if(!(z<0||z>=o.outHeight||Math.floor(z)!==z))for(var Y=0;Y<v;Y+=h){var ne=(q+Y)/a;ne<0||ne>=o.outWidth||Math.floor(ne)!==ne||(K+=D.get(k,V,z,ne,R))}}}x.set(K*E,k,A,M,O,R)}return x.toTensor()},t.prototype.maxPool3d=function(e,r){return J(e,"maxPool3d"),this.pool3d(e,r,"max").toFloat()},t.prototype.maxPool3dPositions=function(e,r){for(var o=Ue(r.outShape,"int32"),i=r.strideDepth,s=r.strideHeight,a=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,d=r.effectiveFilterDepth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.front,m=r.padInfo.top,v=r.padInfo.left,y=this.bufferSync(e),_=0;_<r.batchSize;++_)for(var b=0;b<r.inChannels;++b)for(var x=0;x<r.outDepth;++x){for(var E=x*i-p,D=E;D<0;)D+=u;for(var k=Math.min(r.inDepth,d+E),R=0;R<r.outHeight;++R){for(var A=R*s-m,M=A;M<0;)M+=l;for(var O=Math.min(r.inHeight,f+A),P=0;P<r.outWidth;++P){for(var G=P*a-v,q=G;q<0;)q+=c;for(var K=Math.min(r.inWidth,h+G),L=Number.NEGATIVE_INFINITY,V=-1,B=D;B<k;B+=u)for(var z=B-E,Y=M;Y<O;Y+=l)for(var ne=Y-A,se=q;se<K;se+=c){var ve=se-G,ge=y.get(_,B,Y,se,b);ge>=L&&(L=ge,V=z*f*h+ne*f+ve)}o.set(V,_,x,R,P,b)}}}return o.toTensor()},t.prototype.maxPool3dBackprop=function(e,r,o,i){J([r,o],"maxPool3dBackprop");for(var s=this.maxPool3dPositions(r,i),a=i.strideDepth,u=i.strideHeight,l=i.strideWidth,c=i.dilationDepth,d=i.dilationHeight,f=i.dilationWidth,h=i.effectiveFilterDepth,p=i.effectiveFilterHeight,m=i.effectiveFilterWidth,v=h-1-i.padInfo.front,y=m-1-i.padInfo.left,_=p-1-i.padInfo.top,b=Ue(r.shape,"float32"),x=this.bufferSync(s),E=this.bufferSync(e),D=0;D<i.batchSize;++D)for(var k=0;k<i.inChannels;++k)for(var R=0;R<i.inDepth;++R)for(var A=0;A<i.inHeight;++A)for(var M=0;M<i.inWidth;++M){for(var O=R-v,P=A-_,G=M-y,q=0,K=0;K<h;K+=c){var L=(O+K)/a;if(!(L<0||L>=i.outDepth||Math.floor(L)!==L))for(var V=0;V<p;V+=d){var B=(P+V)/u;if(!(B<0||B>=i.outHeight||Math.floor(B)!==B))for(var z=0;z<m;z+=f){var Y=(G+z)/l;if(!(Y<0||Y>=i.outWidth||Math.floor(Y)!==Y)){var ne=h*p*m-1-x.get(D,L,B,Y,k)===K*p*m+V*m+z?1:0;0!==ne&&(q+=E.get(D,L,B,Y,k)*ne)}}}}b.set(q,D,R,A,M,k)}return b.toTensor()},t.prototype.cast=function(e,r){return c_(e,r,this)},t.prototype.reshape=function(e,r){return Kg(e,r)},t.prototype.avgPool=function(e,r){return J(e,"avgPool"),this.pool(e,r,"avg").toFloat()},t.prototype.resizeBilinear=function(e,r,o,i){J(e,"resizeBilinear");for(var s=e.shape,a=s[0],u=s[1],l=s[2],c=s[3],d=this.readSync(e.dataId),f=new Float32Array(me([a,r,o,c])),h=[i&&r>1?u-1:u,i&&o>1?l-1:l],p=[i&&r>1?r-1:r,i&&o>1?o-1:o],m=0,v=h[0]/p[0],y=h[1]/p[1],_=0;_<a;_++)for(var b=0;b<r;b++)for(var x=v*b,E=Math.floor(x),D=x-E,k=Math.min(u-1,Math.ceil(x)),R=_*e.strides[0]+E*e.strides[1],A=_*e.strides[0]+k*e.strides[1],M=0;M<o;M++)for(var O=y*M,P=Math.floor(O),G=O-P,q=Math.min(l-1,Math.ceil(O)),K=R+P*e.strides[2],L=A+P*e.strides[2],V=R+q*e.strides[2],B=A+q*e.strides[2],z=0;z<c;z++){var Y=d[K+z],ne=d[L+z],se=Y+(d[V+z]-Y)*G;f[m++]=se+(ne+(d[B+z]-ne)*G-se)*D}return Wn(f,[a,r,o,c])},t.prototype.resizeBilinearBackprop=function(e,r,o){J([e,r],"resizeBilinearBackprop");for(var i=r.shape,s=i[0],a=i[1],u=i[2],l=i[3],c=e.shape,d=c[1],f=c[2],h=new Float32Array(s*a*u*l),p=[o&&d>1?a-1:a,o&&f>1?u-1:u],m=[o&&d>1?d-1:d,o&&f>1?f-1:f],v=p[0]/m[0],y=p[1]/m[1],_=this.readSync(e.dataId),b=0,x=0;x<s;x++)for(var E=x*r.strides[0],D=0;D<d;D++)for(var k=D*v,R=Math.floor(k),A=Math.min(Math.ceil(k),a-1),M=E+R*r.strides[1],O=E+A*r.strides[1],P=k-R,G=1-P,q=0;q<f;q++)for(var K=q*y,L=Math.floor(K),V=Math.min(Math.ceil(K),u-1),B=K-L,z=1-B,Y=M+L*r.strides[2],ne=M+V*r.strides[2],se=O+L*r.strides[2],ve=O+V*r.strides[2],ge=G*z,We=G*B,Xe=P*z,Me=P*B,He=0;He<l;He++){var Fe=_[b++];h[Y+He]+=Fe*ge,h[ne+He]+=Fe*We,h[se+He]+=Fe*Xe,h[ve+He]+=Fe*Me}return Rr(h,[s,u,a,l],r.dtype)},t.prototype.resizeNearestNeighbor=function(e,r,o,i){J(e,"resizeNearestNeighbor");for(var s=e.shape,a=s[0],u=s[1],l=s[2],c=s[3],d=this.readSync(e.dataId),f=new Float32Array(a*r*o*c),h=[i&&r>1?u-1:u,i&&o>1?l-1:l],p=[i&&r>1?r-1:r,i&&o>1?o-1:o],m=h[0]/p[0],v=h[1]/p[1],y=0,_=0;_<a;_++)for(var b=_*e.strides[0],x=0;x<r;x++)for(var E=m*x,D=b+Math.min(u-1,i?Math.round(E):Math.floor(E))*e.strides[1],k=0;k<o;k++)for(var R=v*k,A=D+Math.min(l-1,i?Math.round(R):Math.floor(R))*e.strides[2],M=0;M<c;M++)f[y++]=d[A+M];return Wn(f,[a,r,o,c],e.dtype)},t.prototype.resizeNearestNeighborBackprop=function(e,r,o){J([e,r],"resizeNearestNeighborBackprop");for(var i=r.shape,s=i[0],a=i[1],u=i[2],l=i[3],c=e.shape,d=c[1],f=c[2],h=new Float32Array(s*a*u*l),p=this.readSync(e.dataId),m=[o&&d>1?a-1:a,o&&f>1?u-1:u],v=[o&&d>1?d-1:d,o&&f>1?f-1:f],y=m[0]/v[0],_=m[1]/v[1],b=1/y,x=1/_,E=2*Math.ceil(b)+2,D=2*Math.ceil(x)+2,k=0;k<s;k++)for(var R=k*r.strides[0],A=0;A<a;A++)for(var M=R+A*r.strides[1],O=Math.floor(A*b),P=Math.floor(O-E/2),G=0;G<u;G++)for(var q=M+G*r.strides[2],K=Math.floor(G*x),L=Math.floor(K-D/2),V=0;V<l;V++){for(var B=0,z=0;z<E;z++){var Y=z+P;if(!(Y<0||Y>=d)){var ne=R+Y*e.strides[1],se=Y*y;if(A===Math.min(a-1,o?Math.round(se):Math.floor(se)))for(var ve=0;ve<D;ve++){var ge=ve+L;if(!(ge<0||ge>=f)){var We=ne+ge*e.strides[2],Xe=ge*_;G===Math.min(u-1,o?Math.round(Xe):Math.floor(Xe))&&(B+=p[We+V])}}}}h[q+V]=B}return Rr(h,r.shape,r.dtype)},t.prototype.batchNormalization=function(e,r,o,i,s,a){J([e,r,o,s,a],"batchNorm");for(var u=this.readSync(e.dataId),l=this.readSync(r.dataId),c=this.readSync(o.dataId),d=s?this.readSync(s.dataId):new Float32Array([1]),f=a?this.readSync(a.dataId):new Float32Array([0]),h=new Float32Array(u.length),p=f.length,m=d.length,v=c.length,y=l.length,_=0,b=0,x=0,E=0,D=0;D<u.length;++D)h[D]=f[_++]+(u[D]-l[b++])*d[x++]/Math.sqrt(c[E++]+i),_>=p&&(_=0),b>=y&&(b=0),x>=m&&(x=0),E>=v&&(E=0);return Rr(h,e.shape)},t.prototype.localResponseNormalization4D=function(e,r,o,i,s){J(e,"localResponseNormalization4D");var a=e.shape[3],u=a-1,l=this.readSync(e.dataId),c=e.size,d=new Float32Array(c);function f(v){for(var y=v%a,_=v-y+Math.max(0,y-r),b=v-y+Math.min(y+r,u),x=0;_<=b;_++){var E=l[_];x+=E*E}return x}for(var h=0;h<c;h++){var p=f(h),m=l[h]*Math.pow(o+i*p,-s);d[h]=m}return Rr(d,e.shape)},t.prototype.LRNGrad=function(e,r,o,i,s,a,u){J(e,"LRNGrad");for(var l=e.shape[3],c=this.readSync(e.dataId),d=this.readSync(r.dataId),f=this.readSync(o.dataId),h=new Float32Array(e.size),p=e.size,m=0;m<p;m++){for(var v=m%l,y=m-v+Math.max(0,v-i),_=m-v+Math.min(l,v+i+1),b=0,x=y;x<_;x++)b+=Math.pow(d[x],2);for(b=a*b+s,x=y;x<_;x++){var E=-2*a*u*d[x]*f[m]/b;m===x&&(E+=Math.pow(b,-u)),h[x]+=E*=c[m]}}return Rr(h,e.shape)},t.prototype.multinomial=function(e,r,o,i){J(e,"multinomial");for(var s=r?e:os(e),a=s.shape[0],u=s.shape[1],l=Ft([a,o],"int32"),c=this.readSync(l.dataId),d=this.readSync(s.dataId),f=0;f<a;++f){var h=f*u,p=new Float32Array(u-1);p[0]=d[h];for(var m=1;m<p.length;++m)p[m]=p[m-1]+d[h+m];for(var v=Bg(i.toString()),y=f*o,_=0;_<o;++_){var b=v();c[y+_]=p.length;for(var x=0;x<p.length;x++)if(b<p[x]){c[y+_]=x;break}}}return l},t.prototype.oneHot=function(e,r,o,i){J(e,"oneHot");var s=new Float32Array(e.size*r);s.fill(i);for(var a=this.readSync(e.dataId),u=0;u<e.size;++u)a[u]>=0&&a[u]<r&&(s[u*r+a[u]]=o);return oa(s,[e.size,r],"int32")},t.prototype.nonMaxSuppression=function(e,r,o,i,s){return J(e,"nonMaxSuppression"),h_(this.readSync(e.dataId),this.readSync(r.dataId),o,i,s)},t.prototype.fft=function(e){return this.fftBatch(e,!1)},t.prototype.ifft=function(e){return this.fftBatch(e,!0)},t.prototype.fftBatch=function(e,r){for(var o=e.shape[0],i=e.shape[1],s=Ue(e.shape,"float32"),a=Ue(e.shape,"float32"),u=fo(e).as2D(o,i),l=fi(e).as2D(o,i),c=0;c<o;c++)for(var d=u.slice([c,0],[1,i]),f=l.slice([c,0],[1,i]),h=Hn(d,f),p=this.readSync(this.fftImpl(h,r).dataId),m=0;m<i;m++){var v=cR(p,m);s.values[c*i+m]=v.real,a.values[c*i+m]=v.imag}return Hn(s.toTensor(),a.toTensor()).as2D(o,i)},t.prototype.fftImpl=function(e,r){var o=e.as1D(),i=o.size;if(this.isExponentOf2(i)){var s=this.fftRadix2(o,i,r).as2D(e.shape[0],e.shape[1]);return r&&(s=Hn(fo(s).div(oe(i)),fi(s).div(oe(i)))),s}var a=this.readSync(e.dataId),u=function(l){for(var c=new Float32Array(l.length/2),d=new Float32Array(l.length/2),f=0;f<l.length;f+=2)c[f/2]=l[f],d[f/2]=l[f+1];return{real:c,imag:d}}(this.fourierTransformByMatmul(a,i,r));return Hn(u.real,u.imag).as2D(e.shape[0],e.shape[1])},t.prototype.isExponentOf2=function(e){return 0==(e&e-1)},t.prototype.fftRadix2=function(e,r,o){if(1===r)return e;var i=this.readSync(e.dataId),s=r/2,a=function(y){for(var _=Math.ceil(y.length/4),b=new Float32Array(_),x=new Float32Array(_),E=0;E<y.length;E+=4)b[Math.floor(E/4)]=y[E],x[Math.floor(E/4)]=y[E+1];return{real:b,imag:x}}(i),u=Hn(a.real,a.imag).as1D(),l=function(y){for(var _=Math.floor(y.length/4),b=new Float32Array(_),x=new Float32Array(_),E=2;E<y.length;E+=4)b[Math.floor(E/4)]=y[E],x[Math.floor(E/4)]=y[E+1];return{real:b,imag:x}}(i),c=Hn(l.real,l.imag).as1D();u=this.fftRadix2(u,s,o),c=this.fftRadix2(c,s,o);var d=function(y,_){for(var b=new Float32Array(y/2),x=new Float32Array(y/2),E=0;E<Math.ceil(y/2);E++){var D=(_?2:-2)*Math.PI*(E/y);b[E]=Math.cos(D),x[E]=Math.sin(D)}return{real:b,imag:x}}(r,o),f=Hn(d.real,d.imag).mul(c),h=u.add(f),p=u.sub(f),m=fo(h).concat(fo(p)),v=fi(h).concat(fi(p));return Hn(m,v).as1D()},t.prototype.fourierTransformByMatmul=function(e,r,o){for(var i=new Float32Array(2*r),s=0;s<r;s++){for(var a=0,u=0,l=0;l<r;l++){var c=b8(s*l,r,o),d=cR(e,l);a+=d.real*c.real-d.imag*c.imag,u+=d.real*c.imag+d.imag*c.real}o&&(a/=r,u/=r),w8(i,a,u,s)}return i},t.prototype.depthToSpace=function(e,r,o){I("NHWC"===o,function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+o}),I(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});for(var i=e.shape[0],s=e.shape[1],a=e.shape[2],u=e.shape[3],l=s*r,c=a*r,d=u/(r*r),f=this.readSync(e.dataId),h=new Float32Array(i*l*c*d),p=0,m=0;m<i;++m)for(var v=0;v<l;++v)for(var y=Math.floor(v/r),_=v%r,b=0;b<c;++b)for(var x=Math.floor(b/r),E=(_*r+b%r)*d,D=0;D<d;++D)h[p++]=f[D+E+u*(x+a*(y+s*m))];return Rr(h,[i,l,c,d])},t.prototype.broadcastedBinaryOp=function(e,r,o,i){var s=Ze(e.shape,r.shape),a=Ue(s,o),u=this.readSync(e.dataId),l=this.readSync(r.dataId),c=is(e.shape,s),d=is(r.shape,s),f=a.values;if(c.length+d.length===0)for(var h=0;h<f.length;++h)f[h]=i(u[h%u.length],l[h%l.length]);else{var p=this.bufferSync(e),m=this.bufferSync(r),v=function(y){var _=a.indexToLoc(y),b=_.slice(-e.rank);c.forEach(function(k){return b[k]=0});var x=p.locToIndex(b),E=_.slice(-r.rank);d.forEach(function(k){return E[k]=0});var D=m.locToIndex(E);f[y]=i(u[x],l[D])};for(h=0;h<f.length;++h)v(h)}return a.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(e,r,o){var i=Ze(e.shape,r.shape),s=Ue(i,"float32"),a=Ue(i,"float32"),u=this.readSync(e.dataId),l=this.readSync(r.dataId),c=is(e.shape,i),d=is(r.shape,i),f=s.values,h=a.values;if(c.length+d.length===0)for(var p=0;p<f.length;p++){var m=p%u.length,v=p%l.length,y=o(u[2*m],u[2*m+1],l[2*v],l[2*v+1]);f[p]=y.real,h[p]=y.imag}else{var _=this.bufferSync(this.data.get(e.dataId).complexTensors.real),b=this.bufferSync(this.data.get(r.dataId).complexTensors.real),x=function(E){var D=s.indexToLoc(E),k=D.slice(-e.rank);c.forEach(function(P){return k[P]=0});var R=_.locToIndex(k),A=D.slice(-r.rank);d.forEach(function(P){return A[P]=0});var M=b.locToIndex(A),O=o(u[2*R],u[2*R+1],l[2*M],l[2*M+1]);f[E]=O.real,h[E]=O.imag};for(p=0;p<f.length;p++)x(p)}return this.complex(s.toTensor(),a.toTensor())},t.prototype.split=function(e,r,o){return hR(e,r,o)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(e,r,o,i,s,a){for(var u=e.shape,l=u[0],c=u[1],d=u[2],f=u[3],h=r.shape[0],p=i[0],m=i[1],v=Ue([h,p,m,f],"float32"),y=this.readSync(r.dataId),_=this.readSync(o.dataId),b=this.readSync(e.dataId),x=e.strides,E=v.strides,D=0;D<h;D++){var k=4*D,R=y[k],A=y[k+1],M=y[k+2],O=y[k+3],P=_[D];if(!(P>=l))for(var G=p>1?(M-R)*(c-1)/(p-1):0,q=m>1?(O-A)*(d-1)/(m-1):0,K=0;K<p;K++){var L=p>1?R*(c-1)+K*G:.5*(R+M)*(c-1);if(L<0||L>c-1)for(var V=0;V<m;V++)for(var B=0;B<f;B++){var z=B+V*E[2]+K*E[1]+D*E[0];v.values[z]=a}else if("bilinear"===s){var Y=Math.floor(L),ne=Math.ceil(L),se=L-Y;for(V=0;V<m;V++)if((Ye=m>1?A*(d-1)+V*q:.5*(A+O)*(d-1))<0||Ye>d-1)for(B=0;B<f;B++)v.values[z=B+V*E[2]+K*E[1]+D*E[0]]=a;else{var ve=Math.floor(Ye),ge=Math.ceil(Ye),We=Ye-ve;for(B=0;B<f;B++){var Xe=b[z=B+ve*x[2]+Y*x[1]+P*x[0]],Me=b[z=B+ge*x[2]+Y*x[1]+P*x[0]],He=b[z=B+ve*x[2]+ne*x[1]+P*x[0]],Fe=Xe+(Me-Xe)*We,kt=He+(b[z=B+ge*x[2]+ne*x[1]+P*x[0]]-He)*We;v.values[z=B+V*E[2]+K*E[1]+D*E[0]]=Fe+(kt-Fe)*se}}}else for(V=0;V<m;++V){var Ye;if((Ye=m>1?A*(d-1)+V*q:.5*(A+O)*(d-1))<0||Ye>d-1)for(B=0;B<f;B++)v.values[z=B+V*E[2]+K*E[1]+D*E[0]]=a;else{var Dt=Math.round(Ye),mt=Math.round(L);for(B=0;B<f;B++)v.values[B+V*E[2]+K*E[1]+D*E[0]]=b[B+Dt*x[2]+mt*x[1]+P*x[0]]}}}}return v.toTensor()},t.prototype.sparseToDense=function(e,r,o,i){var s=hf(0,e,o);return this.scatter(e,r,o,s.outputSize,s.sliceSize,s.numUpdates,s.sliceRank,s.strides,i,!1)},t.prototype.gatherND=function(e,r){var o=r.shape,i=o[o.length-1],s=r_(e,r),a=s[0],u=s[1],l=s[2],c=s[3];if(0===u)return Wn([],a,e.dtype);for(var d=new tf([u,l],e.dtype),f=this.readSync(r.dataId),h=this.readSync(e.dataId),p=0;p<u;p++){for(var m=[],v=0,y=0;y<i;y++){var _=f[p*i+y];v+=_*c[y],m.push(_)}if(v<0||v>=e.size/l)throw new Error("Invalid indices: "+m+" does not index into "+e.shape);for(var b=0;b<l;b++)d.values[p*l+b]=h[v*l+b]}return d.toTensor().reshape(a)},t.prototype.scatterND=function(e,r,o){var i=hf(0,e,o),s=i.sliceRank,a=i.numUpdates,u=i.sliceSize,l=i.strides,c=i.outputSize,d=oe(0);return this.scatter(e,r,o,c,u,a,s,l,d,!0)},t.prototype.fill=function(e,r,o){var i=Yd(o=o||Il(r),me(e));return i.fill(r),N.makeTensor(i,e,o,this)},t.prototype.onesLike=function(e){if("string"===e.dtype)throw new Error("onesLike is not supported for string tensors");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){var r=Yd(e.dtype,me(e.shape));return this.makeOutput(r,e.shape,e.dtype)},t.prototype.linspace=function(e,r,o){return d_(e,r,o)},t.prototype.scatter=function(e,r,o,i,s,a,u,l,c,d){var f=[i/s,s],h=this.readSync(e.dataId),p=this.readSync(r.dataId);if(0===i)return Wn([],o,r.dtype);var m=new tf(f,r.dtype);m.values.fill(this.readSync(c.dataId)[0]);for(var v=0;v<a;v++){for(var y=[],_=0,b=0;b<u;b++){var x=h[v*u+b];y.push(x),_+=x*l[b]}if(_<0||_>=i/s)throw new Error("Invalid indices: "+y+" does not index into "+o);for(var E=0;E<s;E++)d?m.values[_*s+E]+=p[v*s+E]:m.values[_*s+E]=0===r.rank?p[0]:p[v*s+E]}return m.toTensor().reshape(o)},t}(lR);N.registerBackend("cpu",function(){return new CK},1);for(var H_=0,WN=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(n){var t=n.inputs,r=n.attrs,i=t.boxes,s=t.scores,u=r.maxOutputSize,l=r.iouThreshold,c=r.scoreThreshold,d=r.softNmsSigma,f=n.backend;J(i,"NonMaxSuppressionWithScore");var h=p_(f.data.get(i.dataId).values,f.data.get(s.dataId).values,u,l,c,d);return[h.selectedIndices,h.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(n){var r=n.inputs.x,o=n.backend;J(r,"square");for(var i=o.data.get(r.dataId).values,s=new Float32Array(i.length),a=0;a<i.length;++a){var u=i[a];s[a]=u*u}return{dataId:o.write(s,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:wf,backendName:"cpu",kernelFunc:function(n){var t=n.inputs,o=t.a,i=t.b,s=n.backend;J([o,i],wf);var a=s.data.get(o.dataId).values,u=s.data.get(i.dataId).values,l=function(f,h,p,m,v,y){var _=Ze(f,h),b=_.length,x=Fo(_),E=Sl(v,me(_)),D=f.length,k=h.length,R=Fo(f),A=Fo(h),M=is(f,_),O=is(h,_);if(M.length+O.length===0)for(var P=0;P<E.length;++P)E[P]=y(p[P%p.length],m[P%m.length]);else{var G=function(q){var K=fk(q,b,x),L=K.slice(-D);M.forEach(function(Y){return L[Y]=0});var V=L0(L,D,R),B=K.slice(-k);O.forEach(function(Y){return B[Y]=0});var z=L0(B,k,A);E[q]=y(p[V],m[z])};for(P=0;P<E.length;++P)G(P)}return[E,_]}(o.shape,i.shape,a,u,o.dtype,function(f,h){var p=f-h;return p*p}),d=l[1];return{dataId:s.write(l[0],d,o.dtype),shape:d,dtype:o.dtype}}}];H_<WN.length;H_++)ek(WN[H_]);for(var Bl,EK=function(n){this.variableNames=["A"];var t=tr(),e=n[0],r=n[1];this.outputShape=n,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+r+".0, "+e+".0);\n\n        vec4 values = "+t.texture2D+"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    "},DK=function(n){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=tr(),e=n[0],r=n[1];this.outputShape=n,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2("+r+".0, "+e+".0);\n            vec4 values = "+t.texture2D+"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        "+t.output+" = result;\n      }\n    "},W_=0,zN=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(n){var e=n.backend,o=n.inputs.pixels,s=typeof HTMLVideoElement<"u"&&o instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&o instanceof HTMLImageElement,u=s?[o.videoWidth,o.videoHeight]:[o.width,o.height],l=u[0],c=u[1],d=[c,l],f=[c,l,n.attrs.numChannels];(a||s)&&(null==Bl&&(Bl=document.createElement("canvas").getContext("2d")),Bl.canvas.width=l,Bl.canvas.height=c,Bl.drawImage(o,0,0,l,c),o=Bl.canvas);var h=e.makeTensorInfo(d,"int32");e.texData.get(h.dataId).usage=zr.PIXELS,e.gpgpu.uploadPixelDataToTexture(e.getTexture(h.dataId),o);var p=$().getBool("WEBGL_PACK")?new DK(f):new EK(f),m=e.runWebGLProgram(p,[h],"int32");return e.disposeData(h.dataId),m}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(n){var t=n.inputs,e=n.backend,r=n.attrs;Pg("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var s=t.scores,u=r.maxOutputSize,l=r.iouThreshold,c=r.scoreThreshold,d=r.softNmsSigma,f=e,h=p_(f.readSync(t.boxes.dataId),f.readSync(s.dataId),u,l,c,d);return[h.selectedIndices,h.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(n){var r=n.inputs.x,o=n.backend,i=new $e(r.shape,"return x * x;");return o.runWebGLProgram(i,[r],r.dtype)}},{kernelName:wf,backendName:"webgl",kernelFunc:function(n){var t=n.inputs,o=t.a,i=t.b,s=n.backend,a=$().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ss("return (a - b) * (a - b);",o.shape,i.shape):new Zt("return (a - b) * (a - b);",o.shape,i.shape);return s.compileAndRun(a,[o,i])}}];W_<zN.length;W_++)ek(zN[W_]);for(var z_=0,$N=[{kernelName:"Square",gradFunc:function(n,t){var e=t[0];return{x:function(){return n.mul(e.toFloat().mul(2))}}}},{kernelName:wf,gradFunc:function(n,t){var e=t[0],r=t[1],o=oe(2);return{a:function(){return nr(n,nr(o,In(e,r)))},b:function(){return nr(n,nr(o,In(r,e)))}}}}];z_<$N.length;z_++)AG($N[z_]);var SK=function(){function n(){}return n.prototype.fetch=function(t,e){return fetch(t,e)},n.prototype.now=function(){return performance.now()},n.prototype.encode=function(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Browser's encoder only supports utf-8, but got "+e);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},n.prototype.decode=function(t,e){return new TextDecoder(e).decode(t)},n}();$().get("IS_BROWSER")&&$().setPlatform("browser",new SK);var $_,AK=function(){function n(){this.util=sr(753),this.textEncoder=new this.util.TextEncoder}return n.prototype.fetch=function(t,e){return null!=$().global.fetch?$().global.fetch(t,e):(null==$_&&($_=sr(522)),$_(t,e))},n.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},n.prototype.encode=function(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Node built-in encoder only supports utf-8, but got "+e);return this.textEncoder.encode(t)},n.prototype.decode=function(t,e){return 0===t.length?"":new this.util.TextDecoder(e).decode(t)},n}();$().get("IS_NODE")&&$().setPlatform("node",new AK);var G_={float32:4,int32:4,uint16:2,uint8:1,bool:1};function GN(n,t){for(var e={},r=0,o=function(a){var u=a.name,l=a.dtype,c=a.shape,d=me(c),f=void 0;if("quantization"in a){var h=a.quantization;if("uint8"!==h.dtype&&"uint16"!==h.dtype)throw new Error("Weight "+a.name+" has unknown quantization dtype "+h.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var p=G_[h.dtype],m=n.slice(r,r+d*p),v="uint8"===h.dtype?new Uint8Array(m):new Uint16Array(m);if("float32"===l)f=Float32Array.from(v,function(D){return D*h.scale+h.min});else{if("int32"!==l)throw new Error("Unsupported dtype in weight '"+u+"': "+l);f=Int32Array.from(v,function(D){return Math.round(D*h.scale+h.min)})}r+=d*p}else if("string"===l){var y=me(a.shape);f=[];for(var _=0;_<y;_++){var b=new Uint32Array(n.slice(r,r+4))[0];r+=4;var x=new Uint8Array(n.slice(r,r+b));f.push(x),r+=b}}else{var E=G_[l];if(m=n.slice(r,r+d*E),"float32"===l)f=new Float32Array(m);else if("int32"===l)f=new Int32Array(m);else{if("bool"!==l)throw new Error("Unsupported dtype in weight '"+u+"': "+l);f=new Uint8Array(m)}r+=d*E}e[u]=Wn(f,c,l)},i=0,s=t;i<s.length;i++)o(s[i]);return e}function TK(n){if(null===n)throw new Error("Invalid input value: "+JSON.stringify(n));var t=0,e=[];n.forEach(function(i){if(t+=i.byteLength,e.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+i.constructor.name)});var r=new Uint8Array(t),o=0;return e.forEach(function(i){r.set(new Uint8Array(i.buffer),o),o+=i.byteLength}),r.buffer}var q_=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function qN(n){return q_?Buffer.byteLength(n):new Blob([n]).size}function K_(n){var t=0;n.forEach(function(o){t+=o.byteLength});var e=new Uint8Array(t),r=0;return n.forEach(function(o){e.set(new Uint8Array(o),r),r+=o.byteLength}),e.buffer}function KN(n){for(n=n.trim();n.endsWith("/");)n=n.slice(0,n.length-1);var t=n.split("/");return t[t.length-1]}function Cf(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==n.modelTopology?0:qN(JSON.stringify(n.modelTopology)),weightSpecsBytes:null==n.weightSpecs?0:qN(JSON.stringify(n.weightSpecs)),weightDataBytes:null==n.weightData?0:n.weightData.byteLength}}var Kr=function(){function n(){this.saveRouters=[],this.loadRouters=[]}return n.getInstance=function(){return null==n.instance&&(n.instance=new n),n.instance},n.registerSaveRouter=function(t){n.getInstance().saveRouters.push(t)},n.registerLoadRouter=function(t){n.getInstance().loadRouters.push(t)},n.getSaveHandlers=function(t){return n.getHandlers(t,"save")},n.getLoadHandlers=function(t,e){return n.getHandlers(t,"load",e)},n.getHandlers=function(t,e,r){var o=[];return("load"===e?n.getInstance().loadRouters:n.getInstance().saveRouters).forEach(function(i){var s=i(t,r);null!==s&&o.push(s)}),o},n}(),Vl="://",aa=function(){function n(){this.managers={}}return n.getInstance=function(){return null==n.instance&&(n.instance=new n),n.instance},n.registerManager=function(t,e){I(null!=t,function(){return"scheme must not be undefined or null."}),t.endsWith(Vl)&&(t=t.slice(0,t.indexOf(Vl))),I(t.length>0,function(){return"scheme must not be an empty string."});var r=n.getInstance();I(null==r.managers[t],function(){return"A model store manager is already registered for scheme '"+t+"'."}),r.managers[t]=e},n.getManager=function(t){var e=this.getInstance().managers[t];if(null==e)throw new Error("Cannot find model manager for scheme '"+t+"'");return e},n.getSchemes=function(){return Object.keys(this.getInstance().managers)},n}();function cm(n){if(-1===n.indexOf(Vl))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+aa.getSchemes().join(","));return{scheme:n.split(Vl)[0],path:n.split(Vl)[1]}}function XN(n,t,e){return void 0===e&&(e=!1),he(this,void 0,void 0,function(){var r,o,i,s,a,u,l,c,d;return pe(this,function(f){switch(f.label){case 0:return I(n!==t,function(){return"Old path and new path are the same: '"+n+"'"}),I((r=Kr.getLoadHandlers(n)).length>0,function(){return"Copying failed because no load handler is found for source URL "+n+"."}),I(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+n+"."}),o=r[0],I((i=Kr.getSaveHandlers(t)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+t+"."}),I(i.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+t+"."}),s=i[0],a=cm(n).scheme,u=cm(n).path,l=a===cm(n).scheme,[4,o.load()];case 1:return c=f.sent(),e&&l?[4,aa.getManager(a).removeModel(u)]:[3,3];case 2:f.sent(),f.label=3;case 3:return[4,s.save(c)];case 4:return d=f.sent(),!e||l?[3,6]:[4,aa.getManager(a).removeModel(u)];case 5:f.sent(),f.label=6;case 6:return[2,d.modelArtifactsInfo]}})})}var ru="models_store",ua="model_info_store";function YN(){if(!$().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var n=window||self,t=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function X_(n){var t=n.result;t.createObjectStore(ru,{keyPath:"modelPath"}),t.createObjectStore(ua,{keyPath:"modelPath"})}var Ul=function(){function n(t){if(this.indexedDB=YN(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return n.prototype.save=function(t){return he(this,void 0,void 0,function(){return pe(this,function(e){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]})})},n.prototype.load=function(){return he(this,void 0,void 0,function(){return pe(this,function(t){return[2,this.databaseAction(this.modelPath)]})})},n.prototype.databaseAction=function(t,e){var r=this;return new Promise(function(o,i){var s=r.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return X_(s)},s.onsuccess=function(){var a=s.result;if(null==e){var u=a.transaction(ru,"readonly"),l=u.objectStore(ru).get(r.modelPath);l.onsuccess=function(){if(null==l.result)return a.close(),i(new Error("Cannot find model with path '"+r.modelPath+"' in IndexedDB."));o(l.result.modelArtifacts)},l.onerror=function(m){return a.close(),i(l.error)},u.oncomplete=function(){return a.close()}}else{var c,d=Cf(e),f=a.transaction(ua,"readwrite"),h=f.objectStore(ua),p=h.put({modelPath:r.modelPath,modelArtifactsInfo:d});p.onsuccess=function(){var m=(c=a.transaction(ru,"readwrite")).objectStore(ru).put({modelPath:r.modelPath,modelArtifacts:e,modelArtifactsInfo:d});m.onsuccess=function(){return o({modelArtifactsInfo:d})},m.onerror=function(v){var y=(h=f.objectStore(ua)).delete(r.modelPath);y.onsuccess=function(){return a.close(),i(m.error)},y.onerror=function(_){return a.close(),i(m.error)}}},p.onerror=function(m){return a.close(),i(p.error)},f.oncomplete=function(){null==c?a.close():c.oncomplete=function(){return a.close()}}}},s.onerror=function(a){return i(s.error)}})},n.URL_SCHEME="indexeddb://",n}(),QN=function(n){return $().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Ul.URL_SCHEME)?(t=n.slice(Ul.URL_SCHEME.length),new Ul(t)):null;var t};Kr.registerSaveRouter(QN),Kr.registerLoadRouter(QN);var MK=function(){function n(){this.indexedDB=YN()}return n.prototype.listModels=function(){return he(this,void 0,void 0,function(){var t=this;return pe(this,function(e){return[2,new Promise(function(r,o){var i=t.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return X_(i)},i.onsuccess=function(){var s=i.result,a=s.transaction(ua,"readonly"),u=a.objectStore(ua).getAll();u.onsuccess=function(){for(var l={},c=0,d=u.result;c<d.length;c++){var f=d[c];l[f.modelPath]=f.modelArtifactsInfo}r(l)},u.onerror=function(l){return s.close(),o(u.error)},a.oncomplete=function(){return s.close()}},i.onerror=function(s){return o(i.error)}})]})})},n.prototype.removeModel=function(t){return he(this,void 0,void 0,function(){var e=this;return pe(this,function(r){var o;return t=(o=t).startsWith(Ul.URL_SCHEME)?o.slice(Ul.URL_SCHEME.length):o,[2,new Promise(function(i,s){var a=e.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return X_(a)},a.onsuccess=function(){var u,l=a.result,c=l.transaction(ua,"readwrite"),d=c.objectStore(ua),f=d.get(t);f.onsuccess=function(){if(null==f.result)return l.close(),s(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var h=d.delete(t),p=function(){var m=(u=l.transaction(ru,"readwrite")).objectStore(ru).delete(t);m.onsuccess=function(){return i(f.result.modelArtifactsInfo)},m.onerror=function(v){return s(f.error)}};h.onsuccess=p,h.onerror=function(m){return p(),l.close(),s(f.error)}},f.onerror=function(h){return l.close(),s(f.error)},c.oncomplete=function(){null==u?l.close():u.oncomplete=function(){return l.close()}}},a.onerror=function(u){return s(a.error)}})]})})},n}();if($().getBool("IS_BROWSER"))try{aa.registerManager(Ul.URL_SCHEME,new MK)}catch{}var us="/",jl="tensorflowjs_models",ZN="info",kK="model_topology",RK="weight_specs",NK="weight_data",FK="model_metadata";function JN(n){return{info:[jl,n,ZN].join(us),topology:[jl,n,kK].join(us),weightSpecs:[jl,n,RK].join(us),weightData:[jl,n,NK].join(us),modelMetadata:[jl,n,FK].join(us)}}function PK(n){var t=n.split(us);if(t.length<3)throw new Error("Invalid key format: "+n);return t.slice(1,t.length-1).join(us)}var Hl=function(){function n(t){if(!$().getBool("IS_BROWSER")||typeof window>"u"||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=JN(this.modelPath)}return n.prototype.save=function(t){return he(this,void 0,void 0,function(){var e,r,o;return pe(this,function(i){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");e=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),o=Cf(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(o)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(s){if(q_)return Buffer.from(s).toString("base64");for(var a=new Uint8Array(s),u="",l=0,c=a.length;l<c;l++)u+=String.fromCharCode(a[l]);return btoa(u)}(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),[2,{modelArtifactsInfo:o}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+o.modelTopologyBytes+", weightSpecsBytes="+o.weightSpecsBytes+", weightDataBytes="+o.weightDataBytes+".")}return[2]})})},n.prototype.load=function(){return he(this,void 0,void 0,function(){var t,e,r,o,i,s,a;return pe(this,function(u){if(null==(t=JSON.parse(this.LS.getItem(this.keys.info))))throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if("JSON"!==t.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(e={},null==(r=JSON.parse(this.LS.getItem(this.keys.topology))))throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(e.modelTopology=r,null==(o=JSON.parse(this.LS.getItem(this.keys.weightSpecs))))throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(e.weightSpecs=o,null!=(i=this.LS.getItem(this.keys.modelMetadata))&&(s=JSON.parse(i),e.format=s.format,e.generatedBy=s.generatedBy,e.convertedBy=s.convertedBy,e.userDefinedMetadata=s.userDefinedMetadata),null==(a=this.LS.getItem(this.keys.weightData)))throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return e.weightData=function(l){if(q_){var c=Buffer.from(l,"base64");return c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength)}for(var d=atob(l),f=new Uint8Array(d.length),h=0;h<d.length;++h)f.set([d.charCodeAt(h)],h);return f.buffer}(a),[2,e]})})},n.URL_SCHEME="localstorage://",n}(),eF=function(n){return $().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Hl.URL_SCHEME)?(t=n.slice(Hl.URL_SCHEME.length),new Hl(t)):null;var t};Kr.registerSaveRouter(eF),Kr.registerLoadRouter(eF);var OK=function(){function n(){I($().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),I(typeof window>"u"||void 0!==window.localStorage,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return n.prototype.listModels=function(){return he(this,void 0,void 0,function(){var t,e,r,o,i,s;return pe(this,function(a){for(t={},e=jl+us,r=us+ZN,o=0;o<this.LS.length;++o)(i=this.LS.key(o)).startsWith(e)&&i.endsWith(r)&&(s=PK(i),t[s]=JSON.parse(this.LS.getItem(i)));return[2,t]})})},n.prototype.removeModel=function(t){return he(this,void 0,void 0,function(){var e,r;return pe(this,function(o){var i;if(t=(i=t).startsWith(Hl.URL_SCHEME)?i.slice(Hl.URL_SCHEME.length):i,e=JN(t),null==this.LS.getItem(e.info))throw new Error("Cannot find model at path '"+t+"'");return r=JSON.parse(this.LS.getItem(e.info)),this.LS.removeItem(e.info),this.LS.removeItem(e.topology),this.LS.removeItem(e.weightSpecs),this.LS.removeItem(e.weightData),[2,r]})})},n}();if($().getBool("IS_BROWSER"))try{aa.registerManager(Hl.URL_SCHEME,new OK)}catch{}function tF(n){return new Promise(function(t){return setTimeout(t)}).then(n)}var Y_=function(){function n(t){if(!$().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(n.URL_SCHEME)&&(t=t.slice(n.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelTopologyFileName=t+".json",this.weightDataFileName=t+".weights.bin"}return n.prototype.save=function(t){return he(this,void 0,void 0,function(){var e,i,s,a;return pe(this,function(u){switch(u.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return i=window.URL.createObjectURL(new Blob([JSON.stringify({modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}]})],{type:"application/json"})),(s=this.jsonAnchor??document.createElement("a")).download=this.modelTopologyFileName,s.href=i,[4,tF(function(){return s.dispatchEvent(new MouseEvent("click"))})];case 2:return u.sent(),null==t.weightData?[3,4]:((a=this.weightDataAnchor??document.createElement("a")).download=this.weightDataFileName,a.href=e,[4,tF(function(){return a.dispatchEvent(new MouseEvent("click"))})]);case 3:u.sent(),u.label=4;case 4:return[2,{modelArtifactsInfo:Cf(t)}]}})})},n.URL_SCHEME="downloads://",n}(),UK=function(){function n(t){if(null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return n.prototype.load=function(){return he(this,void 0,void 0,function(){var t,e,r=this;return pe(this,function(o){return t=this.files[0],e=this.files.slice(1),[2,new Promise(function(i,s){var a=new FileReader;a.onload=function(u){var l=JSON.parse(u.target.result),c=l.modelTopology;if(null!=c){0===e.length&&i({modelTopology:c});var d=l.weightsManifest;if(null!=d){var f;try{f=r.checkManifestAndWeightFiles(d,e)}catch(v){return void s(v)}var h=[],p=[],m=[];d.forEach(function(v){v.paths.forEach(function(y){p.push(y),m.push(null)}),h.push.apply(h,v.weights)}),d.forEach(function(v){v.paths.forEach(function(y){var _=new FileReader;_.onload=function(b){var x=b.target.result,E=p.indexOf(y);m[E]=x,-1===m.indexOf(null)&&i({modelTopology:c,weightSpecs:h,weightData:K_(m),format:l.format,generatedBy:l.generatedBy,convertedBy:l.convertedBy,userDefinedMetadata:l.userDefinedMetadata})},_.onerror=function(b){return s("Failed to weights data from file of path '"+y+"'.")},_.readAsArrayBuffer(f[y])})})}else s(new Error("weightManifest field is missing from file "+t.name))}else s(new Error("modelTopology field is missing from file "+t.name))},a.onerror=function(u){return s("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},a.readAsText(t)})]})})},n.prototype.checkManifestAndWeightFiles=function(t,e){for(var r=[],o=e.map(function(u){return KN(u.name)}),i={},s=0,a=t;s<a.length;s++)a[s].paths.forEach(function(u){var l=KN(u);if(-1!==r.indexOf(l))throw new Error("Duplicate file basename found in weights manifest: '"+l+"'");if(r.push(l),-1===o.indexOf(l))throw new Error("Weight file with basename '"+l+"' is not provided.");i[u]=e[o.indexOf(l)]});if(r.length!==e.length)throw new Error("Mismatch in the number of files in weights manifest ("+r.length+") and the number of weight files provided ("+e.length+").");return i},n}();function nF(n,t,e,r){var i;I(null!=(i=n)&&Array.isArray(i)&&i.length>0,function(){return"promises must be a none empty array"}),function(i,s){I(i>=0&&i<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+i}),I(s>=0&&s<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+s}),I(s>=i,function(){return"startFraction must be no more than endFraction, but got startFraction "+i+" and endFraction "+s})}(e=e??0,r=r??1);var o=0;return Promise.all(n.map(function(i){return i.then(function(s){var a=e+ ++o/n.length*(r-e);return t(a),s}),i}))}function rF(n,t){return he(this,void 0,void 0,function(){var e,r,o,i,s,a,u,l,c;return pe(this,function(d){switch(d.label){case 0:return null==t&&(t={}),e=t.fetchFunc??$().platform.fetch,r=n.map(function(f){return e(f,t.requestInit,{isBinary:!0})}),o=0,i=.5,null!=t.onProgress?[3,2]:[4,Promise.all(r)];case 1:return s=d.sent(),[3,4];case 2:return[4,nF(r,t.onProgress,o,i)];case 3:s=d.sent(),d.label=4;case 4:return a=s.map(function(f){return f.arrayBuffer()}),u=.5,l=1,null!=t.onProgress?[3,6]:[4,Promise.all(a)];case 5:return c=d.sent(),[3,8];case 6:return[4,nF(a,t.onProgress,u,l)];case 7:c=d.sent(),d.label=8;case 8:return[2,c]}})})}function oF(n){var t=this;return function(e,r,o){return void 0===r&&(r=""),he(t,void 0,void 0,function(){var i,s,a,u,l,c,d,f,h,p;return pe(this,function(m){switch(m.label){case 0:if(i=e.map(function(){return!1}),s={},a=null!=o?o.map(function(){return!1}):[],u=[],e.forEach(function(v,y){var _=0;v.weights.forEach(function(b){var E=G_["quantization"in b?b.quantization.dtype:b.dtype]*me(b.shape),D=function(){i[y]=!0,null==s[y]&&(s[y]=[]),s[y].push({manifestEntry:b,groupOffset:_,sizeBytes:E})};null!=o?o.forEach(function(k,R){k===b.name&&(D(),a[R]=!0)}):D(),u.push(b.name),_+=E})}),!a.every(function(v){return v}))throw l=o.filter(function(v,y){return!a[y]}),new Error("Could not find weights in manifest with names: "+l.join(", ")+". \nManifest JSON has weights with names: "+u.join(", ")+".");return c=i.reduce(function(v,y,_){return y&&v.push(_),v},[]),d=[],c.forEach(function(v){e[v].paths.forEach(function(y){var _=r+(r.endsWith("/")?"":"/")+y;d.push(_)})}),[4,n(d)];case 1:return f=m.sent(),h={},p=0,c.forEach(function(v){for(var y=e[v].paths.length,_=0,b=0;b<y;b++)_+=f[p+b].byteLength;for(var x=new ArrayBuffer(_),E=new Uint8Array(x),D=0,k=0;k<y;k++){var R=new Uint8Array(f[p+k]);E.set(R,D),D+=R.byteLength}s[v].forEach(function(A){var M=GN(x.slice(A.groupOffset,A.groupOffset+A.sizeBytes),[A.manifestEntry]);for(var O in M)h[O]=M[O]}),p+=y}),[2,h]}})})}}Kr.registerSaveRouter(function(n){return $().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Y_.URL_SCHEME)?(void 0===(t=n.slice(Y_.URL_SCHEME.length))&&(t="model"),new Y_(t)):null;var t});var iF=function(){function n(t,e){if(this.DEFAULT_METHOD="POST",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,null!=e.fetchFunc?(I("function"==typeof e.fetchFunc,function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=e.fetchFunc):this.fetch=$().platform.fetch,I(null!=t&&t.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(t)&&I(2===t.length,function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."}),this.path=t,null!=e.requestInit&&null!=e.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}return n.prototype.save=function(t){return he(this,void 0,void 0,function(){var e,i;return pe(this,function(s){switch(s.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,e.body.append("model.json",new Blob([JSON.stringify({modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:[{paths:["./model.weights.bin"],weights:t.weightSpecs}]})],{type:"application/json"}),"model.json"),null!=t.weightData&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,e)];case 1:if((i=s.sent()).ok)return[2,{modelArtifactsInfo:Cf(t),responses:[i]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+i.status+".")}})})},n.prototype.load=function(){return he(this,void 0,void 0,function(){var t,e,r,o,i,s,a,u,l,c,d,f;return pe(this,function(h){switch(h.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=h.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");h.label=2;case 2:return h.trys.push([2,4,,5]),[4,t.json()];case 3:return e=h.sent(),[3,5];case 4:throw h.sent(),r="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 5:if(i=e.weightsManifest,s=e.generatedBy,a=e.convertedBy,u=e.format,l=e.userDefinedMetadata,null==(o=e.modelTopology)&&null==i)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return null==i?[3,7]:[4,this.loadWeights(i)];case 6:f=h.sent(),c=f[0],d=f[1],h.label=7;case 7:return[2,{modelTopology:o,weightSpecs:c,weightData:d,userDefinedMetadata:l,generatedBy:s,convertedBy:a,format:u}]}})})},n.prototype.loadWeights=function(t){return he(this,void 0,void 0,function(){var r,o,i,s,a,u,l,d,f;return pe(this,function(h){switch(h.label){case 0:for(void 0,void 0,m=(p=Array.isArray(this.path)?this.path[1]:this.path).lastIndexOf("/"),v=p.lastIndexOf("?"),r=[p.substring(0,m)+"/",v>m?p.substring(v):""],o=r[0],i=r[1],s=this.weightPathPrefix||o,a=[],u=0,l=t;u<l.length;u++)a.push.apply(a,l[u].weights);return d=[],t.forEach(function(p){p.paths.forEach(function(m){d.push(s+m+i)})}),[4,rF(d,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return f=h.sent(),[2,[a,K_(f)]]}var p,m,v})})},n.URL_SCHEME_REGEX=/^https?:\/\//,n}();function Q_(n){return null!=n.match(iF.URL_SCHEME_REGEX)}var sF=function(n,t){return typeof fetch>"u"?null:(Array.isArray(n)?n.every(function(e){return Q_(e)}):Q_(n))?Z_(n,{onProgress:t}):null};function Z_(n,t){return new iF(n,t)}Kr.registerSaveRouter(sF),Kr.registerLoadRouter(sF);var Wl,J_=function(){function n(t){this.modelArtifacts=t}return n.prototype.load=function(){return he(this,void 0,void 0,function(){return pe(this,function(t){return[2,this.modelArtifacts]})})},n}(),jK=function(){function n(t){this.saveHandler=t}return n.prototype.save=function(t){return he(this,void 0,void 0,function(){return pe(this,function(e){return[2,this.saveHandler(t)]})})},n}(),aF=Object.freeze({browserFiles:function(n){return new UK(n)},browserHTTPRequest:function(n,t){return Z_(n,t)},concatenateArrayBuffers:K_,decodeWeights:GN,encodeWeights:function(n,t){return he(this,void 0,void 0,function(){var e,r,o,i,s,a=this;return pe(this,function(u){switch(u.label){case 0:for(e=[],r=[],o=Array.isArray(n)?n.map(function(l){return l.name}):Object.keys(n),i=function(l){var c=o[l],d=Array.isArray(n)?n[l].tensor:n[c];if("float32"!==d.dtype&&"int32"!==d.dtype&&"bool"!==d.dtype&&"string"!==d.dtype)throw new Error("Unsupported dtype in weight '"+c+"': "+d.dtype);var f={name:c,shape:d.shape,dtype:d.dtype};if("string"===d.dtype){var h=new Promise(function(p){return he(a,void 0,void 0,function(){var m,v,y,_,b,x,E;return pe(this,function(D){switch(D.label){case 0:return[4,d.bytes()];case 1:for(m=D.sent(),v=m.reduce(function(k,R){return k+R.length},0)+4*m.length,y=new Uint8Array(v),_=0,b=0;b<m.length;b++)x=m[b],E=new Uint8Array(new Uint32Array([x.length]).buffer),y.set(E,_),y.set(x,_+=4),_+=x.length;return p(y),[2]}})})});r.push(h)}else r.push(d.data());null!=t&&(f.group=t),e.push(f)},s=0;s<o.length;++s)i(s);return[4,Promise.all(r)];case 1:return[2,{data:TK(u.sent()),specs:e}]}})})},fromMemory:function(n,t,e,r){return 1===arguments.length?null!=n.modelTopology||null!=n.weightSpecs?new J_(n):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new J_({modelTopology:n})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new J_({modelTopology:n,weightSpecs:t,weightData:e,trainingConfig:r}))},getLoadHandlers:function(n,t){return Kr.getLoadHandlers(n,t)},getModelArtifactsInfoForJSON:Cf,getSaveHandlers:function(n){return Kr.getSaveHandlers(n)},http:Z_,isHTTPScheme:Q_,loadWeights:function(n,t,e,r){return void 0===t&&(t=""),he(this,void 0,void 0,function(){return pe(this,function(o){return[2,oF(function(i){return rF(i,{requestInit:r})})(n,t,e)]})})},registerLoadRouter:function(n){return Kr.registerLoadRouter(n)},registerSaveRouter:function(n){return Kr.registerSaveRouter(n)},weightsLoaderFactory:oF,withSaveHandler:function(n){return new jK(n)},copyModel:function(n,t){return he(this,void 0,void 0,function(){return pe(this,function(e){return[2,XN(n,t,!1)]})})},listModels:function(){return he(this,void 0,void 0,function(){var n,t,e,r,o,i,s;return pe(this,function(a){switch(a.label){case 0:n=aa.getSchemes(),t={},e=0,r=n,a.label=1;case 1:return e<r.length?[4,aa.getManager(o=r[e]).listModels()]:[3,4];case 2:for(s in i=a.sent())t[o+Vl+s]=i[s];a.label=3;case 3:return e++,[3,1];case 4:return[2,t]}})})},moveModel:function(n,t){return he(this,void 0,void 0,function(){return pe(this,function(e){return[2,XN(n,t,!0)]})})},removeModel:function(n){return he(this,void 0,void 0,function(){var t;return pe(this,function(e){return t=cm(n),[2,aa.getManager(t.scheme).removeModel(t.path)]})})}}),HK=F({confusionMatrix_:function(n,t,e){var r=S(n,"labels","confusionMatrix"),o=S(t,"predictions","confusionMatrix");I(null==e||e>0&&Number.isInteger(e),function(){return"If provided, numClasses must be a positive integer, but got "+e}),I(1===r.rank,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),I(1===o.rank,function(){return"Expected the rank of predictions to be 1, but got "+o.rank}),I(r.shape[0]===o.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+o.shape[0]+". Labels and predictions should have the same number of elements."}),I(e>0&&Number.isInteger(e),function(){return"numClasses is required to be a positive integer, but got "+e});var i=n_(r.asType("int32"),e),s=n_(o.asType("int32"),e);return i.transpose().matMul(s).asType("int32")}}),WK=(Object.freeze({confusionMatrix:HK}),F({fromPixels_:function(n,t){if(void 0===t&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==n)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var e=!1,r=!1,o=!1,i=!1,s=!1;if(n.data instanceof Uint8Array)e=!0;else if(typeof ImageData<"u"&&n instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement)o=!0;else if(typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement)i=!0;else{if(null==n.getContext)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+n.constructor.name);s=!0}if(o&&o&&n.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(null!=ZM("FromPixels",N.backendName))return N.runKernel("FromPixels",{pixels:n},{numChannels:t});var a,u,l=o?[n.videoWidth,n.videoHeight]:[n.width,n.height],c=l[0],d=l[1];if(s?a=n.getContext("2d").getImageData(0,0,c,d).data:r||e?a=n.data:(i||o)&&(null==Wl&&(Wl=document.createElement("canvas").getContext("2d")),Wl.canvas.width=c,Wl.canvas.height=d,Wl.drawImage(n,0,0,c,d),a=Wl.getImageData(0,0,c,d).data),4===t)u=new Int32Array(a);else{var f=c*d;u=new Int32Array(f*t);for(var h=0;h<f;h++)for(var p=0;p<t;++p)u[h*t+p]=a[4*h+p]}return J0(u,[d,c,t],"int32")}})),e1=Object.freeze({toPixels:function(n,t){return he(this,void 0,void 0,function(){var e,r,o,i,s,a,u,l,c,h,p,m,v,y,_,b,x,E,D,k,R;return pe(this,function(A){switch(A.label){case 0:if(e=S(n,"img","toPixels"),n instanceof It||(e=e.toInt()),2!==e.rank&&3!==e.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+e.rank+".");if(r=e.shape.slice(0,2),o=r[0],i=r[1],(s=2===e.rank?1:e.shape[2])>4||2===s)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+s);return[4,e.data()];case 1:return a=A.sent(),u=e.min(),l=e.max(),[4,Promise.all([u.data(),l.data()])];case 2:if(c=A.sent(),h=c[0][0],p=c[1][0],u.dispose(),l.dispose(),"float32"===e.dtype){if(h<0||p>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+h+" - "+p+"].")}else{if("int32"!==e.dtype)throw new Error("Unsupported type for toPixels: "+e.dtype+". Please use float32 or int32 tensors.");if(h<0||p>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+h+" - "+p+"].")}for(m="float32"===e.dtype?255:1,v=new Uint8ClampedArray(i*o*4),y=0;y<o*i;++y)_=void 0,b=void 0,x=void 0,E=void 0,1===s?(_=a[y]*m,b=a[y]*m,x=a[y]*m,E=255):3===s?(_=a[3*y]*m,b=a[3*y+1]*m,x=a[3*y+2]*m,E=255):4===s&&(_=a[4*y]*m,b=a[4*y+1]*m,x=a[4*y+2]*m,E=a[4*y+3]*m),v[0+(D=4*y)]=Math.round(_),v[D+1]=Math.round(b),v[D+2]=Math.round(x),v[D+3]=Math.round(E);return null!=t&&(t.width=i,t.height=o,k=t.getContext("2d"),R=new ImageData(v,i,o),k.putImageData(R,0,0)),e!==n&&e.dispose(),[2,v]}})})},fromPixels:WK}),uF=function(){function n(){}return n.prototype.getClassName=function(){return this.constructor.className},n.fromConfig=function(t,e){return new t(e)},n}(),lF=function(){function n(){this.classNameMap={}}return n.getMap=function(){return null==n.instance&&(n.instance=new n),n.instance},n.register=function(t){n.getMap().classNameMap[t.className]=[t,t.fromConfig]},n}();function la(n){I(null!=n.className,function(){return"Class being registered does not have the static className property defined."}),I("string"==typeof n.className,function(){return"className is required to be a string, but got type "+typeof n.className}),I(n.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),lF.register(n)}function t1(){return 32===N.backend.floatPrecision()?.001:.1}function n1(n,t,e){var r=!0;if((Un(n)||Un(t))&&(r=!1),Un(n)&&Un(t)&&(r=!0),r){var o=n.constructor.name,i=t.constructor.name;if(o!==i)throw new Error("Arrays are of different type. Actual: "+o+". Expected: "+i)}if(Array.isArray(n)&&Array.isArray(t)){var s=di(n),a=di(t);if(!pn(s,a))throw new Error("Arrays have different shapes. Actual: ["+s+"]. Expected: ["+a+"]")}var u=Un(n)?n:ts(n),l=Un(t)?t:ts(t);if(u.length!==l.length)throw new Error("Arrays have different lengths actual: "+u.length+" vs expected: "+l.length+".\nActual:   "+u+".\nExpected: "+l+".");for(var c=0;c<l.length;++c){var d=u[c],f=l[c];if(!e(d,f))throw new Error("Arrays differ: actual["+c+"] = "+d+", expected["+c+"] = "+f+".\nActual:   "+u+".\nExpected: "+l+".")}}function r1(n,t,e){return!isFinite(n)&&!isFinite(t)||!(isNaN(n)||isNaN(t)||Math.abs(n-t)>e)}Object.freeze({Serializable:uF,SerializationMap:lF,registerClass:la}),Object.freeze({TEST_EPSILON_FLOAT16:.1,expectArraysClose:function(n,t,e){return null==e&&(e=t1()),n1(n,t,function(r,o){return r1(r,o,e)})},testEpsilon:t1,expectPromiseToFail:function(n,t){n().then(function(){return t.fail()},function(){return t()})},expectArraysEqual:function(n,t){var e="string"==typeof t||"number"==typeof t||"boolean"==typeof t?[t]:t;return ta(n)||ta(n[0])||ta(t)||ta(t[0])?n1(n,e,function(r,o){return r==o}):n1(n,t,function(r,o){return r1(r,o,0)})},expectNumbersClose:function(n,t,e){if(null==e&&(e=t1()),!r1(n,t,e))throw new Error("Numbers differ: actual === "+n+", expected === "+t)},expectValuesInRange:function(n,t,e){for(var r=0;r<n.length;r++)if(n[r]<t||n[r]>e)throw new Error("Value out of range:"+n[r]+" low: "+t+", high: "+e)},expectArrayBuffersEqual:function(n,t){expect(new Float32Array(n)).toEqual(new Float32Array(t))}}),Object.freeze({gpgpu_util:hq,webgl_util:LG,forceHalfFloat:function(){$().set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:aN,setWebGLContext:bk,GPGPUContext:zR});var ou=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return No(t,n),t.prototype.minimize=function(e,r,o){void 0===r&&(r=!1);var i=this.computeGradients(e,o),s=i.value,a=i.grads;if(null!=o){var u=o.map(function(l){return{name:l.name,tensor:a[l.name]}});this.applyGradients(u)}else this.applyGradients(a);return Mr(a),r?s:(s.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(e,r){return function v8(n,t){I(na(n),function(){return"The f passed in variableGrads(f) must be a function"}),I(null==t||Array.isArray(t)&&t.every(function(c){return c instanceof Tl}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var e=null!=t;if(!e)for(var r in t=[],N.registeredVariables)t.push(N.registeredVariables[r]);var o=e?t.filter(function(c){return!c.trainable}):null,i=t.length;I((t=t.filter(function(c){return c.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."});var s=N.gradients(n,t,null,!0),a=s.value,u=s.grads;I(u.some(function(c){return null!=c}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),I(0===a.rank,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+a.rank+" tensor"});var l={};return t.forEach(function(c,d){null!=u[d]&&(l[c.name]=u[d])}),o?.forEach(function(c){return l[c.name]=null}),{value:a,grads:l}}(e,r)},t.prototype.dispose=function(){null!=this.iterations_&&Mr(this.iterations_)},t.prototype.saveIterations=function(){return he(this,void 0,void 0,function(){return pe(this,function(e){return null==this.iterations_&&(this.iterations_=0),[2,{name:"iter",tensor:oe(this.iterations_,"int32")}]})})},t.prototype.getWeights=function(){return he(this,void 0,void 0,function(){return pe(this,function(e){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},t.prototype.setWeights=function(e){return he(this,void 0,void 0,function(){return pe(this,function(r){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},t.prototype.extractIterations=function(e){return he(this,void 0,void 0,function(){var r;return pe(this,function(o){switch(o.label){case 0:return r=this,[4,e[0].tensor.data()];case 1:return r.iterations_=o.sent()[0],[2,e.slice(1)]}})})},t}(uF);Object.defineProperty(ou,Symbol.hasInstance,{value:function(n){return null!=n.minimize&&null!=n.computeGradients&&null!=n.applyGradients}});var dF=function(n){function t(e,r,o){void 0===o&&(o=null);var i=n.call(this)||this;return i.learningRate=e,i.rho=r,i.epsilon=o,i.accumulatedGrads=[],i.accumulatedUpdates=[],null==o&&(i.epsilon=N.backend.epsilon()),i}return No(t,n),t.prototype.applyGradients=function(e){var r=this;(Array.isArray(e)?e.map(function(o){return o.name}):Object.keys(e)).forEach(function(o,i){var s=N.registeredVariables[o];null==r.accumulatedGrads[i]&&(r.accumulatedGrads[i]={originalName:o+"/accum_grad",variable:le(function(){return ut(s).variable(!1)})}),null==r.accumulatedUpdates[i]&&(r.accumulatedUpdates[i]={originalName:o+"/accum_var",variable:le(function(){return ut(s).variable(!1)})});var a=Array.isArray(e)?e[i].tensor:e[o];if(null!=a){var u=r.accumulatedGrads[i].variable,l=r.accumulatedUpdates[i].variable;le(function(){var c=u.mul(r.rho).add(a.square().mul(1-r.rho)),d=l.add(r.epsilon).sqrt().div(u.add(r.epsilon).sqrt()).mul(a),f=l.mul(r.rho).add(d.square().mul(1-r.rho));u.assign(c),l.assign(f);var h=d.mul(-r.learningRate).add(s);s.assign(h)})}}),this.incrementIterations()},t.prototype.dispose=function(){null!=this.accumulatedUpdates&&(Mr(this.accumulatedGrads.map(function(e){return e.variable})),Mr(this.accumulatedUpdates.map(function(e){return e.variable})))},t.prototype.getWeights=function(){return he(this,void 0,void 0,function(){var e;return pe(this,function(r){switch(r.label){case 0:return e=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(e.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},t.prototype.setWeights=function(e){return he(this,void 0,void 0,function(){var r;return pe(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(e)];case 1:return e=o.sent(),this.accumulatedGrads=e.slice(0,r=e.length/2).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedUpdates=e.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(e,r){return new e(r.learningRate,r.rho,r.epsilon)},t.className="Adadelta",t}(ou);la(dF);var fF=function(n){function t(e,r){void 0===r&&(r=.1);var o=n.call(this)||this;return o.learningRate=e,o.initialAccumulatorValue=r,o.accumulatedGrads=[],o}return No(t,n),t.prototype.applyGradients=function(e){var r=this;(Array.isArray(e)?e.map(function(o){return o.name}):Object.keys(e)).forEach(function(o,i){var s=N.registeredVariables[o];null==r.accumulatedGrads[i]&&(r.accumulatedGrads[i]={originalName:o+"/accumulator",variable:le(function(){return hi(s.shape,r.initialAccumulatorValue).variable(!1)})});var a=Array.isArray(e)?e[i].tensor:e[o];if(null!=a){var u=r.accumulatedGrads[i].variable;le(function(){var l=u.add(a.square());u.assign(l);var c=a.div(l.add(N.backend.epsilon()).sqrt()).mul(-r.learningRate).add(s);s.assign(c)})}}),this.incrementIterations()},t.prototype.dispose=function(){null!=this.accumulatedGrads&&Mr(this.accumulatedGrads.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return he(this,void 0,void 0,function(){return pe(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulatedGrads.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(e){return he(this,void 0,void 0,function(){return pe(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(e)];case 1:return e=r.sent(),this.accumulatedGrads=e.map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(e,r){return new e(r.learningRate,r.initialAccumulatorValue)},t.className="Adagrad",t}(ou);la(fF);var hF=function(n){function t(e,r,o,i){void 0===i&&(i=null);var s=n.call(this)||this;return s.learningRate=e,s.beta1=r,s.beta2=o,s.epsilon=i,s.accumulatedFirstMoment=[],s.accumulatedSecondMoment=[],le(function(){s.accBeta1=oe(r).variable(),s.accBeta2=oe(o).variable()}),null==i&&(s.epsilon=N.backend.epsilon()),s}return No(t,n),t.prototype.applyGradients=function(e){var r=this,o=Array.isArray(e)?e.map(function(i){return i.name}):Object.keys(e);le(function(){var i=In(1,r.accBeta1),s=In(1,r.accBeta2);o.forEach(function(a,u){var l=N.registeredVariables[a];null==r.accumulatedFirstMoment[u]&&(r.accumulatedFirstMoment[u]={originalName:a+"/m",variable:le(function(){return ut(l).variable(!1)})}),null==r.accumulatedSecondMoment[u]&&(r.accumulatedSecondMoment[u]={originalName:a+"/v",variable:le(function(){return ut(l).variable(!1)})});var c=Array.isArray(e)?e[u].tensor:e[a];if(null!=c){var d=r.accumulatedFirstMoment[u].variable,f=r.accumulatedSecondMoment[u].variable,h=d.mul(r.beta1).add(c.mul(1-r.beta1)),p=f.mul(r.beta2).add(c.square().mul(1-r.beta2)),m=h.div(i),v=p.div(s);d.assign(h),f.assign(p);var y=m.div(v.sqrt().add(r.epsilon)).mul(-r.learningRate).add(l);l.assign(y)}}),r.accBeta1.assign(r.accBeta1.mul(r.beta1)),r.accBeta2.assign(r.accBeta2.mul(r.beta2))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&Mr(this.accumulatedFirstMoment.map(function(e){return e.variable})),null!=this.accumulatedSecondMoment&&Mr(this.accumulatedSecondMoment.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return he(this,void 0,void 0,function(){var e;return pe(this,function(r){switch(r.label){case 0:return e=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(e.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},t.prototype.setWeights=function(e){return he(this,void 0,void 0,function(){var r,o=this;return pe(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(e)];case 1:return e=i.sent(),le(function(){o.accBeta1.assign(rm(o.beta1,o.iterations_+1)),o.accBeta2.assign(rm(o.beta2,o.iterations_+1))}),this.accumulatedFirstMoment=e.slice(0,r=e.length/2).map(function(s){return{originalName:s.name,variable:s.tensor.variable(!1)}}),this.accumulatedSecondMoment=e.slice(r,2*r).map(function(s){return{originalName:s.name,variable:s.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(e,r){return new e(r.learningRate,r.beta1,r.beta2,r.epsilon)},t.className="Adam",t}(ou);la(hF);var pF=function(n){function t(e,r,o,i,s){void 0===i&&(i=null),void 0===s&&(s=0);var a=n.call(this)||this;return a.learningRate=e,a.beta1=r,a.beta2=o,a.epsilon=i,a.decay=s,a.accumulatedFirstMoment=[],a.accumulatedWeightedInfNorm=[],le(function(){a.iteration=oe(0).variable(),a.accBeta1=oe(r).variable()}),null==i&&(a.epsilon=N.backend.epsilon()),a}return No(t,n),t.prototype.applyGradients=function(e){var r=this,o=Array.isArray(e)?e.map(function(i){return i.name}):Object.keys(e);le(function(){var i=In(1,r.accBeta1),s=Uo(-r.learningRate,r.iteration.mul(r.decay).add(1));o.forEach(function(a,u){var l=N.registeredVariables[a];null==r.accumulatedFirstMoment[u]&&(r.accumulatedFirstMoment[u]={originalName:a+"/m",variable:ut(l).variable(!1)}),null==r.accumulatedWeightedInfNorm[u]&&(r.accumulatedWeightedInfNorm[u]={originalName:a+"/v",variable:ut(l).variable(!1)});var c=Array.isArray(e)?e[u].tensor:e[a];if(null!=c){var d=r.accumulatedFirstMoment[u].variable,f=r.accumulatedWeightedInfNorm[u].variable,h=d.mul(r.beta1).add(c.mul(1-r.beta1)),p=f.mul(r.beta2),m=c.abs(),v=p.maximum(m);d.assign(h),f.assign(v);var y=s.div(i).mul(h.div(v.add(r.epsilon))).add(l);l.assign(y)}}),r.iteration.assign(r.iteration.add(1)),r.accBeta1.assign(r.accBeta1.mul(r.beta1))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&Mr(this.accumulatedFirstMoment.map(function(e){return e.variable})),null!=this.accumulatedWeightedInfNorm&&Mr(this.accumulatedWeightedInfNorm.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return he(this,void 0,void 0,function(){return pe(this,function(e){throw new Error("getWeights() is not implemented for Adamax yet.")})})},t.prototype.setWeights=function(e){return he(this,void 0,void 0,function(){return pe(this,function(r){throw new Error("setWeights() is not implemented for Adamax yet.")})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(e,r){return new e(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)},t.className="Adamax",t}(ou);la(pF);var o1=function(n){function t(e){var r=n.call(this)||this;return r.learningRate=e,r.setLearningRate(e),r}return No(t,n),t.prototype.applyGradients=function(e){var r=this;(Array.isArray(e)?e.map(function(o){return o.name}):Object.keys(e)).forEach(function(o,i){var s=Array.isArray(e)?e[i].tensor:e[o];if(null!=s){var a=N.registeredVariables[o];le(function(){var u=r.c.mul(s).add(a);a.assign(u)})}}),this.incrementIterations()},t.prototype.setLearningRate=function(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=function BG(n){return N.keep(n)}(oe(-e))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return he(this,void 0,void 0,function(){return pe(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()]]}})})},t.prototype.setWeights=function(e){return he(this,void 0,void 0,function(){return pe(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(e)];case 1:if(0!==(e=r.sent()).length)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(e,r){return new e(r.learningRate)},t.className="SGD",t}(ou);la(o1);var gF=function(n){function t(e,r,o){void 0===o&&(o=!1);var i=n.call(this,e)||this;return i.learningRate=e,i.momentum=r,i.useNesterov=o,i.accumulations=[],i.m=oe(i.momentum),i}return No(t,n),t.prototype.applyGradients=function(e){var r=this;(Array.isArray(e)?e.map(function(o){return o.name}):Object.keys(e)).forEach(function(o,i){var s=N.registeredVariables[o];null==r.accumulations[i]&&(r.accumulations[i]={originalName:o+"/momentum",variable:le(function(){return ut(s).variable(!1)})});var a=r.accumulations[i].variable,u=Array.isArray(e)?e[i].tensor:e[o];null!=u&&le(function(){var l,c=r.m.mul(a).add(u);l=r.useNesterov?r.c.mul(u.add(c.mul(r.m))).add(s):r.c.mul(c).add(s),a.assign(c),s.assign(l)})}),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),null!=this.accumulations&&Mr(this.accumulations.map(function(e){return e.variable}))},t.prototype.setMomentum=function(e){this.momentum=e},t.prototype.getWeights=function(){return he(this,void 0,void 0,function(){return pe(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulations.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(e){return he(this,void 0,void 0,function(){return pe(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(e)];case 1:return e=r.sent(),this.accumulations=e.map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(e,r){return new e(r.learningRate,r.momentum,r.useNesterov)},t.className="Momentum",t}(o1);la(gF);var mF=function(n){function t(e,r,o,i,s){void 0===r&&(r=.9),void 0===o&&(o=0),void 0===i&&(i=null),void 0===s&&(s=!1);var a=n.call(this)||this;if(a.learningRate=e,a.decay=r,a.momentum=o,a.epsilon=i,a.accumulatedMeanSquares=[],a.accumulatedMoments=[],a.accumulatedMeanGrads=[],a.centered=s,null==i&&(a.epsilon=N.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.");return a}return No(t,n),t.prototype.applyGradients=function(e){var r=this;(Array.isArray(e)?e.map(function(o){return o.name}):Object.keys(e)).forEach(function(o,i){var s=N.registeredVariables[o];null==r.accumulatedMeanSquares[i]&&(r.accumulatedMeanSquares[i]={originalName:o+"/rms",variable:le(function(){return ut(s).variable(!1)})}),null==r.accumulatedMoments[i]&&(r.accumulatedMoments[i]={originalName:o+"/momentum",variable:le(function(){return ut(s).variable(!1)})}),null==r.accumulatedMeanGrads[i]&&r.centered&&(r.accumulatedMeanGrads[i]={originalName:o+"/mg",variable:le(function(){return ut(s).variable(!1)})});var a=Array.isArray(e)?e[i].tensor:e[o];if(null!=a){var u=r.accumulatedMeanSquares[i].variable,l=r.accumulatedMoments[i].variable;le(function(){var c=u.mul(r.decay).add(a.square().mul(1-r.decay));if(r.centered){var d=r.accumulatedMeanGrads[i].variable,f=d.mul(r.decay).add(a.mul(1-r.decay)),h=l.mul(r.momentum).add(a.mul(r.learningRate).div(c.sub(f.square().add(r.epsilon)).sqrt()));u.assign(c),d.assign(f),l.assign(h);var p=s.sub(h);s.assign(p)}else{var m=u.mul(r.decay).add(a.square().mul(1-r.decay));h=l.mul(r.momentum).add(a.mul(r.learningRate).div(m.add(r.epsilon).sqrt())),u.assign(m),l.assign(h),p=s.sub(h),s.assign(p)}})}}),this.incrementIterations()},t.prototype.dispose=function(){null!=this.accumulatedMeanSquares&&Mr(this.accumulatedMeanSquares.map(function(e){return e.variable})),null!=this.accumulatedMeanGrads&&this.centered&&Mr(this.accumulatedMeanGrads.map(function(e){return e.variable})),null!=this.accumulatedMoments&&Mr(this.accumulatedMoments.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return he(this,void 0,void 0,function(){var e;return pe(this,function(r){switch(r.label){case 0:return e=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&e.push.apply(e,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(e.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},t.prototype.setWeights=function(e){return he(this,void 0,void 0,function(){var r;return pe(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(e)];case 1:return e=o.sent(),this.accumulatedMeanSquares=e.slice(0,r=this.centered?e.length/3:e.length/2).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedMoments=e.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=e.slice(2*r,3*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(e,r){return new e(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)},t.className="RMSProp",t}(ou);la(mF),function(){function n(){}n.sgd=function(t){return new o1(t)},n.momentum=function(t,e,r){return void 0===r&&(r=!1),new gF(t,e,r)},n.rmsprop=function(t,e,r,o,i){return void 0===e&&(e=.9),void 0===r&&(r=0),void 0===o&&(o=null),void 0===i&&(i=!1),new mF(t,e,r,o,i)},n.adam=function(t,e,r,o){return void 0===t&&(t=.001),void 0===e&&(e=.9),void 0===r&&(r=.999),void 0===o&&(o=null),new hF(t,e,r,o)},n.adadelta=function(t,e,r){return void 0===t&&(t=.001),void 0===e&&(e=.95),void 0===r&&(r=null),new dF(t,e,r)},n.adamax=function(t,e,r,o,i){return void 0===t&&(t=.002),void 0===e&&(e=.9),void 0===r&&(r=.999),void 0===o&&(o=null),void 0===i&&(i=0),new pF(t,e,r,o,i)},n.adagrad=function(t,e){return void 0===e&&(e=.1),new fF(t,e)}}(),typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"&&setImmediate,It.prototype.squaredDifference=function(n){return uN(this,n)},H=xK;var i1=function(n,t){return(i1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o])})(n,t)};function Be(n,t){function e(){this.constructor=n}i1(n,t),n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}var or=function(){return or=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},or.apply(this,arguments)};function we(n,t,e,r){return new(e||(e=Promise))(function(i,s){function a(c){try{l(r.next(c))}catch(d){s(d)}}function u(c){try{l(r.throw(c))}catch(d){s(d)}}function l(c){c.done?i(c.value):function o(i){return i instanceof e?i:new e(function(s){s(i)})}(c.value).then(a,u)}l((r=r.apply(n,t||[])).next())})}function be(n,t){var r,o,i,s,e={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(l){return function(c){return function u(l){if(r)throw new TypeError("Generator is already executing.");for(;e;)try{if(r=1,o&&(i=2&l[0]?o.return:l[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,l[1])).done)return i;switch(o=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return e.label++,{value:l[1],done:!1};case 5:e.label++,o=l[1],l=[0];continue;case 7:l=e.ops.pop(),e.trys.pop();continue;default:if(!(i=(i=e.trys).length>0&&i[i.length-1])&&(6===l[0]||2===l[0])){e=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){e.label=l[1];break}if(6===l[0]&&e.label<i[1]){e.label=i[1],i=l;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(l);break}i[2]&&e.ops.pop(),e.trys.pop();continue}l=t.call(n,e)}catch(c){l=[6,c],o=0}finally{r=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}}function Ef(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length;var r=Array(n),o=0;for(t=0;t<e;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r}var su=function(){function n(t,e){if(!au(t)||!au(e))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:t,height:e}));this._width=t,this._height=e}return Object.defineProperty(n.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),n.prototype.reverse=function(){return new n(1/this.width,1/this.height)},n}();function Df(n,t){return n instanceof It&&n.shape.length===t}function fm(n){return Df(n,3)}function ca(n){return Df(n,4)}function yF(n){return n%2==0}function wF(n){return n&&n.width&&n.height}function s1(n){return n.reduce(function(t,e){return t.add(e)},new gt(0,0)).div(new gt(n.length,n.length))}function Sf(n,t,e){return Array(n).fill(0).map(function(r,o){return t+o*e})}function au(n){return!!n&&n!==1/0&&n!==-1/0&&!isNaN(n)||0===n}function bF(n){return au(n)&&0<=n&&n<=1}var gt=function(){function n(t,e){this._x=t,this._y=e}return Object.defineProperty(n.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),n.prototype.add=function(t){return new n(this.x+t.x,this.y+t.y)},n.prototype.sub=function(t){return new n(this.x-t.x,this.y-t.y)},n.prototype.mul=function(t){return new n(this.x*t.x,this.y*t.y)},n.prototype.div=function(t){return new n(this.x/t.x,this.y/t.y)},n.prototype.abs=function(){return new n(Math.abs(this.x),Math.abs(this.y))},n.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},n.prototype.floor=function(){return new n(Math.floor(this.x),Math.floor(this.y))},n}(),ls=function(){function n(t,e){void 0===e&&(e=!0);var r=t||{},o=[r.left,r.top,r.right,r.bottom].every(au),i=[r.x,r.y,r.width,r.height].every(au);if(!i&&!o)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var s=i?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],a=s[0],u=s[1],l=s[2],c=s[3];n.assertIsValidBox({x:a,y:u,width:l,height:c},"Box.constructor",e),this._x=a,this._y=u,this._width=l,this._height=c}return n.isRect=function(t){return!!t&&[t.x,t.y,t.width,t.height].every(au)},n.assertIsValidBox=function(t,e,r){if(void 0===r&&(r=!1),!n.isRect(t))throw new Error(e+" - invalid box: "+JSON.stringify(t)+", expected object with properties x, y, width, height");if(!r&&(t.width<0||t.height<0))throw new Error(e+" - width ("+t.width+") and height ("+t.height+") must be positive numbers")},Object.defineProperty(n.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"topLeft",{get:function(){return new gt(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"topRight",{get:function(){return new gt(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottomLeft",{get:function(){return new gt(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottomRight",{get:function(){return new gt(this.right,this.bottom)},enumerable:!0,configurable:!0}),n.prototype.round=function(){var t=[this.x,this.y,this.width,this.height].map(function(s){return Math.round(s)});return new n({x:t[0],y:t[1],width:t[2],height:t[3]})},n.prototype.floor=function(){var t=[this.x,this.y,this.width,this.height].map(function(s){return Math.floor(s)});return new n({x:t[0],y:t[1],width:t[2],height:t[3]})},n.prototype.toSquare=function(){var t=this,e=t.x,r=t.y,o=t.width,i=t.height,s=Math.abs(o-i);return o<i&&(e-=s/2,o+=s),i<o&&(r-=s/2,i+=s),new n({x:e,y:r,width:o,height:i})},n.prototype.rescale=function(t){var e=wF(t)?t.width:t,r=wF(t)?t.height:t;return new n({x:this.x*e,y:this.y*r,width:this.width*e,height:this.height*r})},n.prototype.pad=function(t,e){var r=[this.x-t/2,this.y-e/2,this.width+t,this.height+e];return new n({x:r[0],y:r[1],width:r[2],height:r[3]})},n.prototype.clipAtImageBorders=function(t,e){var r=this,i=r.y,s=r.right,a=r.bottom,u=Math.max(r.x,0),l=Math.max(i,0),d=a-l;return new n({x:u,y:l,width:Math.min(s-u,t-u),height:Math.min(d,e-l)}).floor()},n.prototype.shift=function(t,e){return new n({x:this.x+t,y:this.y+e,width:this.width,height:this.height})},n.prototype.padAtBorders=function(t,e){var r=this.width+1,o=this.height+1,a=r,u=o,l=this.left,c=this.top,d=this.right,f=this.bottom;return d>e&&(a=-d+e+r,d=e),f>t&&(u=-f+t+o,f=t),l<1&&(u=2-l,l=1),c<1&&(u=2-c,c=1),{dy:1,edy:u,dx:1,edx:a,y:c,ey:f,x:l,ex:d,w:r,h:o}},n.prototype.calibrate=function(t){return new n({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()},n}(),hm=function(n){function t(e,r,o,i,s){return void 0===s&&(s=!1),n.call(this,{left:e,top:r,right:o,bottom:i},s)||this}return Be(t,n),t}(ls),_F=function(){function n(t,e,r,o,i){this._imageDims=new su(i.width,i.height),this._score=t,this._classScore=e,this._className=r,this._box=new ls(o).rescale(this._imageDims)}return Object.defineProperty(n.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"relativeBox",{get:function(){return new ls(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),n.prototype.forSize=function(t,e){return new n(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:e})},n}(),jo=function(n){function t(e,r,o){return n.call(this,e,e,"",r,o)||this}return Be(t,n),t.prototype.forSize=function(e,r){var o=n.prototype.forSize.call(this,e,r);return new t(o.score,o.relativeBox,o.imageDims)},t}(_F);function ZK(n,t,e){void 0===e&&(e=!0);var i=Math.max(0,Math.min(n.right,t.right)-Math.max(n.left,t.left))*Math.max(0,Math.min(n.bottom,t.bottom)-Math.max(n.top,t.top));return e?i/(n.area+t.area-i):i/Math.min(n.area,t.area)}function If(n,t,e,r){void 0===r&&(r=!0);for(var o=t.map(function(a,u){return{score:a,boxIndex:u}}).sort(function(a,u){return a.score-u.score}).map(function(a){return a.boxIndex}),i=[],s=function(){var a=o.pop();i.push(a);for(var u=o,l=[],c=0;c<u.length;c++)l.push(ZK(n[a],n[u[c]],r));o=o.filter(function(p,m){return l[m]<=e})};o.length>0;)s();return i}function Af(n,t){return le(function(){var e=t[0],r=t[1],o=t[2],i=hi(Ef(n.shape.slice(0,3),[1]),e),s=hi(Ef(n.shape.slice(0,3),[1]),r),a=hi(Ef(n.shape.slice(0,3),[1]),o),u=Dn([i,s,a],3);return In(n,u)})}function a1(n){return 1/(1+Math.exp(-n))}var An,u1=function(n){function t(e,r,o,i,s){return void 0===s&&(s=!1),n.call(this,{x:e,y:r,width:o,height:i},s)||this}return Be(t,n),t}(ls),Tf=function(){function n(t,e,r){void 0===r&&(r=new gt(0,0));var o=e.width,i=e.height;this._imgDims=new su(o,i),this._shift=r,this._positions=t.map(function(s){return s.mul(new gt(o,i)).add(r)})}return Object.defineProperty(n.prototype,"shift",{get:function(){return new gt(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"relativePositions",{get:function(){var t=this;return this._positions.map(function(e){return e.sub(t._shift).div(new gt(t.imageWidth,t.imageHeight))})},enumerable:!0,configurable:!0}),n.prototype.forSize=function(t,e){return new this.constructor(this.relativePositions,{width:t,height:e})},n.prototype.shiftBy=function(t,e){return new this.constructor(this.relativePositions,this._imgDims,new gt(t,e))},n.prototype.shiftByPoint=function(t){return this.shiftBy(t.x,t.y)},n.prototype.align=function(t,e){if(void 0===e&&(e={}),t){var r=t instanceof jo?t.box.floor():new ls(t);return this.shiftBy(r.x,r.y).align(null,e)}var o=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},e),s=o.minBoxPadding;return o.useDlibAlignment?this.alignDlib():this.alignMinBbox(s)},n.prototype.alignDlib=function(){var t=this.getRefPointsForAlignment(),r=t[1],o=t[2],i=function(d){return o.sub(d).magnitude()},s=(i(t[0])+i(r))/2,a=Math.floor(s/.45),u=s1(t),l=Math.floor(Math.max(0,u.x-.5*a)),c=Math.floor(Math.max(0,u.y-.43*a));return new u1(l,c,Math.min(a,this.imageWidth+l),Math.min(a,this.imageHeight+c))},n.prototype.alignMinBbox=function(t){var e=function QK(n){var t=n.map(function(a){return a.x}),e=n.map(function(a){return a.y}),r=t.reduce(function(a,u){return u<a?u:a},1/0),o=e.reduce(function(a,u){return u<a?u:a},1/0),i=t.reduce(function(a,u){return a<u?u:a},0),s=e.reduce(function(a,u){return a<u?u:a},0);return new hm(r,o,i,s)}(this.positions);return e.pad(e.width*t,e.height*t)},n.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},n}(),rX=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return Be(t,n),t.prototype.getRefPointsForAlignment=function(){var e=this.positions;return[e[0],e[1],s1([e[3],e[4]])]},t}(Tf),xF=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return Be(t,n),t.prototype.getJawOutline=function(){return this.positions.slice(0,17)},t.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},t.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},t.prototype.getNose=function(){return this.positions.slice(27,36)},t.prototype.getLeftEye=function(){return this.positions.slice(36,42)},t.prototype.getRightEye=function(){return this.positions.slice(42,48)},t.prototype.getMouth=function(){return this.positions.slice(48,68)},t.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(s1)},t}(Tf),CF=function(){function n(t,e){this._label=t,this._distance=e}return Object.defineProperty(n.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),n.prototype.toString=function(t){return void 0===t&&(t=!0),this.label+(t?" ("+function XK(n,t){void 0===t&&(t=2);var e=Math.pow(10,t);return Math.floor(n*e)/e}(this.distance)+")":"")},n}(),EF=function(n){function t(e,r){var o=n.call(this,e)||this;return o._label=r,o}return Be(t,n),t.assertIsValidLabeledBox=function(e,r){if(ls.assertIsValidBox(e,r),!au(e.label))throw new Error(r+" - expected property label ("+e.label+") to be a number")},Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),t}(ls),pm=function(){function n(t,e){if("string"!=typeof t)throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(e)||e.some(function(r){return!(r instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=t,this._descriptors=e}return Object.defineProperty(n.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),n.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(t){return Array.from(t)})}},n.fromJSON=function(t){var e=t.descriptors.map(function(r){return new Float32Array(r)});return new n(t.label,e)},n}();function DF(n){return n.detection instanceof jo}function Mf(n,t){return Object.assign({},n,{detection:t})}function SF(){var n=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:n,readFile:function(){throw new Error("readFile - filesystem not available for browser environment")}}}function IF(n){var t="";if(!n)try{n=sr(Object(function(){var o=new Error("Cannot find module 'fs'");throw o.code="MODULE_NOT_FOUND",o}()))}catch(r){t=r.toString()}return{readFile:n?function(r){return new Promise(function(o,i){n.readFile(r,function(s,a){return s?i(s):o(a)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+t)}}}function AF(){var n=global.Canvas||global.HTMLCanvasElement,t=global.Image||global.HTMLImageElement,o=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},i=IF();return or({Canvas:n||function s(){},CanvasRenderingContext2D:global.CanvasRenderingContext2D||function s(){},Image:t||function s(){},ImageData:global.ImageData||function s(){},Video:global.HTMLVideoElement||function s(){},createCanvasElement:function(){if(n)return new n;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},createImageElement:function(){if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},fetch:o},i)}function TF(){return"object"==typeof window&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function MF(){return"object"==typeof global&&typeof process<"u"&&!!process.version}function l1(n){An=n}function c1(){TF()&&l1(SF()),MF()&&l1(AF())}!function(n){function t(e,r,o,i){var s=n.call(this,e,r)||this;return s._score=o,s._classScore=i,s}Be(t,n),t.assertIsValidPredictedBox=function(e,r){if(EF.assertIsValidLabeledBox(e,r),!bF(e.score)||!bF(e.classScore))throw new Error(r+" - expected properties score ("+e.score+") and ("+e.classScore+") to be a number between [0, 1]")},Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0})}(EF);var ir={getEnv:function oX(){if(!An)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return An},setEnv:l1,initialize:c1,createBrowserEnv:SF,createFileSystem:IF,createNodejsEnv:AF,monkeyPatch:function iX(n){if(An||c1(),!An)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var t=n.Canvas,e=void 0===t?An.Canvas:t,r=n.Image,o=void 0===r?An.Image:r;An.Canvas=e,An.Image=o,An.createCanvasElement=n.createCanvasElement||function(){return new e},An.createImageElement=n.createImageElement||function(){return new o},An.ImageData=n.ImageData||An.ImageData,An.Video=n.Video||An.Video,An.fetch=n.fetch||An.fetch,An.readFile=n.readFile||An.readFile},isBrowser:TF,isNodejs:MF};function d1(n){return ir.isNodejs()||"string"!=typeof n?n:document.getElementById(n)}function gi(n){var t=ir.getEnv(),e=t.Canvas;if(n instanceof t.CanvasRenderingContext2D)return n;var o=d1(n);if(!(o instanceof e))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var i=o.getContext("2d");if(!i)throw new Error("resolveContext2d - canvas 2d context is null");return i}c1();var cs=(()=>(function(n){n.TOP_LEFT="TOP_LEFT",n.TOP_RIGHT="TOP_RIGHT",n.BOTTOM_LEFT="BOTTOM_LEFT",n.BOTTOM_RIGHT="BOTTOM_RIGHT"}(cs||(cs={})),cs))(),kF=function n(t){void 0===t&&(t={});var r=t.backgroundColor,o=t.fontColor,i=t.fontSize,s=t.fontStyle,a=t.padding;this.anchorPosition=t.anchorPosition||cs.TOP_LEFT,this.backgroundColor=r||"rgba(0, 0, 0, 0.5)",this.fontColor=o||"rgba(255, 255, 255, 1)",this.fontSize=i||14,this.fontStyle=s||"Georgia",this.padding=a||4};!function(){function n(t,e,r){void 0===r&&(r={}),this.text="string"==typeof t?[t]:t instanceof n?t.text:t,this.anchor=e,this.options=new kF(r)}n.prototype.measureWidth=function(t){var e=this.options.padding;return this.text.map(function(r){return t.measureText(r).width}).reduce(function(r,o){return r<o?o:r},0)+2*e},n.prototype.measureHeight=function(){var t=this.options;return this.text.length*t.fontSize+2*t.padding},n.prototype.getUpperLeft=function(t,e){var r=this.options.anchorPosition,o=r===cs.BOTTOM_RIGHT||r===cs.TOP_RIGHT,i=r===cs.BOTTOM_LEFT||r===cs.BOTTOM_RIGHT,s=this.measureWidth(t),a=this.measureHeight(),u=o?this.anchor.x-s:this.anchor.x,l=i?this.anchor.y-a:this.anchor.y;if(e){var d=e.height;return{x:Math.max(Math.min(u,e.width-s),0),y:Math.max(Math.min(l,d-a),0)}}return{x:u,y:l}},n.prototype.draw=function(t){var e=d1(t),r=gi(e),o=this.options,i=o.backgroundColor,s=o.fontColor,a=o.fontSize,l=o.padding;r.font=a+"px "+o.fontStyle;var c=this.measureWidth(r),d=this.measureHeight();r.fillStyle=i;var f=this.getUpperLeft(r,e);r.fillRect(f.x,f.y,c,d),r.fillStyle=s,this.text.forEach(function(h,p){r.fillText(h,l+f.x,l+f.y+(p+1)*a)})}}();function RF(n){var t=ir.getEnv();return n instanceof t.Image&&n.complete||n instanceof t.Video&&n.readyState>=3}function f1(n){var t=ir.getEnv(),r=t.Video;return n instanceof t.Image?new su(n.naturalWidth,n.naturalHeight):n instanceof r?new su(n.videoWidth,n.videoHeight):new su(n.width,n.height)}function gm(n){var t=n.width,e=n.height,o=(0,ir.getEnv().createCanvasElement)();return o.width=t,o.height=e,o}function h1(n,t){var e=ir.getEnv().ImageData;if(!(n instanceof e||RF(n)))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=t||f1(n),o=r.width,i=r.height,s=gm({width:o,height:i});return n instanceof e?gi(s).putImageData(n,0,0):gi(s).drawImage(n,0,0,o,i),s}function lX(n,t){return we(this,void 0,void 0,function(){var e,r,o,i,s,a;return be(this,function(u){switch(u.label){case 0:return e=t||ir.getEnv().createCanvasElement(),r=n.shape.slice(ca(n)?1:0),o=r[0],i=r[1],s=r[2],a=le(function(){return n.as3D(o,i,s).toInt()}),[4,e1.toPixels(a,e)];case 1:return u.sent(),a.dispose(),[2,e]}})})}function NF(n){var t=ir.getEnv();return n instanceof t.Image||n instanceof t.Canvas||n instanceof t.Video}var mm=function(){function n(t,e){var r=this;if(void 0===e&&(e=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(t))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+t);this._treatAsBatchInput=e,this._batchSize=t.length,t.forEach(function(o,i){if(fm(o))return r._imageTensors[i]=o,void(r._inputDimensions[i]=o.shape);if(ca(o)){var s=o.shape[0];if(1!==s)throw new Error("NetInput - tf.Tensor4D with batchSize "+s+" passed, but not supported in input array");return r._imageTensors[i]=o,void(r._inputDimensions[i]=o.shape.slice(1))}var a=o instanceof ir.getEnv().Canvas?o:h1(o);r._canvases[i]=a,r._inputDimensions[i]=[a.height,a.width,3]})}return Object.defineProperty(n.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"reshapedInputDimensions",{get:function(){var t=this;return Sf(this.batchSize,0,1).map(function(e,r){return t.getReshapedInputDimensions(r)})},enumerable:!0,configurable:!0}),n.prototype.getInput=function(t){return this.canvases[t]||this.imageTensors[t]},n.prototype.getInputDimensions=function(t){return this._inputDimensions[t]},n.prototype.getInputHeight=function(t){return this._inputDimensions[t][0]},n.prototype.getInputWidth=function(t){return this._inputDimensions[t][1]},n.prototype.getReshapedInputDimensions=function(t){if("number"!=typeof this.inputSize)throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");return function YK(n,t){var e=n.width,r=n.height,o=t/Math.max(r,e);return new su(Math.round(e*o),Math.round(r*o))}({width:this.getInputWidth(t),height:this.getInputHeight(t)},this.inputSize)},n.prototype.toBatchTensor=function(t,e){var r=this;return void 0===e&&(e=!0),this._inputSize=t,le(function(){var o=Sf(r.batchSize,0,1).map(function(s){var a=r.getInput(s);if(a instanceof It){var u=ca(a)?a:a.expandDims();return u=function JK(n,t){return void 0===t&&(t=!1),le(function(){var e=n.shape.slice(1),r=e[0],o=e[1];if(r===o)return n;var i=Math.abs(r-o),s=Math.round(i*(t?.5:1)),a=r>o?2:1,u=function(h){var p=n.shape.slice();return p[a]=h,hi(p,0)},l=u(s),c=i-l.shape[a],f=[t&&c?u(c):null,n,l].filter(function(h){return!!h}).map(function(h){return h.toFloat()});return Dn(f,a)})}(u,e),(u.shape[1]!==t||u.shape[2]!==t)&&(u=O_.resizeBilinear(u,[t,t])),u.as3D(t,t,3)}if(a instanceof ir.getEnv().Canvas)return e1.fromPixels(function cX(n,t,e){void 0===e&&(e=!1);var r=ir.getEnv(),i=r.Canvas;if(!(n instanceof r.Image||n instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var s=f1(n),a=t/Math.max(s.height,s.width),u=a*s.width,l=a*s.height,c=gm({width:t,height:t}),d=n instanceof i?n:h1(n),f=Math.abs(u-l)/2,h=e&&u<l?f:0,p=e&&l<u?f:0;return gi(c).drawImage(d,h,p,u,l),c}(a,t,e));throw new Error("toBatchTensor - at batchIdx "+s+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+a)});return qr(o.map(function(s){return s.toFloat()})).as4D(r.batchSize,t,t,3)})},n}();function Nn(n){return we(this,void 0,void 0,function(){var t,e,r;return be(this,function(o){switch(o.label){case 0:if(n instanceof mm)return[2,n];if(!(t=Array.isArray(n)?n:[n]).length)throw new Error("toNetInput - empty array passed as input");return e=function(i){return Array.isArray(n)?" at input index "+i+":":""},(r=t.map(d1)).forEach(function(i,s){if(!NF(i)&&!fm(i)&&!ca(i))throw"string"==typeof t[s]?new Error("toNetInput -"+e(s)+" string passed, but could not resolve HTMLElement for element id "+t[s]):new Error("toNetInput -"+e(s)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(ca(i)){var a=i.shape[0];if(1!==a)throw new Error("toNetInput -"+e(s)+" tf.Tensor4D with batchSize "+a+" passed, but not supported in input array")}}),[4,Promise.all(r.map(function(i){return NF(i)&&function uX(n){return new Promise(function(t,e){if(n instanceof ir.getEnv().Canvas||RF(n))return t();function r(i){!i.currentTarget||(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",o),t(i))}function o(i){!i.currentTarget||(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",o),e(i))}n.addEventListener("load",r),n.addEventListener("error",o)})}(i)}))];case 1:return o.sent(),[2,new mm(r,Array.isArray(n))]}})})}function p1(n,t){return we(this,void 0,void 0,function(){var e,r,o,i,s,a;return be(this,function(l){switch(l.label){case 0:return e=ir.getEnv().Canvas,r=n,n instanceof e?[3,5]:[4,Nn(n)];case 1:if((o=l.sent()).batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return(i=o.getInput(0))instanceof e?(s=i,[3,4]):[3,2];case 2:return[4,lX(i)];case 3:s=l.sent(),l.label=4;case 4:r=s,l.label=5;case 5:return a=gi(r),[2,t.map(function(c){return c instanceof jo?c.forSize(r.width,r.height).box.floor():c}).map(function(c){return c.clipAtImageBorders(r.width,r.height)}).map(function(c){var d=c.x,f=c.y,h=c.width,p=c.height,m=gm({width:h,height:p});return gi(m).putImageData(a.getImageData(d,f,h,p),0,0),m})]}})})}function g1(n,t){return we(this,void 0,void 0,function(){return be(this,function(e){if(!fm(n)&&!ca(n))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(ca(n)&&n.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,le(function(){var r=n.shape.slice(ca(n)?1:0),o=r[0],i=r[1],s=r[2];return t.map(function(l){return l instanceof jo?l.forSize(i,o).box:l}).map(function(l){return l.clipAtImageBorders(i,o)}).map(function(l){var c=l.x,d=l.y,f=l.width,h=l.height;return kN(n.as3D(o,i,s),[d,c,0],[h,f,s])})})]})})}function dX(n,t){return we(this,void 0,void 0,function(){var r;return be(this,function(o){switch(o.label){case 0:return[4,(0,ir.getEnv().fetch)(n,t)];case 1:if(!((r=o.sent()).status<400))throw new Error("failed to fetch: ("+r.status+") "+r.statusText+", from url: "+r.url);return[2,r]}})})}function fX(n){return we(this,void 0,void 0,function(){return be(this,function(t){switch(t.label){case 0:return[4,dX(n)];case 1:return[2,t.sent().json()]}})})}function FF(n,t){var e=t+"-weights_manifest.json";if(!n)return{modelBaseUri:"",manifestUri:e};if("/"===n)return{modelBaseUri:"/",manifestUri:"/"+e};var r=n.startsWith("http://")?"http://":n.startsWith("https://")?"https://":"",o=(n=n.replace(r,"")).split("/").filter(function(a){return a}),i=n.endsWith(".json")?o[o.length-1]:e,s=r+(n.endsWith(".json")?o.slice(0,o.length-1):o).join("/");return{modelBaseUri:s=n.startsWith("/")?"/"+s:s,manifestUri:"/"===s?"/"+i:s+"/"+i}}function hX(n,t){return we(this,void 0,void 0,function(){var e,o,i;return be(this,function(s){switch(s.label){case 0:return e=FF(n,t),o=e.modelBaseUri,[4,fX(e.manifestUri)];case 1:return i=s.sent(),[2,aF.loadWeights(i,o)]}})})}var ds=function(){function n(t){this._name=t,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(n.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),n.prototype.getParamFromPath=function(t){var e=this.traversePropertyPath(t);return e.obj[e.objProp]},n.prototype.reassignParamFromPath=function(t,e){var r=this.traversePropertyPath(t),o=r.obj,i=r.objProp;o[i].dispose(),o[i]=e},n.prototype.getParamList=function(){var t=this;return this._paramMappings.map(function(e){var r=e.paramPath;return{path:r,tensor:t.getParamFromPath(r)}})},n.prototype.getTrainableParams=function(){return this.getParamList().filter(function(t){return t.tensor instanceof Tl})},n.prototype.getFrozenParams=function(){return this.getParamList().filter(function(t){return!(t.tensor instanceof Tl)})},n.prototype.variable=function(){var t=this;this.getFrozenParams().forEach(function(e){t.reassignParamFromPath(e.path,e.tensor.variable())})},n.prototype.freeze=function(){var t=this;this.getTrainableParams().forEach(function(e){var r=e.path,o=e.tensor,i=Wn(o.dataSync());o.dispose(),t.reassignParamFromPath(r,i)})},n.prototype.dispose=function(t){void 0===t&&(t=!0),this.getParamList().forEach(function(e){if(t&&e.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+e.path);e.tensor.dispose()}),this._params=void 0},n.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(t){return Array.from(t.tensor.dataSync())}).reduce(function(t,e){return t.concat(e)}))},n.prototype.load=function(t){return we(this,void 0,void 0,function(){return be(this,function(e){switch(e.label){case 0:return t instanceof Float32Array?(this.extractWeights(t),[2]):[4,this.loadFromUri(t)];case 1:return e.sent(),[2]}})})},n.prototype.loadFromUri=function(t){return we(this,void 0,void 0,function(){var e;return be(this,function(r){switch(r.label){case 0:if(t&&"string"!=typeof t)throw new Error(this._name+".loadFromUri - expected model uri");return[4,hX(t,this.getDefaultModelName())];case 1:return e=r.sent(),this.loadFromWeightMap(e),[2]}})})},n.prototype.loadFromDisk=function(t){return we(this,void 0,void 0,function(){var e,r,o,i,a,u,l,c,d;return be(this,function(f){switch(f.label){case 0:if(t&&"string"!=typeof t)throw new Error(this._name+".loadFromDisk - expected model file path");return e=ir.getEnv().readFile,r=FF(t,this.getDefaultModelName()),o=r.manifestUri,i=r.modelBaseUri,a=aF.weightsLoaderFactory(function(h){return Promise.all(h.map(function(p){return e(p).then(function(m){return m.buffer})}))}),c=(l=JSON).parse,[4,e(o)];case 1:return u=c.apply(l,[f.sent().toString()]),[4,a(u,i)];case 2:return d=f.sent(),this.loadFromWeightMap(d),[2]}})})},n.prototype.loadFromWeightMap=function(t){var e=this.extractParamsFromWeigthMap(t),o=e.params;this._paramMappings=e.paramMappings,this._params=o},n.prototype.extractWeights=function(t){var e=this.extractParams(t),o=e.params;this._paramMappings=e.paramMappings,this._params=o},n.prototype.traversePropertyPath=function(t){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var e=t.split("/").reduce(function(i,s){if(!i.nextObj.hasOwnProperty(s))throw new Error("traversePropertyPath - object does not have property "+s+", for path "+t);return{obj:i.nextObj,objProp:s,nextObj:i.nextObj[s]}},{nextObj:this.params}),r=e.obj,o=e.objProp;if(!(r&&o&&r[o]instanceof It))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+t);return{obj:r,objProp:o}},n}();function Xr(n,t,e){return le(function(){var r=k_(n,t.depthwise_filter,t.pointwise_filter,e,"same");return Je(r,t.bias)})}function m1(n,t,e){return void 0===e&&(e=!1),le(function(){var r=$t(e?Je(po(n,t.conv0.filters,[2,2],"same"),t.conv0.bias):Xr(n,t.conv0,[2,2])),o=Xr(r,t.conv1,[1,1]),s=Xr($t(Je(r,o)),t.conv2,[1,1]);return $t(Je(r,Je(o,s)))})}function vm(n,t,e,r){return void 0===e&&(e=!1),void 0===r&&(r=!0),le(function(){var o=$t(e?Je(po(n,t.conv0.filters,r?[2,2]:[1,1],"same"),t.conv0.bias):Xr(n,t.conv0,r?[2,2]:[1,1])),i=Xr(o,t.conv1,[1,1]),a=Xr($t(Je(o,i)),t.conv2,[1,1]),l=Xr($t(Je(o,Je(i,a))),t.conv3,[1,1]);return $t(Je(o,Je(i,Je(a,l))))})}function Ho(n,t,e,r){return void 0===e&&(e="same"),void 0===r&&(r=!1),le(function(){var o=Je(po(n,t.filters,[1,1],e),t.bias);return r?$t(o):o})}function fs(n,t){Object.keys(n).forEach(function(e){t.some(function(r){return r.originalPath===e})||n[e].dispose()})}function ym(n,t){return function(e,r,o,i){var s=Rr(n(e*r*o*o),[o,o,e,r]),a=mn(n(r));return t.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:s,bias:a}}}function v1(n,t){return function(e,r,o){var i=oa(n(e*r),[e,r]),s=mn(n(r));return t.push({paramPath:o+"/weights"},{paramPath:o+"/bias"}),{weights:i,bias:s}}}var PF=function n(t,e,r){this.depthwise_filter=t,this.pointwise_filter=e,this.bias=r};function y1(n,t){return function(e,r,o){var i=Rr(n(9*e),[3,3,e,1]),s=Rr(n(e*r),[1,1,e,r]),a=mn(n(r));return t.push({paramPath:o+"/depthwise_filter"},{paramPath:o+"/pointwise_filter"},{paramPath:o+"/bias"}),new PF(i,s,a)}}function w1(n){return function(t){var e=n(t+"/depthwise_filter",4),r=n(t+"/pointwise_filter",4),o=n(t+"/bias",1);return new PF(e,r,o)}}function da(n,t){return function(e,r,o){var i=n[e];if(!Df(i,r))throw new Error("expected weightMap["+e+"] to be a Tensor"+r+"D, instead have "+i);return t.push({originalPath:e,paramPath:o||e}),i}}function hs(n){var t=n;return{extractWeights:function e(o){var i=t.slice(0,o);return t=t.slice(o),i},getRemainingWeights:function r(){return t}}}function OF(n,t){var e=ym(n,t),r=y1(n,t);function o(s,a,u,l){return void 0===l&&(l=!1),{conv0:l?e(s,a,3,u+"/conv0"):r(s,a,u+"/conv0"),conv1:r(a,a,u+"/conv1"),conv2:r(a,a,u+"/conv2")}}return{extractDenseBlock3Params:o,extractDenseBlock4Params:function i(s,a,u,l){void 0===l&&(l=!1);var c=o(s,a,u,l);return{conv0:c.conv0,conv1:c.conv1,conv2:c.conv2,conv3:r(a,a,u+"/conv3")}}}}function LF(n){return function(t){return{filters:n(t+"/filters",4),bias:n(t+"/bias",1)}}}function BF(n,t){var e=da(n,t),r=LF(e),o=w1(e);return{extractDenseBlock3Params:function i(a,u){return void 0===u&&(u=!1),{conv0:u?r(a+"/conv0"):o(a+"/conv0"),conv1:o(a+"/conv1"),conv2:o(a+"/conv2")}},extractDenseBlock4Params:function s(a,u){return void 0===u&&(u=!1),{conv0:u?r(a+"/conv0"):o(a+"/conv0"),conv1:o(a+"/conv1"),conv2:o(a+"/conv2"),conv3:o(a+"/conv3")}}}}var VF=function(n){function t(){return n.call(this,"FaceFeatureExtractor")||this}return Be(t,n),t.prototype.forwardInput=function(e){var r=this.params;if(!r)throw new Error("FaceFeatureExtractor - load model before inference");return le(function(){var a=vm(Af(e.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(oe(255)),r.dense0,!0);return a=vm(a,r.dense1),a=vm(a,r.dense2),a=vm(a,r.dense3),xf(a,[7,7],[2,2],"valid")})},t.prototype.forward=function(e){return we(this,void 0,void 0,function(){var r;return be(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Nn(e)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},t.prototype.extractParamsFromWeigthMap=function(e){return function mX(n){var t=[],e=BF(n,t).extractDenseBlock4Params,r={dense0:e("dense0",!0),dense1:e("dense1"),dense2:e("dense2"),dense3:e("dense3")};return fs(n,t),{params:r,paramMappings:t}}(e)},t.prototype.extractParams=function(e){return function gX(n){var t=[],e=hs(n),o=e.getRemainingWeights,i=OF(e.extractWeights,t).extractDenseBlock4Params,s=i(3,32,"dense0",!0),a=i(32,64,"dense1"),u=i(64,128,"dense2"),l=i(128,256,"dense3");if(0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{dense0:s,dense1:a,dense2:u,dense3:l}}}(e)},t}(ds);function mi(n,t){return le(function(){return Je(im(n,t.weights),t.bias)})}function UF(n){var t={},e={};return Object.keys(n).forEach(function(r){(r.startsWith("fc")?e:t)[r]=n[r]}),{featureExtractorMap:t,classifierMap:e}}var jF=function(n){function t(e,r){var o=n.call(this,e)||this;return o._faceFeatureExtractor=r,o}return Be(t,n),Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(e){var r=this,o=this.params;if(!o)throw new Error(this._name+" - load model before inference");return le(function(){var i=e instanceof mm?r.faceFeatureExtractor.forwardInput(e):e;return mi(i.as2D(i.shape[0],-1),o.fc)})},t.prototype.dispose=function(e){void 0===e&&(e=!0),this.faceFeatureExtractor.dispose(e),n.prototype.dispose.call(this,e)},t.prototype.loadClassifierParams=function(e){var r=this.extractClassifierParams(e),i=r.paramMappings;this._params=r.params,this._paramMappings=i},t.prototype.extractClassifierParams=function(e){return function vX(n,t,e){var r=[],o=hs(n),s=o.getRemainingWeights,u=v1(o.extractWeights,r)(t,e,"fc");if(0!==s().length)throw new Error("weights remaing after extract: "+s().length);return{paramMappings:r,params:{fc:u}}}(e,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},t.prototype.extractParamsFromWeigthMap=function(e){var r=UF(e),i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(r.featureExtractorMap),function yX(n){var t=[],e=da(n,t),o={fc:function r(i){return{weights:e(i+"/weights",2),bias:e(i+"/bias",1)}}("fc")};return fs(n,t),{params:o,paramMappings:t}}(i)},t.prototype.extractParams=function(e){var r=this.getClassifierChannelsIn(),o=this.getClassifierChannelsOut(),i=o*r+o,s=e.slice(0,e.length-i),a=e.slice(e.length-i);return this.faceFeatureExtractor.extractWeights(s),this.extractClassifierParams(a)},t}(ds),HF=["neutral","happy","sad","angry","fearful","disgusted","surprised"],wX=function(){function n(t){var e=this;if(7!==t.length)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+t.length);HF.forEach(function(r,o){e[r]=t[o]})}return n.prototype.asSortedArray=function(){var t=this;return HF.map(function(e){return{expression:e,probability:t[e]}}).sort(function(e,r){return r.probability-e.probability})},n}(),bX=function(n){function t(e){return void 0===e&&(e=new VF),n.call(this,"FaceExpressionNet",e)||this}return Be(t,n),t.prototype.forwardInput=function(e){var r=this;return le(function(){return os(r.runNet(e))})},t.prototype.forward=function(e){return we(this,void 0,void 0,function(){var r;return be(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Nn(e)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.predictExpressions=function(e){return we(this,void 0,void 0,function(){var r,o,i,s,a=this;return be(this,function(u){switch(u.label){case 0:return[4,Nn(e)];case 1:return r=u.sent(),[4,this.forwardInput(r)];case 2:return o=u.sent(),[4,Promise.all(Sn(o).map(function(l){return we(a,void 0,void 0,function(){var c;return be(this,function(d){switch(d.label){case 0:return[4,l.data()];case 1:return c=d.sent(),l.dispose(),[2,c]}})})}))];case 3:return i=u.sent(),o.dispose(),s=i.map(function(l){return new wX(l)}),[2,r.isBatchInput?s:s[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_expression_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t.prototype.getClassifierChannelsOut=function(){return 7},t}(jF);function WF(n,t){return Object.assign({},n,{expressions:t})}function zF(n){return DF(n)&&n.landmarks instanceof Tf&&n.unshiftedLandmarks instanceof Tf&&n.alignedRect instanceof jo}function wm(n,t){var e=n.detection.box,r=t.shiftBy(e.x,e.y),o=r.align(),i=n.detection.imageDims,s=new jo(n.detection.score,o.rescale(i.reverse()),i);return Object.assign({},n,{landmarks:r,unshiftedLandmarks:t,alignedRect:s})}function $F(n,t,e){return Je(po(n,t.filters,e,"same"),t.bias)}function b1(n,t,e){void 0===e&&(e=!0);var r=e?$t(n):n;return r=Xr(r,t.separable_conv0,[1,1]),r=Xr($t(r),t.separable_conv1,[1,1]),r=Rn(r,[3,3],[2,2],"same"),Je(r,$F(n,t.expansion_conv,[2,2]))}var AX=function(n){function t(e){var r=n.call(this,"TinyXception")||this;return r._numMainBlocks=e,r}return Be(t,n),t.prototype.forwardInput=function(e){var r=this,o=this.params;if(!o)throw new Error("TinyXception - load model before inference");return le(function(){var a=Af(e.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(oe(256)),u=$t($F(a,o.entry_flow.conv_in,[2,2]));return u=b1(u,o.entry_flow.reduction_block_0,!1),u=b1(u,o.entry_flow.reduction_block_1),Sf(r._numMainBlocks,0,1).forEach(function(l){u=function IX(n,t){var e=Xr($t(n),t.separable_conv0,[1,1]);return e=Xr($t(e),t.separable_conv1,[1,1]),e=Xr($t(e),t.separable_conv2,[1,1]),Je(e,n)}(u,o.middle_flow["main_block_"+l])}),u=b1(u,o.exit_flow.reduction_block),u=$t(Xr(u,o.exit_flow.separable_conv,[1,1]))})},t.prototype.forward=function(e){return we(this,void 0,void 0,function(){var r;return be(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Nn(e)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"tiny_xception_model"},t.prototype.extractParamsFromWeigthMap=function(e){return function SX(n,t){var e=[],r=function DX(n,t){var e=da(n,t),r=LF(e),o=w1(e);return{extractConvParams:r,extractSeparableConvParams:o,extractReductionBlockParams:function i(a){return{separable_conv0:o(a+"/separable_conv0"),separable_conv1:o(a+"/separable_conv1"),expansion_conv:r(a+"/expansion_conv")}},extractMainBlockParams:function s(a){return{separable_conv0:o(a+"/separable_conv0"),separable_conv1:o(a+"/separable_conv1"),separable_conv2:o(a+"/separable_conv2")}}}}(n,e),i=r.extractSeparableConvParams,s=r.extractReductionBlockParams,a=r.extractMainBlockParams,d={conv_in:(0,r.extractConvParams)("entry_flow/conv_in"),reduction_block_0:s("entry_flow/reduction_block_0"),reduction_block_1:s("entry_flow/reduction_block_1")},f={};Sf(t,0,1).forEach(function(v){f["main_block_"+v]=a("middle_flow/main_block_"+v)});var m={reduction_block:s("exit_flow/reduction_block"),separable_conv:i("exit_flow/separable_conv")};return fs(n,e),{params:{entry_flow:d,middle_flow:f,exit_flow:m},paramMappings:e}}(e,this._numMainBlocks)},t.prototype.extractParams=function(e){return function EX(n,t){var e=[],r=hs(n),i=r.getRemainingWeights,s=function CX(n,t){var e=ym(n,t),r=y1(n,t);return{extractConvParams:e,extractSeparableConvParams:r,extractReductionBlockParams:function o(s,a,u){return{separable_conv0:r(s,a,u+"/separable_conv0"),separable_conv1:r(a,a,u+"/separable_conv1"),expansion_conv:e(s,a,1,u+"/expansion_conv")}},extractMainBlockParams:function i(s,a){return{separable_conv0:r(s,s,a+"/separable_conv0"),separable_conv1:r(s,s,a+"/separable_conv1"),separable_conv2:r(s,s,a+"/separable_conv2")}}}}(r.extractWeights,e),u=s.extractSeparableConvParams,l=s.extractReductionBlockParams,c=s.extractMainBlockParams,p={conv_in:(0,s.extractConvParams)(3,32,3,"entry_flow/conv_in"),reduction_block_0:l(32,64,"entry_flow/reduction_block_0"),reduction_block_1:l(64,128,"entry_flow/reduction_block_1")},m={};Sf(t,0,1).forEach(function(b){m["main_block_"+b]=c(128,"middle_flow/main_block_"+b)});var _={reduction_block:l(128,256,"exit_flow/reduction_block"),separable_conv:u(256,512,"exit_flow/separable_conv")};if(0!==i().length)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:e,params:{entry_flow:p,middle_flow:m,exit_flow:_}}}(e,this._numMainBlocks)},t}(ds),kf=(()=>(function(n){n.FEMALE="female",n.MALE="male"}(kf||(kf={})),kf))(),kX=function(n){function t(e){void 0===e&&(e=new AX(2));var r=n.call(this,"AgeGenderNet")||this;return r._faceFeatureExtractor=e,r}return Be(t,n),Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(e){var r=this,o=this.params;if(!o)throw new Error(this._name+" - load model before inference");return le(function(){var i=e instanceof mm?r.faceFeatureExtractor.forwardInput(e):e,s=xf(i,[7,7],[2,2],"valid").as2D(i.shape[0],-1);return{age:mi(s,o.fc.age).as1D(),gender:mi(s,o.fc.gender)}})},t.prototype.forwardInput=function(e){var r=this;return le(function(){var o=r.runNet(e);return{age:o.age,gender:os(o.gender)}})},t.prototype.forward=function(e){return we(this,void 0,void 0,function(){var r;return be(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Nn(e)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.predictAgeAndGender=function(e){return we(this,void 0,void 0,function(){var r,o,i,s,a,u,l=this;return be(this,function(c){switch(c.label){case 0:return[4,Nn(e)];case 1:return r=c.sent(),[4,this.forwardInput(r)];case 2:return o=c.sent(),i=Sn(o.age),s=Sn(o.gender),a=i.map(function(d,f){return{ageTensor:d,genderTensor:s[f]}}),[4,Promise.all(a.map(function(d){var f=d.ageTensor,h=d.genderTensor;return we(l,void 0,void 0,function(){var p,m,v,y,_;return be(this,function(b){switch(b.label){case 0:return[4,f.data()];case 1:return p=b.sent()[0],[4,h.data()];case 2:return m=b.sent()[0],y=(v=m>.5)?kf.MALE:kf.FEMALE,_=v?m:1-m,f.dispose(),h.dispose(),[2,{age:p,gender:y,genderProbability:_}]}})})}))];case 3:return u=c.sent(),o.age.dispose(),o.gender.dispose(),[2,r.isBatchInput?u:u[0]]}})})},t.prototype.getDefaultModelName=function(){return"age_gender_model"},t.prototype.dispose=function(e){void 0===e&&(e=!0),this.faceFeatureExtractor.dispose(e),n.prototype.dispose.call(this,e)},t.prototype.loadClassifierParams=function(e){var r=this.extractClassifierParams(e),i=r.paramMappings;this._params=r.params,this._paramMappings=i},t.prototype.extractClassifierParams=function(e){return function TX(n){var t=[],e=hs(n),o=e.getRemainingWeights,i=v1(e.extractWeights,t),s=i(512,1,"fc/age"),a=i(512,2,"fc/gender");if(0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{fc:{age:s,gender:a}}}}(e)},t.prototype.extractParamsFromWeigthMap=function(e){var r=UF(e),i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(r.featureExtractorMap),function MX(n){var t=[],e=da(n,t);function r(i){return{weights:e(i+"/weights",2),bias:e(i+"/bias",1)}}var o={fc:{age:r("fc/age"),gender:r("fc/gender")}};return fs(n,t),{params:o,paramMappings:t}}(i)},t.prototype.extractParams=function(e){var o=e.slice(0,e.length-1539),i=e.slice(e.length-1539);return this.faceFeatureExtractor.extractWeights(o),this.extractClassifierParams(i)},t}(ds),GF=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return Be(t,n),t.prototype.postProcess=function(e,r,o){var i=o.map(function(a){var u=a.width,l=a.height,c=r/Math.max(l,u);return{width:u*c,height:l*c}}),s=i.length;return le(function(){var a=function(f,h){return qr([hi([68],f),hi([68],h)],1).as2D(1,136).as1D()},u=function(f,h){var p=i[f],m=p.width,v=p.height;return h(m,v)?Math.abs(m-v)/2:0};return e.mul(hi([s,136],r)).sub(qr(Array.from(Array(s),function(f,h){return a(function(f){return u(f,function(h,p){return h<p})}(h),function(f){return u(f,function(h,p){return p<h})}(h))}))).div(qr(Array.from(Array(s),function(f,h){return a(i[h].width,i[h].height)})))})},t.prototype.forwardInput=function(e){var r=this;return le(function(){var o=r.runNet(e);return r.postProcess(o,e.inputSize,e.inputDimensions.map(function(i){return{height:i[0],width:i[1]}}))})},t.prototype.forward=function(e){return we(this,void 0,void 0,function(){var r;return be(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Nn(e)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.detectLandmarks=function(e){return we(this,void 0,void 0,function(){var r,o,i,s=this;return be(this,function(a){switch(a.label){case 0:return[4,Nn(e)];case 1:return r=a.sent(),o=le(function(){return Sn(s.forwardInput(r))}),[4,Promise.all(o.map(function(u,l){return we(s,void 0,void 0,function(){var c,d,f,h,p;return be(this,function(m){switch(m.label){case 0:return f=(d=Array).from,[4,u.data()];case 1:return c=f.apply(d,[m.sent()]),h=c.filter(function(v,y){return yF(y)}),p=c.filter(function(v,y){return!yF(y)}),[2,new xF(Array(68).fill(0).map(function(v,y){return new gt(h[y],p[y])}),{height:r.getInputHeight(l),width:r.getInputWidth(l)})]}})})}))];case 2:return i=a.sent(),o.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},t.prototype.getClassifierChannelsOut=function(){return 136},t}(jF),qF=function(n){function t(e){return void 0===e&&(e=new VF),n.call(this,"FaceLandmark68Net",e)||this}return Be(t,n),t.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t}(GF),FX=function(n){function t(){return n.call(this,"TinyFaceFeatureExtractor")||this}return Be(t,n),t.prototype.forwardInput=function(e){var r=this.params;if(!r)throw new Error("TinyFaceFeatureExtractor - load model before inference");return le(function(){var a=m1(Af(e.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(oe(255)),r.dense0,!0);return a=m1(a,r.dense1),a=m1(a,r.dense2),xf(a,[14,14],[2,2],"valid")})},t.prototype.forward=function(e){return we(this,void 0,void 0,function(){var r;return be(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Nn(e)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},t.prototype.extractParamsFromWeigthMap=function(e){return function RX(n){var t=[],e=BF(n,t).extractDenseBlock3Params,r={dense0:e("dense0",!0),dense1:e("dense1"),dense2:e("dense2")};return fs(n,t),{params:r,paramMappings:t}}(e)},t.prototype.extractParams=function(e){return function NX(n){var t=[],e=hs(n),o=e.getRemainingWeights,i=OF(e.extractWeights,t).extractDenseBlock3Params,s=i(3,32,"dense0",!0),a=i(32,64,"dense1"),u=i(64,128,"dense2");if(0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{dense0:s,dense1:a,dense2:u}}}(e)},t}(ds),PX=function(n){function t(e){return void 0===e&&(e=new FX),n.call(this,"FaceLandmark68TinyNet",e)||this}return Be(t,n),t.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},t.prototype.getClassifierChannelsIn=function(){return 128},t}(GF);function _1(n,t,e,r,o){void 0===o&&(o="same");var i=t.conv,a=i.bias,u=po(n,i.filters,e,o);return u=function OX(n,t){return Je(nr(n,t.weights),t.biases)}(u=Je(u,a),t.scale),r?$t(u):u}function KF(n,t){return _1(n,t,[1,1],!1)}function XF(n,t){return _1(n,t,[2,2],!0,"valid")}function BX(n,t){function i(a,u,l,c){var d=function r(a,u,l,c){var d=function e(a,u,l){var c=n(a),d=c.length/(u*l*l);if(function KK(n){return n%1!=0}(d))throw new Error("depth has to be an integer: "+d+", weights.length: "+c.length+", numFilters: "+u+", filterSize: "+l);return le(function(){return sa(Rr(c,[u,d,l,l]),[2,3,1,0])})}(a,u,l),f=mn(n(u));return t.push({paramPath:c+"/filters"},{paramPath:c+"/bias"}),{filters:d,bias:f}}(a,u,l,c+"/conv"),f=function o(a,u){var l=mn(n(a)),c=mn(n(a));return t.push({paramPath:u+"/weights"},{paramPath:u+"/biases"}),{weights:l,biases:c}}(u,c+"/scale");return{conv:d,scale:f}}return{extractConvLayerParams:i,extractResidualLayerParams:function s(a,u,l,c,d){return void 0===d&&(d=!1),{conv1:i((d?.5:1)*a,u,l,c+"/conv1"),conv2:i(a,u,l,c+"/conv2")}}}}function jX(n){var t=[],e=function UX(n,t){var e=da(n,t);function o(s){var a=e(s+"/conv/filters",4),u=e(s+"/conv/bias",1),l=function r(s){return{weights:e(s+"/scale/weights",1),biases:e(s+"/scale/biases",1)}}(s);return{conv:{filters:a,bias:u},scale:l}}return{extractConvLayerParams:o,extractResidualLayerParams:function i(s){return{conv1:o(s+"/conv1"),conv2:o(s+"/conv2")}}}}(n,t),o=e.extractResidualLayerParams,i=(0,e.extractConvLayerParams)("conv32_down"),s=o("conv32_1"),a=o("conv32_2"),u=o("conv32_3"),l=o("conv64_down"),c=o("conv64_1"),d=o("conv64_2"),f=o("conv64_3"),h=o("conv128_down"),p=o("conv128_1"),m=o("conv128_2"),v=o("conv256_down"),y=o("conv256_1"),_=o("conv256_2"),b=o("conv256_down_out"),x=n.fc;if(t.push({originalPath:"fc",paramPath:"fc"}),!function qK(n){return Df(n,2)}(x))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+x);var E={conv32_down:i,conv32_1:s,conv32_2:a,conv32_3:u,conv64_down:l,conv64_1:c,conv64_2:d,conv64_3:f,conv128_down:h,conv128_1:p,conv128_2:m,conv256_down:v,conv256_1:y,conv256_2:_,conv256_down_out:b,fc:x};return fs(n,t),{params:E,paramMappings:t}}function vi(n,t){var e=function LX(n,t){return _1(n,t,[1,1],!0)}(n,t.conv1);return e=KF(e,t.conv2),e=Je(e,n),$t(e)}function bm(n,t){var e=XF(n,t.conv1);e=KF(e,t.conv2);var r=xf(n,2,2,"valid"),o=Ft(r.shape),i=r.shape[3]!==e.shape[3];if(r.shape[1]!==e.shape[1]||r.shape[2]!==e.shape[2]){var a=Ef(e.shape);a[1]=1;var u=Ft(a),l=Ef((e=Dn([e,u],1)).shape);l[2]=1;var c=Ft(l);e=Dn([e,c],2)}return r=i?Dn([r,o],3):r,e=Je(r,e),$t(e)}!function(n){Be(function t(){return null!==n&&n.apply(this,arguments)||this},n)}(qF);var HX=function(n){function t(){return n.call(this,"FaceRecognitionNet")||this}return Be(t,n),t.prototype.forwardInput=function(e){var r=this.params;if(!r)throw new Error("FaceRecognitionNet - load model before inference");return le(function(){var a=XF(Af(e.toBatchTensor(150,!0).toFloat(),[122.782,117.001,104.298]).div(oe(256)),r.conv32_down);a=vi(a=Rn(a,3,2,"valid"),r.conv32_1),a=vi(a,r.conv32_2),a=vi(a,r.conv32_3),a=vi(a=bm(a,r.conv64_down),r.conv64_1),a=vi(a,r.conv64_2),a=vi(a,r.conv64_3),a=vi(a=bm(a,r.conv128_down),r.conv128_1),a=vi(a,r.conv128_2),a=vi(a=bm(a,r.conv256_down),r.conv256_1);var u=(a=bm(a=vi(a,r.conv256_2),r.conv256_down_out)).mean([1,2]);return im(u,r.fc)})},t.prototype.forward=function(e){return we(this,void 0,void 0,function(){var r;return be(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Nn(e)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.computeFaceDescriptor=function(e){return we(this,void 0,void 0,function(){var r,o,i,s=this;return be(this,function(a){switch(a.label){case 0:return[4,Nn(e)];case 1:return r=a.sent(),o=le(function(){return Sn(s.forwardInput(r))}),[4,Promise.all(o.map(function(u){return u.data()}))];case 2:return i=a.sent(),o.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_recognition_model"},t.prototype.extractParamsFromWeigthMap=function(e){return jX(e)},t.prototype.extractParams=function(e){return function VX(n){var t=hs(n),e=t.extractWeights,r=t.getRemainingWeights,o=[],i=BX(e,o),a=i.extractResidualLayerParams,u=(0,i.extractConvLayerParams)(4704,32,7,"conv32_down"),l=a(9216,32,3,"conv32_1"),c=a(9216,32,3,"conv32_2"),d=a(9216,32,3,"conv32_3"),f=a(36864,64,3,"conv64_down",!0),h=a(36864,64,3,"conv64_1"),p=a(36864,64,3,"conv64_2"),m=a(36864,64,3,"conv64_3"),v=a(147456,128,3,"conv128_down",!0),y=a(147456,128,3,"conv128_1"),_=a(147456,128,3,"conv128_2"),b=a(589824,256,3,"conv256_down",!0),x=a(589824,256,3,"conv256_1"),E=a(589824,256,3,"conv256_2"),D=a(589824,256,3,"conv256_down_out"),k=le(function(){return sa(oa(e(32768),[128,256]),[1,0])});if(o.push({paramPath:"fc"}),0!==r().length)throw new Error("weights remaing after extract: "+r().length);return{params:{conv32_down:u,conv32_1:l,conv32_2:c,conv32_3:d,conv64_down:f,conv64_1:h,conv64_2:p,conv64_3:m,conv128_down:v,conv128_1:y,conv128_2:_,conv256_down:b,conv256_1:x,conv256_2:E,conv256_down_out:D,fc:k},paramMappings:o}}(e)},t}(ds);function YF(n,t,e){return Object.assign({},n,{gender:t,genderProbability:e})}var QF=function(){function n(t){var e=void 0===t?{}:t,r=e.minFaceSize,o=e.scaleFactor,i=e.maxNumScales,s=e.scoreThresholds,a=e.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=r||20,this._scaleFactor=o||.709,this._maxNumScales=i||10,this._scoreThresholds=s||[.6,.7,.7],this._scaleSteps=a,"number"!=typeof this._minFaceSize||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if("number"!=typeof this._scaleFactor||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if("number"!=typeof this._maxNumScales||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||3!==this._scoreThresholds.length||this._scoreThresholds.some(function(u){return"number"!=typeof u}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(u){return"number"!=typeof u})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(n.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),n}();function yi(n,t,e){return le(function(){var r=po(n,t.filters,e,"same");return r=Je(r,t.batch_norm_offset),D_(r,0,6)})}function ZX(n,t,e){var r=n.arraySync(),o=Math.min(r[t][0],r[t][2]),i=Math.min(r[t][1],r[t][3]),s=Math.max(r[t][0],r[t][2]),a=Math.max(r[t][1],r[t][3]),u=Math.min(r[e][0],r[e][2]),l=Math.min(r[e][1],r[e][3]),c=Math.max(r[e][0],r[e][2]),d=Math.max(r[e][1],r[e][3]),f=(s-o)*(a-i),h=(c-u)*(d-l);if(f<=0||h<=0)return 0;var p=Math.max(o,u),m=Math.max(i,l),v=Math.min(s,c),y=Math.min(a,d),_=Math.max(v-p,0)*Math.max(y-m,0);return _/(f+h-_)}function zl(n,t){return le(function(){var e=n.shape[0];return{boxPredictionEncoding:Bo(Ho(n,t.box_encoding_predictor),[e,-1,1,4]),classPrediction:Bo(Ho(n,t.class_predictor),[e,-1,3])}})}var _m=function(){function n(t){var e=void 0===t?{}:t,r=e.minConfidence,o=e.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=r||.5,this._maxResults=o||100,"number"!=typeof this._minConfidence||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if("number"!=typeof this._maxResults)throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(n.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),n}(),ZF=function(n){function t(){return n.call(this,"SsdMobilenetv1")||this}return Be(t,n),t.prototype.forwardInput=function(e){var r=this.params;if(!r)throw new Error("SsdMobilenetv1 - load model before inference");return le(function(){var o=e.toBatchTensor(512,!1).toFloat(),s=function YX(n,t){return le(function(){var e=null,r=yi(n,t.conv_0,[2,2]);if([t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13].forEach(function(i,s){var a=s+1,u=function XX(n){return[2,4,6,12].some(function(t){return t===n})?[2,2]:[1,1]}(a);r=function KX(n,t,e){return le(function(){var r=om(n,t.filters,e,"same");return r=pN(r,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,.0010000000474974513),D_(r,0,6)})}(r,i.depthwise_conv,u),r=yi(r,i.pointwise_conv,[1,1]),11===a&&(e=r)}),null===e)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:e}})}(In(nr(o,oe(.007843137718737125)),oe(1)),r.mobilenetv1),a=function nY(n,t,e){return le(function(){var r=yi(n,e.conv_0,[1,1]),o=yi(r,e.conv_1,[2,2]),i=yi(o,e.conv_2,[1,1]),s=yi(i,e.conv_3,[2,2]),a=yi(s,e.conv_4,[1,1]),u=yi(a,e.conv_5,[2,2]),l=yi(u,e.conv_6,[1,1]),c=yi(l,e.conv_7,[2,2]),d=zl(t,e.box_predictor_0),f=zl(n,e.box_predictor_1),h=zl(o,e.box_predictor_2),p=zl(s,e.box_predictor_3),m=zl(u,e.box_predictor_4),v=zl(c,e.box_predictor_5);return{boxPredictions:Dn([d.boxPredictionEncoding,f.boxPredictionEncoding,h.boxPredictionEncoding,p.boxPredictionEncoding,m.boxPredictionEncoding,v.boxPredictionEncoding],1),classPredictions:Dn([d.classPrediction,f.classPrediction,h.classPrediction,p.classPrediction,m.classPrediction,v.classPrediction],1)}})}(s.out,s.conv11,r.prediction_layer);return function tY(n,t,e){return le(function(){var r=n.shape[0],o=function eY(n,t){var e=function JX(n){var t=Sn(sa(n,[1,0])),e=[In(t[2],t[0]),In(t[3],t[1])];return{sizes:e,centers:[Je(t[0],Uo(e[0],oe(2))),Je(t[1],Uo(e[1],oe(2)))]}}(n),r=e.sizes,o=e.centers,i=Sn(sa(t,[1,0])),s=Uo(nr(S_(Uo(i[2],oe(5))),r[0]),oe(2)),a=Je(nr(Uo(i[0],oe(10)),r[0]),o[0]),u=Uo(nr(S_(Uo(i[3],oe(5))),r[1]),oe(2)),l=Je(nr(Uo(i[1],oe(10)),r[1]),o[1]);return sa(qr([In(a,s),In(l,u),Je(a,s),Je(l,u)]),[1,0])}(Bo(kl(e.extra_dim,[r,1,1]),[-1,4]),Bo(n,[-1,4]));o=Bo(o,[r,o.shape[0]/r,4]);var i=cN(pi(t,[0,0,1],[-1,-1,-1])),s=pi(i,[0,0,0],[-1,-1,1]);return s=Bo(s,[r,s.shape[1]]),{boxes:Sn(o),scores:Sn(s)}})}(a.boxPredictions,a.classPredictions,r.output_layer)})},t.prototype.forward=function(e){return we(this,void 0,void 0,function(){var r;return be(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Nn(e)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.locateFaces=function(e,r){return void 0===r&&(r={}),we(this,void 0,void 0,function(){var o,i,s,a,u,l,c,d,f,h,p,m,v,_,b,x,E,D,k,R;return be(this,function(A){switch(A.label){case 0:return o=new _m(r),i=o.maxResults,s=o.minConfidence,[4,Nn(e)];case 1:for(a=A.sent(),u=this.forwardInput(a),d=(l=u.boxes)[0],f=(c=u.scores)[0],h=1;h<l.length;h++)l[h].dispose(),c[h].dispose();return v=(m=Array).from,[4,f.data()];case 2:return p=v.apply(m,[A.sent()]),_=function QX(n,t,e,r,o){var s=Math.min(e,n.shape[0]),a=t.map(function(c,d){return{score:c,boxIndex:d}}).filter(function(c){return c.score>o}).sort(function(c,d){return d.score-c.score}),u=function(c){return c<=r?1:0},l=[];return a.forEach(function(c){if(!(l.length>=s)){for(var d=c.score,f=l.length-1;f>=0;--f){var h=ZX(n,c.boxIndex,l[f]);if(0!==h&&(c.score*=u(h),c.score<=o))break}d===c.score&&l.push(c.boxIndex)}}),l}(d,p,i,.5,s),b=a.getReshapedInputDimensions(0),E=(x=a.inputSize)/b.width,D=x/b.height,k=d.arraySync(),R=_.map(function(M){var O=[Math.max(0,k[M][0]),Math.min(1,k[M][2])].map(function(V){return V*D}),P=O[0],G=O[1],q=[Math.max(0,k[M][1]),Math.min(1,k[M][3])].map(function(V){return V*E}),K=q[0];return new jo(p[M],new u1(K,P,q[1]-K,G-P),{height:a.getInputHeight(0),width:a.getInputWidth(0)})}),d.dispose(),f.dispose(),[2,R]}})})},t.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},t.prototype.extractParamsFromWeigthMap=function(e){return function GX(n){var t=[],e=function $X(n,t){var e=da(n,t);function r(l,c,d){return{filters:e(l+"/Conv2d_"+c+"_pointwise/weights",4,d+"/filters"),batch_norm_offset:e(l+"/Conv2d_"+c+"_pointwise/convolution_bn_offset",1,d+"/batch_norm_offset")}}function o(l){var c="mobilenetv1/conv_"+l,d="MobilenetV1/Conv2d_"+l+"_depthwise",f=c+"/depthwise_conv",h=c+"/pointwise_conv";return{depthwise_conv:{filters:e(d+"/depthwise_weights",4,f+"/filters"),batch_norm_scale:e(d+"/BatchNorm/gamma",1,f+"/batch_norm_scale"),batch_norm_offset:e(d+"/BatchNorm/beta",1,f+"/batch_norm_offset"),batch_norm_mean:e(d+"/BatchNorm/moving_mean",1,f+"/batch_norm_mean"),batch_norm_variance:e(d+"/BatchNorm/moving_variance",1,f+"/batch_norm_variance")},pointwise_conv:r("MobilenetV1",l,h)}}function s(l,c){return{filters:e(l+"/weights",4,c+"/filters"),bias:e(l+"/biases",1,c+"/bias")}}function a(l){return{box_encoding_predictor:s("Prediction/BoxPredictor_"+l+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+l+"/box_encoding_predictor"),class_predictor:s("Prediction/BoxPredictor_"+l+"/ClassPredictor","prediction_layer/box_predictor_"+l+"/class_predictor")}}return{extractMobilenetV1Params:function i(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:o(1),conv_2:o(2),conv_3:o(3),conv_4:o(4),conv_5:o(5),conv_6:o(6),conv_7:o(7),conv_8:o(8),conv_9:o(9),conv_10:o(10),conv_11:o(11),conv_12:o(12),conv_13:o(13)}},extractPredictionLayerParams:function u(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:a(0),box_predictor_1:a(1),box_predictor_2:a(2),box_predictor_3:a(3),box_predictor_4:a(4),box_predictor_5:a(5)}}}}(n,t),r=e.extractMobilenetV1Params,o=e.extractPredictionLayerParams,i=n["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!fm(i))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+i);var s={mobilenetv1:r(),prediction_layer:o(),output_layer:{extra_dim:i}};return fs(n,t),{params:s,paramMappings:t}}(e)},t.prototype.extractParams=function(e){return function zX(n){var t=[],e=hs(n),r=e.extractWeights,o=e.getRemainingWeights,i=function WX(n,t){function r(u,l,c,d,f){var h=Rr(n(u*l*c*c),[c,c,u,l]),p=mn(n(l));return t.push({paramPath:d+"/filters"},{paramPath:d+"/"+(f?"batch_norm_offset":"bias")}),{filters:h,bias:p}}function o(u,l,c,d){var f=r(u,l,c,d,!0);return{filters:f.filters,batch_norm_offset:f.bias}}function i(u,l,c){var d=function e(u,l){var c=Rr(n(9*u),[3,3,u,1]),d=mn(n(u)),f=mn(n(u)),h=mn(n(u)),p=mn(n(u));return t.push({paramPath:l+"/filters"},{paramPath:l+"/batch_norm_scale"},{paramPath:l+"/batch_norm_offset"},{paramPath:l+"/batch_norm_mean"},{paramPath:l+"/batch_norm_variance"}),{filters:c,batch_norm_scale:d,batch_norm_offset:f,batch_norm_mean:h,batch_norm_variance:p}}(u,c+"/depthwise_conv");return{depthwise_conv:d,pointwise_conv:o(u,l,1,c+"/pointwise_conv")}}return{extractMobilenetV1Params:function s(){return{conv_0:o(3,32,3,"mobilenetv1/conv_0"),conv_1:i(32,64,"mobilenetv1/conv_1"),conv_2:i(64,128,"mobilenetv1/conv_2"),conv_3:i(128,128,"mobilenetv1/conv_3"),conv_4:i(128,256,"mobilenetv1/conv_4"),conv_5:i(256,256,"mobilenetv1/conv_5"),conv_6:i(256,512,"mobilenetv1/conv_6"),conv_7:i(512,512,"mobilenetv1/conv_7"),conv_8:i(512,512,"mobilenetv1/conv_8"),conv_9:i(512,512,"mobilenetv1/conv_9"),conv_10:i(512,512,"mobilenetv1/conv_10"),conv_11:i(512,512,"mobilenetv1/conv_11"),conv_12:i(512,1024,"mobilenetv1/conv_12"),conv_13:i(1024,1024,"mobilenetv1/conv_13")}},extractPredictionLayerParams:function a(){return{conv_0:o(1024,256,1,"prediction_layer/conv_0"),conv_1:o(256,512,3,"prediction_layer/conv_1"),conv_2:o(512,128,1,"prediction_layer/conv_2"),conv_3:o(128,256,3,"prediction_layer/conv_3"),conv_4:o(256,128,1,"prediction_layer/conv_4"),conv_5:o(128,256,3,"prediction_layer/conv_5"),conv_6:o(256,64,1,"prediction_layer/conv_6"),conv_7:o(64,128,3,"prediction_layer/conv_7"),box_predictor_0:{box_encoding_predictor:r(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),class_predictor:r(512,9,1,"prediction_layer/box_predictor_0/class_predictor")},box_predictor_1:{box_encoding_predictor:r(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),class_predictor:r(1024,18,1,"prediction_layer/box_predictor_1/class_predictor")},box_predictor_2:{box_encoding_predictor:r(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),class_predictor:r(512,18,1,"prediction_layer/box_predictor_2/class_predictor")},box_predictor_3:{box_encoding_predictor:r(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),class_predictor:r(256,18,1,"prediction_layer/box_predictor_3/class_predictor")},box_predictor_4:{box_encoding_predictor:r(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),class_predictor:r(256,18,1,"prediction_layer/box_predictor_4/class_predictor")},box_predictor_5:{box_encoding_predictor:r(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),class_predictor:r(128,18,1,"prediction_layer/box_predictor_5/class_predictor")}}}}}(r,t),a=i.extractPredictionLayerParams,u=(0,i.extractMobilenetV1Params)(),l=a(),d={extra_dim:J0(r(20472),[1,5118,4])};if(t.push({paramPath:"output_layer/extra_dim"}),0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{params:{mobilenetv1:u,prediction_layer:l,output_layer:d},paramMappings:t}}(e)},t}(ds);!function(n){Be(function t(){return null!==n&&n.apply(this,arguments)||this},n)}(ZF);var iY=[new gt(.738768,.874946),new gt(2.42204,2.65704),new gt(4.30971,7.04493),new gt(10.246,4.59428),new gt(12.6868,11.8741)],sY=[new gt(1.603231,2.094468),new gt(6.041143,7.080126),new gt(2.882459,3.518061),new gt(4.266906,5.178857),new gt(9.041765,10.66308)],aY=[117.001,114.697,97.404],xm=function(n){return"number"==typeof n};function x1(n){return le(function(){var t=nr(n,oe(.10000000149011612));return Je($t(In(n,t)),t)})}function fa(n,t){return le(function(){var e=Za(n,[[0,0],[1,1],[1,1],[0,0]]);return e=po(e,t.conv.filters,[1,1],"valid"),e=In(e,t.bn.sub),e=nr(e,t.bn.truediv),x1(e=Je(e,t.conv.bias))})}function ha(n,t){return le(function(){var e=Za(n,[[0,0],[1,1],[1,1],[0,0]]);return e=k_(e,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),x1(e=Je(e,t.bias))})}var C1=function(){function n(t){var e=void 0===t?{}:t,r=e.inputSize,o=e.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=r||416,this._scoreThreshold=o||.5,"number"!=typeof this._inputSize||this._inputSize%32!=0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if("number"!=typeof this._scoreThreshold||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(n.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),n}(),JF=function(n){function t(e){var r=n.call(this,"TinyYolov2")||this;return function cY(n){if(!n)throw new Error("invalid config: "+n);if("boolean"!=typeof n.withSeparableConvs)throw new Error("config.withSeparableConvs has to be a boolean, have: "+n.withSeparableConvs);if(!xm(n.iouThreshold)||n.iouThreshold<0||n.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+n.iouThreshold);if(!Array.isArray(n.classes)||!n.classes.length||!n.classes.every(function(t){return"string"==typeof t}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(n.classes));if(!Array.isArray(n.anchors)||!n.anchors.length||!n.anchors.map(function(t){return t||{}}).every(function(t){return xm(t.x)&&xm(t.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(n.anchors));if(n.meanRgb&&(!Array.isArray(n.meanRgb)||3!==n.meanRgb.length||!n.meanRgb.every(xm)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(n.meanRgb))}(e),r._config=e,r}return Be(t,n),Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),t.prototype.runTinyYolov2=function(e,r){var o=fa(e,r.conv0);return o=fa(o=Rn(o,[2,2],[2,2],"same"),r.conv1),o=fa(o=Rn(o,[2,2],[2,2],"same"),r.conv2),o=fa(o=Rn(o,[2,2],[2,2],"same"),r.conv3),o=fa(o=Rn(o,[2,2],[2,2],"same"),r.conv4),o=fa(o=Rn(o,[2,2],[2,2],"same"),r.conv5),o=fa(o=Rn(o,[2,2],[1,1],"same"),r.conv6),Ho(o=fa(o,r.conv7),r.conv8,"valid",!1)},t.prototype.runMobilenet=function(e,r){var o=this.config.isFirstLayerConv2d?x1(Ho(e,r.conv0,"valid",!1)):ha(e,r.conv0);return o=ha(o=Rn(o,[2,2],[2,2],"same"),r.conv1),o=ha(o=Rn(o,[2,2],[2,2],"same"),r.conv2),o=ha(o=Rn(o,[2,2],[2,2],"same"),r.conv3),o=ha(o=Rn(o,[2,2],[2,2],"same"),r.conv4),o=ha(o=Rn(o,[2,2],[2,2],"same"),r.conv5),o=Rn(o,[2,2],[1,1],"same"),o=r.conv6?ha(o,r.conv6):o,Ho(o=r.conv7?ha(o,r.conv7):o,r.conv8,"valid",!1)},t.prototype.forwardInput=function(e,r){var o=this,i=this.params;if(!i)throw new Error("TinyYolov2 - load model before inference");return le(function(){var s=e.toBatchTensor(r,!1).toFloat();return s=(s=o.config.meanRgb?Af(s,o.config.meanRgb):s).div(oe(256)),o.config.withSeparableConvs?o.runMobilenet(s,i):o.runTinyYolov2(s,i)})},t.prototype.forward=function(e,r){return we(this,void 0,void 0,function(){var o;return be(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,Nn(e)];case 1:return[4,o.apply(this,[i.sent(),r])];case 2:return[2,i.sent()]}})})},t.prototype.detect=function(e,r){return void 0===r&&(r={}),we(this,void 0,void 0,function(){var o,i,s,a,u,l,c,d,f,h,p,m,_=this;return be(this,function(b){switch(b.label){case 0:return o=new C1(r),i=o.inputSize,s=o.scoreThreshold,[4,Nn(e)];case 1:return a=b.sent(),[4,this.forwardInput(a,i)];case 2:return u=b.sent(),l=le(function(){return Sn(u)[0].expandDims()}),c={width:a.getInputWidth(0),height:a.getInputHeight(0)},[4,this.extractBoxes(l,a.getReshapedInputDimensions(0),s)];case 3:return d=b.sent(),u.dispose(),l.dispose(),f=d.map(function(x){return x.box}),h=d.map(function(x){return x.score}),p=d.map(function(x){return x.classScore}),m=d.map(function(x){return _.config.classes[x.label]}),[2,If(f.map(function(x){return x.rescale(i)}),h,this.config.iouThreshold,!0).map(function(x){return new _F(h[x],p[x],m[x],f[x],c)})]}})})},t.prototype.getDefaultModelName=function(){return""},t.prototype.extractParamsFromWeigthMap=function(e){return function pY(n,t){var a,e=[],r=function hY(n,t){var e=da(n,t);function o(a){return{filters:e(a+"/filters",4),bias:e(a+"/bias",1)}}return{extractConvParams:o,extractConvWithBatchNormParams:function i(a){var u=o(a+"/conv"),l=function r(a){return{sub:e(a+"/sub",1),truediv:e(a+"/truediv",1)}}(a+"/bn");return{conv:u,bn:l}},extractSeparableConvParams:w1(e)}}(n,e),o=r.extractConvParams,i=r.extractConvWithBatchNormParams,s=r.extractSeparableConvParams;if(t.withSeparableConvs){var u=t.filterSizes&&t.filterSizes.length||9;a={conv0:t.isFirstLayerConv2d?o("conv0"):s("conv0"),conv1:s("conv1"),conv2:s("conv2"),conv3:s("conv3"),conv4:s("conv4"),conv5:s("conv5"),conv6:u>7?s("conv6"):void 0,conv7:u>8?s("conv7"):void 0,conv8:o("conv8")}}else a={conv0:i("conv0"),conv1:i("conv1"),conv2:i("conv2"),conv3:i("conv3"),conv4:i("conv4"),conv5:i("conv5"),conv6:i("conv6"),conv7:i("conv7"),conv8:o("conv8")};return fs(n,e),{params:a,paramMappings:e}}(e,this.config)},t.prototype.extractParams=function(e){var r=this.config.filterSizes||t.DEFAULT_FILTER_SIZES,o=r?r.length:void 0;if(7!==o&&8!==o&&9!==o)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+o+" filterSizes in config");return function fY(n,t,e,r){var f,o=hs(n),s=o.getRemainingWeights,a=[],u=function dY(n,t){var e=ym(n,t),i=y1(n,t);return{extractConvParams:e,extractConvWithBatchNormParams:function o(s,a,u){var l=e(s,a,3,u+"/conv"),c=function r(s,a){var u=mn(n(s)),l=mn(n(s));return t.push({paramPath:a+"/sub"},{paramPath:a+"/truediv"}),{sub:u,truediv:l}}(a,u+"/bn");return{conv:l,bn:c}},extractSeparableConvParams:i}}(o.extractWeights,a),l=u.extractConvParams,c=u.extractConvWithBatchNormParams,d=u.extractSeparableConvParams;if(t.withSeparableConvs){var h=r[0],p=r[1],m=r[2],v=r[3],y=r[4],_=r[5],b=r[6],x=r[7],E=r[8];f={conv0:t.isFirstLayerConv2d?l(h,p,3,"conv0"):d(h,p,"conv0"),conv1:d(p,m,"conv1"),conv2:d(m,v,"conv2"),conv3:d(v,y,"conv3"),conv4:d(y,_,"conv4"),conv5:d(_,b,"conv5"),conv6:x?d(b,x,"conv6"):void 0,conv7:E?d(x,E,"conv7"):void 0,conv8:l(E||x||b,5*e,1,"conv8")}}else m=r[2],v=r[3],y=r[4],_=r[5],b=r[6],x=r[7],E=r[8],f={conv0:c(h=r[0],p=r[1],"conv0"),conv1:c(p,m,"conv1"),conv2:c(m,v,"conv2"),conv3:c(v,y,"conv3"),conv4:c(y,_,"conv4"),conv5:c(_,b,"conv5"),conv6:c(b,x,"conv6"),conv7:c(x,E,"conv7"),conv8:l(E,5*e,1,"conv8")};if(0!==s().length)throw new Error("weights remaing after extract: "+s().length);return{params:f,paramMappings:a}}(e,this.config,this.boxEncodingSize,r)},t.prototype.extractBoxes=function(e,r,o){return we(this,void 0,void 0,function(){var i,s,a,u,l,c,d,f,h,p,m,v,y,_,b,x,E,D,k,R,A,M,O,P,G,q,K,L,V,B=this;return be(this,function(z){switch(z.label){case 0:return i=r.width,s=r.height,a=Math.max(i,s),u=a/i,l=a/s,c=e.shape[1],d=this.config.anchors.length,f=le(function(){var Y=e.reshape([c,c,d,B.boxEncodingSize]);return[Y.slice([0,0,0,0],[c,c,d,4]),Y.slice([0,0,0,4],[c,c,d,1]),B.withClassScores?os(Y.slice([0,0,0,5],[c,c,d,B.config.classes.length]),3):oe(0)]}),h=f[0],m=f[2],v=[],[4,(p=f[1]).array()];case 1:return y=z.sent(),[4,h.array()];case 2:_=z.sent(),b=0,z.label=3;case 3:if(!(b<c))return[3,12];x=0,z.label=4;case 4:if(!(x<c))return[3,11];E=0,z.label=5;case 5:return E<d?(D=a1(y[b][x][E][0]),!o||D>o?(k=(x+a1(_[b][x][E][0]))/c*u,R=(b+a1(_[b][x][E][1]))/c*l,A=Math.exp(_[b][x][E][2])*this.config.anchors[E].x/c*u,M=Math.exp(_[b][x][E][3])*this.config.anchors[E].y/c*l,O=k-A/2,P=R-M/2,G={row:b,col:x,anchor:E},this.withClassScores?[4,this.extractPredictedClass(m,G)]:[3,7]):[3,9]):[3,10];case 6:return V=z.sent(),[3,8];case 7:V={classScore:1,label:0},z.label=8;case 8:K=(q=V).classScore,L=q.label,v.push(or({box:new hm(O,P,O+A,P+M),score:D,classScore:D*K,label:L},G)),z.label=9;case 9:return E++,[3,5];case 10:return x++,[3,4];case 11:return b++,[3,3];case 12:return h.dispose(),p.dispose(),m.dispose(),[2,v]}})})},t.prototype.extractPredictedClass=function(e,r){return we(this,void 0,void 0,function(){var o,i,s,a;return be(this,function(u){switch(u.label){case 0:return o=r.row,i=r.col,s=r.anchor,[4,e.array()];case 1:return a=u.sent(),[2,Array(this.config.classes.length).fill(0).map(function(l,c){return a[o][i][s][c]}).map(function(l,c){return{classScore:l,label:c}}).reduce(function(l,c){return l.classScore>c.classScore?l:c})]}})})},t.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],t}(ds),gY=function(n){function t(e){void 0===e&&(e=!0);var o=Object.assign({},{withSeparableConvs:e,iouThreshold:.4,classes:["face"]},e?{anchors:sY,meanRgb:aY}:{anchors:iY,withClassScores:!0});return n.call(this,o)||this}return Be(t,n),Object.defineProperty(t.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(e,r){return we(this,void 0,void 0,function(){return be(this,function(i){switch(i.label){case 0:return[4,this.detect(e,r)];case 1:return[2,i.sent().map(function(s){return new jo(s.score,s.relativeBox,{width:s.imageWidth,height:s.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return this.withSeparableConvs?"tiny_yolov2_separable_conv_model":"tiny_yolov2_model"},t.prototype.extractParamsFromWeigthMap=function(e){return n.prototype.extractParamsFromWeigthMap.call(this,e)},t}(JF),E1=function(n){function t(){var e=null!==n&&n.apply(this,arguments)||this;return e._name="TinyFaceDetectorOptions",e}return Be(t,n),t}(C1),Rf=function(){function n(){}return n.prototype.then=function(t){return we(this,void 0,void 0,function(){var e;return be(this,function(r){switch(r.label){case 0:return e=t,[4,this.run()];case 1:return[2,e.apply(void 0,[r.sent()])]}})})},n.prototype.run=function(){return we(this,void 0,void 0,function(){return be(this,function(t){throw new Error("ComposableTask - run is not implemented")})})},n}();function eP(n,t){return Object.assign({},n,{descriptor:t})}function Cm(n,t,e,r,o){return void 0===o&&(o=function(i){return i.alignedRect}),we(this,void 0,void 0,function(){var i,s,a,u,l;return be(this,function(c){switch(c.label){case 0:return i=n.map(function(d){return zF(d)?o(d):d.detection}),(a=r)?[3,5]:t instanceof It?[4,g1(t,i)]:[3,2];case 1:return u=c.sent(),[3,4];case 2:return[4,p1(t,i)];case 3:u=c.sent(),c.label=4;case 4:a=u,c.label=5;case 5:return[4,e(s=a)];case 6:return l=c.sent(),s.forEach(function(d){return d instanceof It&&d.dispose()}),[2,l]}})})}function D1(n,t,e,r,o){return we(this,void 0,void 0,function(){var i=this;return be(this,function(s){return[2,Cm([n],t,function(a){return we(i,void 0,void 0,function(){return be(this,function(u){return[2,e(a[0])]})})},r,o)]})})}function S1(n,t){var r=t[1];return{height:Math.floor(t[0]*n),width:Math.floor(r*n)}}var I1=function(n){function t(e,r,o,i){return n.call(this,{left:e,top:r,right:o,bottom:i},!0)||this}return Be(t,n),t}(ls);function tP(n){return le(function(){return nr(In(n,oe(127.5)),oe(.0078125))})}function $l(n,t){return le(function(){return Je($t(n),nr(t,Jg($t(Jg(n)))))})}function A1(n,t,e){return void 0===e&&(e=!1),le(function(){var r=Ho(n,t.conv1,"valid");return r=$l(r,t.prelu1_alpha),r=$l(r=Ho(r=Rn(r,e?[2,2]:[3,3],[2,2],"same"),t.conv2,"valid"),t.prelu2_alpha),$l(r=Ho(r=e?r:Rn(r,[3,3],[2,2],"valid"),t.conv3,"valid"),t.prelu3_alpha)})}function DY(n,t,e,r,o){o.stage1=[];var i=t.map(function(f){return le(function(){var h={scale:f},p=function CY(n,t){return le(function(){var e=S1(t,n.shape.slice(1)),s=tP(O_.resizeBilinear(n,[e.height,e.width]));return sa(s,[0,2,1,3])})}(n,f),m=Date.now(),v=function xY(n,t){return le(function(){var e=A1(n,t,!0),r=Ho(e,t.conv4_1,"valid"),o=ho(sm(r,3),3);return{prob:os(In(r,o),3),regions:Ho(e,t.conv4_2,"valid")}})}(p,r),y=v.prob,_=v.regions;return h.pnet=Date.now()-m,{scoresTensor:Sn(Sn(y,3)[1])[0],regionsTensor:Sn(_)[0],scale:f,statsForScale:h}})}),s=i.map(function(f){var h=f.scoresTensor,p=f.regionsTensor,v=f.statsForScale,y=function EY(n,t,e,r){for(var o=[],i=n.arraySync(),s=0;s<n.shape[0];s++)for(var a=0;a<n.shape[1];a++)i[s][a]>=r&&o.push(new gt(a,s));return o.map(function(l){var c=new hm(Math.round((2*l.y+1)/e),Math.round((2*l.x+1)/e),Math.round((2*l.y+12)/e),Math.round((2*l.x+12)/e)),d=i[l.y][l.x],f=t.arraySync();return{cell:c,score:d,region:new I1(f[l.y][l.x][0],f[l.y][l.x][1],f[l.y][l.x][2],f[l.y][l.x][3])}})}(h,p,f.scale,e);if(h.dispose(),p.dispose(),!y.length)return o.stage1.push(v),[];var _=Date.now(),b=If(y.map(function(x){return x.cell}),y.map(function(x){return x.score}),.5);return v.nms=Date.now()-_,v.numBoxes=b.length,o.stage1.push(v),b.map(function(x){return y[x]})}),a=s.reduce(function(f,h){return f.concat(h)},[]),u=[],l=[];if(a.length>0){var c=Date.now(),d=If(a.map(function(f){return f.cell}),a.map(function(f){return f.score}),.7);o.stage1_nms=Date.now()-c,l=d.map(function(f){return a[f].score}),u=d.map(function(f){return a[f]}).map(function(f){var h=f.cell,p=f.region;return new hm(h.left+p.left*h.width,h.top+p.top*h.height,h.right+p.right*h.width,h.bottom+p.bottom*h.height).toSquare().round()})}return{boxes:u,scores:l}}function nP(n,t,e){var r=e.width,o=e.height;return we(this,void 0,void 0,function(){var i,s,a,u=this;return be(this,function(l){switch(l.label){case 0:return i=gi(n),[4,Promise.all(t.map(function(c){return we(u,void 0,void 0,function(){var d,v,y,_;return be(this,function(b){return d=c.padAtBorders(n.height,n.width),_=i.getImageData(v=d.x-1,y=d.y-1,d.ex-v,d.ey-y),[2,ir.isNodejs()?h1(_):createImageBitmap(_)]})})}))];case 1:return s=l.sent(),a=[],s.forEach(function(c){var f=gi(gm({width:r,height:o}));f.drawImage(c,0,0,r,o);for(var h=f.getImageData(0,0,r,o).data,p=[],m=0;m<h.length;m+=4)p.push(h[m+2]),p.push(h[m+1]),p.push(h[m]);a.push(p)}),[2,a.map(function(c){return le(function(){return tP(sa(Rr(c,[1,r,o,3]),[0,2,1,3]).toFloat())})})]}})})}function IY(n,t,e,r,o){return we(this,void 0,void 0,function(){var i,s,a,u,l,c,d,f,h,p,m,v,y,_;return be(this,function(b){switch(b.label){case 0:return i=Date.now(),[4,nP(n,t,{width:24,height:24})];case 1:return s=b.sent(),o.stage2_extractImagePatches=Date.now()-i,i=Date.now(),a=s.map(function(x){var E=function SY(n,t){return le(function(){var e=A1(n,t),i=$l(mi(Bo(e,[e.shape[0],t.fc1.weights.shape[0]]),t.fc1),t.prelu4_alpha),s=mi(i,t.fc2_1),a=ho(sm(s,1),1),u=os(In(s,a),1),l=mi(i,t.fc2_2);return{scores:Sn(u,1)[1],regions:l}})}(x,r);return x.dispose(),E}),o.stage2_rnet=Date.now()-i,u=a.length>1?Dn(a.map(function(x){return x.scores})):a[0].scores,d=(c=Array).from,[4,u.data()];case 2:return l=d.apply(c,[b.sent()]),u.dispose(),f=l.map(function(x,E){return{score:x,idx:E}}).filter(function(x){return x.score>e}).map(function(x){return x.idx}),h=f.map(function(x){return t[x]}),p=f.map(function(x){return l[x]}),m=[],v=[],h.length>0&&(i=Date.now(),y=If(h,p,.7),o.stage2_nms=Date.now()-i,_=y.map(function(x){var E=a[f[x]].regions.arraySync();return new I1(E[0][0],E[0][1],E[0][2],E[0][3])}),v=y.map(function(x){return p[x]}),m=y.map(function(x,E){return h[x].calibrate(_[E])})),a.forEach(function(x){x.regions.dispose(),x.scores.dispose()}),[2,{boxes:m,scores:v}]}})})}function TY(n,t,e,r,o){return we(this,void 0,void 0,function(){var i,s,a,u,l,c,d,f,h,p,m,v,y,_,b;return be(this,function(x){switch(x.label){case 0:return i=Date.now(),[4,nP(n,t,{width:48,height:48})];case 1:return s=x.sent(),o.stage3_extractImagePatches=Date.now()-i,i=Date.now(),a=s.map(function(E){var D=function AY(n,t){return le(function(){var e=A1(n,t);e=$l(e=Ho(e=Rn(e,[2,2],[2,2],"same"),t.conv4,"valid"),t.prelu4_alpha);var i=$l(mi(Bo(e,[e.shape[0],t.fc1.weights.shape[0]]),t.fc1),t.prelu5_alpha),s=mi(i,t.fc2_1),a=ho(sm(s,1),1),u=os(In(s,a),1),l=mi(i,t.fc2_2),c=mi(i,t.fc2_3);return{scores:Sn(u,1)[1],regions:l,points:c}})}(E,r);return E.dispose(),D}),o.stage3_onet=Date.now()-i,u=a.length>1?Dn(a.map(function(E){return E.scores})):a[0].scores,d=(c=Array).from,[4,u.data()];case 2:return l=d.apply(c,[x.sent()]),u.dispose(),f=l.map(function(E,D){return{score:E,idx:D}}).filter(function(E){return E.score>e}).map(function(E){return E.idx}),h=f.map(function(E){var D=a[E].regions.arraySync();return new I1(D[0][0],D[0][1],D[0][2],D[0][3])}),p=f.map(function(E,D){return t[E].calibrate(h[D])}),m=f.map(function(E){return l[E]}),v=[],y=[],_=[],p.length>0&&(i=Date.now(),b=If(p,m,.7,!1),o.stage3_nms=Date.now()-i,v=b.map(function(E){return p[E]}),y=b.map(function(E){return m[E]}),_=b.map(function(E,D){return Array(5).fill(0).map(function(k,R){var A=a[E].points.arraySync();return new gt(A[0][R]*(v[D].width+1)+v[D].left,A[0][R+5]*(v[D].height+1)+v[D].top)})})),a.forEach(function(E){E.regions.dispose(),E.scores.dispose(),E.points.dispose()}),[2,{boxes:v,scores:y,points:_}]}})})}var MY=function(n){function t(){return n.call(this,"Mtcnn")||this}return Be(t,n),t.prototype.load=function(e){return we(this,void 0,void 0,function(){return be(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,n.prototype.load.call(this,e)]})})},t.prototype.loadFromDisk=function(e){return we(this,void 0,void 0,function(){return be(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,n.prototype.loadFromDisk.call(this,e)]})})},t.prototype.forwardInput=function(e,r){return void 0===r&&(r={}),we(this,void 0,void 0,function(){var o,i,s,a,u,l,c,d,f,h,p,m,v,y,b,x,E,D,k,R;return be(this,function(A){switch(A.label){case 0:if(!(o=this.params))throw new Error("Mtcnn - load model before inference");if(!(i=e.canvases[0]))throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return s={},a=Date.now(),u=le(function(){return function mY(n){return le(function(){return qr(Sn(n,3).reverse(),3)})}(ho(e1.fromPixels(i)).toFloat())}),l=function(M){return u.dispose(),s.total=Date.now()-a,M},c=u.shape.slice(1),d=c[0],f=c[1],h=new QF(r),p=h.minFaceSize,m=h.scaleFactor,v=h.maxNumScales,y=h.scoreThresholds,b=(h.scaleSteps||function _Y(n,t,e){for(var i=12/n,s=[],a=Math.min(e[0],e[1])*i,u=0;a>=12;)s.push(i*Math.pow(t,u)),a*=t,u+=1;return s}(p,m,[d,f])).filter(function(M){var O=S1(M,[d,f]);return Math.min(O.width,O.height)>12}).slice(0,v),s.scales=b,s.pyramid=b.map(function(M){return S1(M,[d,f])}),x=Date.now(),[4,DY(u,b,y[0],o.pnet,s)];case 1:return E=A.sent(),s.total_stage1=Date.now()-x,E.boxes.length?(s.stage2_numInputBoxes=E.boxes.length,x=Date.now(),[4,IY(i,E.boxes,y[1],o.rnet,s)]):[2,l({results:[],stats:s})];case 2:return D=A.sent(),s.total_stage2=Date.now()-x,D.boxes.length?(s.stage3_numInputBoxes=D.boxes.length,x=Date.now(),[4,TY(i,D.boxes,y[2],o.onet,s)]):[2,l({results:[],stats:s})];case 3:return k=A.sent(),s.total_stage3=Date.now()-x,R=k.boxes.map(function(M,O){return wm(Mf({},new jo(k.scores[O],new u1(M.left/f,M.top/d,M.width/f,M.height/d),{height:d,width:f})),new rX(k.points[O].map(function(P){return P.sub(new gt(M.left,M.top)).div(new gt(M.width,M.height))}),{width:M.width,height:M.height}))}),[2,l({results:R,stats:s})]}})})},t.prototype.forward=function(e,r){return void 0===r&&(r={}),we(this,void 0,void 0,function(){var o;return be(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,Nn(e)];case 1:return[4,o.apply(this,[i.sent(),r])];case 2:return[2,i.sent().results]}})})},t.prototype.forwardWithStats=function(e,r){return void 0===r&&(r={}),we(this,void 0,void 0,function(){var o;return be(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,Nn(e)];case 1:return[2,o.apply(this,[i.sent(),r])]}})})},t.prototype.getDefaultModelName=function(){return"mtcnn_model"},t.prototype.extractParamsFromWeigthMap=function(e){return function bY(n){var t=[],e=function wY(n,t){var e=da(n,t);function r(c){return{filters:e(c+"/weights",4,c+"/filters"),bias:e(c+"/bias",1)}}function o(c){return{weights:e(c+"/weights",2),bias:e(c+"/bias",1)}}function i(c){return e(c,1)}function s(c){return{conv1:r(c+"/conv1"),prelu1_alpha:i(c+"/prelu1_alpha"),conv2:r(c+"/conv2"),prelu2_alpha:i(c+"/prelu2_alpha"),conv3:r(c+"/conv3"),prelu3_alpha:i(c+"/prelu3_alpha")}}return{extractPNetParams:function a(){var c=s("pnet"),d=r("pnet/conv4_1"),f=r("pnet/conv4_2");return or(or({},c),{conv4_1:d,conv4_2:f})},extractRNetParams:function u(){var c=s("rnet"),d=o("rnet/fc1"),f=i("rnet/prelu4_alpha"),h=o("rnet/fc2_1"),p=o("rnet/fc2_2");return or(or({},c),{fc1:d,prelu4_alpha:f,fc2_1:h,fc2_2:p})},extractONetParams:function l(){var c=s("onet"),d=r("onet/conv4"),f=i("onet/prelu4_alpha"),h=o("onet/fc1"),p=i("onet/prelu5_alpha"),m=o("onet/fc2_1"),v=o("onet/fc2_2"),y=o("onet/fc2_3");return or(or({},c),{conv4:d,prelu4_alpha:f,fc1:h,prelu5_alpha:p,fc2_1:m,fc2_2:v,fc2_3:y})}}}(n,t),o=e.extractRNetParams,i=e.extractONetParams,s=(0,e.extractPNetParams)(),a=o(),u=i();return fs(n,t),{params:{pnet:s,rnet:a,onet:u},paramMappings:t}}(e)},t.prototype.extractParams=function(e){return function yY(n){var t=hs(n),r=t.getRemainingWeights,o=[],i=function vY(n,t){var e=ym(n,t),r=v1(n,t);function o(l,c){var d=mn(n(l));return t.push({paramPath:c}),d}function i(l,c,d){return void 0===d&&(d=!1),{conv1:e(l[0],l[1],3,c+"/conv1"),prelu1_alpha:o(l[1],c+"/prelu1_alpha"),conv2:e(l[1],l[2],3,c+"/conv2"),prelu2_alpha:o(l[2],c+"/prelu2_alpha"),conv3:e(l[2],l[3],d?2:3,c+"/conv3"),prelu3_alpha:o(l[3],c+"/prelu3_alpha")}}return{extractPNetParams:function s(){var l=i([3,10,16,32],"pnet"),c=e(32,2,1,"pnet/conv4_1"),d=e(32,4,1,"pnet/conv4_2");return or(or({},l),{conv4_1:c,conv4_2:d})},extractRNetParams:function a(){var l=i([3,28,48,64],"rnet",!0),c=r(576,128,"rnet/fc1"),d=o(128,"rnet/prelu4_alpha"),f=r(128,2,"rnet/fc2_1"),h=r(128,4,"rnet/fc2_2");return or(or({},l),{fc1:c,prelu4_alpha:d,fc2_1:f,fc2_2:h})},extractONetParams:function u(){var l=i([3,32,64,64],"onet"),c=e(64,128,2,"onet/conv4"),d=o(128,"onet/prelu4_alpha"),f=r(1152,256,"onet/fc1"),h=o(256,"onet/prelu5_alpha"),p=r(256,2,"onet/fc2_1"),m=r(256,4,"onet/fc2_2"),v=r(256,10,"onet/fc2_3");return or(or({},l),{conv4:c,prelu4_alpha:d,fc1:f,prelu5_alpha:h,fc2_1:p,fc2_2:m,fc2_3:v})}}}(t.extractWeights,o),a=i.extractRNetParams,u=i.extractONetParams,l=(0,i.extractPNetParams)(),c=a(),d=u();if(0!==r().length)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:l,rnet:c,onet:d},paramMappings:o}}(e)},t}(ds),RY=[new gt(1.603231,2.094468),new gt(6.041143,7.080126),new gt(2.882459,3.518061),new gt(4.266906,5.178857),new gt(9.041765,10.66308)],NY=[117.001,114.697,97.404],FY=function(n){function t(){return n.call(this,{withSeparableConvs:!0,iouThreshold:.4,classes:["face"],anchors:RY,meanRgb:NY,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]})||this}return Be(t,n),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(e,r){return we(this,void 0,void 0,function(){return be(this,function(i){switch(i.label){case 0:return[4,this.detect(e,r)];case 1:return[2,i.sent().map(function(s){return new jo(s.score,s.relativeBox,{width:s.imageWidth,height:s.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},t.prototype.extractParamsFromWeigthMap=function(e){return n.prototype.extractParamsFromWeigthMap.call(this,e)},t}(JF),ft={ssdMobilenetv1:new ZF,tinyFaceDetector:new FY,tinyYolov2:new gY,mtcnn:new MY,faceLandmark68Net:new qF,faceLandmark68TinyNet:new PX,faceRecognitionNet:new HX,faceExpressionNet:new bX,ageGenderNet:new kX};function rP(n,t){return Object.assign({},n,{age:t})}var oP=function(n){function t(e,r,o){var i=n.call(this)||this;return i.parentTask=e,i.input=r,i.extractedFaces=o,i}return Be(t,n),t}(Rf),T1=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return Be(t,n),t.prototype.run=function(){return we(this,void 0,void 0,function(){var e,r,o=this;return be(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return[4,Cm(e=i.sent(),this.input,function(s){return we(o,void 0,void 0,function(){return be(this,function(a){switch(a.label){case 0:return[4,Promise.all(s.map(function(u){return ft.faceExpressionNet.predictExpressions(u)}))];case 1:return[2,a.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,e.map(function(s,a){return WF(s,r[a])})]}})})},t.prototype.withAgeAndGender=function(){return new N1(this,this.input)},t}(oP),M1=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return Be(t,n),t.prototype.run=function(){return we(this,void 0,void 0,function(){var e,r;return be(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return(e=o.sent())?[4,D1(e,this.input,function(i){return ft.faceExpressionNet.predictExpressions(i)},this.extractedFaces)]:[2];case 2:return r=o.sent(),[2,WF(e,r)]}})})},t.prototype.withAgeAndGender=function(){return new F1(this,this.input)},t}(oP),k1=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return Be(t,n),t.prototype.withAgeAndGender=function(){return new P1(this,this.input)},t.prototype.withFaceDescriptors=function(){return new L1(this,this.input)},t}(T1),R1=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return Be(t,n),t.prototype.withAgeAndGender=function(){return new O1(this,this.input)},t.prototype.withFaceDescriptor=function(){return new B1(this,this.input)},t}(M1),iP=function(n){function t(e,r,o){var i=n.call(this)||this;return i.parentTask=e,i.input=r,i.extractedFaces=o,i}return Be(t,n),t}(Rf),N1=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return Be(t,n),t.prototype.run=function(){return we(this,void 0,void 0,function(){var e,r,o=this;return be(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return[4,Cm(e=i.sent(),this.input,function(s){return we(o,void 0,void 0,function(){return be(this,function(a){switch(a.label){case 0:return[4,Promise.all(s.map(function(u){return ft.ageGenderNet.predictAgeAndGender(u)}))];case 1:return[2,a.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,e.map(function(s,a){var u=r[a],l=u.age;return rP(YF(s,u.gender,u.genderProbability),l)})]}})})},t.prototype.withFaceExpressions=function(){return new T1(this,this.input)},t}(iP),F1=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return Be(t,n),t.prototype.run=function(){return we(this,void 0,void 0,function(){var e,r,o;return be(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return(e=a.sent())?[4,D1(e,this.input,function(u){return ft.ageGenderNet.predictAgeAndGender(u)},this.extractedFaces)]:[2];case 2:return r=a.sent(),o=r.age,[2,rP(YF(e,r.gender,r.genderProbability),o)]}})})},t.prototype.withFaceExpressions=function(){return new M1(this,this.input)},t}(iP),P1=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return Be(t,n),t.prototype.withFaceExpressions=function(){return new k1(this,this.input)},t.prototype.withFaceDescriptors=function(){return new L1(this,this.input)},t}(N1),O1=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return Be(t,n),t.prototype.withFaceExpressions=function(){return new R1(this,this.input)},t.prototype.withFaceDescriptor=function(){return new B1(this,this.input)},t}(F1),sP=function(n){function t(e,r){var o=n.call(this)||this;return o.parentTask=e,o.input=r,o}return Be(t,n),t}(Rf),L1=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return Be(t,n),t.prototype.run=function(){return we(this,void 0,void 0,function(){var e;return be(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return[4,Cm(e=o.sent(),this.input,function(i){return Promise.all(i.map(function(s){return ft.faceRecognitionNet.computeFaceDescriptor(s)}))},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return[2,o.sent().map(function(i,s){return eP(e[s],i)})]}})})},t.prototype.withFaceExpressions=function(){return new k1(this,this.input)},t.prototype.withAgeAndGender=function(){return new P1(this,this.input)},t}(sP),B1=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return Be(t,n),t.prototype.run=function(){return we(this,void 0,void 0,function(){var e,r;return be(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return(e=o.sent())?[4,D1(e,this.input,function(i){return ft.faceRecognitionNet.computeFaceDescriptor(i)},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return r=o.sent(),[2,eP(e,r)]}})})},t.prototype.withFaceExpressions=function(){return new R1(this,this.input)},t.prototype.withAgeAndGender=function(){return new O1(this,this.input)},t}(sP),aP=function(n){function t(e,r,o){var i=n.call(this)||this;return i.parentTask=e,i.input=r,i.useTinyLandmarkNet=o,i}return Be(t,n),Object.defineProperty(t.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?ft.faceLandmark68TinyNet:ft.faceLandmark68Net},enumerable:!0,configurable:!0}),t}(Rf),PY=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return Be(t,n),t.prototype.run=function(){return we(this,void 0,void 0,function(){var e,r,o,i,s,a=this;return be(this,function(u){switch(u.label){case 0:return[4,this.parentTask];case 1:return e=u.sent(),r=e.map(function(l){return l.detection}),this.input instanceof It?[4,g1(this.input,r)]:[3,3];case 2:return i=u.sent(),[3,5];case 3:return[4,p1(this.input,r)];case 4:i=u.sent(),u.label=5;case 5:return o=i,[4,Promise.all(o.map(function(l){return a.landmarkNet.detectLandmarks(l)}))];case 6:return s=u.sent(),o.forEach(function(l){return l instanceof It&&l.dispose()}),[2,e.map(function(l,c){return wm(l,s[c])})]}})})},t.prototype.withFaceExpressions=function(){return new k1(this,this.input)},t.prototype.withAgeAndGender=function(){return new P1(this,this.input)},t.prototype.withFaceDescriptors=function(){return new L1(this,this.input)},t}(aP),OY=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return Be(t,n),t.prototype.run=function(){return we(this,void 0,void 0,function(){var e,r,o,i,s;return be(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return(e=a.sent())?(r=e.detection,this.input instanceof It?[4,g1(this.input,[r])]:[3,3]):[2];case 2:return i=a.sent(),[3,5];case 3:return[4,p1(this.input,[r])];case 4:i=a.sent(),a.label=5;case 5:return[4,this.landmarkNet.detectLandmarks((o=i)[0])];case 6:return s=a.sent(),o.forEach(function(u){return u instanceof It&&u.dispose()}),[2,wm(e,s)]}})})},t.prototype.withFaceExpressions=function(){return new R1(this,this.input)},t.prototype.withAgeAndGender=function(){return new O1(this,this.input)},t.prototype.withFaceDescriptor=function(){return new B1(this,this.input)},t}(aP),uP=function(n){function t(e,r){void 0===r&&(r=new _m);var o=n.call(this)||this;return o.input=e,o.options=r,o}return Be(t,n),t}(Rf),lP=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return Be(t,n),t.prototype.run=function(){return we(this,void 0,void 0,function(){var e,r,o,i;return be(this,function(s){switch(s.label){case 0:return r=(e=this).input,(o=e.options)instanceof QF?[4,ft.mtcnn.forward(r,o)]:[3,2];case 1:return[2,s.sent().map(function(a){return a.detection})];case 2:if(!(i=o instanceof E1?function(a){return ft.tinyFaceDetector.locateFaces(a,o)}:o instanceof _m?function(a){return ft.ssdMobilenetv1.locateFaces(a,o)}:o instanceof C1?function(a){return ft.tinyYolov2.locateFaces(a,o)}:null))throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,i(r)]}})})},t.prototype.runAndExtendWithFaceDetections=function(){var e=this;return new Promise(function(r){return we(e,void 0,void 0,function(){var o;return be(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return o=i.sent(),[2,r(o.map(function(s){return Mf({},s)}))]}})})})},t.prototype.withFaceLandmarks=function(e){return void 0===e&&(e=!1),new PY(this.runAndExtendWithFaceDetections(),this.input,e)},t.prototype.withFaceExpressions=function(){return new T1(this.runAndExtendWithFaceDetections(),this.input)},t.prototype.withAgeAndGender=function(){return new N1(this.runAndExtendWithFaceDetections(),this.input)},t}(uP);function cP(n,t){return void 0===t&&(t=new _m),new lP(n,t)}function dP(n,t){var e=new su(t.width,t.height),r=e.width,o=e.height;if(r<=0||o<=0)throw new Error("resizeResults - invalid dimensions: "+JSON.stringify({width:r,height:o}));if(Array.isArray(n))return n.map(function(a){return dP(a,{width:r,height:o})});if(zF(n)){var i=n.detection.forSize(r,o),s=n.unshiftedLandmarks.forSize(i.box.width,i.box.height);return wm(Mf(n,i),s)}return DF(n)?Mf(n,n.detection.forSize(r,o)):n instanceof Tf||n instanceof jo?n.forSize(r,o):n}!function(n){function t(){return null!==n&&n.apply(this,arguments)||this}Be(t,n),t.prototype.run=function(){return we(this,void 0,void 0,function(){var e,r;return be(this,function(o){switch(o.label){case 0:return[4,new lP(this.input,this.options)];case 1:return e=o.sent(),r=e[0],e.forEach(function(i){i.score>r.score&&(r=i)}),[2,r]}})})},t.prototype.runAndExtendWithFaceDetection=function(){var e=this;return new Promise(function(r){return we(e,void 0,void 0,function(){var o;return be(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return o=i.sent(),[2,r(o?Mf({},o):void 0)]}})})})},t.prototype.withFaceLandmarks=function(e){return void 0===e&&(e=!1),new OY(this.runAndExtendWithFaceDetection(),this.input,e)},t.prototype.withFaceExpressions=function(){return new M1(this.runAndExtendWithFaceDetection(),this.input)},t.prototype.withAgeAndGender=function(){return new F1(this.runAndExtendWithFaceDetection(),this.input)}}(uP),function(){function n(t,e){void 0===e&&(e=.6),this._distanceThreshold=e;var r=Array.isArray(t)?t:[t];if(!r.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var o=1,i=function(){return"person "+o++};this._labeledDescriptors=r.map(function(s){if(s instanceof pm)return s;if(s instanceof Float32Array)return new pm(i(),[s]);if(s.descriptor&&s.descriptor instanceof Float32Array)return new pm(i(),[s.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}Object.defineProperty(n.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),n.prototype.computeMeanDistance=function(t,e){return e.map(function(r){return function LY(n,t){if(n.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var e=Array.from(n),r=Array.from(t);return Math.sqrt(e.map(function(o,i){return o-r[i]}).reduce(function(o,i){return o+Math.pow(i,2)},0))}(r,t)}).reduce(function(r,o){return r+o},0)/(e.length||1)},n.prototype.matchDescriptor=function(t){var e=this;return this.labeledDescriptors.map(function(r){return new CF(r.label,e.computeMeanDistance(t,r.descriptors))}).reduce(function(r,o){return r.distance<o.distance?r:o})},n.prototype.findBestMatch=function(t){var e=this.matchDescriptor(t);return e.distance<this.distanceThreshold?e:new CF("unknown",e.distance)},n.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(t){return t.toJSON()})}},n.fromJSON=function(t){return new n(t.labeledDescriptors.map(function(r){return pm.fromJSON(r)}),t.distanceThreshold)}}();let fP=(()=>{class n{constructor(e){this.http=e,this.apiUrl=El_apiUrl}getLocation(){const e=`${this.apiUrl}/location`,r=ai(),o=new Vn({"Content-Type":"application/json",Authorization:r?`Bearer ${r}`:""});return this.http.get(e,{headers:o})}getDefualt(e=null){const r=`${this.apiUrl}/attendance`,o=ai(),i=new Vn({"Content-Type":"application/json",Authorization:o?`Bearer ${o}`:""});return this.http.post(r,e,{headers:i})}addAttendance(){const e=`${this.apiUrl}/attendance`,r=ai(),o=new Vn({"Content-Type":"application/json",Authorization:r?`Bearer ${r}`:""});return this.http.put(e,{},{headers:o})}getAllStudent(e){const r=`${this.apiUrl}/attendance`,o=ai(),i=new Vn({"Content-Type":"application/json",Authorization:o?`Bearer ${o}`:""});return this.http.post(r,e,{headers:i})}getStudentByface(e){const o=ai(),i=new Vn({"Content-Type":"application/json",Authorization:o?`Bearer ${o}`:""});return this.http.post(`${this.apiUrl}/attendance/face`,{image:e},{headers:i})}sendHaven(e){const r=`${this.apiUrl}/attendance/comeHaven`,o=ai(),i=new Vn({"Content-Type":"application/json",Authorization:o?`Bearer ${o}`:""});return this.http.post(`${r}`,{id:e},{headers:i})}}return n.\u0275fac=function(e){return new(e||n)(re($a))},n.\u0275prov=fe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),BY=(()=>{class n{constructor(){this.modelsLoaded=!1}loadModels(){var e=this;return er(function*(){try{yield ft.tinyFaceDetector.loadFromUri("/assets/models"),yield ft.faceLandmark68Net.loadFromUri("/assets/models"),e.modelsLoaded=!0,console.log("Models loaded successfully")}catch(r){console.error("Error loading face recognition models:",r)}})()}detectBestFace(e){var r=this;return er(function*(){if(!r.modelsLoaded)return console.warn("Models are not loaded yet. Please wait."),null;const o=new E1({inputSize:128,scoreThreshold:.5}),i=yield cP(e,o).withFaceLandmarks();if(0===i.length)return null;const s=i.reduce((a,u)=>u.detection.box.width*u.detection.box.height>a.detection.box.width*a.detection.box.height?u:a);return{box:s.detection.box,landmarks:s.landmarks.positions}})()}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=fe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const VY=["video"],UY=["overlay"];function jY(n,t){if(1&n&&(Z(0,"option",13),Ee(1),te()),2&n){const e=t.$implicit;Ce("value",e.value),xe(1),Wr(e.lable)}}function HY(n,t){if(1&n&&(Z(0,"option",13),Ee(1),te()),2&n){const e=t.$implicit;Ce("value",e.value),xe(1),Wr(e.lable)}}function WY(n,t){if(1&n){const e=So();Z(0,"label",14)(1,"select",7),pt("ngModelChange",function(o){return Kn(e),Xn(dt(2).selectedstream=o)})("change",function(){return Kn(e),Xn(dt(2).selectstream())}),Z(2,"option",8),Ee(3,"Stream"),te(),et(4,HY,2,2,"option",9),te()()}if(2&n){const e=dt(2);xe(1),Ce("ngModel",e.selectedstream),xe(3),Ce("ngForOf",e.stream)}}function zY(n,t){if(1&n&&(Z(0,"option",13),Ee(1),te()),2&n){const e=t.$implicit;Ce("value",e.value),xe(1),Wr(e.lable)}}function $Y(n,t){if(1&n){const e=So();Z(0,"label",14)(1,"select",7),pt("ngModelChange",function(o){return Kn(e),Xn(dt(2).selectedsem=o)})("change",function(){return Kn(e),Xn(dt(2).selectsem())}),Z(2,"option",8),Ee(3,"Semester"),te(),et(4,zY,2,2,"option",9),te()()}if(2&n){const e=dt(2);xe(1),Ce("ngModel",e.selectedsem),xe(3),Ce("ngForOf",e.semester)}}function GY(n,t){1&n&&(Z(0,"h1"),Ee(1,"Selecet Month"),te())}function qY(n,t){1&n&&(Z(0,"h1"),Ee(1,"Selecet Stream"),te())}function KY(n,t){1&n&&(Z(0,"h1"),Ee(1,"Selecet semester"),te())}function XY(n,t){if(1&n&&(Z(0,"div",15),et(1,GY,2,0,"h1",16),et(2,qY,2,0,"h1",16),et(3,KY,2,0,"h1",16),te()),2&n){const e=dt(2);xe(1),Ce("ngIf","0"==e.selectedMonth),xe(1),Ce("ngIf","0"==e.selectedstream&&"0"!=e.selectedMonth),xe(1),Ce("ngIf","0"!=e.selectedMonth&&"0"!=e.selectedstream&&"0"==e.selectedsem)}}function YY(n,t){1&n&&ye(0,"img",32)}function QY(n,t){1&n&&ye(0,"img",33),2&n&&Ce("src",dt().$implicit.img,Wu)}function ZY(n,t){if(1&n&&(Z(0,"tr",24)(1,"td")(2,"div",25)(3,"div",26)(4,"div",27),et(5,YY,1,0,"img",28),et(6,QY,1,1,"img",29),te()(),Z(7,"div")(8,"div",30),Ee(9),te(),Z(10,"div",31),Ee(11),te()()()(),Z(12,"td"),Ee(13,"12/16/2020"),te()()),2&n){const e=t.$implicit;xe(5),Ce("ngIf",""==e.img),xe(1),Ce("ngIf",""!=e.img),xe(3),Wr(e.name),xe(2),Wr(e.roll)}}function JY(n,t){if(1&n&&(Z(0,"div",17)(1,"div",18)(2,"div",19)(3,"table",20)(4,"thead",21)(5,"tr",22)(6,"th"),Ee(7,"Name"),te(),Z(8,"th"),Ee(9,"Attendance Date"),te()()(),Z(10,"tbody"),et(11,ZY,14,4,"tr",23),te()()()()()),2&n){const e=dt(2);xe(11),Ce("ngForOf",e.usersList)}}function eQ(n,t){if(1&n){const e=So();Z(0,"div",1)(1,"div",2)(2,"button",3),ye(3,"i",4),te(),Z(4,"div",5)(5,"label",6)(6,"select",7),pt("ngModelChange",function(o){return Kn(e),Xn(dt().selectedMonth=o)})("change",function(){return Kn(e),Xn(dt().selectMonth())}),Z(7,"option",8),Ee(8,"Months"),te(),et(9,jY,2,2,"option",9),te()(),et(10,WY,5,2,"label",10),et(11,$Y,5,2,"label",10),te()(),et(12,XY,4,3,"div",11),et(13,JY,12,1,"div",12),te()}if(2&n){const e=dt();xe(6),Ce("ngModel",e.selectedMonth),xe(3),Ce("ngForOf",e.months),xe(1),Ce("ngIf","0"!=e.selectedMonth),xe(1),Ce("ngIf","0"!=e.selectedstream),xe(1),Ce("ngIf",!e.usersList),xe(1),Ce("ngIf",e.usersList)}}function tQ(n,t){1&n&&ye(0,"video",47,48)}function nQ(n,t){if(1&n){const e=So();Z(0,"button",49),pt("click",function(){return Kn(e),Xn(dt(2).reset())}),ye(1,"i",50),te()}}function rQ(n,t){if(1&n){const e=So();Z(0,"div",51)(1,"div",26)(2,"div",27),ye(3,"img",52),te()(),Z(4,"div")(5,"div",53),Ee(6),te(),Z(7,"div",54),Ee(8),te()(),Z(9,"div",55)(10,"button",56)(11,"i",57),pt("click",function(){return Kn(e),Xn(dt(2).giveTOHaven())}),te()()()()}if(2&n){const e=dt(2);xe(3),Ce("src",e.giveUser.img,Wu),xe(3),Wr(e.giveUser.name),xe(2),Wr(e.giveUser.roll)}}function oQ(n,t){if(1&n){const e=So();Z(0,"div",1)(1,"button",34),pt("click",function(){return Kn(e),Xn(dt().back())}),xo(),Z(2,"svg",35),ye(3,"path",36),te()(),Co(),Z(4,"div",37)(5,"div",38),pt("click",function(){return Kn(e),Xn(dt().enableScan())}),et(6,tQ,2,0,"video",39),ye(7,"canvas",40,41),te(),et(9,nQ,2,0,"button",42),et(10,rQ,12,3,"div",43),Z(11,"div",44)(12,"button",45),pt("click",function(){return Kn(e),Xn(dt().attend())}),ye(13,"i",46),Ee(14),te()()()()}if(2&n){const e=dt();xe(6),Ce("ngIf",e.scan),xe(3),Ce("ngIf",e.alradyDetected),xe(1),Ce("ngIf",e.giveUser),xe(2),Ce("disabled",!e.attAble),xe(2),Wr(e.attAble?"Give Attendance":"Attendance alrady given")}}let iQ=(()=>{class n{constructor(e,r,o,i){this.service=e,this.location=r,this.attService=o,this.faceRecognitionService=i,this.success=!1,this.user=localStorage.getItem("info"),this.storedLocation={lat:0,lng:0},this.attAble=!1,this.selectedMonth="0",this.selectedsem="0",this.stream=void 0,this.selectedstream="0",this.msg="",this.alradyDetected=!1,this.enableReset=!1,this.giveUser=void 0,this.scan=!1}ngOnDestroy(){clearInterval(this.detectionInterval),this.releaseStream()}ngOnInit(){var e=this;return er(function*(){if(yield e.faceRecognitionService.loadModels(),e.months=[{lable:"January",value:1},{lable:"February",value:2},{lable:"March",value:3},{lable:"April",value:4},{lable:"May",value:5},{lable:"June",value:6},{lable:"July",value:7},{lable:"August",value:8},{lable:"Septembe",value:9},{lable:"October",value:10},{lable:"November",value:11},{lable:"December",value:12}],e.semester=[{lable:"First sem",value:1},{lable:"Second sem",value:2},{lable:"Third sem",value:3},{lable:"Fourth sem",value:4},{lable:"Fifth sem",value:5},{lable:"six sem",value:6},{lable:"Seven sem",value:7},{lable:"Eight sem",value:8}],e.stream=[{lable:"BCA",value:3},{lable:"BBA",value:1},{lable:"BHM",value:2},{lable:"MSC",value:4}],e.user&&(e.user=JSON.parse(e.user),e.lable=localStorage.getItem("lable"),3==e.lable)){let r=localStorage.getItem("presentDate");if(null!=r){const o=new Date(r),i=new Date;i.setHours(0,0,0,0),o.setHours(0,0,0,0),i.getTime()!==o.getTime()&&(e.attAble=!0)}else e.attAble=!0}})()}ngAfterViewInit(){}enableScan(){this.scan=!0,this.startVideo()}startVideo(){this.releaseStream(),navigator.mediaDevices.getUserMedia({video:!0}).then(e=>{this.videoRef.nativeElement.srcObject=e,this.startDetection(),this.currentStream=e}).catch(e=>{console.log(e)})}releaseStream(){this.currentStream&&(this.currentStream.getTracks().forEach(e=>e.stop()),this.videoRef.nativeElement.srcObject=null,this.currentStream=null)}startDetection(){var e=this;return er(function*(){const r=e.videoRef.nativeElement,o=e.overlayRef.nativeElement,i={width:r.width,height:r.height};(function pX(n,t,e){void 0===e&&(e=!1);var r=e?f1(t):t,o=r.width,i=r.height;n.width=o,n.height=i})(o,i),e.detectionInterval=setInterval(er(function*(){const s=yield cP(r,new E1).withFaceLandmarks(),a=o.getContext("2d");a&&(a.clearRect(0,0,o.width,o.height),dP(s,i),s.length>0&&(e.alradyDetected||(e.alradyDetected=!0,e.captureFaceImage(r),clearInterval(e.detectionInterval))))}),100)})()}captureFaceImage(e){const r=document.createElement("canvas");r.width=e.videoWidth,r.height=e.videoHeight;const o=r.getContext("2d");if(o){o.drawImage(e,0,0,r.width,r.height);const i=r.toDataURL("image/jpeg").split(",")[1];this.sendImageToBackend(i)}}sendImageToBackend(e){var r=this;return er(function*(){yield ui(r.attService.getStudentByface(e).pipe(Tt(o=>{o&&(r.giveUser=o)},o=>{Qs(o.error.massage),r.back()})))})()}getAllStudents(){var e=this;return er(function*(){"0"!=e.selectedMonth&&"0"!=e.selectedsem&&"0"!=e.selectedstream&&e.service.getAllStudent({sem:e.selectedsem,stream:e.selectedstream,month:e.selectedMonth}).subscribe(o=>{o.attendance&&(e.usersList=o.attendance)})})()}selectMonth(){this.getAllStudents()}back(){this.location.back()}selectsem(){this.getAllStudents()}selectstream(){this.getAllStudents()}attend(){var e=this;return er(function*(){yield ui(e.service.getDefualt().pipe(Tt(function(){var r=er(function*(o){if(o&&o.record)if(o.record.length<1)yield ui(e.attService.getLocation().pipe(Tt(i=>{e.storedLocation={lat:i.locations.lat,lng:i.locations.lon},e.distent=i.locations.distend,console.log(e.distent)}))),navigator.geolocation?navigator.geolocation.getCurrentPosition(i=>{const a=e.calculateDistance({lat:i.coords.latitude,lng:i.coords.longitude},e.storedLocation);null!=e.distent&&a<=String(e.distent)?e.add():Qs("You are too far from the collage location.")},i=>{switch(i.code){case i.PERMISSION_DENIED:e.msg="Permission denied. Please allow location access.";break;case i.POSITION_UNAVAILABLE:e.msg="Location information is unavailable.";break;case i.TIMEOUT:e.msg="Location request timed out.";break;default:e.msg="An unknown error occurred."}Qs(e.msg)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}):Zs("Geolocation is not supported by this browser.");else{const i=new Date;localStorage.setItem("presentDate",i.toISOString()),e.attAble=!1}});return function(o){return r.apply(this,arguments)}}())))})()}add(){var e=this;return er(function*(){try{yield ui(e.attService.addAttendance().pipe(Tt(o=>{if(!o.message){xg("Attendees Update successfully!");const i=new Date;localStorage.setItem("presentDate",i.toISOString()),e.attAble=!1}})))}catch{Qs("Error updating attendance. Please try again.")}})()}calculateDistance(e,r){const o=h=>h*Math.PI/180,s=o(e.lat),a=o(r.lat),u=o(r.lat-e.lat),l=o(r.lng-e.lng),c=Math.sin(u/2)*Math.sin(u/2)+Math.cos(s)*Math.cos(a)*Math.sin(l/2)*Math.sin(l/2),f=2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c))*6371e3;return f>=1e3?(f/1e3).toFixed(2)+" km":f.toFixed(2)+" meters"}reset(){this.alradyDetected=!1,this.startDetection()}giveTOHaven(){var e=this;return er(function*(){null!=e.giveUser.user_id&&(navigator.geolocation?(yield ui(e.attService.getLocation().pipe(Tt(r=>{e.storedLocation={lat:r.locations.lat,lng:r.locations.lon},e.distent=r.locations.distend}))),navigator.geolocation.getCurrentPosition(function(){var r=er(function*(o){const s=e.calculateDistance({lat:o.coords.latitude,lng:o.coords.longitude},e.storedLocation);if(null!=e.distent&&s<=String(e.distent)){const a=new Date;localStorage.setItem("presentDate",a.toISOString()),yield ui(e.attService.sendHaven(e.giveUser.user_id).pipe(Tt(u=>{u.message?(xg(u.message),e.giveUser=void 0):Qs("Error updating attendance. Please try again.")},u=>{Qs("Error updating attendance. Please try again.")})))}else Qs("You are too far from the collage location.")});return function(o){return r.apply(this,arguments)}}(),r=>{switch(r.code){case r.PERMISSION_DENIED:e.msg="Permission denied. Please allow location access.";break;case r.POSITION_UNAVAILABLE:e.msg="Location information is unavailable.";break;case r.TIMEOUT:e.msg="Location request timed out.";break;default:e.msg="An unknown error occurred."}Zs(e.msg)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})):Zs("Geolocation is not supported by this browser."))})()}}return n.\u0275fac=function(e){return new(e||n)(X(fP),X(md),X(fP),X(BY))},n.\u0275cmp=bn({type:n,selectors:[["app-attendance"]],viewQuery:function(e,r){if(1&e&&(lp(VY,5),lp(UY,5)),2&e){let o;ll(o=cl())&&(r.videoRef=o.first),ll(o=cl())&&(r.overlayRef=o.first)}},decls:2,vars:2,consts:[["class","flex flex-wrap h-full w-full",4,"ngIf"],[1,"flex","flex-wrap","h-full","w-full"],[1,"fixed","navbar","h-[57px]","bg-slate-500","hover:bg-blue-500","w-full"],[1,"btn","btn-square","btn-ghost","bg-transparent","border-none"],["routerLink","/",1,"bi","bi-box-arrow-left","text-white","text-3xl"],[2,"position","absolute","right","2px"],[1,"form-control","w-fit"],[1,"select","select-bordered",3,"ngModel","ngModelChange","change"],["disabled","","selected","","value","0"],[3,"value",4,"ngFor","ngForOf"],["class","form-control w-fit m-3",4,"ngIf"],["style","display: flex; justify-content: center; align-items: center;","class","w-full h-full",4,"ngIf"],["class","overflow-x-hidden","style","position: absolute; top: 70px; left: 0; right: 0; bottom: 0;",4,"ngIf"],[3,"value"],[1,"form-control","w-fit","m-3"],[1,"w-full","h-full",2,"display","flex","justify-content","center","align-items","center"],[4,"ngIf"],[1,"overflow-x-hidden",2,"position","absolute","top","70px","left","0","right","0","bottom","0"],[1,"w-full","h-full","overflow-hidden"],[1,"overflow-y-auto",2,"max-height","calc(100vh - 70px)"],[1,"table","table-xs","text-center","w-full"],[1,"sticky","top-0","bg-[#042f4b]"],[1,"h-45px","hover:bg-slate-500","text-white","text-lg"],["class","hover:bg-blue-500",4,"ngFor","ngForOf"],[1,"hover:bg-blue-500"],[1,"flex","items-center","gap-3"],[1,"avatar"],[1,"mask","mask-squircle","h-12","w-12"],["src","/assets/imgs/user-286-512.png","alt","Avatar Tailwind CSS Component",4,"ngIf"],["alt","profile img",3,"src",4,"ngIf"],[1,"font-bold"],[1,"text-sm","opacity-50"],["src","/assets/imgs/user-286-512.png","alt","Avatar Tailwind CSS Component"],["alt","profile img",3,"src"],[1,"btn","btn-circle","bg-transparent","outline-none","hover:bg-blue-500",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-6","w-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"flex","w-full","h-full","flex-col","place-items-center"],["id","scan-box",1,"w-52","h-52","bg-black","place-items-center","rounded-box","my_shdow","overflow-hidden","outline","outline-[#647bfd7a]","relative",3,"click"],["autoplay","","class","rounded-box","width","100%","height","100%",4,"ngIf"],[2,"position","absolute","top","0","left","0","bottom","0","right","0","height","100%","width","100%"],["overlay",""],["class","btn btn-outline btn-info m-4",3,"click",4,"ngIf"],["class","flex gap-3 items-center bg-[#ffffff2c] px-6 rounded-md m-5",4,"ngIf"],[1,"m-14"],[1,"btn","btn-outline","btn-info","disabled",3,"disabled","click"],[1,"bi","bi-person-raised-hand","text-2xl"],["autoplay","","width","100%","height","100%",1,"rounded-box"],["video",""],[1,"btn","btn-outline","btn-info","m-4",3,"click"],[1,"bi","bi-arrow-clockwise","text-2xl"],[1,"flex","gap-3","items-center","bg-[#ffffff2c]","px-6","rounded-md","m-5"],["alt","Avatar Tailwind CSS Component",3,"src"],[1,"font-bold","text-white"],[1,"text-sm","opacity-50","text-white"],["data-tip","Give Attendance",1,"tooltip","my-6","ml-4","text-white"],[1,"btn","btn-outline","btn-info"],[1,"bi","bi-person-check","text-2xl",3,"click"]],template:function(e,r){1&e&&(et(0,eQ,14,6,"div",0),et(1,oQ,15,5,"div",0)),2&e&&(Ce("ngIf",1==r.lable||2==r.lable),xe(1),Ce("ngIf",3==r.lable))},dependencies:[kI,Hs,gM,vM,bg,Vd,c0,Bd],styles:[".holder[_ngcontent-%COMP%]{font-family:Arial,sans-serif;display:flex;justify-content:center;align-items:center;height:100vh;margin:0;background:linear-gradient(to right,#f0f4f8,#c9e2f4)}.card[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;background:#ffffff;border-radius:15px;box-shadow:0 4px 8px #0003;padding:20px;text-align:center;width:350px;max-width:100%;transition:transform .3s ease,box-shadow .3s ease}.card[_ngcontent-%COMP%]:hover{transform:translateY(-10px);box-shadow:0 8px 16px #0000004d}.card[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px;font-weight:700;margin-top:20px}.card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#555;font-size:16px;margin:10px 0}.my_shdow[_ngcontent-%COMP%]{box-shadow:#107af30d 0 0 0 1px,#015ce48a 0 0 0 1px inset}video[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}#scan-box[_ngcontent-%COMP%]{background-position:center;background-repeat:no-repeat;background-image:url(/assets/imgs/face-scan.png);background-size:contain}"]}),n})(),sQ=(()=>{class n{constructor(e){this.http=e,this.apiUrl=El_apiUrl}getPost(e){}postPost(e){const r=ai(),o=new Vn({Authorization:r?`Bearer ${r}`:""}),i=new FormData;return i.append("file",e),this.http.post(this.apiUrl+"/posts",i,{headers:o})}}return n.\u0275fac=function(e){return new(e||n)(re($a))},n.\u0275prov=fe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),aQ=(()=>{class n{constructor(e){this.http=e,this.apiUrl=El_apiUrl}addClass(e){const r=`${this.apiUrl}/classes`,o=e,i={"Content-Type":"application/json",Authorization:`Bearer ${ai()}`};return this.http.post(r,o,{headers:i})}getAll(){const e=`${this.apiUrl}/classes`,r={"Content-Type":"application/json",Authorization:`Bearer ${ai()}`};return this.http.get(e,{headers:r})}}return n.\u0275fac=function(e){return new(e||n)(re($a))},n.\u0275prov=fe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function uQ(n,t){1&n&&(Z(0,"div",10)(1,"div",11)(2,"div",12),ye(3,"input",13),Z(4,"div",14),Ee(5,"All Classes"),te(),ye(6,"input",15),Z(7,"div",14),Ee(8,"My Classes"),te()()(),Z(9,"div",16)(10,"div",17)(11,"div",18)(12,"button",19),Ee(13,"\xab"),te(),Z(14,"button",19),Ee(15,"Page 1"),te(),Z(16,"button",19),Ee(17,"\xbb"),te()()()()())}function lQ(n,t){if(1&n&&(Z(0,"div",31)(1,"div",32),Ee(2),te()()),2&n){const e=dt(4);xe(2),np(" ",e.progress.value,"% ")}}function cQ(n,t){if(1&n&&(Z(0,"div",27)(1,"div",28),ye(2,"i",29),et(3,lQ,3,1,"div",30),te()()),2&n){const e=dt(3);xe(3),Ce("ngIf",e.progress)}}function dQ(n,t){1&n&&ye(0,"div",22)}function fQ(n,t){if(1&n){const e=So();Z(0,"form",33),pt("ngSubmit",function(){return Kn(e),Xn(dt(3).onSubmit())}),Z(1,"label",34),ye(2,"input",35),te(),Z(3,"label",34),ye(4,"input",36),te(),Z(5,"label",34),ye(6,"input",37),te(),ye(7,"textarea",38),Z(8,"div",39)(9,"button",40),Ee(10,"Submit"),te()()()}2&n&&Ce("formGroup",dt(3).calssForm)}function hQ(n,t){if(1&n){const e=So();Z(0,"div",20)(1,"h1",21),Ee(2," Create Class"),te(),ye(3,"div",22),et(4,cQ,4,1,"div",23),et(5,dQ,1,0,"div",24),Z(6,"input",25),pt("change",function(o){return Kn(e),Xn(dt(2).onFileSelected(o))}),te(),et(7,fQ,11,1,"form",26),te()}if(2&n){const e=dt(2);xe(4),Ce("ngIf",e.selectedFile),xe(1),Ce("ngIf",e.selectedFile),xe(2),Ce("ngIf",e.calssForm)}}function pQ(n,t){if(1&n){const e=So();Z(0,"div",2)(1,"div",3)(2,"button",4),ye(3,"i",5),te(),Z(4,"button",6),pt("click",function(){return Kn(e),Xn(dt().createClass())}),ye(5,"i",7),Ee(6," Create Class "),te()(),et(7,uQ,18,0,"div",8),et(8,hQ,8,3,"div",9),te()}if(2&n){const e=dt();xe(7),Ce("ngIf",!e.createClassView),xe(1),Ce("ngIf",e.createClassView)}}function gQ(n,t){1&n&&(Z(0,"div")(1,"h1"),Ee(2,"IT is your"),te()())}let mQ=(()=>{class n{constructor(e,r,o){this.postService=e,this.fb=r,this.service=o,this.allClassesView=!1,this.createClassView=!1,this.selectedFile=null,this.uploadId=0,this.label=localStorage.getItem("lable")}ngOnInit(){this.fetchClasses()}fetchClasses(){var e=this;return er(function*(){yield ui(e.service.getAll().pipe(Tt(r=>{r&&console.log(r)},r=>{Zs(r.error.message)})))})()}createClass(){this.calssForm=this.fb.group({content_id:[""],title:["",si.required],stream:["",si.required],semester:["",si.required],description:[""]}),this.createClassView=!this.createClassView,this.createClassView||this.fetchClasses()}onFileSelected(e){const r=e.target;r.files&&r.files[0]&&(this.selectedFile=r.files[0],this.uploadFile())}uploadFile(){var e=this;return er(function*(){e.selectedFile&&(yield ui(e.postService.postPost(e.selectedFile).pipe(Tt(r=>{r.post_id&&(e.uploadId=r.post_id)},r=>{console.log(r),Zs(r.error.message)}))))})()}onSubmit(){var e=this;return er(function*(){e.calssForm?.patchValue({content_id:e.uploadId}),e.calssForm?.valid?yield ui(e.service.addClass(e.calssForm.value).pipe(Tt(r=>{xg(r.message)},r=>{Zs(r.error.message)}))):Zs("Please fill all the fields")})()}}return n.\u0275fac=function(e){return new(e||n)(X(sQ),X(w0),X(aQ))},n.\u0275cmp=bn({type:n,selectors:[["app-classes"]],decls:2,vars:2,consts:[["class","flex flex-wrap h-full w-full","style","justify-content: center;",4,"ngIf"],[4,"ngIf"],[1,"flex","flex-wrap","h-full","w-full",2,"justify-content","center"],[1,"fixed","navbar","h-[57px]","bg-slate-500","hover:bg-blue-500","w-full","z-10"],[1,"btn","btn-square","btn-ghost","bg-transparent","border-none"],["routerLink","/",1,"bi","bi-box-arrow-left","text-white","text-3xl"],[1,"btn","bg-white","absolute","right-3","text-blue-500",3,"click"],[1,"bi","bi-patch-plus-fill","text-blue-500","text-3xl"],["class","w-full absolute top-[70px] p-4 h-full",4,"ngIf"],["class","w-full absolute top-[70px] p-4 flex flex-col itc",4,"ngIf"],[1,"w-full","absolute","top-[70px]","p-4","h-full"],[1,"divider","divider-primary","text-center"],["role","tablist",1,"tabs","tabs-bordered"],["type","radio","name","my_tabs_1","role","tab","aria-label","All Classes","checked","",1,"tab"],["role","tabpanel",1,"tab-content","p-10"],["type","radio","name","my_tabs_1","role","tab","aria-label","My Classes",1,"tab"],[1,"w-full","h-full","pt-2","relative","overflow-scroll"],[1,"w-full","flex","justify-center"],[1,"join","mt-2"],[1,"join-item","btn"],[1,"w-full","absolute","top-[70px]","p-4","flex","flex-col","itc"],[1,"text-center"],[1,"divider","divider-primary"],["class","w-full m-3 flex justify-center items-center relative",4,"ngIf"],["class","divider divider-primary",4,"ngIf"],["type","file","extensions","pdf,xlsx,mp4,doc",1,"file-input","file-input-bordered","w-full","max-w-xs","m-3",3,"change"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"w-full","m-3","flex","justify-center","items-center","relative"],[1,"w-full","h-full","rounded-lg","relative","min-h-[300px]","flex","justify-center","items-center"],[1,"bi","bi-cloud-arrow-up-fill","text-5xl"],["class","w-full h-full absolute flex justify-center items-center bg-[#ffffff1c]",4,"ngIf"],[1,"w-full","h-full","absolute","flex","justify-center","items-center","bg-[#ffffff1c]"],["role","progressbar",1,"radial-progress","text-primary",2,"--value","70"],[3,"formGroup","ngSubmit"],[1,"input","input-bordered","flex","items-center","gap-2","m-3"],["type","text","formControlName","title","placeholder","Title or Class name",1,"grow"],["type","text","formControlName","stream","placeholder","stream",1,"grow"],["type","text","formControlName","semester","placeholder","semester",1,"grow"],["type","password","formControlName","description","placeholder","description",1,"textarea","textarea-bordered","grow","gap-2","m-3","w-[99%]"],[1,"w-full","text-center"],["type","submit",1,"btn","btn-primary"]],template:function(e,r){1&e&&(et(0,pQ,9,2,"div",0),et(1,gQ,3,0,"div",1)),2&e&&(Ce("ngIf","2"==r.label||"1"==r.label),xe(1),Ce("ngIf","3"==r.label))},dependencies:[Hs,wg,bl,Vd,cg,xl,Gd,Bd],styles:[".card-css[_ngcontent-%COMP%]{box-shadow:#0000000d 0 6px 24px,#00000014 0 0 0 1px}"]}),n})(),vQ=(()=>{class n{constructor(e){this.http=e,this.apiUrl="https://www.timt.org.in/api/protected/notice"}getNotices(){return this.http.get(this.apiUrl)}}return n.\u0275fac=function(e){return new(e||n)(re($a))},n.\u0275prov=fe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),yQ=(()=>{class n{constructor(e){this.service=e}ngOnInit(){return er(function*(){})()}}return n.\u0275fac=function(e){return new(e||n)(X(vQ))},n.\u0275cmp=bn({type:n,selectors:[["app-notic-bord"]],decls:2,vars:0,template:function(e,r){1&e&&(Z(0,"p"),Ee(1,"notic-bord disable by admin!"),te())}}),n})();function wQ(n,t){if(1&n&&(Z(0,"div",11),xo(),Z(1,"svg",12),ye(2,"path",13),te(),Co(),Z(3,"span"),Ee(4),te()()),2&n){const e=dt();xe(4),Wr(e.token)}}const bQ=[{path:"attendance",component:iQ,canActivate:[Ji]},{path:"classes",component:mQ,canActivate:[Ji]},{path:"notic_bord",component:yQ,canActivate:[Ji]},{path:"token",component:(()=>{class n{constructor(e){this.location=e}ngOnInit(){this.token=localStorage.getItem("token")?localStorage.getItem("token"):null}back(){this.location.back()}}return n.\u0275fac=function(e){return new(e||n)(X(md))},n.\u0275cmp=bn({type:n,selectors:[["app-token-viwer"]],decls:14,vars:1,consts:[[1,"w-full","h-full"],[1,"fixed","navbar","h-[57px]","bg-slate-500","hover:bg-blue-500","w-full","z-10"],[1,"btn","btn-square","btn-ghost","bg-transparent","border-none"],[1,"bi","bi-box-arrow-left","text-white","text-3xl",3,"click"],[1,"absolute","top-[70px]","left-0","right-0","bottom-0"],[1,"divider"],["role","alert",1,"alert","alert-warning"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"h-6","w-6","shrink-0","stroke-current"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"],[1,"w-full","h-full","flex","justify-center","items-center"],["role","alert","class","alert",4,"ngIf"],["role","alert",1,"alert"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"stroke-info","h-6","w-6","shrink-0"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"]],template:function(e,r){1&e&&(Z(0,"div",0)(1,"div",1)(2,"button",2)(3,"i",3),pt("click",function(){return r.back()}),te()()(),Z(4,"div",4)(5,"div",5),Ee(6,"API KEY"),te(),Z(7,"div",6),xo(),Z(8,"svg",7),ye(9,"path",8),te(),Co(),Z(10,"span"),Ee(11,"Warning: API KEY are confidential and should not be shared or published."),te()(),Z(12,"div",9),et(13,wQ,5,1,"div",10),te()()()),2&e&&(xe(13),Ce("ngIf",r.token))},dependencies:[Hs]}),n})(),canActivate:[Ji]}];let hP=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Tn({type:n,bootstrap:[n]}),n.\u0275inj=wn({imports:[Lp,KM,_g,y0,ag.forChild(bQ),ag]}),n})();const _Q=[{path:"login",component:lG},{path:"logout",component:cG},{path:"me_data",component:xG,canActivate:[Ji]},{path:"dash",component:qM,canActivate:[Ji]},{path:"setting",component:CG,canActivate:[Ji]},{path:"notify",component:EG,canActivate:[Ji]},{path:"",component:qM,canActivate:[Ji]},{path:"**",redirectTo:"/login",pathMatch:"full"}];let xQ=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Tn({type:n}),n.\u0275inj=wn({imports:[ag.forRoot(_Q),hP,ag]}),n})(),pP=(()=>{class n{constructor(){this.loadingSubject=new lo(!1),this.loading$=this.loadingSubject.asObservable()}showLoading(){this.loadingSubject.next(!0)}hideLoading(){this.loadingSubject.next(!1)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=fe({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function CQ(n,t){1&n&&(Z(0,"div",1),ye(1,"span",2),te())}let EQ=(()=>{class n{constructor(e){this.loadingService=e,this.loading$=this.loadingService.loading$}}return n.\u0275fac=function(e){return new(e||n)(X(pP))},n.\u0275cmp=bn({type:n,selectors:[["app-loading"]],decls:2,vars:3,consts:[["class","loading-overlay flex justify-center align-middle",4,"ngIf"],[1,"loading-overlay","flex","justify-center","align-middle"],[1,"loading","loading-ring","loading-lg","text-primary"]],template:function(e,r){1&e&&(et(0,CQ,2,0,"div",0),function l2(n,t){const e=st();let r;const o=n+22;e.firstCreatePass?(r=function CU(n,t){if(t)for(let e=t.length-1;e>=0;e--){const r=t[e];if(n===r.name)return r}}(t,e.pipeRegistry),e.data[o]=r,r.onDestroy&&(e.destroyHooks||(e.destroyHooks=[])).push(o,r.onDestroy)):r=e.data[o];const i=r.factory||(r.factory=Pi(r.type)),s=cr(X);try{const a=Dh(!1),u=i();return Dh(a),function h4(n,t,e,r){e>=n.data.length&&(n.data[e]=null,n.blueprint[e]=null),t[e]=r}(e,ee(),o,u),u}finally{cr(s)}}(1,"async")),2&e&&Ce("ngIf",function c2(n,t,e){const r=n+22,o=ee(),i=function Mu(n,t){return n[t]}(o,r);return function dd(n,t){return n[1].data[t].pure}(o,r)?o2(o,pr(),t,i.transform,e,i):i.transform(e)}(1,1,r.loading$))},dependencies:[Hs,OI],styles:[".loading-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(164,187,252,.8);display:flex;justify-content:center;align-items:center;z-index:1000}.loading-spinner[_ngcontent-%COMP%]{display:flex;justify-content:space-around;width:100px}.dot[_ngcontent-%COMP%]{width:15px;height:15px;background-color:#4285f4;border-radius:50%;animation:dot-blink 1.2s infinite ease-in-out both}@keyframes dot-blink{0%,80%,to{transform:scale(0)}40%{transform:scale(1)}}"]}),n})(),DQ=(()=>{class n{constructor(){this.title="timt"}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=bn({type:n,selectors:[["app-root"]],decls:2,vars:0,template:function(e,r){1&e&&ye(0,"app-loading")(1,"router-outlet")},dependencies:[Bb,EQ]}),n})(),SQ=(()=>{class n{constructor(e){this.loadingService=e}intercept(e,r){return this.loadingService.showLoading(),r.handle(e).pipe(Vp(()=>{this.loadingService.hideLoading()}))}}return n.\u0275fac=function(e){return new(e||n)(re(pP))},n.\u0275prov=fe({token:n,factory:n.\u0275fac}),n})();function gP(n){return new Q(3e3,!1)}function aZ(){return typeof window<"u"&&typeof window.document<"u"}function V1(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function pa(n){switch(n.length){case 0:return new qd;case 1:return n[0];default:return new OM(n)}}function mP(n,t,e,r,o=new Map,i=new Map){const s=[],a=[];let u=-1,l=null;if(r.forEach(c=>{const d=c.get("offset"),f=d==u,h=f&&l||new Map;c.forEach((p,m)=>{let v=m,y=p;if("offset"!==m)switch(v=t.normalizePropertyName(v,s),y){case"!":y=o.get(m);break;case es:y=i.get(m);break;default:y=t.normalizeStyleValue(m,v,y,s)}h.set(v,y)}),f||a.push(h),l=h,u=d}),s.length)throw function XQ(n){return new Q(3502,!1)}();return a}function U1(n,t,e,r){switch(t){case"start":n.onStart(()=>r(e&&j1(e,"start",n)));break;case"done":n.onDone(()=>r(e&&j1(e,"done",n)));break;case"destroy":n.onDestroy(()=>r(e&&j1(e,"destroy",n)))}}function j1(n,t,e){const i=H1(n.element,n.triggerName,n.fromState,n.toState,t||n.phaseName,e.totalTime??n.totalTime,!!e.disabled),s=n._data;return null!=s&&(i._data=s),i}function H1(n,t,e,r,o="",i=0,s){return{element:n,triggerName:t,fromState:e,toState:r,phaseName:o,totalTime:i,disabled:!!s}}function Yr(n,t,e){let r=n.get(t);return r||n.set(t,r=e),r}function vP(n){const t=n.indexOf(":");return[n.substring(1,t),n.slice(t+1)]}let W1=(n,t)=>!1,yP=(n,t,e)=>[],wP=null;function z1(n){const t=n.parentNode||n.host;return t===wP?null:t}(V1()||typeof Element<"u")&&(aZ()?(wP=(()=>document.documentElement)(),W1=(n,t)=>{for(;t;){if(t===n)return!0;t=z1(t)}return!1}):W1=(n,t)=>n.contains(t),yP=(n,t,e)=>{if(e)return Array.from(n.querySelectorAll(t));const r=n.querySelector(t);return r?[r]:[]});let lu=null,bP=!1;const _P=W1,xP=yP;let CP=(()=>{class n{validateStyleProperty(e){return function lZ(n){lu||(lu=function cZ(){return typeof document<"u"?document.body:null}()||{},bP=!!lu.style&&"WebkitAppearance"in lu.style);let t=!0;return lu.style&&!function uZ(n){return"ebkit"==n.substring(1,6)}(n)&&(t=n in lu.style,!t&&bP&&(t="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in lu.style)),t}(e)}matchesElement(e,r){return!1}containsElement(e,r){return _P(e,r)}getParentElement(e){return z1(e)}query(e,r,o){return xP(e,r,o)}computeStyle(e,r,o){return o||""}animate(e,r,o,i,s,a=[],u){return new qd(o,i)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=fe({token:n,factory:n.\u0275fac}),n})(),$1=(()=>{class n{}return n.NOOP=new CP,n})();const G1="ng-enter",Sm="ng-leave",Im="ng-trigger",Am=".ng-trigger",DP="ng-animating",q1=".ng-animating";function ps(n){if("number"==typeof n)return n;const t=n.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:K1(parseFloat(t[1]),t[2])}function K1(n,t){return"s"===t?1e3*n:n}function Tm(n,t,e){return n.hasOwnProperty("duration")?n:function hZ(n,t,e){let o,i=0,s="";if("string"==typeof n){const a=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return t.push(gP()),{duration:0,delay:0,easing:""};o=K1(parseFloat(a[1]),a[2]);const u=a[3];null!=u&&(i=K1(parseFloat(u),a[4]));const l=a[5];l&&(s=l)}else o=n;if(!e){let a=!1,u=t.length;o<0&&(t.push(function IQ(){return new Q(3100,!1)}()),a=!0),i<0&&(t.push(function AQ(){return new Q(3101,!1)}()),a=!0),a&&t.splice(u,0,gP())}return{duration:o,delay:i,easing:s}}(n,t,e)}function Nf(n,t={}){return Object.keys(n).forEach(e=>{t[e]=n[e]}),t}function SP(n){const t=new Map;return Object.keys(n).forEach(e=>{t.set(e,n[e])}),t}function ga(n,t=new Map,e){if(e)for(let[r,o]of e)t.set(r,o);for(let[r,o]of n)t.set(r,o);return t}function AP(n,t,e){return e?t+":"+e+";":""}function TP(n){let t="";for(let e=0;e<n.style.length;e++){const r=n.style.item(e);t+=AP(0,r,n.style.getPropertyValue(r))}for(const e in n.style)n.style.hasOwnProperty(e)&&!e.startsWith("_")&&(t+=AP(0,vZ(e),n.style[e]));n.setAttribute("style",t)}function wi(n,t,e){n.style&&(t.forEach((r,o)=>{const i=Y1(o);e&&!e.has(o)&&e.set(o,n.style[i]),n.style[i]=r}),V1()&&TP(n))}function cu(n,t){n.style&&(t.forEach((e,r)=>{const o=Y1(r);n.style[o]=""}),V1()&&TP(n))}function Ff(n){return Array.isArray(n)?1==n.length?n[0]:NM(n):n}const X1=new RegExp("{{\\s*(.+?)\\s*}}","g");function MP(n){let t=[];if("string"==typeof n){let e;for(;e=X1.exec(n);)t.push(e[1]);X1.lastIndex=0}return t}function Pf(n,t,e){const r=n.toString(),o=r.replace(X1,(i,s)=>{let a=t[s];return null==a&&(e.push(function MQ(n){return new Q(3003,!1)}()),a=""),a.toString()});return o==r?n:o}function Mm(n){const t=[];let e=n.next();for(;!e.done;)t.push(e.value),e=n.next();return t}const mZ=/-+([a-z0-9])/g;function Y1(n){return n.replace(mZ,(...t)=>t[1].toUpperCase())}function vZ(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function Qr(n,t,e){switch(t.type){case 7:return n.visitTrigger(t,e);case 0:return n.visitState(t,e);case 1:return n.visitTransition(t,e);case 2:return n.visitSequence(t,e);case 3:return n.visitGroup(t,e);case 4:return n.visitAnimate(t,e);case 5:return n.visitKeyframes(t,e);case 6:return n.visitStyle(t,e);case 8:return n.visitReference(t,e);case 9:return n.visitAnimateChild(t,e);case 10:return n.visitAnimateRef(t,e);case 11:return n.visitQuery(t,e);case 12:return n.visitStagger(t,e);default:throw function kQ(n){return new Q(3004,!1)}()}}function kP(n,t){return window.getComputedStyle(n)[t]}function CZ(n,t){const e=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(r=>function EZ(n,t,e){if(":"==n[0]){const u=function DZ(n,t){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,r)=>parseFloat(r)>parseFloat(e);case":decrement":return(e,r)=>parseFloat(r)<parseFloat(e);default:return t.push(function $Q(n){return new Q(3016,!1)}()),"* => *"}}(n,e);if("function"==typeof u)return void t.push(u);n=u}const r=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return e.push(function zQ(n){return new Q(3015,!1)}()),t;const o=r[1],i=r[2],s=r[3];t.push(RP(o,s));"<"==i[0]&&!("*"==o&&"*"==s)&&t.push(RP(s,o))}(r,e,t)):e.push(n),e}const Fm=new Set(["true","1"]),Pm=new Set(["false","0"]);function RP(n,t){const e=Fm.has(n)||Pm.has(n),r=Fm.has(t)||Pm.has(t);return(o,i)=>{let s="*"==n||n==o,a="*"==t||t==i;return!s&&e&&"boolean"==typeof o&&(s=o?Fm.has(n):Pm.has(n)),!a&&r&&"boolean"==typeof i&&(a=i?Fm.has(t):Pm.has(t)),s&&a}}const SZ=new RegExp("s*:selfs*,?","g");function Q1(n,t,e,r){return new IZ(n).build(t,e,r)}class IZ{constructor(t){this._driver=t}build(t,e,r){const o=new MZ(e);return this._resetContextStyleTimingState(o),Qr(this,Ff(t),o)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles=new Map,t.collectedStyles.set("",new Map),t.currentTime=0}visitTrigger(t,e){let r=e.queryCount=0,o=e.depCount=0;const i=[],s=[];return"@"==t.name.charAt(0)&&e.errors.push(function NQ(){return new Q(3006,!1)}()),t.definitions.forEach(a=>{if(this._resetContextStyleTimingState(e),0==a.type){const u=a,l=u.name;l.toString().split(/\s*,\s*/).forEach(c=>{u.name=c,i.push(this.visitState(u,e))}),u.name=l}else if(1==a.type){const u=this.visitTransition(a,e);r+=u.queryCount,o+=u.depCount,s.push(u)}else e.errors.push(function FQ(){return new Q(3007,!1)}())}),{type:7,name:t.name,states:i,transitions:s,queryCount:r,depCount:o,options:null}}visitState(t,e){const r=this.visitStyle(t.styles,e),o=t.options&&t.options.params||null;if(r.containsDynamicStyles){const i=new Set,s=o||{};r.styles.forEach(a=>{a instanceof Map&&a.forEach(u=>{MP(u).forEach(l=>{s.hasOwnProperty(l)||i.add(l)})})}),i.size&&(Mm(i.values()),e.errors.push(function PQ(n,t){return new Q(3008,!1)}()))}return{type:0,name:t.name,style:r,options:o?{params:o}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const r=Qr(this,Ff(t.animation),e);return{type:1,matchers:CZ(t.expr,e.errors),animation:r,queryCount:e.queryCount,depCount:e.depCount,options:du(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(r=>Qr(this,r,e)),options:du(t.options)}}visitGroup(t,e){const r=e.currentTime;let o=0;const i=t.steps.map(s=>{e.currentTime=r;const a=Qr(this,s,e);return o=Math.max(o,e.currentTime),a});return e.currentTime=o,{type:3,steps:i,options:du(t.options)}}visitAnimate(t,e){const r=function RZ(n,t){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return Z1(Tm(n,t).duration,0,"");const e=n;if(e.split(/\s+/).some(i=>"{"==i.charAt(0)&&"{"==i.charAt(1))){const i=Z1(0,0,"");return i.dynamic=!0,i.strValue=e,i}const o=Tm(e,t);return Z1(o.duration,o.delay,o.easing)}(t.timings,e.errors);e.currentAnimateTimings=r;let o,i=t.styles?t.styles:Cl({});if(5==i.type)o=this.visitKeyframes(i,e);else{let s=t.styles,a=!1;if(!s){a=!0;const l={};r.easing&&(l.easing=r.easing),s=Cl(l)}e.currentTime+=r.duration+r.delay;const u=this.visitStyle(s,e);u.isEmptyStep=a,o=u}return e.currentAnimateTimings=null,{type:4,timings:r,style:o,options:null}}visitStyle(t,e){const r=this._makeStyleAst(t,e);return this._validateStyleAst(r,e),r}_makeStyleAst(t,e){const r=[],o=Array.isArray(t.styles)?t.styles:[t.styles];for(let a of o)"string"==typeof a?a===es?r.push(a):e.errors.push(new Q(3002,!1)):r.push(SP(a));let i=!1,s=null;return r.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(s=a.get("easing"),a.delete("easing")),!i))for(let u of a.values())if(u.toString().indexOf("{{")>=0){i=!0;break}}),{type:6,styles:r,easing:s,offset:t.offset,containsDynamicStyles:i,options:null}}_validateStyleAst(t,e){const r=e.currentAnimateTimings;let o=e.currentTime,i=e.currentTime;r&&i>0&&(i-=r.duration+r.delay),t.styles.forEach(s=>{"string"!=typeof s&&s.forEach((a,u)=>{const l=e.collectedStyles.get(e.currentQuerySelector),c=l.get(u);let d=!0;c&&(i!=o&&i>=c.startTime&&o<=c.endTime&&(e.errors.push(function LQ(n,t,e,r,o){return new Q(3010,!1)}()),d=!1),i=c.startTime),d&&l.set(u,{startTime:i,endTime:o}),e.options&&function gZ(n,t,e){const r=t.params||{},o=MP(n);o.length&&o.forEach(i=>{r.hasOwnProperty(i)||e.push(function TQ(n){return new Q(3001,!1)}())})}(a,e.options,e.errors)})})}visitKeyframes(t,e){const r={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function BQ(){return new Q(3011,!1)}()),r;let i=0;const s=[];let a=!1,u=!1,l=0;const c=t.steps.map(y=>{const _=this._makeStyleAst(y,e);let b=null!=_.offset?_.offset:function kZ(n){if("string"==typeof n)return null;let t=null;if(Array.isArray(n))n.forEach(e=>{if(e instanceof Map&&e.has("offset")){const r=e;t=parseFloat(r.get("offset")),r.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const e=n;t=parseFloat(e.get("offset")),e.delete("offset")}return t}(_.styles),x=0;return null!=b&&(i++,x=_.offset=b),u=u||x<0||x>1,a=a||x<l,l=x,s.push(x),_});u&&e.errors.push(function VQ(){return new Q(3012,!1)}()),a&&e.errors.push(function UQ(){return new Q(3200,!1)}());const d=t.steps.length;let f=0;i>0&&i<d?e.errors.push(function jQ(){return new Q(3202,!1)}()):0==i&&(f=1/(d-1));const h=d-1,p=e.currentTime,m=e.currentAnimateTimings,v=m.duration;return c.forEach((y,_)=>{const b=f>0?_==h?1:f*_:s[_],x=b*v;e.currentTime=p+m.delay+x,m.duration=x,this._validateStyleAst(y,e),y.offset=b,r.styles.push(y)}),r}visitReference(t,e){return{type:8,animation:Qr(this,Ff(t.animation),e),options:du(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:du(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:du(t.options)}}visitQuery(t,e){const r=e.currentQuerySelector,o=t.options||{};e.queryCount++,e.currentQuery=t;const[i,s]=function AZ(n){const t=!!n.split(/\s*,\s*/).find(e=>":self"==e);return t&&(n=n.replace(SZ,"")),n=n.replace(/@\*/g,Am).replace(/@\w+/g,e=>Am+"-"+e.slice(1)).replace(/:animating/g,q1),[n,t]}(t.selector);e.currentQuerySelector=r.length?r+" "+i:i,Yr(e.collectedStyles,e.currentQuerySelector,new Map);const a=Qr(this,Ff(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=r,{type:11,selector:i,limit:o.limit||0,optional:!!o.optional,includeSelf:s,animation:a,originalSelector:t.selector,options:du(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push(function HQ(){return new Q(3013,!1)}());const r="full"===t.timings?{duration:0,delay:0,easing:"full"}:Tm(t.timings,e.errors,!0);return{type:12,animation:Qr(this,Ff(t.animation),e),timings:r,options:null}}}class MZ{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function du(n){return n?(n=Nf(n)).params&&(n.params=function TZ(n){return n?Nf(n):null}(n.params)):n={},n}function Z1(n,t,e){return{duration:n,delay:t,easing:e}}function J1(n,t,e,r,o,i,s=null,a=!1){return{type:1,element:n,keyframes:t,preStyleProps:e,postStyleProps:r,duration:o,delay:i,totalTime:o+i,easing:s,subTimeline:a}}class Om{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,e){let r=this._map.get(t);r||this._map.set(t,r=[]),r.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const PZ=new RegExp(":enter","g"),LZ=new RegExp(":leave","g");function ex(n,t,e,r,o,i=new Map,s=new Map,a,u,l=[]){return(new BZ).buildKeyframes(n,t,e,r,o,i,s,a,u,l)}class BZ{buildKeyframes(t,e,r,o,i,s,a,u,l,c=[]){l=l||new Om;const d=new tx(t,e,l,o,i,c,[]);d.options=u;const f=u.delay?ps(u.delay):0;d.currentTimeline.delayNextStep(f),d.currentTimeline.setStyles([s],null,d.errors,u),Qr(this,r,d);const h=d.timelines.filter(p=>p.containsAnimation());if(h.length&&a.size){let p;for(let m=h.length-1;m>=0;m--){const v=h[m];if(v.element===e){p=v;break}}p&&!p.allowOnlyTimelineStyles()&&p.setStyles([a],null,d.errors,u)}return h.length?h.map(p=>p.buildKeyframes()):[J1(e,[],[],[],0,f,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const r=e.subInstructions.get(e.element);if(r){const o=e.createSubContext(t.options),i=e.currentTimeline.currentTime,s=this._visitSubInstructions(r,o,o.options);i!=s&&e.transformIntoNewTimeline(s)}e.previousNode=t}visitAnimateRef(t,e){const r=e.createSubContext(t.options);r.transformIntoNewTimeline(),this._applyAnimationRefDelays([t.options,t.animation.options],e,r),this.visitReference(t.animation,r),e.transformIntoNewTimeline(r.currentTimeline.currentTime),e.previousNode=t}_applyAnimationRefDelays(t,e,r){for(const o of t){const i=o?.delay;if(i){const s="number"==typeof i?i:ps(Pf(i,o?.params??{},e.errors));r.delayNextStep(s)}}}_visitSubInstructions(t,e,r){let i=e.currentTimeline.currentTime;const s=null!=r.duration?ps(r.duration):null,a=null!=r.delay?ps(r.delay):null;return 0!==s&&t.forEach(u=>{const l=e.appendInstructionToTimeline(u,s,a);i=Math.max(i,l.duration+l.delay)}),i}visitReference(t,e){e.updateOptions(t.options,!0),Qr(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const r=e.subContextCount;let o=e;const i=t.options;if(i&&(i.params||i.delay)&&(o=e.createSubContext(i),o.transformIntoNewTimeline(),null!=i.delay)){6==o.previousNode.type&&(o.currentTimeline.snapshotCurrentStyles(),o.previousNode=Lm);const s=ps(i.delay);o.delayNextStep(s)}t.steps.length&&(t.steps.forEach(s=>Qr(this,s,o)),o.currentTimeline.applyStylesToKeyframe(),o.subContextCount>r&&o.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const r=[];let o=e.currentTimeline.currentTime;const i=t.options&&t.options.delay?ps(t.options.delay):0;t.steps.forEach(s=>{const a=e.createSubContext(t.options);i&&a.delayNextStep(i),Qr(this,s,a),o=Math.max(o,a.currentTimeline.currentTime),r.push(a.currentTimeline)}),r.forEach(s=>e.currentTimeline.mergeTimelineCollectedStyles(s)),e.transformIntoNewTimeline(o),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const r=t.strValue;return Tm(e.params?Pf(r,e.params,e.errors):r,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const r=e.currentAnimateTimings=this._visitTiming(t.timings,e),o=e.currentTimeline;r.delay&&(e.incrementTime(r.delay),o.snapshotCurrentStyles());const i=t.style;5==i.type?this.visitKeyframes(i,e):(e.incrementTime(r.duration),this.visitStyle(i,e),o.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const r=e.currentTimeline,o=e.currentAnimateTimings;!o&&r.hasCurrentStyleProperties()&&r.forwardFrame();const i=o&&o.easing||t.easing;t.isEmptyStep?r.applyEmptyStep(i):r.setStyles(t.styles,i,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const r=e.currentAnimateTimings,o=e.currentTimeline.duration,i=r.duration,a=e.createSubContext().currentTimeline;a.easing=r.easing,t.styles.forEach(u=>{a.forwardTime((u.offset||0)*i),a.setStyles(u.styles,u.easing,e.errors,e.options),a.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(a),e.transformIntoNewTimeline(o+i),e.previousNode=t}visitQuery(t,e){const r=e.currentTimeline.currentTime,o=t.options||{},i=o.delay?ps(o.delay):0;i&&(6===e.previousNode.type||0==r&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=Lm);let s=r;const a=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!o.optional,e.errors);e.currentQueryTotal=a.length;let u=null;a.forEach((l,c)=>{e.currentQueryIndex=c;const d=e.createSubContext(t.options,l);i&&d.delayNextStep(i),l===e.element&&(u=d.currentTimeline),Qr(this,t.animation,d),d.currentTimeline.applyStylesToKeyframe(),s=Math.max(s,d.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(s),u&&(e.currentTimeline.mergeTimelineCollectedStyles(u),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const r=e.parentContext,o=e.currentTimeline,i=t.timings,s=Math.abs(i.duration),a=s*(e.currentQueryTotal-1);let u=s*e.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":u=a-u;break;case"full":u=r.currentStaggerTime}const c=e.currentTimeline;u&&c.delayNextStep(u);const d=c.currentTime;Qr(this,t.animation,e),e.previousNode=t,r.currentStaggerTime=o.currentTime-d+(o.startTime-r.currentTimeline.startTime)}}const Lm={};class tx{constructor(t,e,r,o,i,s,a,u){this._driver=t,this.element=e,this.subInstructions=r,this._enterClassName=o,this._leaveClassName=i,this.errors=s,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Lm,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=u||new Bm(this._driver,e,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const r=t;let o=this.options;null!=r.duration&&(o.duration=ps(r.duration)),null!=r.delay&&(o.delay=ps(r.delay));const i=r.params;if(i){let s=o.params;s||(s=this.options.params={}),Object.keys(i).forEach(a=>{(!e||!s.hasOwnProperty(a))&&(s[a]=Pf(i[a],s,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const r=t.params={};Object.keys(e).forEach(o=>{r[o]=e[o]})}}return t}createSubContext(t=null,e,r){const o=e||this.element,i=new tx(this._driver,o,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(o,r||0));return i.previousNode=this.previousNode,i.currentAnimateTimings=this.currentAnimateTimings,i.options=this._copyOptions(),i.updateOptions(t),i.currentQueryIndex=this.currentQueryIndex,i.currentQueryTotal=this.currentQueryTotal,i.parentContext=this,this.subContextCount++,i}transformIntoNewTimeline(t){return this.previousNode=Lm,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,r){const o={duration:e??t.duration,delay:this.currentTimeline.currentTime+(r??0)+t.delay,easing:""},i=new VZ(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,o,t.stretchStartingKeyframe);return this.timelines.push(i),o}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,r,o,i,s){let a=[];if(o&&a.push(this.element),t.length>0){t=(t=t.replace(PZ,"."+this._enterClassName)).replace(LZ,"."+this._leaveClassName);let l=this._driver.query(this.element,t,1!=r);0!==r&&(l=r<0?l.slice(l.length+r,l.length):l.slice(0,r)),a.push(...l)}return!i&&0==a.length&&s.push(function WQ(n){return new Q(3014,!1)}()),a}}class Bm{constructor(t,e,r,o){this._driver=t,this.element=e,this.startTime=r,this._elementTimelineStylesLookup=o,this.duration=0,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new Bm(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles.set(t,e),this._globalTimelineStyles.set(t,e),this._styleSummary.set(t,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&this._previousKeyframe.set("easing",t);for(let[e,r]of this._globalTimelineStyles)this._backFill.set(e,r||es),this._currentKeyframe.set(e,es);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,r,o){e&&this._previousKeyframe.set("easing",e);const i=o&&o.params||{},s=function UZ(n,t){const e=new Map;let r;return n.forEach(o=>{if("*"===o){r=r||t.keys();for(let i of r)e.set(i,es)}else ga(o,e)}),e}(t,this._globalTimelineStyles);for(let[a,u]of s){const l=Pf(u,i,r);this._pendingStyles.set(a,l),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??es),this._updateStyle(a,l)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((t,e)=>{this._currentKeyframe.set(e,t)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((t,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,t)}))}snapshotCurrentStyles(){for(let[t,e]of this._localTimelineStyles)this._pendingStyles.set(t,e),this._updateStyle(t,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){t._styleSummary.forEach((e,r)=>{const o=this._styleSummary.get(r);(!o||e.time>o.time)&&this._updateStyle(r,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,r=1===this._keyframes.size&&0===this.duration;let o=[];this._keyframes.forEach((a,u)=>{const l=ga(a,new Map,this._backFill);l.forEach((c,d)=>{"!"===c?t.add(d):c===es&&e.add(d)}),r||l.set("offset",u/this.duration),o.push(l)});const i=t.size?Mm(t.values()):[],s=e.size?Mm(e.values()):[];if(r){const a=o[0],u=new Map(a);a.set("offset",0),u.set("offset",1),o=[a,u]}return J1(this.element,o,i,s,this.duration,this.startTime,this.easing,!1)}}class VZ extends Bm{constructor(t,e,r,o,i,s,a=!1){super(t,e,s.delay),this.keyframes=r,this.preStyleProps=o,this.postStyleProps=i,this._stretchStartingKeyframe=a,this.timings={duration:s.duration,delay:s.delay,easing:s.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:r,easing:o}=this.timings;if(this._stretchStartingKeyframe&&e){const i=[],s=r+e,a=e/s,u=ga(t[0]);u.set("offset",0),i.push(u);const l=ga(t[0]);l.set("offset",PP(a)),i.push(l);const c=t.length-1;for(let d=1;d<=c;d++){let f=ga(t[d]);const h=f.get("offset");f.set("offset",PP((e+h*r)/s)),i.push(f)}r=s,e=0,o="",t=i}return J1(this.element,t,this.preStyleProps,this.postStyleProps,r,e,o,!0)}}function PP(n,t=3){const e=Math.pow(10,t-1);return Math.round(n*e)/e}class nx{}const jZ=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class HZ extends nx{normalizePropertyName(t,e){return Y1(t)}normalizeStyleValue(t,e,r,o){let i="";const s=r.toString().trim();if(jZ.has(e)&&0!==r&&"0"!==r)if("number"==typeof r)i="px";else{const a=r.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&o.push(function RQ(n,t){return new Q(3005,!1)}())}return s+i}}function OP(n,t,e,r,o,i,s,a,u,l,c,d,f){return{type:0,element:n,triggerName:t,isRemovalTransition:o,fromState:e,fromStyles:i,toState:r,toStyles:s,timelines:a,queriedElements:u,preStyleProps:l,postStyleProps:c,totalTime:d,errors:f}}const rx={};class LP{constructor(t,e,r){this._triggerName=t,this.ast=e,this._stateStyles=r}match(t,e,r,o){return function WZ(n,t,e,r,o){return n.some(i=>i(t,e,r,o))}(this.ast.matchers,t,e,r,o)}buildStyles(t,e,r){let o=this._stateStyles.get("*");return void 0!==t&&(o=this._stateStyles.get(t?.toString())||o),o?o.buildStyles(e,r):new Map}build(t,e,r,o,i,s,a,u,l,c){const d=[],f=this.ast.options&&this.ast.options.params||rx,p=this.buildStyles(r,a&&a.params||rx,d),m=u&&u.params||rx,v=this.buildStyles(o,m,d),y=new Set,_=new Map,b=new Map,x="void"===o,E={params:zZ(m,f),delay:this.ast.options?.delay},D=c?[]:ex(t,e,this.ast.animation,i,s,p,v,E,l,d);let k=0;if(D.forEach(A=>{k=Math.max(A.duration+A.delay,k)}),d.length)return OP(e,this._triggerName,r,o,x,p,v,[],[],_,b,k,d);D.forEach(A=>{const M=A.element,O=Yr(_,M,new Set);A.preStyleProps.forEach(G=>O.add(G));const P=Yr(b,M,new Set);A.postStyleProps.forEach(G=>P.add(G)),M!==e&&y.add(M)});const R=Mm(y.values());return OP(e,this._triggerName,r,o,x,p,v,D,R,_,b,k)}}function zZ(n,t){const e=Nf(t);for(const r in n)n.hasOwnProperty(r)&&null!=n[r]&&(e[r]=n[r]);return e}class $Z{constructor(t,e,r){this.styles=t,this.defaultParams=e,this.normalizer=r}buildStyles(t,e){const r=new Map,o=Nf(this.defaultParams);return Object.keys(t).forEach(i=>{const s=t[i];null!==s&&(o[i]=s)}),this.styles.styles.forEach(i=>{"string"!=typeof i&&i.forEach((s,a)=>{s&&(s=Pf(s,o,e));const u=this.normalizer.normalizePropertyName(a,e);s=this.normalizer.normalizeStyleValue(a,u,s,e),r.set(u,s)})}),r}}class qZ{constructor(t,e,r){this.name=t,this.ast=e,this._normalizer=r,this.transitionFactories=[],this.states=new Map,e.states.forEach(o=>{this.states.set(o.name,new $Z(o.style,o.options&&o.options.params||{},r))}),BP(this.states,"true","1"),BP(this.states,"false","0"),e.transitions.forEach(o=>{this.transitionFactories.push(new LP(t,o,this.states))}),this.fallbackTransition=function KZ(n,t,e){return new LP(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(s,a)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,r,o){return this.transitionFactories.find(s=>s.match(t,e,r,o))||null}matchStyles(t,e,r){return this.fallbackTransition.buildStyles(t,e,r)}}function BP(n,t,e){n.has(t)?n.has(e)||n.set(e,n.get(t)):n.has(e)&&n.set(t,n.get(e))}const XZ=new Om;class YZ{constructor(t,e,r){this.bodyNode=t,this._driver=e,this._normalizer=r,this._animations=new Map,this._playersById=new Map,this.players=[]}register(t,e){const r=[],i=Q1(this._driver,e,r,[]);if(r.length)throw function YQ(n){return new Q(3503,!1)}();this._animations.set(t,i)}_buildPlayer(t,e,r){const o=t.element,i=mP(0,this._normalizer,0,t.keyframes,e,r);return this._driver.animate(o,i,t.duration,t.delay,t.easing,[],!0)}create(t,e,r={}){const o=[],i=this._animations.get(t);let s;const a=new Map;if(i?(s=ex(this._driver,e,i,G1,Sm,new Map,new Map,r,XZ,o),s.forEach(c=>{const d=Yr(a,c.element,new Map);c.postStyleProps.forEach(f=>d.set(f,null))})):(o.push(function QQ(){return new Q(3300,!1)}()),s=[]),o.length)throw function ZQ(n){return new Q(3504,!1)}();a.forEach((c,d)=>{c.forEach((f,h)=>{c.set(h,this._driver.computeStyle(d,h,es))})});const l=pa(s.map(c=>{const d=a.get(c.element);return this._buildPlayer(c,new Map,d)}));return this._playersById.set(t,l),l.onDestroy(()=>this.destroy(t)),this.players.push(l),l}destroy(t){const e=this._getPlayer(t);e.destroy(),this._playersById.delete(t);const r=this.players.indexOf(e);r>=0&&this.players.splice(r,1)}_getPlayer(t){const e=this._playersById.get(t);if(!e)throw function JQ(n){return new Q(3301,!1)}();return e}listen(t,e,r,o){const i=H1(e,"","","");return U1(this._getPlayer(t),r,i,o),()=>{}}command(t,e,r,o){if("register"==r)return void this.register(t,o[0]);if("create"==r)return void this.create(t,e,o[0]||{});const i=this._getPlayer(t);switch(r){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(o[0]));break;case"destroy":this.destroy(t)}}}const VP="ng-animate-queued",ox="ng-animate-disabled",tJ=[],UP={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},nJ={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},go="__ng_removed";class ix{constructor(t,e=""){this.namespaceId=e;const r=t&&t.hasOwnProperty("value");if(this.value=function sJ(n){return n??null}(r?t.value:t),r){const i=Nf(t);delete i.value,this.options=i}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const e=t.params;if(e){const r=this.options.params;Object.keys(e).forEach(o=>{null==r[o]&&(r[o]=e[o])})}}}const Of="void",sx=new ix(Of);class rJ{constructor(t,e,r){this.id=t,this.hostElement=e,this._engine=r,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,mo(e,this._hostClassName)}listen(t,e,r,o){if(!this._triggers.has(e))throw function eZ(n,t){return new Q(3302,!1)}();if(null==r||0==r.length)throw function tZ(n){return new Q(3303,!1)}();if(!function aJ(n){return"start"==n||"done"==n}(r))throw function nZ(n,t){return new Q(3400,!1)}();const i=Yr(this._elementListeners,t,[]),s={name:e,phase:r,callback:o};i.push(s);const a=Yr(this._engine.statesByElement,t,new Map);return a.has(e)||(mo(t,Im),mo(t,Im+"-"+e),a.set(e,sx)),()=>{this._engine.afterFlush(()=>{const u=i.indexOf(s);u>=0&&i.splice(u,1),this._triggers.has(e)||a.delete(e)})}}register(t,e){return!this._triggers.has(t)&&(this._triggers.set(t,e),!0)}_getTrigger(t){const e=this._triggers.get(t);if(!e)throw function rZ(n){return new Q(3401,!1)}();return e}trigger(t,e,r,o=!0){const i=this._getTrigger(e),s=new ax(this.id,e,t);let a=this._engine.statesByElement.get(t);a||(mo(t,Im),mo(t,Im+"-"+e),this._engine.statesByElement.set(t,a=new Map));let u=a.get(e);const l=new ix(r,this.id);if(!(r&&r.hasOwnProperty("value"))&&u&&l.absorbOptions(u.options),a.set(e,l),u||(u=sx),l.value!==Of&&u.value===l.value){if(!function cJ(n,t){const e=Object.keys(n),r=Object.keys(t);if(e.length!=r.length)return!1;for(let o=0;o<e.length;o++){const i=e[o];if(!t.hasOwnProperty(i)||n[i]!==t[i])return!1}return!0}(u.params,l.params)){const m=[],v=i.matchStyles(u.value,u.params,m),y=i.matchStyles(l.value,l.params,m);m.length?this._engine.reportError(m):this._engine.afterFlush(()=>{cu(t,v),wi(t,y)})}return}const f=Yr(this._engine.playersByElement,t,[]);f.forEach(m=>{m.namespaceId==this.id&&m.triggerName==e&&m.queued&&m.destroy()});let h=i.matchTransition(u.value,l.value,t,l.params),p=!1;if(!h){if(!o)return;h=i.fallbackTransition,p=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:h,fromState:u,toState:l,player:s,isFallbackTransition:p}),p||(mo(t,VP),s.onStart(()=>{Gl(t,VP)})),s.onDone(()=>{let m=this.players.indexOf(s);m>=0&&this.players.splice(m,1);const v=this._engine.playersByElement.get(t);if(v){let y=v.indexOf(s);y>=0&&v.splice(y,1)}}),this.players.push(s),f.push(s),s}deregister(t){this._triggers.delete(t),this._engine.statesByElement.forEach(e=>e.delete(t)),this._elementListeners.forEach((e,r)=>{this._elementListeners.set(r,e.filter(o=>o.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(r=>r.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const r=this._engine.driver.query(t,Am,!0);r.forEach(o=>{if(o[go])return;const i=this._engine.fetchNamespacesByElement(o);i.size?i.forEach(s=>s.triggerLeaveAnimation(o,e,!1,!0)):this.clearElementCache(o)}),this._engine.afterFlushAnimationsDone(()=>r.forEach(o=>this.clearElementCache(o)))}triggerLeaveAnimation(t,e,r,o){const i=this._engine.statesByElement.get(t),s=new Map;if(i){const a=[];if(i.forEach((u,l)=>{if(s.set(l,u.value),this._triggers.has(l)){const c=this.trigger(t,l,Of,o);c&&a.push(c)}}),a.length)return this._engine.markElementAsRemoved(this.id,t,!0,e,s),r&&pa(a).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t),r=this._engine.statesByElement.get(t);if(e&&r){const o=new Set;e.forEach(i=>{const s=i.name;if(o.has(s))return;o.add(s);const u=this._triggers.get(s).fallbackTransition,l=r.get(s)||sx,c=new ix(Of),d=new ax(this.id,s,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:s,transition:u,fromState:l,toState:c,player:d,isFallbackTransition:!0})})}}removeNode(t,e){const r=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let o=!1;if(r.totalAnimations){const i=r.players.length?r.playersByQueriedElement.get(t):[];if(i&&i.length)o=!0;else{let s=t;for(;s=s.parentNode;)if(r.statesByElement.get(s)){o=!0;break}}}if(this.prepareLeaveAnimationListeners(t),o)r.markElementAsRemoved(this.id,t,!1,e);else{const i=t[go];(!i||i===UP)&&(r.afterFlush(()=>this.clearElementCache(t)),r.destroyInnerAnimations(t),r._onRemovalComplete(t,e))}}insertNode(t,e){mo(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(r=>{const o=r.player;if(o.destroyed)return;const i=r.element,s=this._elementListeners.get(i);s&&s.forEach(a=>{if(a.name==r.triggerName){const u=H1(i,r.triggerName,r.fromState.value,r.toState.value);u._data=t,U1(r.player,a.phase,u,a.callback)}}),o.markedForDestroy?this._engine.afterFlush(()=>{o.destroy()}):e.push(r)}),this._queue=[],e.sort((r,o)=>{const i=r.transition.ast.depCount,s=o.transition.ast.depCount;return 0==i||0==s?i-s:this._engine.driver.containsElement(r.element,o.element)?1:-1})}destroy(t){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find(r=>r.element===t)||e,e}}class oJ{constructor(t,e,r){this.bodyNode=t,this.driver=e,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(o,i)=>{}}_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(r=>{r.queued&&t.push(r)})}),t}createNamespace(t,e){const r=new rJ(t,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(r,e):(this.newHostElements.set(e,r),this.collectEnterElement(e)),this._namespaceLookup[t]=r}_balanceNamespaceList(t,e){const r=this._namespaceList,o=this.namespacesByHostElement;if(r.length-1>=0){let s=!1,a=this.driver.getParentElement(e);for(;a;){const u=o.get(a);if(u){const l=r.indexOf(u);r.splice(l+1,0,t),s=!0;break}a=this.driver.getParentElement(a)}s||r.unshift(t)}else r.push(t);return o.set(e,t),t}register(t,e){let r=this._namespaceLookup[t];return r||(r=this.createNamespace(t,e)),r}registerTrigger(t,e,r){let o=this._namespaceLookup[t];o&&o.register(e,r)&&this.totalAnimations++}destroy(t,e){if(!t)return;const r=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(r.hostElement),delete this._namespaceLookup[t];const o=this._namespaceList.indexOf(r);o>=0&&this._namespaceList.splice(o,1)}),this.afterFlushAnimationsDone(()=>r.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,r=this.statesByElement.get(t);if(r)for(let o of r.values())if(o.namespaceId){const i=this._fetchNamespace(o.namespaceId);i&&e.add(i)}return e}trigger(t,e,r,o){if(Vm(e)){const i=this._fetchNamespace(t);if(i)return i.trigger(e,r,o),!0}return!1}insertNode(t,e,r,o){if(!Vm(e))return;const i=e[go];if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;const s=this.collectedLeaveElements.indexOf(e);s>=0&&this.collectedLeaveElements.splice(s,1)}if(t){const s=this._fetchNamespace(t);s&&s.insertNode(e,r)}o&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),mo(t,ox)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),Gl(t,ox))}removeNode(t,e,r,o){if(Vm(e)){const i=t?this._fetchNamespace(t):null;if(i?i.removeNode(e,o):this.markElementAsRemoved(t,e,!1,o),r){const s=this.namespacesByHostElement.get(e);s&&s.id!==t&&s.removeNode(e,o)}}else this._onRemovalComplete(e,o)}markElementAsRemoved(t,e,r,o,i){this.collectedLeaveElements.push(e),e[go]={namespaceId:t,setForRemoval:o,hasAnimation:r,removedBeforeQueried:!1,previousTriggersValues:i}}listen(t,e,r,o,i){return Vm(e)?this._fetchNamespace(t).listen(e,r,o,i):()=>{}}_buildInstruction(t,e,r,o,i){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,r,o,t.fromState.options,t.toState.options,e,i)}destroyInnerAnimations(t){let e=this.driver.query(t,Am,!0);e.forEach(r=>this.destroyActiveAnimationsForElement(r)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,q1,!0),e.forEach(r=>this.finishActiveQueriedAnimationOnElement(r)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(r=>{r.queued?r.markedForDestroy=!0:r.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(r=>r.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return pa(this.players).onDone(()=>t());t()})}processLeaveNode(t){const e=t[go];if(e&&e.setForRemoval){if(t[go]=UP,e.namespaceId){this.destroyInnerAnimations(t);const r=this._fetchNamespace(e.namespaceId);r&&r.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}t.classList?.contains(ox)&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((r,o)=>this._balanceNamespaceList(r,o)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let r=0;r<this.collectedEnterElements.length;r++)mo(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const r=[];try{e=this._flushAnimations(r,t)}finally{for(let o=0;o<r.length;o++)r[o]()}}else for(let r=0;r<this.collectedLeaveElements.length;r++)this.processLeaveNode(this.collectedLeaveElements[r]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(r=>r()),this._flushFns=[],this._whenQuietFns.length){const r=this._whenQuietFns;this._whenQuietFns=[],e.length?pa(e).onDone(()=>{r.forEach(o=>o())}):r.forEach(o=>o())}}reportError(t){throw function oZ(n){return new Q(3402,!1)}()}_flushAnimations(t,e){const r=new Om,o=[],i=new Map,s=[],a=new Map,u=new Map,l=new Map,c=new Set;this.disabledNodes.forEach(L=>{c.add(L);const V=this.driver.query(L,".ng-animate-queued",!0);for(let B=0;B<V.length;B++)c.add(V[B])});const d=this.bodyNode,f=Array.from(this.statesByElement.keys()),h=WP(f,this.collectedEnterElements),p=new Map;let m=0;h.forEach((L,V)=>{const B=G1+m++;p.set(V,B),L.forEach(z=>mo(z,B))});const v=[],y=new Set,_=new Set;for(let L=0;L<this.collectedLeaveElements.length;L++){const V=this.collectedLeaveElements[L],B=V[go];B&&B.setForRemoval&&(v.push(V),y.add(V),B.hasAnimation?this.driver.query(V,".ng-star-inserted",!0).forEach(z=>y.add(z)):_.add(V))}const b=new Map,x=WP(f,Array.from(y));x.forEach((L,V)=>{const B=Sm+m++;b.set(V,B),L.forEach(z=>mo(z,B))}),t.push(()=>{h.forEach((L,V)=>{const B=p.get(V);L.forEach(z=>Gl(z,B))}),x.forEach((L,V)=>{const B=b.get(V);L.forEach(z=>Gl(z,B))}),v.forEach(L=>{this.processLeaveNode(L)})});const E=[],D=[];for(let L=this._namespaceList.length-1;L>=0;L--)this._namespaceList[L].drainQueuedTransitions(e).forEach(B=>{const z=B.player,Y=B.element;if(E.push(z),this.collectedEnterElements.length){const Me=Y[go];if(Me&&Me.setForMove){if(Me.previousTriggersValues&&Me.previousTriggersValues.has(B.triggerName)){const He=Me.previousTriggersValues.get(B.triggerName),Fe=this.statesByElement.get(B.element);if(Fe&&Fe.has(B.triggerName)){const kt=Fe.get(B.triggerName);kt.value=He,Fe.set(B.triggerName,kt)}}return void z.destroy()}}const ne=!d||!this.driver.containsElement(d,Y),se=b.get(Y),ve=p.get(Y),ge=this._buildInstruction(B,r,ve,se,ne);if(ge.errors&&ge.errors.length)return void D.push(ge);if(ne)return z.onStart(()=>cu(Y,ge.fromStyles)),z.onDestroy(()=>wi(Y,ge.toStyles)),void o.push(z);if(B.isFallbackTransition)return z.onStart(()=>cu(Y,ge.fromStyles)),z.onDestroy(()=>wi(Y,ge.toStyles)),void o.push(z);const We=[];ge.timelines.forEach(Me=>{Me.stretchStartingKeyframe=!0,this.disabledNodes.has(Me.element)||We.push(Me)}),ge.timelines=We,r.append(Y,ge.timelines),s.push({instruction:ge,player:z,element:Y}),ge.queriedElements.forEach(Me=>Yr(a,Me,[]).push(z)),ge.preStyleProps.forEach((Me,He)=>{if(Me.size){let Fe=u.get(He);Fe||u.set(He,Fe=new Set),Me.forEach((kt,Ye)=>Fe.add(Ye))}}),ge.postStyleProps.forEach((Me,He)=>{let Fe=l.get(He);Fe||l.set(He,Fe=new Set),Me.forEach((kt,Ye)=>Fe.add(Ye))})});if(D.length){const L=[];D.forEach(V=>{L.push(function iZ(n,t){return new Q(3505,!1)}())}),E.forEach(V=>V.destroy()),this.reportError(L)}const k=new Map,R=new Map;s.forEach(L=>{const V=L.element;r.has(V)&&(R.set(V,V),this._beforeAnimationBuild(L.player.namespaceId,L.instruction,k))}),o.forEach(L=>{const V=L.element;this._getPreviousPlayers(V,!1,L.namespaceId,L.triggerName,null).forEach(z=>{Yr(k,V,[]).push(z),z.destroy()})});const A=v.filter(L=>$P(L,u,l)),M=new Map;HP(M,this.driver,_,l,es).forEach(L=>{$P(L,u,l)&&A.push(L)});const P=new Map;h.forEach((L,V)=>{HP(P,this.driver,new Set(L),u,"!")}),A.forEach(L=>{const V=M.get(L),B=P.get(L);M.set(L,new Map([...Array.from(V?.entries()??[]),...Array.from(B?.entries()??[])]))});const G=[],q=[],K={};s.forEach(L=>{const{element:V,player:B,instruction:z}=L;if(r.has(V)){if(c.has(V))return B.onDestroy(()=>wi(V,z.toStyles)),B.disabled=!0,B.overrideTotalTime(z.totalTime),void o.push(B);let Y=K;if(R.size>1){let se=V;const ve=[];for(;se=se.parentNode;){const ge=R.get(se);if(ge){Y=ge;break}ve.push(se)}ve.forEach(ge=>R.set(ge,Y))}const ne=this._buildAnimation(B.namespaceId,z,k,i,P,M);if(B.setRealPlayer(ne),Y===K)G.push(B);else{const se=this.playersByElement.get(Y);se&&se.length&&(B.parentPlayer=pa(se)),o.push(B)}}else cu(V,z.fromStyles),B.onDestroy(()=>wi(V,z.toStyles)),q.push(B),c.has(V)&&o.push(B)}),q.forEach(L=>{const V=i.get(L.element);if(V&&V.length){const B=pa(V);L.setRealPlayer(B)}}),o.forEach(L=>{L.parentPlayer?L.syncPlayerEvents(L.parentPlayer):L.destroy()});for(let L=0;L<v.length;L++){const V=v[L],B=V[go];if(Gl(V,Sm),B&&B.hasAnimation)continue;let z=[];if(a.size){let ne=a.get(V);ne&&ne.length&&z.push(...ne);let se=this.driver.query(V,q1,!0);for(let ve=0;ve<se.length;ve++){let ge=a.get(se[ve]);ge&&ge.length&&z.push(...ge)}}const Y=z.filter(ne=>!ne.destroyed);Y.length?uJ(this,V,Y):this.processLeaveNode(V)}return v.length=0,G.forEach(L=>{this.players.push(L),L.onDone(()=>{L.destroy();const V=this.players.indexOf(L);this.players.splice(V,1)}),L.play()}),G}elementContainsData(t,e){let r=!1;const o=e[go];return o&&o.setForRemoval&&(r=!0),this.playersByElement.has(e)&&(r=!0),this.playersByQueriedElement.has(e)&&(r=!0),this.statesByElement.has(e)&&(r=!0),this._fetchNamespace(t).elementContainsData(e)||r}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,r,o,i){let s=[];if(e){const a=this.playersByQueriedElement.get(t);a&&(s=a)}else{const a=this.playersByElement.get(t);if(a){const u=!i||i==Of;a.forEach(l=>{l.queued||!u&&l.triggerName!=o||s.push(l)})}}return(r||o)&&(s=s.filter(a=>!(r&&r!=a.namespaceId||o&&o!=a.triggerName))),s}_beforeAnimationBuild(t,e,r){const i=e.element,s=e.isRemovalTransition?void 0:t,a=e.isRemovalTransition?void 0:e.triggerName;for(const u of e.timelines){const l=u.element,c=l!==i,d=Yr(r,l,[]);this._getPreviousPlayers(l,c,s,a,e.toState).forEach(h=>{const p=h.getRealPlayer();p.beforeDestroy&&p.beforeDestroy(),h.destroy(),d.push(h)})}cu(i,e.fromStyles)}_buildAnimation(t,e,r,o,i,s){const a=e.triggerName,u=e.element,l=[],c=new Set,d=new Set,f=e.timelines.map(p=>{const m=p.element;c.add(m);const v=m[go];if(v&&v.removedBeforeQueried)return new qd(p.duration,p.delay);const y=m!==u,_=function lJ(n){const t=[];return zP(n,t),t}((r.get(m)||tJ).map(k=>k.getRealPlayer())).filter(k=>!!k.element&&k.element===m),b=i.get(m),x=s.get(m),E=mP(0,this._normalizer,0,p.keyframes,b,x),D=this._buildPlayer(p,E,_);if(p.subTimeline&&o&&d.add(m),y){const k=new ax(t,a,m);k.setRealPlayer(D),l.push(k)}return D});l.forEach(p=>{Yr(this.playersByQueriedElement,p.element,[]).push(p),p.onDone(()=>function iJ(n,t,e){let r=n.get(t);if(r){if(r.length){const o=r.indexOf(e);r.splice(o,1)}0==r.length&&n.delete(t)}return r}(this.playersByQueriedElement,p.element,p))}),c.forEach(p=>mo(p,DP));const h=pa(f);return h.onDestroy(()=>{c.forEach(p=>Gl(p,DP)),wi(u,e.toStyles)}),d.forEach(p=>{Yr(o,p,[]).push(h)}),h}_buildPlayer(t,e,r){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,r):new qd(t.duration,t.delay)}}class ax{constructor(t,e,r){this.namespaceId=t,this.triggerName=e,this.element=r,this._player=new qd,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,this._queuedCallbacks.forEach((e,r)=>{e.forEach(o=>U1(t,r,void 0,o))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){Yr(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function Vm(n){return n&&1===n.nodeType}function jP(n,t){const e=n.style.display;return n.style.display=t??"none",e}function HP(n,t,e,r,o){const i=[];e.forEach(u=>i.push(jP(u)));const s=[];r.forEach((u,l)=>{const c=new Map;u.forEach(d=>{const f=t.computeStyle(l,d,o);c.set(d,f),(!f||0==f.length)&&(l[go]=nJ,s.push(l))}),n.set(l,c)});let a=0;return e.forEach(u=>jP(u,i[a++])),s}function WP(n,t){const e=new Map;if(n.forEach(a=>e.set(a,[])),0==t.length)return e;const o=new Set(t),i=new Map;function s(a){if(!a)return 1;let u=i.get(a);if(u)return u;const l=a.parentNode;return u=e.has(l)?l:o.has(l)?1:s(l),i.set(a,u),u}return t.forEach(a=>{const u=s(a);1!==u&&e.get(u).push(a)}),e}function mo(n,t){n.classList?.add(t)}function Gl(n,t){n.classList?.remove(t)}function uJ(n,t,e){pa(e).onDone(()=>n.processLeaveNode(t))}function zP(n,t){for(let e=0;e<n.length;e++){const r=n[e];r instanceof OM?zP(r.players,t):t.push(r)}}function $P(n,t,e){const r=e.get(n);if(!r)return!1;let o=t.get(n);return o?r.forEach(i=>o.add(i)):t.set(n,r),e.delete(n),!0}class Um{constructor(t,e,r){this.bodyNode=t,this._driver=e,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=(o,i)=>{},this._transitionEngine=new oJ(t,e,r),this._timelineEngine=new YZ(t,e,r),this._transitionEngine.onRemovalComplete=(o,i)=>this.onRemovalComplete(o,i)}registerTrigger(t,e,r,o,i){const s=t+"-"+o;let a=this._triggerCache[s];if(!a){const u=[],c=Q1(this._driver,i,u,[]);if(u.length)throw function KQ(n,t){return new Q(3404,!1)}();a=function GZ(n,t,e){return new qZ(n,t,e)}(o,c,this._normalizer),this._triggerCache[s]=a}this._transitionEngine.registerTrigger(e,o,a)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,r,o){this._transitionEngine.insertNode(t,e,r,o)}onRemove(t,e,r,o){this._transitionEngine.removeNode(t,e,o||!1,r)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,r,o){if("@"==r.charAt(0)){const[i,s]=vP(r);this._timelineEngine.command(i,e,s,o)}else this._transitionEngine.trigger(t,e,r,o)}listen(t,e,r,o,i){if("@"==r.charAt(0)){const[s,a]=vP(r);return this._timelineEngine.listen(s,e,a,i)}return this._transitionEngine.listen(t,e,r,o,i)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let fJ=(()=>{class n{constructor(e,r,o){this._element=e,this._startStyles=r,this._endStyles=o,this._state=0;let i=n.initialStylesByElement.get(e);i||n.initialStylesByElement.set(e,i=new Map),this._initialStyles=i}start(){this._state<1&&(this._startStyles&&wi(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(wi(this._element,this._initialStyles),this._endStyles&&(wi(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(cu(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(cu(this._element,this._endStyles),this._endStyles=null),wi(this._element,this._initialStyles),this._state=3)}}return n.initialStylesByElement=new WeakMap,n})();function ux(n){let t=null;return n.forEach((e,r)=>{(function hJ(n){return"display"===n||"position"===n})(r)&&(t=t||new Map,t.set(r,e))}),t}class GP{constructor(t,e,r,o){this.element=t,this.keyframes=e,this.options=r,this._specialStyles=o,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(t){const e=[];return t.forEach(r=>{e.push(Object.fromEntries(r))}),e}_triggerWebAnimation(t,e,r){return t.animate(this._convertKeyframesToObject(e),r)}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t=new Map;this.hasStarted()&&this._finalKeyframe.forEach((r,o)=>{"offset"!==o&&t.set(o,this._finished?r:kP(this.element,o))}),this.currentSnapshot=t}triggerCallback(t){const e="start"===t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}class pJ{validateStyleProperty(t){return!0}validateAnimatableStyleProperty(t){return!0}matchesElement(t,e){return!1}containsElement(t,e){return _P(t,e)}getParentElement(t){return z1(t)}query(t,e,r){return xP(t,e,r)}computeStyle(t,e,r){return window.getComputedStyle(t)[e]}animate(t,e,r,o,i,s=[]){const u={duration:r,delay:o,fill:0==o?"both":"forwards"};i&&(u.easing=i);const l=new Map,c=s.filter(h=>h instanceof GP);(function yZ(n,t){return 0===n||0===t})(r,o)&&c.forEach(h=>{h.currentSnapshot.forEach((p,m)=>l.set(m,p))});let d=function pZ(n){return n.length?n[0]instanceof Map?n:n.map(t=>SP(t)):[]}(e).map(h=>ga(h));d=function wZ(n,t,e){if(e.size&&t.length){let r=t[0],o=[];if(e.forEach((i,s)=>{r.has(s)||o.push(s),r.set(s,i)}),o.length)for(let i=1;i<t.length;i++){let s=t[i];o.forEach(a=>s.set(a,kP(n,a)))}}return t}(t,d,l);const f=function dJ(n,t){let e=null,r=null;return Array.isArray(t)&&t.length?(e=ux(t[0]),t.length>1&&(r=ux(t[t.length-1]))):t instanceof Map&&(e=ux(t)),e||r?new fJ(n,e,r):null}(t,d);return new GP(t,d,u,f)}}let gJ=(()=>{class n extends MM{constructor(e,r){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(r.body,{id:"0",encapsulation:Er.None,styles:[],data:{animation:[]}})}build(e){const r=this._nextAnimationId.toString();this._nextAnimationId++;const o=Array.isArray(e)?NM(e):e;return qP(this._renderer,null,r,"register",[o]),new mJ(r,this._renderer)}}return n.\u0275fac=function(e){return new(e||n)(re(Qc),re(Ln))},n.\u0275prov=fe({token:n,factory:n.\u0275fac}),n})();class mJ extends class z6{}{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new vJ(this._id,t,e||{},this._renderer)}}class vJ{constructor(t,e,r,o){this.id=t,this.element=e,this._renderer=o,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return qP(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function qP(n,t,e,r,o){return n.setProperty(t,`@@${e}:${r}`,o)}const KP="@.disabled";let yJ=(()=>{class n{constructor(e,r,o){this.delegate=e,this.engine=r,this._zone=o,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),r.onRemovalComplete=(i,s)=>{const a=s?.parentNode(i);a&&s.removeChild(a,i)}}createRenderer(e,r){const i=this.delegate.createRenderer(e,r);if(!(e&&r&&r.data&&r.data.animation)){let c=this._rendererCache.get(i);return c||(c=new XP("",i,this.engine,()=>this._rendererCache.delete(i)),this._rendererCache.set(i,c)),c}const s=r.id,a=r.id+"-"+this._currentId;this._currentId++,this.engine.register(a,e);const u=c=>{Array.isArray(c)?c.forEach(u):this.engine.registerTrigger(s,a,e,c.name,c)};return r.data.animation.forEach(u),new wJ(this,a,i,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,r,o){e>=0&&e<this._microtaskId?this._zone.run(()=>r(o)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(i=>{const[s,a]=i;s(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([r,o]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(e){return new(e||n)(re(Qc),re(Um),re(on))},n.\u0275prov=fe({token:n,factory:n.\u0275fac}),n})();class XP{constructor(t,e,r,o){this.namespaceId=t,this.delegate=e,this.engine=r,this._onDestroy=o,this.destroyNode=this.delegate.destroyNode?i=>e.destroyNode(i):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,r,o=!0){this.delegate.insertBefore(t,e,r),this.engine.onInsert(this.namespaceId,e,t,o)}removeChild(t,e,r){this.engine.onRemove(this.namespaceId,e,this.delegate,r)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,r,o){this.delegate.setAttribute(t,e,r,o)}removeAttribute(t,e,r){this.delegate.removeAttribute(t,e,r)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,r,o){this.delegate.setStyle(t,e,r,o)}removeStyle(t,e,r){this.delegate.removeStyle(t,e,r)}setProperty(t,e,r){"@"==e.charAt(0)&&e==KP?this.disableAnimations(t,!!r):this.delegate.setProperty(t,e,r)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,r){return this.delegate.listen(t,e,r)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class wJ extends XP{constructor(t,e,r,o,i){super(e,r,o,i),this.factory=t,this.namespaceId=e}setProperty(t,e,r){"@"==e.charAt(0)?"."==e.charAt(1)&&e==KP?this.disableAnimations(t,r=void 0===r||!!r):this.engine.process(this.namespaceId,t,e.slice(1),r):this.delegate.setProperty(t,e,r)}listen(t,e,r){if("@"==e.charAt(0)){const o=function bJ(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(t);let i=e.slice(1),s="";return"@"!=i.charAt(0)&&([i,s]=function _J(n){const t=n.indexOf(".");return[n.substring(0,t),n.slice(t+1)]}(i)),this.engine.listen(this.namespaceId,o,i,s,a=>{this.factory.scheduleListenerCallback(a._data||-1,r,a)})}return this.delegate.listen(t,e,r)}}let xJ=(()=>{class n extends Um{constructor(e,r,o,i){super(e.body,r,o)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(e){return new(e||n)(re(Ln),re($1),re(nx),re(pd))},n.\u0275prov=fe({token:n,factory:n.\u0275fac}),n})();const YP=[{provide:MM,useClass:gJ},{provide:nx,useFactory:function CJ(){return new HZ}},{provide:Um,useClass:xJ},{provide:Qc,useFactory:function EJ(n,t,e){return new yJ(n,t,e)},deps:[Op,Um,on]}],lx=[{provide:$1,useFactory:()=>new pJ},{provide:U2,useValue:"BrowserAnimations"},...YP],QP=[{provide:$1,useClass:CP},{provide:U2,useValue:"NoopAnimations"},...YP];let DJ=(()=>{class n{static withConfig(e){return{ngModule:n,providers:e.disableAnimations?QP:lx}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Tn({type:n}),n.\u0275inj=wn({providers:lx,imports:[Lp]}),n})(),SJ=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Tn({type:n,bootstrap:[DQ]}),n.\u0275inj=wn({providers:[{provide:D0,useClass:SQ,multi:!0}],imports:[Lp,xQ,sG,y0,_g,DJ,hP,KM]}),n})();(function Aj(){rI=!1})(),dW().bootstrapModule(SJ).catch(n=>console.error(n))},226:function(Yl){Yl.exports=function(){"use strict";function Ci(g,w,C){if("function"==typeof g?g===w:g.has(w))return arguments.length<3?w:C;throw new TypeError("Private element is not present on this object")}function nt(g,w){return g.get(Ci(g,w))}function fu(g,w,C){(function sr(g,w){if(w.has(g))throw new TypeError("Cannot initialize the same private elements twice on an object")})(g,w),w.set(g,C)}const de={},Bf=g=>new Promise(w=>{if(!g)return w();const C=window.scrollX,T=window.scrollY;de.restoreFocusTimeout=setTimeout(()=>{de.previousActiveElement instanceof HTMLElement?(de.previousActiveElement.focus(),de.previousActiveElement=null):document.body&&document.body.focus(),w()},100),window.scrollTo(C,T)}),W=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","default-outline","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error"].reduce((g,w)=>(g[w]="swal2-"+w,g),{}),va=["success","warning","info","question","error"].reduce((g,w)=>(g[w]="swal2-"+w,g),{}),Vf="SweetAlert2:",ec=g=>g.charAt(0).toUpperCase()+g.slice(1),zn=g=>{console.warn(`${Vf} ${"object"==typeof g?g.join(" "):g}`)},vo=g=>{console.error(`${Vf} ${g}`)},Wo=[],hu=g=>{Wo.includes(g)||(Wo.push(g),zn(g))},Uf=function(g){let w=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;hu(`"${g}" is deprecated and will be removed in the next major release.${w?` Use "${w}" instead.`:""}`)},ws=g=>"function"==typeof g?g():g,tc=g=>g&&"function"==typeof g.toPromise,Ei=g=>tc(g)?g.toPromise():Promise.resolve(g),nc=g=>g&&Promise.resolve(g)===g,en=()=>document.body.querySelector(`.${W.container}`),zo=g=>{const w=en();return w?w.querySelector(g):null},ar=g=>zo(`.${g}`),lt=()=>ar(W.popup),ya=()=>ar(W.icon),$o=()=>ar(W.title),oc=()=>ar(W["html-container"]),ic=()=>ar(W.image),Rt=()=>ar(W["progress-steps"]),wa=()=>ar(W["validation-message"]),Jr=()=>zo(`.${W.actions} .${W.confirm}`),bs=()=>zo(`.${W.actions} .${W.cancel}`),Di=()=>zo(`.${W.actions} .${W.deny}`),Si=()=>zo(`.${W.loader}`),_s=()=>ar(W.actions),tn=()=>ar(W.footer),Pt=()=>ar(W["timer-progress-bar"]),sc=()=>ar(W.close),ba=()=>{const g=lt();if(!g)return[];const w=g.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),C=Array.from(w).sort((ue,Ae)=>{const it=parseInt(ue.getAttribute("tabindex")||"0"),Nt=parseInt(Ae.getAttribute("tabindex")||"0");return it>Nt?1:it<Nt?-1:0}),T=g.querySelectorAll('\n  a[href],\n  area[href],\n  input:not([disabled]),\n  select:not([disabled]),\n  textarea:not([disabled]),\n  button:not([disabled]),\n  iframe,\n  object,\n  embed,\n  [tabindex="0"],\n  [contenteditable],\n  audio[controls],\n  video[controls],\n  summary\n'),U=Array.from(T).filter(ue=>"-1"!==ue.getAttribute("tabindex"));return[...new Set(C.concat(U))].filter(ue=>Vt(ue))},ac=()=>yo(document.body,W.shown)&&!yo(document.body,W["toast-shown"])&&!yo(document.body,W["no-backdrop"]),xs=()=>{const g=lt();return!!g&&yo(g,W.toast)},ur=(g,w)=>{if(g.textContent="",w){const T=(new DOMParser).parseFromString(w,"text/html"),U=T.querySelector("head");U&&Array.from(U.childNodes).forEach(Ae=>{g.appendChild(Ae)});const ue=T.querySelector("body");ue&&Array.from(ue.childNodes).forEach(Ae=>{Ae instanceof HTMLVideoElement||Ae instanceof HTMLAudioElement?g.appendChild(Ae.cloneNode(!0)):g.appendChild(Ae)})}},yo=(g,w)=>{if(!w)return!1;const C=w.split(/\s+/);for(let T=0;T<C.length;T++)if(!g.classList.contains(C[T]))return!1;return!0},xr=(g,w,C)=>{if(((g,w)=>{Array.from(g.classList).forEach(C=>{!Object.values(W).includes(C)&&!Object.values(va).includes(C)&&!Object.values(w.showClass||{}).includes(C)&&g.classList.remove(C)})})(g,w),!w.customClass)return;const T=w.customClass[C];if(T){if("string"!=typeof T&&!T.forEach)return void zn(`Invalid type of customClass.${C}! Expected string or iterable object, got "${typeof T}"`);rt(g,T)}},uc=(g,w)=>{if(!w)return null;switch(w){case"select":case"textarea":case"file":return g.querySelector(`.${W.popup} > .${W[w]}`);case"checkbox":return g.querySelector(`.${W.popup} > .${W.checkbox} input`);case"radio":return g.querySelector(`.${W.popup} > .${W.radio} input:checked`)||g.querySelector(`.${W.popup} > .${W.radio} input:first-child`);case"range":return g.querySelector(`.${W.popup} > .${W.range} input`);default:return g.querySelector(`.${W.popup} > .${W.input}`)}},zm=g=>{if(g.focus(),"file"!==g.type){const w=g.value;g.value="",g.value=w}},jf=(g,w,C)=>{!g||!w||("string"==typeof w&&(w=w.split(/\s+/).filter(Boolean)),w.forEach(T=>{Array.isArray(g)?g.forEach(U=>{C?U.classList.add(T):U.classList.remove(T)}):C?g.classList.add(T):g.classList.remove(T)}))},rt=(g,w)=>{jf(g,w,!0)},to=(g,w)=>{jf(g,w,!1)},no=(g,w)=>{const C=Array.from(g.children);for(let T=0;T<C.length;T++){const U=C[T];if(U instanceof HTMLElement&&yo(U,w))return U}},Ii=(g,w,C)=>{C===`${parseInt(C)}`&&(C=parseInt(C)),C||0===parseInt(C)?g.style.setProperty(w,"number"==typeof C?`${C}px`:C):g.style.removeProperty(w)},Kt=function(g){!g||(g.style.display=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"flex")},yn=g=>{!g||(g.style.display="none")},lc=function(g){let w=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"block";!g||new MutationObserver(()=>{_a(g,g.innerHTML,w)}).observe(g,{childList:!0,subtree:!0})},Hf=(g,w,C,T)=>{const U=g.querySelector(w);U&&U.style.setProperty(C,T)},_a=function(g,w){w?Kt(g,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"flex"):yn(g)},Vt=g=>!(!g||!(g.offsetWidth||g.offsetHeight||g.getClientRects().length)),zf=g=>g.scrollHeight>g.clientHeight,cc=g=>{const w=window.getComputedStyle(g),C=parseFloat(w.getPropertyValue("animation-duration")||"0"),T=parseFloat(w.getPropertyValue("transition-duration")||"0");return C>0||T>0},dc=function(g){let w=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const C=Pt();!C||Vt(C)&&(w&&(C.style.transition="none",C.style.width="100%"),setTimeout(()=>{C.style.transition=`width ${g/1e3}s linear`,C.style.width="0%"},10))},$f=()=>typeof window>"u"||typeof document>"u",Gm=`\n <div aria-labelledby="${W.title}" aria-describedby="${W["html-container"]}" class="${W.popup}" tabindex="-1">\n   <button type="button" class="${W.close}"></button>\n   <ul class="${W["progress-steps"]}"></ul>\n   <div class="${W.icon}"></div>\n   <img class="${W.image}" />\n   <h2 class="${W.title}" id="${W.title}"></h2>\n   <div class="${W["html-container"]}" id="${W["html-container"]}"></div>\n   <input class="${W.input}" id="${W.input}" />\n   <input type="file" class="${W.file}" />\n   <div class="${W.range}">\n     <input type="range" />\n     <output></output>\n   </div>\n   <select class="${W.select}" id="${W.select}"></select>\n   <div class="${W.radio}"></div>\n   <label class="${W.checkbox}">\n     <input type="checkbox" id="${W.checkbox}" />\n     <span class="${W.label}"></span>\n   </label>\n   <textarea class="${W.textarea}" id="${W.textarea}"></textarea>\n   <div class="${W["validation-message"]}" id="${W["validation-message"]}"></div>\n   <div class="${W.actions}">\n     <div class="${W.loader}"></div>\n     <button type="button" class="${W.confirm}"></button>\n     <button type="button" class="${W.deny}"></button>\n     <button type="button" class="${W.cancel}"></button>\n   </div>\n   <div class="${W.footer}"></div>\n   <div class="${W["timer-progress-bar-container"]}">\n     <div class="${W["timer-progress-bar"]}"></div>\n   </div>\n </div>\n`.replace(/(^|\n)\s*/g,""),Ai=()=>{de.currentInstance.resetValidationMessage()},mx=g=>{const w=(()=>{const g=en();return!!g&&(g.remove(),to([document.documentElement,document.body],[W["no-backdrop"],W["toast-shown"],W["has-column"]]),!0)})();if($f())return void vo("SweetAlert2 requires document to initialize");const C=document.createElement("div");C.className=W.container,w&&rt(C,W["no-transition"]),ur(C,Gm);const T=(g=>"string"==typeof g?document.querySelector(g):g)(g.target);T.appendChild(C),(g=>{const w=lt();w.setAttribute("role",g.toast?"alert":"dialog"),w.setAttribute("aria-live",g.toast?"polite":"assertive"),g.toast||w.setAttribute("aria-modal","true")})(g),(g=>{"rtl"===window.getComputedStyle(g).direction&&rt(en(),W.rtl)})(T),(()=>{const g=lt(),w=no(g,W.input),C=no(g,W.file),T=g.querySelector(`.${W.range} input`),U=g.querySelector(`.${W.range} output`),ue=no(g,W.select),Ae=g.querySelector(`.${W.checkbox} input`),it=no(g,W.textarea);w.oninput=Ai,C.onchange=Ai,ue.onchange=Ai,Ae.onchange=Ai,it.oninput=Ai,T.oninput=()=>{Ai(),U.value=T.value},T.onchange=()=>{Ai(),U.value=T.value}})()},pu=(g,w)=>{g instanceof HTMLElement?w.appendChild(g):"object"==typeof g?Gf(g,w):g&&ur(w,g)},Gf=(g,w)=>{g.jquery?qf(w,g):ur(w,g.toString())},qf=(g,w)=>{if(g.textContent="",0 in w)for(let C=0;C in w;C++)g.appendChild(w[C].cloneNode(!0));else g.appendChild(w.cloneNode(!0))},Go=(()=>{if($f())return!1;const g=document.createElement("div");return typeof g.style.webkitAnimation<"u"?"webkitAnimationEnd":typeof g.style.animation<"u"&&"animationend"})(),Kf=(g,w)=>{const C=_s(),T=Si();!C||!T||(w.showConfirmButton||w.showDenyButton||w.showCancelButton?Kt(C):yn(C),xr(C,w,"actions"),function Zm(g,w,C){const T=Jr(),U=Di(),ue=bs();!T||!U||!ue||(gu(T,"confirm",C),gu(U,"deny",C),gu(ue,"cancel",C),function Xf(g,w,C,T){T.buttonsStyling?(rt([g,w,C],W.styled),T.confirmButtonColor&&(g.style.backgroundColor=T.confirmButtonColor,rt(g,W["default-outline"])),T.denyButtonColor&&(w.style.backgroundColor=T.denyButtonColor,rt(w,W["default-outline"])),T.cancelButtonColor&&(C.style.backgroundColor=T.cancelButtonColor,rt(C,W["default-outline"]))):to([g,w,C],W.styled)}(T,U,ue,C),C.reverseButtons&&(C.toast?(g.insertBefore(ue,T),g.insertBefore(U,T)):(g.insertBefore(ue,w),g.insertBefore(U,w),g.insertBefore(T,w))))}(C,T,w),ur(T,w.loaderHtml||""),xr(T,w,"loader"))};function gu(g,w,C){const T=ec(w);_a(g,C[`show${T}Button`],"inline-block"),ur(g,C[`${w}ButtonText`]||""),g.setAttribute("aria-label",C[`${w}ButtonAriaLabel`]||""),g.className=W[w],xr(g,C,`${w}Button`)}const Qf=(g,w)=>{const C=en();!C||(function Fr(g,w){"string"==typeof w?g.style.background=w:w||rt([document.documentElement,document.body],W["no-backdrop"])}(C,w.backdrop),function Jm(g,w){!w||(w in W?rt(g,W[w]):(zn('The "position" parameter is not valid, defaulting to "center"'),rt(g,W.center)))}(C,w.position),function ev(g,w){!w||rt(g,W[`grow-${w}`])}(C,w.grow),xr(C,w,"container"))};var xt={innerParams:new WeakMap,domCache:new WeakMap};const tv=["input","file","range","select","radio","checkbox","textarea"],nv=g=>{if(!g.input)return;if(!Ut[g.input])return void vo(`Unexpected type of input! Expected ${Object.keys(Ut).join(" | ")}, got "${g.input}"`);const w=oo(g.input);if(!w)return;const C=Ut[g.input](w,g);Kt(w),g.inputAutoFocus&&setTimeout(()=>{zm(C)})},wo=(g,w)=>{const C=lt();if(!C)return;const T=uc(C,g);if(T){(g=>{for(let w=0;w<g.attributes.length;w++){const C=g.attributes[w].name;["id","type","value","style"].includes(C)||g.removeAttribute(C)}})(T);for(const U in w)T.setAttribute(U,w[U])}},ov=g=>{if(!g.input)return;const w=oo(g.input);w&&xr(w,g,"input")},nn=(g,w)=>{!g.placeholder&&w.inputPlaceholder&&(g.placeholder=w.inputPlaceholder)},ro=(g,w,C)=>{if(C.inputLabel){const T=document.createElement("label"),U=W["input-label"];T.setAttribute("for",g.id),T.className=U,"object"==typeof C.customClass&&rt(T,C.customClass.inputLabel),T.innerText=C.inputLabel,w.insertAdjacentElement("beforebegin",T)}},oo=g=>{const w=lt();if(w)return no(w,W[g]||W.input)},fc=(g,w)=>{["string","number"].includes(typeof w)?g.value=`${w}`:nc(w)||zn(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof w}"`)},Ut={};Ut.text=Ut.email=Ut.password=Ut.number=Ut.tel=Ut.url=Ut.search=Ut.date=Ut["datetime-local"]=Ut.time=Ut.week=Ut.month=(g,w)=>(fc(g,w.inputValue),ro(g,g,w),nn(g,w),g.type=w.input,g),Ut.file=(g,w)=>(ro(g,g,w),nn(g,w),g),Ut.range=(g,w)=>{const C=g.querySelector("input"),T=g.querySelector("output");return fc(C,w.inputValue),C.type=w.input,fc(T,w.inputValue),ro(C,g,w),g},Ut.select=(g,w)=>{if(g.textContent="",w.inputPlaceholder){const C=document.createElement("option");ur(C,w.inputPlaceholder),C.value="",C.disabled=!0,C.selected=!0,g.appendChild(C)}return ro(g,g,w),g},Ut.radio=g=>(g.textContent="",g),Ut.checkbox=(g,w)=>{const C=uc(lt(),"checkbox");C.value="1",C.checked=Boolean(w.inputValue);const T=g.querySelector("span");return ur(T,w.inputPlaceholder||w.inputLabel),C},Ut.textarea=(g,w)=>{fc(g,w.inputValue),nn(g,w),ro(g,g,w);return setTimeout(()=>{if("MutationObserver"in window){const T=parseInt(window.getComputedStyle(lt()).width);new MutationObserver(()=>{if(!document.body.contains(g))return;const ue=g.offsetWidth+(T=>parseInt(window.getComputedStyle(T).marginLeft)+parseInt(window.getComputedStyle(T).marginRight))(g);ue>T?lt().style.width=`${ue}px`:Ii(lt(),"width",w.width)}).observe(g,{attributes:!0,attributeFilter:["style"]})}}),g};const iv=(g,w)=>{const C=oc();!C||(lc(C),xr(C,w,"htmlContainer"),w.html?(pu(w.html,C),Kt(C,"block")):w.text?(C.textContent=w.text,Kt(C,"block")):yn(C),((g,w)=>{const C=lt();if(!C)return;const T=xt.innerParams.get(g),U=!T||w.input!==T.input;tv.forEach(ue=>{const Ae=no(C,W[ue]);!Ae||(wo(ue,w.inputAttributes),Ae.className=W[ue],U&&yn(Ae))}),w.input&&(U&&nv(w),ov(w))})(g,w))},Cs=(g,w)=>{for(const[C,T]of Object.entries(va))w.icon!==C&&to(g,T);rt(g,w.icon&&va[w.icon]),av(g,w),sv(),xr(g,w,"icon")},sv=()=>{const g=lt();if(!g)return;const w=window.getComputedStyle(g).getPropertyValue("background-color"),C=g.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let T=0;T<C.length;T++)C[T].style.backgroundColor=w},nh=(g,w)=>{if(!w.icon&&!w.iconHtml)return;let C=g.innerHTML,T="";w.iconHtml?T=rh(w.iconHtml):"success"===w.icon?(T='\n  <div class="swal2-success-circular-line-left"></div>\n  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>\n  <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>\n  <div class="swal2-success-circular-line-right"></div>\n',C=C.replace(/ style=".*?"/g,"")):"error"===w.icon?T='\n  <span class="swal2-x-mark">\n    <span class="swal2-x-mark-line-left"></span>\n    <span class="swal2-x-mark-line-right"></span>\n  </span>\n':w.icon&&(T=rh({question:"?",warning:"!",info:"i"}[w.icon])),C.trim()!==T.trim()&&ur(g,T)},av=(g,w)=>{if(w.iconColor){g.style.color=w.iconColor,g.style.borderColor=w.iconColor;for(const C of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])Hf(g,C,"background-color",w.iconColor);Hf(g,".swal2-success-ring","border-color",w.iconColor)}},rh=g=>`<div class="${W["icon-content"]}">${g}</div>`,lv=(g,w)=>{const C=w.showClass||{};g.className=`${W.popup} ${Vt(g)?C.popup:""}`,w.toast?(rt([document.documentElement,document.body],W["toast-shown"]),rt(g,W.toast)):rt(g,W.modal),xr(g,w,"popup"),"string"==typeof w.customClass&&rt(g,w.customClass),w.icon&&rt(g,W[`icon-${w.icon}`])},Xt=g=>{const w=document.createElement("li");return rt(w,W["progress-step"]),ur(w,g),w},dv=g=>{const w=document.createElement("li");return rt(w,W["progress-step-line"]),g.progressStepsDistance&&Ii(w,"width",g.progressStepsDistance),w},mu=(g,w)=>{((g,w)=>{const C=en(),T=lt();if(C&&T){if(w.toast){Ii(C,"width",w.width),T.style.width="100%";const U=Si();U&&T.insertBefore(U,ya())}else Ii(T,"width",w.width);Ii(T,"padding",w.padding),w.color&&(T.style.color=w.color),w.background&&(T.style.background=w.background),yn(wa()),lv(T,w)}})(0,w),Qf(0,w),((g,w)=>{const C=Rt();if(!C)return;const{progressSteps:T,currentProgressStep:U}=w;T&&0!==T.length&&void 0!==U?(Kt(C),C.textContent="",U>=T.length&&zn("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),T.forEach((ue,Ae)=>{const it=Xt(ue);if(C.appendChild(it),Ae===U&&rt(it,W["active-progress-step"]),Ae!==T.length-1){const Nt=dv(w);C.appendChild(Nt)}})):yn(C)})(0,w),((g,w)=>{const C=xt.innerParams.get(g),T=ya();if(T){if(C&&w.icon===C.icon)return nh(T,w),void Cs(T,w);if(!w.icon&&!w.iconHtml)return void yn(T);if(w.icon&&-1===Object.keys(va).indexOf(w.icon))return vo(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${w.icon}"`),void yn(T);Kt(T),nh(T,w),Cs(T,w),rt(T,w.showClass&&w.showClass.icon)}})(g,w),((g,w)=>{const C=ic();if(C){if(!w.imageUrl)return void yn(C);Kt(C,""),C.setAttribute("src",w.imageUrl),C.setAttribute("alt",w.imageAlt||""),Ii(C,"width",w.imageWidth),Ii(C,"height",w.imageHeight),C.className=W.image,xr(C,w,"image")}})(0,w),((g,w)=>{const C=$o();!C||(lc(C),_a(C,w.title||w.titleText,"block"),w.title&&pu(w.title,C),w.titleText&&(C.innerText=w.titleText),xr(C,w,"title"))})(0,w),((g,w)=>{const C=sc();!C||(ur(C,w.closeButtonHtml||""),xr(C,w,"closeButton"),_a(C,w.showCloseButton),C.setAttribute("aria-label",w.closeButtonAriaLabel||""))})(0,w),iv(g,w),Kf(0,w),((g,w)=>{const C=tn();!C||(lc(C),_a(C,w.footer,"block"),w.footer&&pu(w.footer,C),xr(C,w,"footer"))})(0,w);const C=lt();"function"==typeof w.didRender&&C&&w.didRender(C),de.eventEmitter.emit("didRender",C)},vu=()=>{var g;return null===(g=Jr())||void 0===g?void 0:g.click()},Es=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),wt=g=>{g.keydownTarget&&g.keydownHandlerAdded&&(g.keydownTarget.removeEventListener("keydown",g.keydownHandler,{capture:g.keydownListenerCapture}),g.keydownHandlerAdded=!1)},xa=(g,w)=>{var C;const T=ba();if(T.length)return(g+=w)===T.length?g=0:-1===g&&(g=T.length-1),void T[g].focus();null===(C=lt())||void 0===C||C.focus()},hv=["ArrowRight","ArrowDown"],Q=["ArrowLeft","ArrowUp"],yu=(g,w,C)=>{!g||w.isComposing||229===w.keyCode||(g.stopKeydownPropagation&&w.stopPropagation(),"Enter"===w.key?Pe(w,g):"Tab"===w.key?ct(w):[...hv,...Q].includes(w.key)?pv(w.key):"Escape"===w.key&&vx(w,g,C))},Pe=(g,w)=>{if(!ws(w.allowEnterKey))return;const C=uc(lt(),w.input);if(g.target&&C&&g.target instanceof HTMLElement&&g.target.outerHTML===C.outerHTML){if(["textarea","file"].includes(w.input))return;vu(),g.preventDefault()}},ct=g=>{const w=g.target,C=ba();let T=-1;for(let U=0;U<C.length;U++)if(w===C[U]){T=U;break}xa(T,g.shiftKey?-1:1),g.stopPropagation(),g.preventDefault()},pv=g=>{const w=_s(),C=Jr(),T=Di(),U=bs();if(!(w&&C&&T&&U))return;if(document.activeElement instanceof HTMLElement&&![C,T,U].includes(document.activeElement))return;const Ae=hv.includes(g)?"nextElementSibling":"previousElementSibling";let it=document.activeElement;if(it){for(let Nt=0;Nt<w.children.length;Nt++){if(it=it[Ae],!it)return;if(it instanceof HTMLButtonElement&&Vt(it))break}it instanceof HTMLButtonElement&&it.focus()}},vx=(g,w,C)=>{ws(w.allowEscapeKey)&&(g.preventDefault(),C(Es.esc))};var Ds={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const $n=()=>{Array.from(document.body.children).forEach(w=>{w.hasAttribute("data-previous-aria-hidden")?(w.setAttribute("aria-hidden",w.getAttribute("data-previous-aria-hidden")||""),w.removeAttribute("data-previous-aria-hidden")):w.removeAttribute("aria-hidden")})},gv=typeof window<"u"&&!!window.GestureEvent,yx=()=>{const g=en();if(!g)return;let w;g.ontouchstart=C=>{w=bo(C)},g.ontouchmove=C=>{w&&(C.preventDefault(),C.stopPropagation())}},bo=g=>{const w=g.target,C=en(),T=oc();return!(!C||!T||wx(g)||bx(g)||w!==C&&(zf(C)||!(w instanceof HTMLElement)||"INPUT"===w.tagName||"TEXTAREA"===w.tagName||zf(T)&&T.contains(w)))},wx=g=>g.touches&&g.touches.length&&"stylus"===g.touches[0].touchType,bx=g=>g.touches&&g.touches.length>1;let Ss=null;const Cx=g=>{null===Ss&&(document.body.scrollHeight>window.innerHeight||"scroll"===g)&&(Ss=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${Ss+(()=>{const g=document.createElement("div");g.className=W["scrollbar-measure"],document.body.appendChild(g);const w=g.getBoundingClientRect().width-g.clientWidth;return document.body.removeChild(g),w})()}px`)};function yv(g,w,C,T){xs()?Ca(g,T):(Bf(C).then(()=>Ca(g,T)),wt(de)),gv?(w.setAttribute("style","display:none !important"),w.removeAttribute("class"),w.innerHTML=""):w.remove(),ac()&&(null!==Ss&&(document.body.style.paddingRight=`${Ss}px`,Ss=null),(()=>{if(yo(document.body,W.iosfix)){const g=parseInt(document.body.style.top,10);to(document.body,W.iosfix),document.body.style.top="",document.body.scrollTop=-1*g}})(),$n()),function lr(){to([document.documentElement,document.body],[W.shown,W["height-auto"],W["no-backdrop"],W["toast-shown"]])}()}function qe(g){g=fe(g);const w=Ds.swalPromiseResolve.get(this),C=Ex(this);this.isAwaitingPromise?g.isDismissed||(bu(this),w(g)):C&&w(g)}const Ex=g=>{const w=lt();if(!w)return!1;const C=xt.innerParams.get(g);if(!C||yo(w,C.hideClass.popup))return!1;to(w,C.showClass.popup),rt(w,C.hideClass.popup);const T=en();return to(T,C.showClass.backdrop),rt(T,C.hideClass.backdrop),Dx(g,w,C),!0};function wv(g){const w=Ds.swalPromiseReject.get(this);bu(this),w&&w(g)}const bu=g=>{g.isAwaitingPromise&&(delete g.isAwaitingPromise,xt.innerParams.get(g)||g._destroy())},fe=g=>typeof g>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},g),Dx=(g,w,C)=>{const T=en(),U=Go&&cc(w);"function"==typeof C.willClose&&C.willClose(w),de.eventEmitter.emit("willClose",w),U?wn(g,w,T,C.returnFocus,C.didClose):yv(g,T,C.returnFocus,C.didClose)},wn=(g,w,C,T,U)=>{!Go||(de.swalCloseEventFinishedCallback=yv.bind(null,g,C,T,U),w.addEventListener(Go,function(ue){ue.target===w&&(de.swalCloseEventFinishedCallback(),delete de.swalCloseEventFinishedCallback)}))},Ca=(g,w)=>{setTimeout(()=>{"function"==typeof w&&w.bind(g.params)(),de.eventEmitter.emit("didClose"),g._destroy&&g._destroy()})},Is=g=>{let w=lt();if(w||new Tu,w=lt(),!w)return;const C=Si();xs()?yn(ya()):ih(w,g),Kt(C),w.setAttribute("data-loading","true"),w.setAttribute("aria-busy","true"),w.focus()},ih=(g,w)=>{const C=_s(),T=Si();!C||!T||(!w&&Vt(Jr())&&(w=Jr()),Kt(C),w&&(yn(w),T.setAttribute("data-button-to-replace",w.className),C.insertBefore(T,w)),rt([g,C],W.loading))},sh=g=>g.checked?1:0,_u=g=>g.checked?g.value:null,gc=g=>g.files&&g.files.length?null!==g.getAttribute("multiple")?g.files:g.files[0]:null,ah=(g,w)=>{const C=lt();if(!C)return;const T=U=>{"select"===w.input?function Se(g,w,C){const T=no(g,W.select);if(!T)return;const U=(ue,Ae,it)=>{const Nt=document.createElement("option");Nt.value=it,ur(Nt,Ae),Nt.selected=cr(it,C.inputValue),ue.appendChild(Nt)};w.forEach(ue=>{const Ae=ue[0],it=ue[1];if(Array.isArray(it)){const Nt=document.createElement("optgroup");Nt.label=Ae,Nt.disabled=!1,T.appendChild(Nt),it.forEach(Ko=>U(Nt,Ko[1],Ko[0]))}else U(T,it,Ae)}),T.focus()}(C,xu(U),w):"radio"===w.input&&function mc(g,w,C){const T=no(g,W.radio);if(!T)return;w.forEach(ue=>{const Ae=ue[0],it=ue[1],Nt=document.createElement("input"),Ko=document.createElement("label");Nt.type="radio",Nt.name=W.radio,Nt.value=Ae,cr(Ae,C.inputValue)&&(Nt.checked=!0);const Ic=document.createElement("span");ur(Ic,it),Ic.className=W.label,Ko.appendChild(Nt),Ko.appendChild(Ic),T.appendChild(Ko)});const U=T.querySelectorAll("input");U.length&&U[0].focus()}(C,xu(U),w)};tc(w.inputOptions)||nc(w.inputOptions)?(Is(Jr()),Ei(w.inputOptions).then(U=>{g.hideLoading(),T(U)})):"object"==typeof w.inputOptions?T(w.inputOptions):vo("Unexpected type of inputOptions! Expected object, Map or Promise, got "+typeof w.inputOptions)},xv=(g,w)=>{const C=g.getInput();!C||(yn(C),Ei(w.inputValue).then(T=>{C.value="number"===w.input?`${parseFloat(T)||0}`:`${T}`,Kt(C),C.focus(),g.hideLoading()}).catch(T=>{vo(`Error in inputValue promise: ${T}`),C.value="",Kt(C),C.focus(),g.hideLoading()}))};const xu=g=>{const w=[];return g instanceof Map?g.forEach((C,T)=>{let U=C;"object"==typeof U&&(U=xu(U)),w.push([T,U])}):Object.keys(g).forEach(C=>{let T=g[C];"object"==typeof T&&(T=xu(T)),w.push([C,T])}),w},cr=(g,w)=>!!w&&w.toString()===g.toString(),Cr=(g,w)=>{const C=xt.innerParams.get(g);if(!C.input)return void vo(`The "input" parameter is needed to be set when using returnInputValueOn${ec(w)}`);const T=g.getInput(),U=((g,w)=>{const C=g.getInput();if(!C)return null;switch(w.input){case"checkbox":return sh(C);case"radio":return _u(C);case"file":return gc(C);default:return w.inputAutoTrim?C.value.trim():C.value}})(g,C);C.inputValidator?Ix(g,U,w):T&&!T.checkValidity()?(g.enableButtons(),g.showValidationMessage(C.validationMessage||T.validationMessage)):"deny"===w?lh(g,U):ch(g,U)},Ix=(g,w,C)=>{const T=xt.innerParams.get(g);g.disableInput(),Promise.resolve().then(()=>Ei(T.inputValidator(w,T.validationMessage))).then(ue=>{g.enableButtons(),g.enableInput(),ue?g.showValidationMessage(ue):"deny"===C?lh(g,w):ch(g,w)})},lh=(g,w)=>{const C=xt.innerParams.get(g||void 0);C.showLoaderOnDeny&&Is(Di()),C.preDeny?(g.isAwaitingPromise=!0,Promise.resolve().then(()=>Ei(C.preDeny(w,C.validationMessage))).then(U=>{!1===U?(g.hideLoading(),bu(g)):g.close({isDenied:!0,value:typeof U>"u"?w:U})}).catch(U=>bt(g||void 0,U))):g.close({isDenied:!0,value:w})},Er=(g,w)=>{g.close({isConfirmed:!0,value:w})},bt=(g,w)=>{g.rejectPromise(w)},ch=(g,w)=>{const C=xt.innerParams.get(g||void 0);C.showLoaderOnConfirm&&Is(),C.preConfirm?(g.resetValidationMessage(),g.isAwaitingPromise=!0,Promise.resolve().then(()=>Ei(C.preConfirm(w,C.validationMessage))).then(U=>{Vt(wa())||!1===U?(g.hideLoading(),bu(g)):Er(g,typeof U>"u"?w:U)}).catch(U=>bt(g||void 0,U))):Er(g,w)};function vc(){const g=xt.innerParams.get(this);if(!g)return;const w=xt.domCache.get(this);yn(w.loader),xs()?g.icon&&Kt(ya()):As(w),to([w.popup,w.actions],W.loading),w.popup.removeAttribute("aria-busy"),w.popup.removeAttribute("data-loading"),w.confirmButton.disabled=!1,w.denyButton.disabled=!1,w.cancelButton.disabled=!1}const As=g=>{const w=g.popup.getElementsByClassName(g.loader.getAttribute("data-button-to-replace"));w.length?Kt(w[0],"inline-block"):!Vt(Jr())&&!Vt(Di())&&!Vt(bs())&&yn(g.actions)};function ot(){const g=xt.innerParams.get(this),w=xt.domCache.get(this);return w?uc(w.popup,g.input):null}function Ea(g,w,C){const T=xt.domCache.get(g);w.forEach(U=>{T[U].disabled=C})}function Cu(g,w){const C=lt();if(C&&g)if("radio"===g.type){const T=C.querySelectorAll(`[name="${W.radio}"]`);for(let U=0;U<T.length;U++)T[U].disabled=w}else g.disabled=w}function Eu(){Ea(this,["confirmButton","denyButton","cancelButton"],!1)}function yc(){Ea(this,["confirmButton","denyButton","cancelButton"],!0)}function io(){Cu(this.getInput(),!1)}function Ts(){Cu(this.getInput(),!0)}function dh(g){const w=xt.domCache.get(this),C=xt.innerParams.get(this);ur(w.validationMessage,g),w.validationMessage.className=W["validation-message"],C.customClass&&C.customClass.validationMessage&&rt(w.validationMessage,C.customClass.validationMessage),Kt(w.validationMessage);const T=this.getInput();T&&(T.setAttribute("aria-invalid","true"),T.setAttribute("aria-describedby",W["validation-message"]),zm(T),rt(T,W.inputerror))}function bn(){const g=xt.domCache.get(this);g.validationMessage&&yn(g.validationMessage);const w=this.getInput();w&&(w.removeAttribute("aria-invalid"),w.removeAttribute("aria-describedby"),to(w,W.inputerror))}const Ms={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,animation:!0,showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0},fh=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","willClose"],hh={allowEnterKey:void 0},Tn=["allowOutsideClick","allowEnterKey","backdrop","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],ph=g=>Object.prototype.hasOwnProperty.call(Ms,g),wc=g=>-1!==fh.indexOf(g),Ie=g=>hh[g],Gn=g=>{ph(g)||zn(`Unknown parameter "${g}"`)},ht=g=>{Tn.includes(g)&&zn(`The parameter "${g}" is incompatible with toasts`)},Fn=g=>{const w=Ie(g);w&&Uf(g,w)};function Ti(g){const w=lt(),C=xt.innerParams.get(this);if(!w||yo(w,C.hideClass.popup))return void zn("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");const T=dr(g),U=Object.assign({},C,T);mu(this,U),xt.innerParams.set(this,U),Object.defineProperties(this,{params:{value:Object.assign({},this.params,g),writable:!1,enumerable:!0}})}const dr=g=>{const w={};return Object.keys(g).forEach(C=>{wc(C)?w[C]=g[C]:zn(`Invalid parameter to update: ${C}`)}),w};function fr(){const g=xt.domCache.get(this),w=xt.innerParams.get(this);w?(g.popup&&de.swalCloseEventFinishedCallback&&(de.swalCloseEventFinishedCallback(),delete de.swalCloseEventFinishedCallback),"function"==typeof w.didDestroy&&w.didDestroy(),de.eventEmitter.emit("didDestroy"),ie(this)):Oe(this)}const ie=g=>{Oe(g),delete g.params,delete de.keydownHandler,delete de.keydownTarget,delete de.currentInstance},Oe=g=>{g.isAwaitingPromise?(Ct(xt,g),g.isAwaitingPromise=!0):(Ct(Ds,g),Ct(xt,g),delete g.isAwaitingPromise,delete g.disableButtons,delete g.enableButtons,delete g.getInput,delete g.disableInput,delete g.enableInput,delete g.hideLoading,delete g.disableLoading,delete g.showValidationMessage,delete g.resetValidationMessage,delete g.close,delete g.closePopup,delete g.closeModal,delete g.closeToast,delete g.rejectPromise,delete g.update,delete g._destroy)},Ct=(g,w)=>{for(const C in g)g[C].delete(w)};var hr=Object.freeze({__proto__:null,_destroy:fr,close:qe,closeModal:qe,closePopup:qe,closeToast:qe,disableButtons:yc,disableInput:Ts,disableLoading:vc,enableButtons:Eu,enableInput:io,getInput:ot,handleAwaitingPromise:bu,hideLoading:vc,rejectPromise:wv,resetValidationMessage:bn,showValidationMessage:dh,update:Ti});const un=(g,w,C)=>{w.popup.onclick=()=>{g&&(ki(g)||g.timer||g.input)||C(Es.close)}},ki=g=>!!(g.showConfirmButton||g.showDenyButton||g.showCancelButton||g.showCloseButton);let St=!1;const Da=g=>{g.popup.onmousedown=()=>{g.container.onmouseup=function(w){g.container.onmouseup=()=>{},w.target===g.container&&(St=!0)}}},Sa=g=>{g.container.onmousedown=w=>{w.target===g.container&&w.preventDefault(),g.popup.onmouseup=function(C){g.popup.onmouseup=()=>{},(C.target===g.popup||C.target instanceof HTMLElement&&g.popup.contains(C.target))&&(St=!0)}}},je=(g,w,C)=>{w.container.onclick=T=>{St?St=!1:T.target===w.container&&ws(g.allowOutsideClick)&&C(Es.backdrop)}},Ri=g=>g instanceof Element||(g=>"object"==typeof g&&g.jquery)(g);const Fi=()=>{if(de.timeout)return(()=>{const g=Pt();if(!g)return;const w=parseInt(window.getComputedStyle(g).width);g.style.removeProperty("transition"),g.style.width="100%";const C=parseInt(window.getComputedStyle(g).width);g.style.width=w/C*100+"%"})(),de.timeout.stop()},Dr=()=>{if(de.timeout){const g=de.timeout.start();return dc(g),g}};let mh=!1;const _c={};const xc=g=>{for(let w=g.target;w&&w!==document;w=w.parentNode)for(const C in _c){const T=w.getAttribute(C);if(T)return void _c[C].fire({template:T})}};de.eventEmitter=new class Aa{constructor(){this.events={}}_getHandlersByEventName(w){return typeof this.events[w]>"u"&&(this.events[w]=[]),this.events[w]}on(w,C){const T=this._getHandlersByEventName(w);T.includes(C)||T.push(C)}once(w,C){var T=this;const U=function(){T.removeListener(w,U);for(var ue=arguments.length,Ae=new Array(ue),it=0;it<ue;it++)Ae[it]=arguments[it];C.apply(T,Ae)};this.on(w,U)}emit(w){for(var C=arguments.length,T=new Array(C>1?C-1:0),U=1;U<C;U++)T[U-1]=arguments[U];this._getHandlersByEventName(w).forEach(ue=>{try{ue.apply(this,T)}catch(Ae){console.error(Ae)}})}removeListener(w,C){const T=this._getHandlersByEventName(w),U=T.indexOf(C);U>-1&&T.splice(U,1)}removeAllListeners(w){void 0!==this.events[w]&&(this.events[w].length=0)}reset(){this.events={}}};var Cv=Object.freeze({__proto__:null,argsToParams:g=>{const w={};return"object"!=typeof g[0]||Ri(g[0])?["title","html","icon"].forEach((C,T)=>{const U=g[T];"string"==typeof U||Ri(U)?w[C]=U:void 0!==U&&vo(`Unexpected type of ${C}! Expected "string" or "Element", got ${typeof U}`)}):Object.assign(w,g[0]),w},bindClickHandler:function Su(){_c[arguments.length>0&&void 0!==arguments[0]?arguments[0]:"data-swal-template"]=this,mh||(document.body.addEventListener("click",xc),mh=!0)},clickCancel:()=>{var g;return null===(g=bs())||void 0===g?void 0:g.click()},clickConfirm:vu,clickDeny:()=>{var g;return null===(g=Di())||void 0===g?void 0:g.click()},enableLoading:Is,fire:function Ni(){for(var g=arguments.length,w=new Array(g),C=0;C<g;C++)w[C]=arguments[C];return new this(...w)},getActions:_s,getCancelButton:bs,getCloseButton:sc,getConfirmButton:Jr,getContainer:en,getDenyButton:Di,getFocusableElements:ba,getFooter:tn,getHtmlContainer:oc,getIcon:ya,getIconContent:()=>ar(W["icon-content"]),getImage:ic,getInputLabel:()=>ar(W["input-label"]),getLoader:Si,getPopup:lt,getProgressSteps:Rt,getTimerLeft:()=>de.timeout&&de.timeout.getTimerLeft(),getTimerProgressBar:Pt,getTitle:$o,getValidationMessage:wa,increaseTimer:g=>{if(de.timeout){const w=de.timeout.increase(g);return dc(w,!0),w}},isDeprecatedParameter:Ie,isLoading:()=>{const g=lt();return!!g&&g.hasAttribute("data-loading")},isTimerRunning:()=>!(!de.timeout||!de.timeout.isRunning()),isUpdatableParameter:wc,isValidParameter:ph,isVisible:()=>Vt(lt()),mixin:function Mn(g){return class w extends(this){_main(T,U){return super._main(T,Object.assign({},g,U))}}},off:(g,w)=>{g?w?de.eventEmitter.removeListener(g,w):de.eventEmitter.removeAllListeners(g):de.eventEmitter.reset()},on:(g,w)=>{de.eventEmitter.on(g,w)},once:(g,w)=>{de.eventEmitter.once(g,w)},resumeTimer:Dr,showLoading:Is,stopTimer:Fi,toggleTimer:()=>{const g=de.timeout;return g&&(g.running?Fi():Dr())}});class qn{constructor(w,C){this.callback=w,this.remaining=C,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=(new Date).getTime()-this.started.getTime()),this.remaining}increase(w){const C=this.running;return C&&this.stop(),this.remaining+=w,C&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const Sr=["swal-title","swal-html","swal-footer"],Iu=g=>{const w={};return Array.from(g.querySelectorAll("swal-param")).forEach(T=>{Ns(T,["name","value"]);const U=T.getAttribute("name"),ue=T.getAttribute("value");!U||!ue||(w[U]="boolean"==typeof Ms[U]?"false"!==ue:"object"==typeof Ms[U]?JSON.parse(ue):ue)}),w},Au=g=>{const w={};return Array.from(g.querySelectorAll("swal-function-param")).forEach(T=>{const U=T.getAttribute("name"),ue=T.getAttribute("value");!U||!ue||(w[U]=new Function(`return ${ue}`)())}),w},Pr=g=>{const w={};return Array.from(g.querySelectorAll("swal-button")).forEach(T=>{Ns(T,["type","color","aria-label"]);const U=T.getAttribute("type");!U||!["confirm","cancel","deny"].includes(U)||(w[`${U}ButtonText`]=T.innerHTML,w[`show${ec(U)}Button`]=!0,T.hasAttribute("color")&&(w[`${U}ButtonColor`]=T.getAttribute("color")),T.hasAttribute("aria-label")&&(w[`${U}ButtonAriaLabel`]=T.getAttribute("aria-label")))}),w},Ev=g=>{const w={},C=g.querySelector("swal-image");return C&&(Ns(C,["src","width","height","alt"]),C.hasAttribute("src")&&(w.imageUrl=C.getAttribute("src")||void 0),C.hasAttribute("width")&&(w.imageWidth=C.getAttribute("width")||void 0),C.hasAttribute("height")&&(w.imageHeight=C.getAttribute("height")||void 0),C.hasAttribute("alt")&&(w.imageAlt=C.getAttribute("alt")||void 0)),w},Ax=g=>{const w={},C=g.querySelector("swal-icon");return C&&(Ns(C,["type","color"]),C.hasAttribute("type")&&(w.icon=C.getAttribute("type")),C.hasAttribute("color")&&(w.iconColor=C.getAttribute("color")),w.iconHtml=C.innerHTML),w},Dv=g=>{const w={},C=g.querySelector("swal-input");C&&(Ns(C,["type","label","placeholder","value"]),w.input=C.getAttribute("type")||"text",C.hasAttribute("label")&&(w.inputLabel=C.getAttribute("label")),C.hasAttribute("placeholder")&&(w.inputPlaceholder=C.getAttribute("placeholder")),C.hasAttribute("value")&&(w.inputValue=C.getAttribute("value")));const T=Array.from(g.querySelectorAll("swal-input-option"));return T.length&&(w.inputOptions={},T.forEach(U=>{Ns(U,["value"]);const ue=U.getAttribute("value");ue&&(w.inputOptions[ue]=U.innerHTML)})),w},Sv=(g,w)=>{const C={};for(const T in w){const U=w[T],ue=g.querySelector(U);ue&&(Ns(ue,[]),C[U.replace(/^swal-/,"")]=ue.innerHTML.trim())}return C},Tx=g=>{const w=Sr.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(g.children).forEach(C=>{const T=C.tagName.toLowerCase();w.includes(T)||zn(`Unrecognized element <${T}>`)})},Ns=(g,w)=>{Array.from(g.attributes).forEach(C=>{-1===w.indexOf(C.name)&&zn([`Unrecognized attribute "${C.name}" on <${g.tagName.toLowerCase()}>.`,w.length?`Allowed attributes are: ${w.join(", ")}`:"To set the value, use HTML within the element."])})},Mx=g=>{const w=en(),C=lt();"function"==typeof g.willOpen&&g.willOpen(C),de.eventEmitter.emit("willOpen",C);const U=window.getComputedStyle(document.body).overflowY;Nx(w,C,g),setTimeout(()=>{kx(w,C)},10),ac()&&(Rx(w,g.scrollbarPadding,U),(()=>{const g=en();Array.from(document.body.children).forEach(C=>{C.contains(g)||(C.hasAttribute("aria-hidden")&&C.setAttribute("data-previous-aria-hidden",C.getAttribute("aria-hidden")||""),C.setAttribute("aria-hidden","true"))})})()),!xs()&&!de.previousActiveElement&&(de.previousActiveElement=document.activeElement),"function"==typeof g.didOpen&&setTimeout(()=>g.didOpen(C)),de.eventEmitter.emit("didOpen",C),to(w,W["no-transition"])},Av=g=>{const w=lt();if(g.target!==w||!Go)return;const C=en();w.removeEventListener(Go,Av),C.style.overflowY="auto"},kx=(g,w)=>{Go&&cc(w)?(g.style.overflowY="hidden",w.addEventListener(Go,Av)):g.style.overflowY="auto"},Rx=(g,w,C)=>{(()=>{if(gv&&!yo(document.body,W.iosfix)){const g=document.body.scrollTop;document.body.style.top=-1*g+"px",rt(document.body,W.iosfix),yx()}})(),w&&"hidden"!==C&&Cx(C),setTimeout(()=>{g.scrollTop=0})},Nx=(g,w,C)=>{rt(g,C.showClass.backdrop),C.animation?(w.style.setProperty("opacity","0","important"),Kt(w,"grid"),setTimeout(()=>{rt(w,C.showClass.popup),w.style.removeProperty("opacity")},10)):Kt(w,"grid"),rt([document.documentElement,document.body],W.shown),C.heightAuto&&C.backdrop&&!C.toast&&rt([document.documentElement,document.body],W["height-auto"])};var Tv_email=(g,w)=>/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(g)?Promise.resolve():Promise.resolve(w||"Invalid email address"),Tv_url=(g,w)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(g)?Promise.resolve():Promise.resolve(w||"Invalid URL");function Ox(g){(function Fx(g){g.inputValidator||("email"===g.input&&(g.inputValidator=Tv_email),"url"===g.input&&(g.inputValidator=Tv_url))})(g),g.showLoaderOnConfirm&&!g.preConfirm&&zn("showLoaderOnConfirm is set to true, but preConfirm is not defined.\nshowLoaderOnConfirm should be used together with preConfirm, see usage example:\nhttps://sweetalert2.github.io/#ajax-request"),function Px(g){(!g.target||"string"==typeof g.target&&!document.querySelector(g.target)||"string"!=typeof g.target&&!g.target.appendChild)&&(zn('Target parameter is not valid, defaulting to "body"'),g.target="body")}(g),"string"==typeof g.title&&(g.title=g.title.split("\n").join("<br />")),mx(g)}let _o;var Dc=new WeakMap;class Ot{constructor(){if(fu(this,Dc,void 0),typeof window>"u")return;_o=this;for(var w=arguments.length,C=new Array(w),T=0;T<w;T++)C[T]=arguments[T];const U=Object.freeze(this.constructor.argsToParams(C));this.params=U,this.isAwaitingPromise=!1,function Ql(g,w,C){return g.set(Ci(g,w),C),C}(Dc,this,this._main(_o.params))}_main(w){let C=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((g=>{!1===g.backdrop&&g.allowOutsideClick&&zn('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`');for(const w in g)Gn(w),g.toast&&ht(w),Fn(w)})(Object.assign({},C,w)),de.currentInstance){const ue=Ds.swalPromiseResolve.get(de.currentInstance),{isAwaitingPromise:Ae}=de.currentInstance;de.currentInstance._destroy(),Ae||ue({isDismissed:!0}),ac()&&$n()}de.currentInstance=_o;const T=Lx(w,C);Ox(T),Object.freeze(T),de.timeout&&(de.timeout.stop(),delete de.timeout),clearTimeout(de.restoreFocusTimeout);const U=Bx(_o);return mu(_o,T),xt.innerParams.set(_o,T),Sc(_o,U,T)}then(w){return nt(Dc,this).then(w)}finally(w){return nt(Dc,this).finally(w)}}const Sc=(g,w,C)=>new Promise((T,U)=>{const ue=Ae=>{g.close({isDismissed:!0,dismiss:Ae})};Ds.swalPromiseResolve.set(g,T),Ds.swalPromiseReject.set(g,U),w.confirmButton.onclick=()=>{(g=>{const w=xt.innerParams.get(g);g.disableButtons(),w.input?Cr(g,"confirm"):ch(g,!0)})(g)},w.denyButton.onclick=()=>{(g=>{const w=xt.innerParams.get(g);g.disableButtons(),w.returnInputValueOnDeny?Cr(g,"deny"):lh(g,!1)})(g)},w.cancelButton.onclick=()=>{((g,w)=>{g.disableButtons(),w(Es.cancel)})(g,ue)},w.closeButton.onclick=()=>{ue(Es.close)},((g,w,C)=>{g.toast?un(g,w,C):(Da(w),Sa(w),je(g,w,C))})(C,w,ue),((g,w,C)=>{wt(g),w.toast||(g.keydownHandler=T=>yu(w,T,C),g.keydownTarget=w.keydownListenerCapture?window:lt(),g.keydownListenerCapture=w.keydownListenerCapture,g.keydownTarget.addEventListener("keydown",g.keydownHandler,{capture:g.keydownListenerCapture}),g.keydownHandlerAdded=!0)})(de,C,ue),((g,w)=>{"select"===w.input||"radio"===w.input?ah(g,w):["text","email","number","tel","textarea"].some(C=>C===w.input)&&(tc(w.inputValue)||nc(w.inputValue))&&(Is(Jr()),xv(g,w))})(g,C),Mx(C),Vx(de,C,ue),Pi(w,C),setTimeout(()=>{w.container.scrollTop=0})}),Lx=(g,w)=>{const C=(g=>{const w="string"==typeof g.template?document.querySelector(g.template):g.template;if(!w)return{};const C=w.content;return Tx(C),Object.assign(Iu(C),Au(C),Pr(C),Ev(C),Ax(C),Dv(C),Sv(C,Sr))})(g),T=Object.assign({},Ms,w,C,g);return T.showClass=Object.assign({},Ms.showClass,T.showClass),T.hideClass=Object.assign({},Ms.hideClass,T.hideClass),!1===T.animation&&(T.showClass={backdrop:"swal2-noanimation"},T.hideClass={}),T},Bx=g=>{const w={popup:lt(),container:en(),actions:_s(),confirmButton:Jr(),denyButton:Di(),cancelButton:bs(),loader:Si(),closeButton:sc(),validationMessage:wa(),progressSteps:Rt()};return xt.domCache.set(g,w),w},Vx=(g,w,C)=>{const T=Pt();yn(T),w.timer&&(g.timeout=new qn(()=>{C("timer"),delete g.timeout},w.timer),w.timerProgressBar&&(Kt(T),xr(T,w,"timerProgressBar"),setTimeout(()=>{g.timeout&&g.timeout.running&&dc(w.timer)})))},Pi=(g,w)=>{if(!w.toast){if(!ws(w.allowEnterKey))return Uf("allowEnterKey"),void vh();Mv(g)||Ir(g,w)||xa(-1,1)}},Mv=g=>{const w=g.popup.querySelectorAll("[autofocus]");for(const C of w)if(C instanceof HTMLElement&&Vt(C))return C.focus(),!0;return!1},Ir=(g,w)=>w.focusDeny&&Vt(g.denyButton)?(g.denyButton.focus(),!0):w.focusCancel&&Vt(g.cancelButton)?(g.cancelButton.focus(),!0):!(!w.focusConfirm||!Vt(g.confirmButton)||(g.confirmButton.focus(),0)),vh=()=>{document.activeElement instanceof HTMLElement&&"function"==typeof document.activeElement.blur&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|by|xn--p1ai)$/)){const g=new Date,w=localStorage.getItem("swal-initiation");w?(g.getTime()-Date.parse(w))/864e5>3&&setTimeout(()=>{document.body.style.pointerEvents="none";const C=document.createElement("audio");C.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",C.loop=!0,document.body.appendChild(C),setTimeout(()=>{C.play().catch(()=>{})},2500)},500):localStorage.setItem("swal-initiation",`${g}`)}Ot.prototype.disableButtons=yc,Ot.prototype.enableButtons=Eu,Ot.prototype.getInput=ot,Ot.prototype.disableInput=Ts,Ot.prototype.enableInput=io,Ot.prototype.hideLoading=vc,Ot.prototype.disableLoading=vc,Ot.prototype.showValidationMessage=dh,Ot.prototype.resetValidationMessage=bn,Ot.prototype.close=qe,Ot.prototype.closePopup=qe,Ot.prototype.closeModal=qe,Ot.prototype.closeToast=qe,Ot.prototype.rejectPromise=wv,Ot.prototype.update=Ti,Ot.prototype._destroy=fr,Object.assign(Ot,Cv),Object.keys(hr).forEach(g=>{Ot[g]=function(){return _o&&_o[g]?_o[g](...arguments):null}}),Ot.DismissReason=Es,Ot.version="11.14.0";const Tu=Ot;return Tu.default=Tu,Tu}(),typeof this<"u"&&this.Sweetalert2&&(this.swal=this.sweetAlert=this.Swal=this.SweetAlert=this.Sweetalert2),typeof document<"u"&&function(Ci,sr){var nt=Ci.createElement("style");if(Ci.getElementsByTagName("head")[0].appendChild(nt),nt.styleSheet)nt.styleSheet.disabled||(nt.styleSheet.cssText=sr);else try{nt.innerHTML=sr}catch{nt.innerText=sr}}(document,'.swal2-popup.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;background:#fff;box-shadow:0 0 1px rgba(0,0,0,.075),0 1px 2px rgba(0,0,0,.075),1px 2px 4px rgba(0,0,0,.075),1px 3px 8px rgba(0,0,0,.075),2px 4px 16px rgba(0,0,0,.075);pointer-events:all}.swal2-popup.swal2-toast>*{grid-column:2}.swal2-popup.swal2-toast .swal2-title{margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-loading{justify-content:center}.swal2-popup.swal2-toast .swal2-input{height:2em;margin:.5em;font-size:1em}.swal2-popup.swal2-toast .swal2-validation-message{font-size:1em}.swal2-popup.swal2-toast .swal2-footer{margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-popup.swal2-toast .swal2-close{grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-popup.swal2-toast .swal2-html-container{margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-html-container:empty{padding:0}.swal2-popup.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-popup.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-popup.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-popup.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-popup.swal2-toast .swal2-actions{justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-popup.swal2-toast .swal2-styled{margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-popup.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-popup.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}.swal2-popup.swal2-toast.swal2-show{animation:swal2-toast-show .5s}.swal2-popup.swal2-toast.swal2-hide{animation:swal2-toast-hide .1s forwards}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:.625em;overflow-x:hidden;transition:background-color .1s;-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:rgba(0,0,0,.4)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:32em;max-width:100%;padding:0 0 1.25em;border:none;border-radius:5px;background:#fff;color:#545454;font-family:inherit;font-size:1rem}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:.8em 1em 0;color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:auto;margin:1.25em auto 0;padding:0}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.1))}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2))}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:box-shadow .1s;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border:0;border-radius:.25em;background:initial;background-color:#7066e0;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):focus-visible{box-shadow:0 0 0 3px rgba(112,102,224,.5)}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border:0;border-radius:.25em;background:initial;background-color:#dc3741;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):focus-visible{box-shadow:0 0 0 3px rgba(220,55,65,.5)}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border:0;border-radius:.25em;background:initial;background-color:#6e7881;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):focus-visible{box-shadow:0 0 0 3px rgba(110,120,129,.5)}div:where(.swal2-container) button:where(.swal2-styled).swal2-default-outline:focus-visible{box-shadow:0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid #eee;color:inherit;font-size:1em;text-align:center}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:5px;border-bottom-left-radius:5px}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:rgba(0,0,0,.2)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em}div:where(.swal2-container) button:where(.swal2-close){z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:color .1s,box-shadow .1s;border:none;border-radius:5px;background:rgba(0,0,0,0);color:#ccc;font-family:monospace;font-size:2.5em;cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:none;background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:inset 0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) .swal2-html-container{z-index:1;justify-content:center;margin:0;padding:1em 1.6em .3em;overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:border-color .1s,box-shadow .1s;border:1px solid #d9d9d9;border-radius:.1875em;background:rgba(0,0,0,0);box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(0,0,0,0);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:1px solid #b4dbed;outline:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:#fff}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:rgba(0,0,0,0);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:rgba(0,0,0,0);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:#fff;color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:#f0f0f0;color:#666;font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:#add8e6;color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:#add8e6}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;border:0.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}div:where(.swal2-icon).swal2-warning{border-color:#facea8;color:#f8bb86}div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}div:where(.swal2-icon).swal2-info{border-color:#9de0f6;color:#3fc3ee}div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}div:where(.swal2-icon).swal2-question{border-color:#c9dae1;color:#87adbd}div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:swal2-show .3s}.swal2-hide{animation:swal2-hide .15s forwards}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px rgba(0,0,0,.4)}@media print{body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown) .swal2-container{position:static !important}}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}')},902:()=>{},522:()=>{},753:()=>{}},Yl=>{Yl(Yl.s=421)}]);